var n=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(e,t,r)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;import{_ as c,j as i,r as _,t as s,s as f,g as l,a as v,c as d,b as T,h as G,d as A,e as m,m as p,f as h,i as g,k as E,l as b,n as w,o as y,u as S,v as I,p as k,q as x,w as D,x as F,y as R,z as N,A as C,B as L,C as X,D as O,E as U,F as z,G as M,H as P,I as V,J as j,K as B,L as Z,M as q,N as $,O as W,P as H,Q as K,R as Y,S as J,T as Q,U as nn,V as en,W as tn,X as rn,Y as un,Z as an,$ as on,a0 as cn,a1 as _n,a2 as sn,a3 as fn,a4 as ln,a5 as vn,a6 as dn,a7 as Tn,a8 as Gn,a9 as An,aa as mn,ab as pn,ac as hn,ad as gn,ae as En,af as bn,ag as wn,ah as yn,ai as Sn,aj as In,ak as kn,al as xn,am as Dn,an as Fn,ao as Rn,ap as Nn,aq as Cn,ar as Ln,as as Xn,at as On,au as Un,av as zn,aw as Mn,ax as Pn,ay as Vn,az as jn,aA as Bn,aB as Zn}from"./vendor.b85d44a6.js";function qn(n){return[[],n]}var $n={empty:void 0,add:v,addMono:function(n,e,t){return v(n,e,[[],t])},remove:T,has:G,get:A,show:function(n,e){return"{\n"+i(m(p(n,e)),"\n",(function(n){return"  "+n[0]+": "+n[1]}))+"\n}"}},Wn={TAG:1,_0:"u32",_1:[]},Hn={TAG:1,_0:"bool",_1:[]},Kn={TAG:1,_0:"()",_1:[]};function Yn(n,e){return{TAG:1,_0:"Fun",_1:d(n,[e])}}function Jn(n){switch(0|n.TAG){case 0:case 1:return!1;case 2:return!0}}var Qn=h("Types.Size.UnkownTypeSize");function ne(n){for(;;){var e=n;switch(0|e.TAG){case 0:throw{RE_EXN_ID:Qn,_1:e,Error:new Error};case 1:switch(e._0){case"()":if(0===e._1.length)return 0;throw{RE_EXN_ID:Qn,_1:e,Error:new Error};case"Mut":var t=e._1;if(1!==t.length)throw{RE_EXN_ID:Qn,_1:e,Error:new Error};n=t[0];continue;case"Fun":case"Ptr":return 4;case"Tuple":return g(E(e._1,ne),0,(function(n,e){return n+e|0}));case"bool":case"u32":break;case"u64":if(0===e._1.length)return 8;throw{RE_EXN_ID:Qn,_1:e,Error:new Error};default:throw{RE_EXN_ID:Qn,_1:e,Error:new Error}}if(0===e._1.length)return 4;throw{RE_EXN_ID:Qn,_1:e,Error:new Error};case 2:return 4}}}var ee={UnkownTypeSize:Qn,size:ne,sizeLog2:function(n){return 0|Math.ceil(Math.log2(ne(n)))},isZeroSizedType:function(n){return 0===ne(n)}};function te(n,e,t){if(0===n.TAG)return{TAG:1,_0:[e,t],_1:{TAG:0,_0:n._0}};var r=n._1,u=n._0,a=u[1],o=u[0];return e<o?{TAG:1,_0:[e,t],_1:{TAG:1,_0:[o,a],_1:r}}:{TAG:1,_0:[o,a],_1:te(r,e,t)}}function re(n){return s(function(n,e){for(;;){var t=e,r=n;if(0===r.TAG){var u=r._0;switch(0|u.TAG){case 0:case 1:return t;case 2:var a=u._0;if(0===a.TAG)return t;var o=a._0;if(0===o.TAG)return t;e={hd:o._0,tl:t},n=o._1;continue}}else e={hd:r._0,tl:t},n=r._1}}(n,0))}function ue(n,e){return"{ "+i(function(n,t){for(;;){var r=t,u=n;if(0===u.TAG)return _(s({hd:"..."+c(e,u._0),tl:r}));var a=u._0;t={hd:a[0]+": "+c(e,a[1]),tl:r},n=u._1}}(n,0),", ",(function(n){return n}))+" }"}var ae={make:function(n){return{TAG:0,_0:n}},insert:te,tail:function(n){for(;;){var e=n;if(0===e.TAG)return e._0;n=e._1}},fromArray:function(n,e){return g(n,{TAG:0,_0:{TAG:0,_0:e}},(function(n,e){return te(n,e[0],e[1])}))},toArray:re,toMap:function(n){return b(re(n))},map:function n(e,t){if(0!==e.TAG){var r=e._0;return{TAG:1,_0:[r[0],c(t,r[1])],_1:n(e._1,t)}}var u=c(t,e._0);switch(0|u.TAG){case 0:case 1:return{TAG:0,_0:u};case 2:var a=u._0;return 0===a.TAG?{TAG:0,_0:u}:a._0}},show:ue};function oe(n){switch(0|n.TAG){case 0:return k(void 0,n._0);case 1:return g(E(n._1,oe),void 0,S);case 2:var e=n._0;return 0===e.TAG?void 0:g(E(re(e._0),(function(n){return c(oe,c((function(n){return n[1]}),n))})),void 0,S)}}function ce(n){return y(oe(n[1]),x(n[0]))}function ie(n,e){return[w(y(oe(e),function(n){return g(E(I(n),ce),void 0,S)}(n))),e]}function _e(n){switch(0|n.TAG){case 0:return function(n){var e=String.fromCharCode(97+n%26|0),t=n/26|0;return 0===t?e:e+String(t)}(n._0);case 1:var e=n._1,t=n._0;if(0===e.length)return t;switch(t){case"Fun":var r=f(e,0,e.length-1|0),u=l(e,e.length-1|0);return 1!==r.length?"("+i(r,", ",_e)+") -> "+_e(u):_e(r[0])+" -> "+_e(u);case"Tuple":return"("+i(e,", ",_e)+")";default:return t+"<"+i(e,", ",_e)+">"}case 2:var a=n._0;return 0===a.TAG?a._0:ue(a._0,_e)}}function se(n){switch(n){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/";case 4:return"%";case 5:return"<";case 6:return"<=";case 7:return">";case 8:return">=";case 9:return"==";case 10:return"!="}}var fe={show:se};function le(n){switch(n){case 0:return"-";case 1:return"!";case 2:return"*"}}var ve={show:le};function de(n){return"number"==typeof n?"()":0===n.TAG?String(n._0):n._0?"true":"false"}var Te={show:de};function Ge(n){switch(0|n.TAG){case 0:return de(n._0);case 1:return le(n._0)+Ge(n._1);case 2:return"("+Ge(n._0)+" "+se(n._1)+" "+Ge(n._2)+")";case 3:return n._0;case 4:return Ge(n._0)+" = "+Ge(n._1);case 5:var e=n._1,t=n._0,r=t.length;return 1!==r?0!==r?"("+i(t,", ",(function(n){return n}))+") -> "+Ge(e):"() -> "+Ge(e):t[0]+" -> "+Ge(e);case 6:return"let "+n._0+" = "+Ge(n._1)+" in "+Ge(n._2);case 7:return"("+Ge(n._0)+")("+i(n._1,", ",Ge)+")";case 8:return(1===n._2?"unsafe ":"")+"{\n"+i(d(E(n._0,Ae),D(n._1,[],(function(n){return[Ge(n)]}))),";\n",(function(n){return"  "+n}))+"}\n}";case 9:var u=n._2,a="if "+Ge(n._0)+" "+Ge(n._1);return void 0!==u?a+" else "+Ge(u):a;case 10:return"while "+Ge(n._0)+" "+Ge(n._1);case 11:return"return "+D(n._0,"",Ge);case 12:return Ge(n._0)+" as "+_e(n._1);case 13:return"("+i(n._0,", ",Ge)+")";case 14:return n._0+" {\n"+i(n._1,", ",(function(n){return n[0]+": "+Ge(n[1])}))+"\n}";case 15:return Ge(n._0)+"."+n._1}}function Ae(n){if(0!==n.TAG)return Ge(n._0)+";";var e=n._2,t=n._0;return n._1?"let mut "+t+" = "+Ge(e):"let "+t+" = "+Ge(e)}var me={showExpr:Ge,showDecl:function n(e){switch(0|e.TAG){case 0:return"fn "+e._0+"("+i(e._1,", ",(function(n){return(n[1]?"mut ":"")+n[0]}))+") "+Ge(e._2);case 1:return(e._1?"mut":"let")+" "+e._0+" = "+Ge(e._2);case 2:return"struct "+e._0+" {\n"+i(e._1,",\n",(function(n){return(n[2]?"mut ":"")+n[0]+": "+_e(n[1])}))+"\n}";case 3:return e._0+" {\n"+i(e._1,"\n\n",n)+"\n}"}},showStmt:Ae};function pe(n,e){for(;;){var t=e;switch(0|t.TAG){case 0:var r=t._0,u=L(n,r);if(void 0===u)return{TAG:0,_0:r};e=u;continue;case 1:return{TAG:1,_0:t._0,_1:E(t._1,(function(e){return pe(n,e)}))};case 2:var a=t._0;return{TAG:2,_0:0===a.TAG?{TAG:0,_0:a._0}:{TAG:1,_0:ae.map(a._0,(function(e){return pe(n,e)}))}}}}}function he(n,e){var t=e[0];return[t,pe(C(n,t),e[1])]}function ge(n,e){return F(R(e,(function(e){return pe(n,e)})),n,(function(n,e,t){return N(t,e)}))}function Ee(n,e){return p(e,(function(e){return he(n,e)}))}function be(n,e){for(var t,r=0;X(t)&&r<n.length;){var u=c(e,l(n,r));void 0!==u&&(t=O(U(u))),r=r+1|0}return t}function we(n,e){for(var t,r=n.length-1|0;X(t)&&r>=0;)c(e,l(n,r))?t=r:r=r-1|0;return t}function ye(n,e){for(var t,r=[],u=0;X(t)&&u<n.length;){var a=l(n,u);0===a.TAG?r.push(c(e,a._0)):t=O(a._0),u=u+1|0}return void 0!==t?{TAG:1,_0:U(t)}:{TAG:0,_0:r}}var Se={show:function(n){return"struct "+n.name+"{\n"+i(n.attributes,",\n",(function(n){return"  "+n.name+": "+_e(n.ty)}))+"\n}"},toPartialStructType:function(n,e){return{TAG:2,_0:{TAG:1,_0:ae.fromArray(E(n.attributes,(function(n){return[n.name,n.ty]})),e)}}},make:function(n,e){var t={contents:0},r=[];return j(e,(function(n){var e=n[1],u=ee.size(e);r.push({name:n[0],mut:n[2],offset:t.contents,ty:e,size:u,impl:void 0}),t.contents=t.contents+u|0})),{name:n,attributes:r,size:t.contents,staticFuncs:[]}},addImplementation:function(n,e,t){n.attributes.push({name:e.contents.name,mut:!1,offset:0,ty:e.contents.ty,size:0,impl:[e,t]})},addStaticFunc:function(n,e){n.staticFuncs.push({name:e})}},Ie={tyVarIndex:0,identifiers:[],renaming:P(10),structs:V(5)};function ke(n){var e=Ie.tyVarIndex;return Ie.tyVarIndex=Ie.tyVarIndex+1|0,e}function xe(n){return{TAG:0,_0:ke()}}function De(n){var e=n[0],t=E(e,(function(n){return{TAG:0,_0:ke()}}));return pe(K(Y(e,t)),n[1])}function Fe(n,e){var t=void 0!==n?U(n):void 0,r=Ie.identifiers.length;Ie.identifiers.push(e);var u={contents:{name:e,newName:e,index:r,ty:void 0!==t?t:{TAG:0,_0:ke()}}};return $(Ie.renaming,r,u),u}function Re(n,e){e.contents.ty=pe(n,e.contents.ty)}function Ne(n){return q(Ie.structs,n)}function Ce(n){switch(0|n.TAG){case 0:var e=n._0;return"number"==typeof e?Kn:0===e.TAG?Wn:Hn;case 3:return n._0.contents.ty;case 4:case 11:return Kn;case 12:return D(n._0,Kn,Ce);case 13:return n._2;case 14:return{TAG:1,_0:"Tuple",_1:E(n._0,Ce)};case 15:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return n._0}}function Le(n,e){var t=void 0!==n?U(n):void 0,r=function(n,e){return void 0!==t?"("+e+": "+_e(pe(U(t),n))+")":e};switch(0|e.TAG){case 0:return r(Ce(e),Te.show(e._0));case 1:return r(e._0,"("+Le(O(t),e._1)+" "+fe.show(e._2)+" "+Le(O(t),e._3)+")");case 2:return r(e._0,"("+ve.show(e._1)+Le(O(t),e._2)+")");case 3:var u=e._0;return r(u.contents.ty,u.contents.name);case 4:var a=e._1;return r(Ce(a),Le(O(t),e._0)+" = "+Le(O(t),a));case 5:return r(e._0,"("+i(e._1,", ",(function(n){return n.contents.name}))+") -> "+Le(O(t),e._2));case 6:return r(e._0,"let "+(e._1?"mut":"")+" "+e._2.contents.name+" = "+Le(O(t),e._3)+" in\n"+Le(O(t),e._4));case 7:return r(e._0,"let rec "+e._1.contents.name+" ("+i(e._2,", ",(function(n){return n.contents.name}))+") = "+Le(O(t),e._3)+" in\n"+Le(O(t),e._4));case 8:return r(e._0,"("+Le(O(t),e._1)+")("+i(e._2,", ",(function(n){return Le(O(t),n)}))+")");case 9:var o=e._2,c=O(t);return r(e._0,(1===e._3?"unsafe ":"")+"{\n"+i(d(E(e._1,(function(n){return Xe(c,n)})),D(o,[],(function(n){return[Le(void 0,n)]}))),";\n",(function(n){return"  "+n}))+(X(o)?"; ":"")+"\n}");case 10:return r(e._0,"if "+Le(O(t),e._1)+" "+Le(O(t),e._2)+" else "+Le(O(t),e._3));case 11:return r(Kn,"while "+Le(void 0,e._0)+" "+Le(void 0,e._1));case 12:var _=O(t);return"return "+r(Ce(e),D(e._0,"",(function(n){return Le(_,n)})));case 13:var s=e._0;return r(Ce(s),Le(void 0,s))+" as "+_e(e._2);case 14:var f=O(t);return"("+i(e._0,", ",(function(n){return Le(f,n)}))+")";case 15:return e._0+" {\n"+i(e._1,",\n",(function(n){return n[0]+": "+Le(void 0,n[1])}))+"\n}";case 16:return r(e._0,Le(void 0,e._1)+"."+e._2)}}function Xe(n,e){var t=void 0!==n?U(n):void 0;return Le(O(t),e._0)}function Oe(n,e){var t=void 0!==n?U(n):void 0,r=function(n,e){return void 0!==t?"("+e+": "+_e(pe(U(t),n))+")":e};switch(0|e.TAG){case 0:var u,a=e._1,o=e._0;if(void 0!==t){var c=U(t);u=i(a,", ",(function(n){var e=n[0];return(n[1]?"mut ":"")+e.contents.name+": "+_e(pe(c,e.contents.ty))}))}else u=i(a,", ",(function(n){return(n[1]?"mut ":"")+n[0].contents.name}));return r(o.contents.ty,"fn "+o.contents.name+"("+u+") "+Le(O(t),e._2));case 1:var _=e._0;return r(_.contents.ty,(e._1?"mut":"let")+" "+_.contents.name+" = "+Le(O(t),e._2));case 2:return me.showDecl({TAG:2,_0:e._0,_1:e._1});case 3:return"impl "+e._0+" {\n"+i(e._1,"\n\n",(function(n){return Oe(void 0,{TAG:0,_0:n[0],_1:n[1],_2:n[2]})}))+"\n}"}}var Ue=h("Core.CoreAst.UnexpectedDeclarationInImplBlock"),ze=h("Core.CoreAst.UndeclaredIdentifer"),Me=h("Core.CoreAst.UnreachableLetStmt");function Pe(n,e,t,r,u){return 5===t.TAG?{TAG:7,_0:t._0,_1:n,_2:t._1,_3:t._2,_4:r}:{TAG:6,_0:u,_1:e,_2:n,_3:t,_4:r}}function Ve(n){var e,t={LAZY_DONE:!1,VAL:function(){return xe()}};switch(0|n.TAG){case 0:return{TAG:0,_0:n._0};case 1:return{TAG:2,_0:J(t),_1:n._0,_2:Ve(n._1)};case 2:return{TAG:1,_0:J(t),_1:Ve(n._0),_2:n._1,_3:Ve(n._2)};case 3:var r=n._0,u=(e=r,W(we(Ie.identifiers,(function(n){return n===e})),(function(n){return H(Ie.renaming,n)})));if(void 0!==u)return{TAG:3,_0:u};if(void 0!==Ne(r))return{TAG:3,_0:Fe(void 0,r)};throw{RE_EXN_ID:ze,_1:r,Error:new Error};case 4:return{TAG:4,_0:Ve(n._0),_1:Ve(n._1)};case 5:var a=n._1,o=n._0;if(0===o.length)return{TAG:5,_0:J(t),_1:[Fe(void 0,"__x")],_2:Ve(a)};var c=O(void 0);return{TAG:5,_0:J(t),_1:E(o,(function(n){return Fe(c,n)})),_2:Ve(a)};case 6:return Pe(Fe(void 0,n._0),!1,Ve(n._1),Ve(n._2),J(t));case 7:return{TAG:8,_0:J(t),_1:Ve(n._0),_2:E(n._1,Ve)};case 8:var i=n._2,_=n._1,s=function(n){if(!n)return z(_,Ve);var e=n.hd;if(0!==e.TAG)return{TAG:9,_0:J(t),_1:[je(e)],_2:s(n.tl),_3:i};var r=e._3;return Pe(Fe(void 0,e._0),e._1,Ve(e._2),D(s(n.tl),{TAG:0,_0:0},(function(n){return n})),void 0!==r?r:xe())};return{TAG:9,_0:J(t),_1:[],_2:s(Q(n._0)),_3:i};case 9:return{TAG:10,_0:J(t),_1:Ve(n._0),_2:Ve(n._1),_3:D(n._2,{TAG:0,_0:0},Ve)};case 10:return{TAG:11,_0:Ve(n._0),_1:Ve(n._1)};case 11:return{TAG:12,_0:z(n._0,Ve)};case 12:return{TAG:13,_0:Ve(n._0),_1:J(t),_2:n._1};case 13:return{TAG:14,_0:E(n._0,Ve)};case 14:return{TAG:15,_0:n._0,_1:E(n._1,(function(n){return[n[0],Ve(n[1])]}))};case 15:return{TAG:16,_0:xe(),_1:Ve(n._0),_2:n._1}}}function je(n){if(0!==n.TAG)return{_0:Ve(n._0)};throw{RE_EXN_ID:Me,Error:new Error}}function Be(n){switch(0|n.TAG){case 0:var e=E(n._1,(function(n){return[Fe(O(void 0),n[0]),n[1]]}));return{TAG:0,_0:Fe(void 0,n._0),_1:e,_2:Ve(n._2)};case 1:return{TAG:1,_0:Fe(void 0,n._0),_1:n._1,_2:Ve(n._2)};case 2:var t=n._1,r=n._0;return a=Se.make(r,t),Z(Ie.structs,a.name,a),{TAG:2,_0:r,_1:t};case 3:var u=E(E(n._1,Be),(function(n){if(0===n.TAG)return[n._0,n._1,n._2];throw{RE_EXN_ID:Ue,_1:n,Error:new Error}}));return{TAG:3,_0:n._0,_1:u}}var a}function Ze(n,e){var t=function(e){return Ze(n,e)};switch(0|e.TAG){case 0:return{TAG:0,_0:e._0};case 1:return{TAG:1,_0:pe(n,e._0),_1:Ze(n,e._1),_2:e._2,_3:Ze(n,e._3)};case 2:return{TAG:2,_0:pe(n,e._0),_1:e._1,_2:Ze(n,e._2)};case 3:return{TAG:3,_0:e._0};case 4:return{TAG:4,_0:Ze(n,e._0),_1:Ze(n,e._1)};case 5:return{TAG:5,_0:pe(n,e._0),_1:e._1,_2:Ze(n,e._2)};case 6:return{TAG:6,_0:pe(n,e._0),_1:e._1,_2:e._2,_3:Ze(n,e._3),_4:Ze(n,e._4)};case 7:return{TAG:7,_0:pe(n,e._0),_1:e._1,_2:e._2,_3:Ze(n,e._3),_4:Ze(n,e._4)};case 8:return{TAG:8,_0:pe(n,e._0),_1:Ze(n,e._1),_2:E(e._2,t)};case 9:return{TAG:9,_0:pe(n,e._0),_1:E(e._1,(function(e){return qe(n,e)})),_2:z(e._2,t),_3:e._3};case 10:return{TAG:10,_0:pe(n,e._0),_1:Ze(n,e._1),_2:Ze(n,e._2),_3:Ze(n,e._3)};case 11:return{TAG:11,_0:Ze(n,e._0),_1:Ze(n,e._1)};case 12:return{TAG:12,_0:z(e._0,t)};case 13:return{TAG:13,_0:Ze(n,e._0),_1:pe(n,e._1),_2:pe(n,e._2)};case 14:return{TAG:14,_0:E(e._0,t)};case 15:var r=e._1,u=e._0,a=Ne(u);if(void 0===a)return nn('unreachable: undeclared struct "'+u+"'");var o=function(n,e){for(var t=[],r=!1,u=0;!1===r&&u<n.length;){var a=l(n,u);void 0!==a?t.push(c(e,U(a))):r=!0,u=u+1|0}return r?void 0:t}(E(tn(a.attributes,(function(n){return X(n.impl)})),(function(n){var e=n.name;return en(r,(function(n){return n[0]===e}))})),(function(e){return[e[0],Ze(n,e[1])]}));return void 0!==o?{TAG:15,_0:u,_1:o}:nn('unreachable: missing attribute for struct "'+u+'"');case 16:return{TAG:16,_0:pe(n,e._0),_1:Ze(n,e._1),_2:e._2}}}function qe(n,e){return{_0:Ze(n,e._0)}}function $e(n,e){switch(0|e.TAG){case 0:return{TAG:0,_0:e._0,_1:e._1,_2:Ze(n,e._2)};case 1:return{TAG:1,_0:e._0,_1:e._1,_2:Ze(n,e._2)};case 2:return e;case 3:return{TAG:3,_0:e._0,_1:E(e._1,(function(e){return[e[0],e[1],Ze(n,e[2])]}))}}}var We={typeOfExpr:Ce,typeOfStmt:function(n){return Ce(n._0)},showExpr:Le,showStmt:Xe,showDecl:Oe,UnexpectedDeclarationInImplBlock:Ue,UndeclaredIdentifer:ze,UnreachableLetStmt:Me,rewriteLetIn:Pe,fromExpr:Ve,fromStmt:je,fromDecl:Be,substExpr:Ze,substStmt:qe,substDecl:$e},He={show:Le,from:Ve,subst:Ze,typeOf:Ce},Ke={show:Oe,from:Be,subst:$e};function Ye(n){var e=[];return function(n){for(;;){var t=127&n,r=n>>>7;if(0===r)return void e.push(t);e.push(128|t),n=r}}(n),e}function Je(n){var e=[];return function(n){for(;;){var t=127&n,r=n>>7;if(0===r&&0==(64&t)||-1===r&&0!=(64&t))return void e.push(t);e.push(128|t),n=r}}(0|n),e}function Qe(n){return d(Ye(n.length),n)}function nt(n){return d(Ye(n.length),rn(n))}var et={encode:Qe,encodeMany:nt};function tt(n){var e=new DataView(new ArrayBuffer(4));return e.setFloat32(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3)]}var rt={encode:tt};function ut(n){var e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3),e.getUint8(4),e.getUint8(5),e.getUint8(6),e.getUint8(7)]}var at={encode:ut};function ot(n,e){return d([n],Qe(e))}function ct(n){var e;switch(n){case 0:e="custom";break;case 1:e="type";break;case 2:e="import";break;case 3:e="function";break;case 4:e="table";break;case 5:e="memory";break;case 6:e="global";break;case 7:e="export";break;case 8:e="start";break;case 9:e="element";break;case 10:e="code";break;case 11:e="data"}return"["+e+"]"}var it={id:function(n){return n},encode:ot,show:ct};function _t(n){switch(n){case 0:return 127;case 1:return 126;case 2:return 125;case 3:return 124}}function st(n){switch(n){case 0:return"i32";case 1:return"i64";case 2:return"f32";case 3:return"f64"}}var ft={encode:_t,show:st};function lt(n){return"number"==typeof n?[64]:0===n.TAG?[_t(n._0)]:Ye(n._0)}var vt={encode:lt,show:function(n){return"number"==typeof n?"void":0===n.TAG?st(n._0):"type "+String(n._0)}};function dt(n){if("number"==typeof n)switch(n){case 0:return[5,"else"];case 1:return[11,"end"];case 2:return[15,"return"];case 3:return[26,"drop"];case 4:return[106,"i32.add"];case 5:return[107,"i32.sub"];case 6:return[108,"i32.mul"];case 7:return[110,"i32.div_s"];case 8:return[109,"i32.div_u"];case 9:return[69,"i32.eqz"];case 10:return[70,"i32.eq"];case 11:return[81,"i64.eq"];case 12:return[91,"f32.eq"];case 13:return[97,"f64.eq"];case 14:return[71,"i32.ne"];case 15:return[82,"i64.ne"];case 16:return[92,"f32.ne"];case 17:return[98,"f64.ne"];case 18:return[76,"i32.le_s"];case 19:return[77,"i32.le_u"];case 20:return[87,"i64.le_s"];case 21:return[88,"i64.le_u"];case 22:return[95,"f32.le"];case 23:return[101,"f64.le"];case 24:return[78,"i32.ge_s"];case 25:return[79,"i32.ge_u"];case 26:return[89,"i64.ge_s"];case 27:return[90,"i64.ge_u"];case 28:return[96,"f32.ge"];case 29:return[102,"f64.ge"];case 30:return[72,"i32.lt_s"];case 31:return[73,"i32.lt_u"];case 32:return[83,"i64.lt_s"];case 33:return[84,"i64.lt_u"];case 34:return[93,"f32.lt"];case 35:return[99,"f64.lt"];case 36:return[74,"i32.gt_s"];case 37:return[75,"i32.gt_u"];case 38:return[85,"i64.gt_s"];case 39:return[86,"i64.gt_u"];case 40:return[94,"f32.gt"];case 41:return[100,"f64.gt"];case 42:return[111,"i32.rem_s"];case 43:return[112,"i32.rem_u"];case 44:return[113,"i32.and"]}else switch(0|n.TAG){case 0:return[65,"i32.const "+String(n._0)];case 1:return[66,"i64.const "+String(n._0)];case 2:return[67,"i64.const "+String(n._0)];case 3:return[68,"i64.const "+String(n._0)];case 4:return[4,"if"];case 5:return[13,"br_if "+String(n._0)];case 6:return[12,"br "+String(n._0)];case 7:return[2,"block"];case 8:return[3,"loop"];case 9:return[35,"global.get "+String(n._0)];case 10:return[36,"global.set "+String(n._0)];case 11:return[32,"local.get "+String(n._0)];case 12:return[33,"local.set "+String(n._0)];case 13:return[34,"local.tee "+String(n._0)];case 14:return[16,"call "+String(n._0)];case 15:return[17,"call_indirect [typeIndex="+String(n._0)+", tableIndex="+String(n._1)+"]"];case 16:return[40,"i32.load (alignment="+String(n._0)+", offset="+String(n._1)+")"];case 17:return[54,"i32.store (alignment="+String(n._0)+", offset="+String(n._1)+")"]}}function Tt(n){return dt(n)[0]}function Gt(n){if("number"==typeof n)switch(n){case 0:case 1:return-1;default:return 0}else switch(0|n.TAG){case 4:case 7:case 8:return 1;default:return 0}}function At(n,e,t,r){var u,a=void 0!==n?n:{contents:0},o=dt(e),c=Gt(e),_=i(un(0,a.contents+(c<0?c:0)|0),"  ",(function(n){return""}));a.contents=a.contents+c|0,0===e&&(a.contents=a.contents+1|0);var s=0;if("number"==typeof e)u="";else switch(0|e.TAG){case 11:case 12:case 13:s=1;break;case 14:u="<"+D(an(t,e._0),"??",(function(n){return n}))+">";break;default:u=""}return 1===s&&(u="<"+D(an(r,e._0),"??",(function(n){return n}))+">"),_+o[1]+" "+u}function mt(n){var e=0;if("number"==typeof n)return[Tt(n)];switch(0|n.TAG){case 0:case 1:e=1;break;case 2:return d([Tt(n)],tt(n._0));case 3:return d([Tt(n)],ut(n._0));case 5:case 6:e=3;break;case 4:case 7:case 8:e=2;break;case 9:case 10:case 11:case 12:case 13:e=4;break;case 14:return d([Tt(n)],Ye(n._0));case 15:return rn([[Tt(n)],Ye(n._0),Ye(n._1)]);case 16:case 17:e=5}switch(e){case 1:return d([Tt(n)],Je(n._0));case 2:return d([Tt(n)],lt(n._0));case 3:case 4:return d([Tt(n)],Ye(n._0));case 5:return rn([[Tt(n)],Ye(n._0),Ye(n._1)])}}var pt={info:dt,opcode:Tt,identationDelta:Gt,show:At,encode:mt};function ht(n){return rn([[96],Qe(E(n._0,_t)),Qe(E(n._1,_t))])}function gt(n){var e=n._1,t=n._0,r=i(t,", ",st),u=i(e,", ",st);if(1===t.length){var a=e.length;if(1===a)return r+" -> "+u;if(0===a)return r+" -> ()"}var o=e.length;return 1!==o?0!==o?"("+r+") -> ("+u+")":"("+r+") -> ()":"("+r+") -> "+u}function Et(n){return d(Ye(n[0].length),[_t(n[1])])}function bt(n){return"local ["+i(n[0],", ",(function(n){return n}))+"] "+st(n[1])}function wt(n){var e=nt(E(n[0],Et)),t=rn(E(n[1],mt));return rn([[e.length+t.length|0],e,t])}function yt(n,e,t){var r=n[0],u={contents:1},a=_n(t._0,(function(n,e){return"param["+String(n)+"]"})),o=d(a,rn(E(r,(function(n){return n[0]})))),c=i(r,"\n",bt),_=i(n[1],"\n",(function(n){return At(u,n,e,o)}));return 0===r.length?_:c+"\n"+_}var St={Signature:{funcTypeCode:96,make:function(n,e){return{_0:n,_1:e}},empty:{_0:[],_1:[]},encode:ht,show:gt},Local:{fromTypes:function(n){var e=on(function(n,e){for(;;){var t=e,r=n;if(!r)return t;var u=r.tl,a=r.hd,o=a[1],c=a[0];if(t){var i=t.tl,_=t.hd,s=_[1],f=_[0];if(sn(o,s)){e={hd:[{hd:c,tl:f},s],tl:i},n=u;continue}e={hd:[{hd:c,tl:0},o],tl:{hd:[f,s],tl:i}},n=u}else e={hd:[{hd:c,tl:0},o],tl:0},n=u}}(Q(n),0));return s(cn(e,(function(n){return[_(s(n[0])),n[1]]})))},encode:Et,show:bt},Body:{make:function(n,e){return[n,e]},encode:wt,show:yt},make:function(n,e,t){return[n,e,t]}};function It(n,e){var t=M(n,(function(n){return sn(n,e)}));return void 0!==t?t:(n.push(e),n.length-1|0)}function kt(n){return ot(1,nt(E(n,ht)))}function xt(n){return ct(1)+"\n"+i(n,"\n",gt)}var Dt={make:function(n){return[]},getOrAdd:It,encode:kt,show:xt};function Ft(n,e){return n.push(e),n.length-1|0}function Rt(n){return ot(3,nt(E(n,Ye)))}function Nt(n,e){return ct(3)+"\n"+i(Y(n,e),"\n",(function(n){return n[1]+": "+String(n[0])}))}var Ct={make:function(n){return[]},addSignature:Ft,encode:Rt,show:Nt};function Lt(n,e){return n.push(e),n.length-1|0}function Xt(n){return ot(10,nt(E(n,wt)))}function Ot(n,e){var t=E(e,(function(n){return n[0]}));return ct(10)+"\n"+i(Y(n,e),"\n\n",(function(n){var e=n[1];return e[0]+"\n"+yt(n[0],t,e[1])}))}var Ut={make:function(n){return[]},addFunc:Lt,encode:Xt,show:Ot};function zt(n){return Qe(E(n.split(""),(function(n){return 0|n.charCodeAt(0)})))}var Mt={encode:zt};function Pt(n){switch(n){case 0:return"func";case 1:return"table";case 2:return"memory";case 3:return"global"}}function Vt(n){return rn([zt(n.name),[n.kind],Ye(n.index)])}function jt(n){return"export "+Pt(n.kind)+" "+n.name+" (index: "+String(n.index)+")"}var Bt={ExternalKind:{encode:function(n){return[n]},show:Pt},make:function(n,e,t){return{name:n,kind:e,index:t}},encode:Vt,show:jt};function Zt(n){return ot(7,nt(E(n,Vt)))}function qt(n){return ct(7)+"\n"+i(n,"\n",jt)}var $t={make:function(n){return[]},add:function(n,e){n.push(e)},encode:Zt,show:qt};var Wt={show:function(n){return n?"externref":"funcref"},encode:function(n){return n?111:112}};function Ht(n){return"{ min: "+String(n[0])+", max: "+D(n[1],"?",(function(n){return String(n)}))+" }"}function Kt(n){var e=n[1],t=n[0];return void 0!==e?rn([[1],Ye(t),Ye(e)]):d([0],Ye(t))}var Yt={show:Ht,make:function(n,e){return[n,e]},makeExact:function(n){return[n,n]},encode:Kt};function Jt(n){return d([n[0]?111:112],Kt(n[1]))}function Qt(n){return"table "+(n[0]?"externref":"funcref")+" "+Ht(n[1])}var nr={make:function(n,e){return[n,e]},encode:Jt,show:Qt};function er(n){return ct(4)+"\n"+i(n,"\n",Qt)}function tr(n){return ot(4,nt(E(n,Jt)))}var rr={make:function(n){return[]},add:function(n,e){n.push(e)},show:er,encode:tr};function ur(n){return"elem funcref ("+i(n.funcIndices," ",(function(n){return String(n)}))+") (offset="+String(n.offset)+")"}function ar(n){return rn([[0],mt({TAG:0,_0:n.offset}),mt(1),nt(E(n.funcIndices,Ye))])}var or={fromFuncRefs:function(n,e){return{offset:void 0!==n?n:0,funcIndices:e}},show:ur,encode:ar};function cr(n){return ct(9)+"\n"+i(n,"\n",ur)}function ir(n){return ot(9,nt(E(n,ar)))}var _r={make:function(n){return[]},add:function(n,e){n.push(e)},show:cr,encode:ir};function sr(n){return d(rn(E(n,mt)),mt(1))}function fr(n){return 1!==n.length?"\n"+i(n,"\n",(function(n){return"  "+At(void 0,n,[],[])}))+"\nend":At(void 0,n[0],[],[])}function lr(n){return"global "+(n[1]?"mutable":"immutable")+" "+st(n[0])+" = "+fr(n[2])}function vr(n){return d([_t(n[0]),n[1]?1:0],sr(n[2]))}var dr={Initializer:{fromInstructions:function(n){return n},encode:sr,show:fr},make:function(n,e,t){return[e,n,t]},show:lr,encode:vr};function Tr(n){return ct(6)+"\n"+i(n,"\n",lr)}function Gr(n){return ot(6,nt(E(n,vr)))}var Ar={make:function(n){return[]},add:function(n,e){n.push(e)},show:Tr,encode:Gr};function mr(n){return"memory "+Ht(n)}var pr={make:function(n){return n},show:mr,encode:Kt};function hr(n,e){return n.push(e)-1|0}function gr(n){return ct(5)+"\n"+i(n,"\n",mr)}function Er(n){return ot(5,nt(E(n,Kt)))}var br={make:function(n){return[]},add:hr,show:gr,encode:Er};function wr(n,e,t,r){var u=It(n.typeSection,t);return Ft(n.funcSection,u),n.funcs.push([e,t,r]),Lt(n.codeSection,r)+n.importsCount|0}function yr(n){return rn([[0,97,115,109,1,0,0,0],kt(n.typeSection),Rt(n.funcSection),tr(n.tableSection),Er(n.memorySection),Gr(n.globalSection),Zt(n.exportSection),ir(n.elementSection),Xt(n.codeSection)])}var Sr={make:function(n){return{typeSection:[],funcSection:[],tableSection:[],memorySection:[],globalSection:[],exportSection:[],elementSection:[],codeSection:[],funcs:[],importsCount:0}},getOrAddSignature:function(n,e){return It(n.typeSection,e)},addFunc:wr,addExportedFunc:function(n,e,t,r){var u=wr(n,e,t,r),a={name:e,kind:0,index:u};return n.exportSection.push(a),u},addTable:function(n,e){n.tableSection.push(e)},addElement:function(n,e){n.elementSection.push(e)},addGlobal:function(n,e){n.globalSection.push(e)},addMemory:function(n,e){return hr(n.memorySection,e)},encode:yr,encodeAsUint8Array:function(n){return e=yr(n),Uint8Array.from(e);var e},show:function(n){return i([xt(n.typeSection),Nt(n.funcSection,E(n.funcs,(function(n){return n[0]}))),er(n.tableSection),gr(n.memorySection),Tr(n.globalSection),qt(n.exportSection),cr(n.elementSection),Ot(n.codeSection,n.funcs)],"\n\n",(function(n){return n}))}},Ir=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uleb128:Ye,sleb128:Je,Vec:et,F32:rt,F64:at,Section:it,ValueType:ft,BlockReturnType:vt,Inst:pt,Func:St,TypeSection:Dt,FuncSection:Ct,CodeSection:Ut,Str:Mt,ExportEntry:Bt,ExportSection:$t,ReferenceType:Wt,Limits:Yt,Table:nr,TableSection:rr,Elem:or,ElementSection:_r,Global:dr,GlobalSection:Ar,Memory:pr,MemorySection:br,Module:Sr});function kr(n){return[n,0,n.length]}function xr(n,e){var t=e[2],r=void 0!==n?n:1;return[e[0],Math.min(e[1]+r|0,t),t]}function Dr(n){return an(n[0],n[1])}function Fr(n){return xr(1,n)}function Rr(n){return n[1]===n[2]}function Nr(n,e){var t=Dr(e);if(void 0!==t&&c(n,t))return[t,xr(void 0,e)]}function Cr(n){return function(e){return Nr((function(e){return e===n}),e)}}function Lr(n){return n>=97&&n<=122}function Xr(n){return n>=48&&n<=57}function Or(n){return!!function(n){return!!Lr(n)||function(n){return n>=65&&n<=90}(n)}(n)||Xr(n)}function Ur(n){return Nr(Lr,n)}function zr(n){return Nr(Or,n)}function Mr(n){return n>13||n<9?32===n:!(12===n||11===n)}function Pr(n){return Nr(Mr,n)}function Vr(n,e,t){return z(c(n,t),(function(n){return[c(e,n[0]),n[1]]}))}function jr(n,e,t){for(;;){var r=t,u=void 0!==n?n:[];if(Rr(r))return[u,r];var a=c(e,r);if(void 0===a)return[u,r];u.push(a[0]),t=a[1],n=u}}function Br(n){return jr(void 0,Pr,n)}function Zr(n,e,t){return W(c(n,t),(function(n){var t=n[0];return z(c(e,n[1]),(function(n){return[[t,n[0]],n[1]]}))}))}function qr(n){return function(e){return Vr((function(e){return Zr(n,(function(e){return jr(void 0,n,e)}),e)}),(function(n){return d([n[0]],n[1])}),e)}}function $r(n){if(!n)return function(n){return[0,n]};var e=n.hd,t=$r(n.tl),r=function(n){return Zr(e,t,n)};return function(n){return Vr(r,(function(n){return{hd:n[0],tl:n[1]}}),n)}}function Wr(n,e,t){var r=c(n,t);return void 0!==r?[r[0],r[1]]:c(e,t)}function Hr(n,e){return be(n,(function(n){return c(n,e)}))}function Kr(n){var e=Array.from(n,(function(n){var e=fn(n,0);return function(n){return Nr((function(n){return n===e}),n)}})),t=$r(Q(e));return function(e){return Vr(t,(function(e){return n}),e)}}var Yr=qr((function(n){return Nr(Xr,n)}));var Jr=Kr("false");function Qr(n){return Vr(Jr,(function(n){return{TAG:1,_0:!1}}),n)}var nu=Kr("true");function eu(n){return Vr(nu,(function(n){return{TAG:1,_0:!0}}),n)}var tu=[zr,Cr(95),Cr(39)];function ru(n){return Hr(tu,n)}function uu(n){return jr(void 0,ru,n)}var au=Cr(95);function ou(n){return Wr(Ur,au,n)}function cu(n){return Zr(ou,uu,n)}var iu=[zr,Cr(95)],_u=qr((function(n){return Hr(iu,n)}));var su=Kr("let"),fu=Kr("mut"),lu=Kr("in"),vu=Kr("if"),du=Kr("else"),Tu=Kr("fn"),Gu=Kr("while"),Au=Kr("return"),mu=Kr("as"),pu=Kr("unsafe"),hu=Kr("struct"),gu=Kr("impl"),Eu=[function(n){return Vr(su,(function(n){return{TAG:5,_0:0}}),n)},function(n){return Vr(fu,(function(n){return{TAG:5,_0:1}}),n)},function(n){return Vr(lu,(function(n){return{TAG:5,_0:2}}),n)},function(n){return Vr(vu,(function(n){return{TAG:5,_0:3}}),n)},function(n){return Vr(du,(function(n){return{TAG:5,_0:4}}),n)},function(n){return Vr(Tu,(function(n){return{TAG:5,_0:5}}),n)},function(n){return Vr(Gu,(function(n){return{TAG:5,_0:6}}),n)},function(n){return Vr(Au,(function(n){return{TAG:5,_0:7}}),n)},function(n){return Vr(mu,(function(n){return{TAG:5,_0:8}}),n)},function(n){return Vr(pu,(function(n){return{TAG:5,_0:9}}),n)},function(n){return Vr(hu,(function(n){return{TAG:5,_0:10}}),n)},function(n){return Vr(gu,(function(n){return{TAG:5,_0:11}}),n)}];function bu(n){return Hr(Eu,n)}function wu(n){return Zr(bu,(function(n){return void 0!==c(zr,e=n)?void 0:[void 0,Fr(e)];var e}),n)}var yu=Kr("->"),Su=Kr("=="),Iu=Kr("!="),ku=Cr(43),xu=Cr(45),Du=Cr(42),Fu=Cr(47),Ru=Cr(37),Nu=Kr("<="),Cu=Kr(">="),Lu=Cr(60),Xu=Cr(62),Ou=Cr(40),Uu=Cr(41),zu=Cr(44),Mu=Cr(59),Pu=Cr(61),Vu=Cr(123),ju=Cr(125),Bu=Cr(58),Zu=Cr(33),qu=Cr(46),$u=[function(n){return Vr(yu,(function(n){return{TAG:2,_0:5}}),n)},function(n){return Vr(Su,(function(n){return{TAG:2,_0:14}}),n)},function(n){return Vr(Iu,(function(n){return{TAG:2,_0:15}}),n)},function(n){return Vr(ku,(function(n){return{TAG:2,_0:9}}),n)},function(n){return Vr(xu,(function(n){return{TAG:2,_0:10}}),n)},function(n){return Vr(Du,(function(n){return{TAG:2,_0:11}}),n)},function(n){return Vr(Fu,(function(n){return{TAG:2,_0:12}}),n)},function(n){return Vr(Ru,(function(n){return{TAG:2,_0:13}}),n)},function(n){return Vr(Nu,(function(n){return{TAG:2,_0:17}}),n)},function(n){return Vr(Cu,(function(n){return{TAG:2,_0:19}}),n)},function(n){return Vr(Lu,(function(n){return{TAG:2,_0:16}}),n)},function(n){return Vr(Xu,(function(n){return{TAG:2,_0:18}}),n)},function(n){return Vr(Ou,(function(n){return{TAG:2,_0:0}}),n)},function(n){return Vr(Uu,(function(n){return{TAG:2,_0:1}}),n)},function(n){return Vr(zu,(function(n){return{TAG:2,_0:2}}),n)},function(n){return Vr(Mu,(function(n){return{TAG:2,_0:3}}),n)},function(n){return Vr(Pu,(function(n){return{TAG:2,_0:4}}),n)},function(n){return Vr(Vu,(function(n){return{TAG:2,_0:6}}),n)},function(n){return Vr(ju,(function(n){return{TAG:2,_0:7}}),n)},function(n){return Vr(Bu,(function(n){return{TAG:2,_0:8}}),n)},function(n){return Vr(Zu,(function(n){return{TAG:2,_0:20}}),n)},function(n){return Vr(qu,(function(n){return{TAG:2,_0:21}}),n)}];var Wu=[function(n){return Vr(Yr,(function(n){return{TAG:0,_0:ln(vn(i(n,"",(function(n){return dn(1,n)}))))}}),n)},function(n){return Wr(eu,Qr,n)},function(n){return Vr(wu,(function(n){return n[0]}),n)},function(n){return Hr($u,n)},function(n){return Vr(cu,(function(n){return{TAG:3,_0:dn(1,n[0])+i(n[1],"",(function(n){return dn(1,n)}))}}),n)},function(n){return Vr(_u,(function(n){return{TAG:4,_0:i(n,"",(function(n){return dn(1,n)}))}}),n)}];function Hu(n){return Hr(Wu,n)}function Ku(n){return jr(void 0,(function(n){return Vr((function(n){return e=Br,W(Zr(Br,Hu,n),(function(n){var t=n[0],r=t[1],u=t[0];return z(c(e,n[1]),(function(n){return[[u,r,n[0]],n[1]]}))}));var e}),(function(n){return n[1]}),n)}),n)}function Yu(n){switch(0|n.TAG){case 0:return String(n._0);case 1:return n._0?"true":"false";case 2:return function(n){switch(n){case 0:return"(";case 1:return")";case 2:return",";case 3:return";";case 4:return"=";case 5:return"->";case 6:return"{";case 7:return"}";case 8:return":";case 9:return"+";case 10:return"-";case 11:return"*";case 12:return"/";case 13:return"%";case 14:return"==";case 15:return"!=";case 16:return"<";case 17:return"<=";case 18:return">";case 19:return">=";case 20:return"!";case 21:return"."}}(n._0);case 3:case 4:return n._0;case 5:return function(n){switch(n){case 0:return"let";case 1:return"mut";case 2:return"in";case 3:return"if";case 4:return"else";case 5:return"fn";case 6:return"while";case 7:return"return";case 8:return"as";case 9:return"unsafe";case 10:return"struct";case 11:return"impl"}}(n._0)}}function Ju(n){return{contents:function(e){return W(Dr(e),(function(t){if(c(n,t))return[t,Fr(e)]}))}}}function Qu(n){return{contents:function(e){return W(Dr(e),(function(t){return z(c(n,t),(function(n){return[n,Fr(e)]}))}))}}}function na(n){return Ju((function(e){return sn(e,n)}))}function ea(n,e){return{contents:function(t){return z(c(n.contents,t),(function(n){return[c(e,n[0]),n[1]]}))}}}function ta(n,e){return{contents:function(t){return W(c(n.contents,t),(function(n){var t=n[0];return z(c(e.contents,n[1]),(function(n){return[[t,n[0]],n[1]]}))}))}}}function ra(n){var e=function(n){return{contents:function(t){if(Rr(t))return[0,t];var r=c(n.contents,t);if(void 0===r)return[0,t];var u=r[0];return z(c(e(n).contents,r[1]),(function(n){return[{hd:u,tl:n[0]},n[1]]}))}}};return ea(e(n),s)}function ua(n,e,t){return{contents:function(r){return W(c(ta(n,e).contents,r),(function(n){var e=n[0],r=e[1],u=e[0];return z(c(t.contents,n[1]),(function(n){return[[u,r,n[0]],n[1]]}))}))}}}function aa(n,e,t,r){return{contents:function(u){return W(c(ua(n,e,t).contents,u),(function(n){var e=n[0],t=e[2],u=e[1],a=e[0];return z(c(r.contents,n[1]),(function(n){return[[a,u,t,n[0]],n[1]]}))}))}}}function oa(n,e,t,r,u){return{contents:function(a){return W(c(aa(n,e,t,r).contents,a),(function(n){var e=n[0],t=e[3],r=e[2],a=e[1],o=e[0];return z(c(u.contents,n[1]),(function(n){return[[o,a,r,t,n[0]],n[1]]}))}))}}}function ca(n,e){return{contents:function(t){var r=c(n.contents,t);return void 0!==r?[r[0],r[1]]:c(e.contents,t)}}}function ia(n){return{contents:function(e){return be(n,(function(n){return c(n.contents,e)}))}}}function _a(n,e,t){return ea(ta(n,ra(e)),(function(n){var e=n[1],r=n[0];return sn(e,[])?r:g(e,r,t)}))}function sa(n,e,t){return _a(n,ta(e,n),(function(n,e){return Tn(t,n,e[0],e[1])}))}function fa(n){return ea(ua(Ju((function(n){return sn(n,{TAG:2,_0:0})})),n,Ju((function(n){return sn(n,{TAG:2,_0:1})}))),(function(n){return n[1]}))}function la(n){return function(n,e){var t=function(r,u){var a=c(n.contents,r);if(void 0===a)return[u,r];var o=a[1];return u.push(a[0]),D(c(e.contents,o),[u,o],(function(n){return t(n[1],u)}))};return{contents:function(n){return t(n,[])}}}(n,Ju((function(n){return sn(n,{TAG:2,_0:2})})))}function va(n){return ca(ea(n,(function(n){return O(n)})),{contents:function(n){return[void 0,n]}})}var da={contents:function(n){}},Ta={contents:function(n){}},Ga={contents:function(n){}},Aa={contents:function(n){}},ma={contents:function(n){}},pa=Qu((function(n){if(0===n.TAG)return{TAG:0,_0:{TAG:0,_0:n._0}}})),ha=Qu((function(n){if(1===n.TAG)return{TAG:0,_0:{TAG:1,_0:n._0}}})),ga=Qu((function(n){if(3===n.TAG)return n._0})),Ea=Qu((function(n){if(4===n.TAG)return n._0})),ba=Qu((function(n){switch(0|n.TAG){case 3:case 4:return n._0;default:return}})),wa=ca(ea(ta(na({TAG:2,_0:0}),na({TAG:2,_0:1})),(function(n){return Kn})),Qu((function(n){switch(0|n.TAG){case 3:switch(n._0){case"bool":return Hn;case"u32":return Wn;default:return}case 4:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return}}))),ya=ca(wa,fa(ma)),Sa=ca(ea(ua(ca(fa(la(ma)),ea(ya,(function(n){return[n]}))),na({TAG:2,_0:5}),ma),(function(n){return Yn(n[0],n[2])})),ya),Ia=ca(ea(aa(Ea,na({TAG:2,_0:16}),la(ma),na({TAG:2,_0:18})),(function(n){return{TAG:1,_0:n[0],_1:n[2]}})),Sa);ma.contents=Ia.contents;var ka,xa,Da,Fa,Ra,Na,Ca,La=ea(ta(ba,va(ta(na({TAG:2,_0:8}),ma))),(function(n){return[n[0],z(n[1],(function(n){return n[1]}))]})),Xa=ea(ca(ga,ba),(function(n){return{TAG:3,_0:n}})),Oa=ia([pa,ha,ea(ta(na({TAG:2,_0:0}),na({TAG:2,_0:1})),(function(n){return{TAG:0,_0:0}})),Xa,ea(fa(aa(Ta,na({TAG:2,_0:2}),Ta,va(ta(na({TAG:2,_0:2}),la(Ta))))),(function(n){return{TAG:13,_0:d([n[0],n[2]],D(n[3],[],(function(n){return n[1]})))}})),fa(Ta)]),Ua=ca(_a(Oa,ta(na({TAG:2,_0:21}),ga),(function(n,e){return{TAG:15,_0:n,_1:e[1]}})),Oa),za=ca(ea(ta(Ua,ea(ta(ka=fa(la(Ta)),ra(ka)),(function(n){return d([n[0]],n[1])}))),(function(n){return g(n[1],n[0],(function(n,e){return{TAG:7,_0:n,_1:e}}))})),Ua),Ma=ia([ea(na({TAG:2,_0:11}),(function(n){return 2})),ea(na({TAG:2,_0:10}),(function(n){return 0})),ea(na({TAG:2,_0:20}),(function(n){return 1}))]),Pa=ca(ea(na({TAG:2,_0:9}),(function(n){return 0})),ea(na({TAG:2,_0:10}),(function(n){return 1}))),Va=ia([ea(na({TAG:2,_0:11}),(function(n){return 2})),ea(na({TAG:2,_0:12}),(function(n){return 3})),ea(na({TAG:2,_0:13}),(function(n){return 4}))]),ja=ia([ea(na({TAG:2,_0:16}),(function(n){return 5})),ea(na({TAG:2,_0:17}),(function(n){return 6})),ea(na({TAG:2,_0:18}),(function(n){return 7})),ea(na({TAG:2,_0:19}),(function(n){return 8}))]),Ba=ca(ea(na({TAG:2,_0:14}),(function(n){return 9})),ea(na({TAG:2,_0:15}),(function(n){return 10}))),Za=sa(ca(ea(ta(Ma,za),(function(n){return{TAG:1,_0:n[0],_1:n[1]}})),za),Va,(function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}})),qa=sa(Za,Pa,(function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}})),$a=sa(qa,ja,(function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}})),Wa=sa($a,Ba,(function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}})),Ha=ca(ea(aa(na({TAG:5,_0:3}),Ta,Ga,va(ta(na({TAG:5,_0:4}),Ga))),(function(n){return{TAG:9,_0:n[1],_1:n[2],_2:z(n[3],(function(n){return n[1]}))}})),Wa),Ka=ca(ea(ua(na({TAG:5,_0:6}),Ta,Ga),(function(n){return{TAG:10,_0:n[1],_1:n[2]}})),Ha),Ya=ca(ea((xa=na({TAG:5,_0:0}),Da=ga,Fa=na({TAG:2,_0:4}),Ra=Ta,Na=na({TAG:5,_0:2}),Ca=Ta,{contents:function(n){return W(c(oa(xa,Da,Fa,Ra,Na).contents,n),(function(n){var e=n[0],t=e[4],r=e[3],u=e[2],a=e[1],o=e[0];return z(c(Ca.contents,n[1]),(function(n){return[[o,a,u,r,t,n[0]],n[1]]}))}))}}),(function(n){return{TAG:6,_0:n[1],_1:n[3],_2:n[5]}})),Ka),Ja=ca(fa(la(ga)),ea(ga,(function(n){return[n]}))),Qa=ca(ea(ua(Ja,na({TAG:2,_0:5}),Ta),(function(n){return{TAG:5,_0:n[0],_1:n[2]}})),Ya),no=function(n,e){return{contents:function(t){var r=c(n.contents,t);if(void 0!==r){var u=r[1];return z(c(e,r[0]),(function(n){return[n,u]}))}}}}(Ta,(function(n){switch(0|n.TAG){case 9:case 10:return[!0,{TAG:1,_0:n}];default:return}}));Ga.contents=ca(ea(oa(va(na({TAG:5,_0:9})),na({TAG:2,_0:6}),ra(ca(ea(Aa,(function(n){return[!1,n]})),no)),va(Ta),na({TAG:2,_0:7})),(function(n){var e=n[3],t=n[2],r=E(t,(function(n){return n[1]})),u=D(n[0],0,(function(n){return 1})),a=an(t,t.length-1|0);if(void 0===a)return{TAG:8,_0:r,_1:e,_2:u};var o=a[1];return 0!==o.TAG&&a[0]&&X(e)?{TAG:8,_0:f(r,0,t.length-2|0),_1:o._0,_2:u}:{TAG:8,_0:r,_1:e,_2:u}})),Qa).contents;var eo=sa(ca(ea(aa(Ea,na({TAG:2,_0:6}),la(ua(ga,na({TAG:2,_0:8}),Ta)),na({TAG:2,_0:7})),(function(n){return{TAG:14,_0:n[0],_1:E(n[2],(function(n){return[n[0],n[2]]}))}})),Ga),na({TAG:2,_0:4}),(function(n,e,t){return{TAG:4,_0:n,_1:t}})),to=ca(ea(ta(na({TAG:5,_0:7}),va(Ta)),(function(n){return{TAG:11,_0:n[1]}})),eo),ro=ea(ta(to,va(ta(na({TAG:5,_0:8}),ma))),(function(n){var e=n[1],t=n[0];return void 0!==e?{TAG:12,_0:t,_1:e[1]}:t}));Ta.contents=ro.contents;var uo=ea(ta(Ta,na({TAG:2,_0:3})),(function(n){return{TAG:1,_0:n[0]}})),ao=ca(ea(oa(ca(na({TAG:5,_0:0}),na({TAG:5,_0:1})),La,na({TAG:2,_0:4}),Ta,na({TAG:2,_0:3})),(function(n){var e=n[1];return{TAG:0,_0:e[0],_1:sn(n[0],{TAG:5,_0:1}),_2:n[3],_3:e[1]}})),uo);Aa.contents=ao.contents;var oo=ea(oa(ca(na({TAG:5,_0:0}),na({TAG:5,_0:1})),ba,na({TAG:2,_0:4}),Ta,na({TAG:2,_0:3})),(function(n){return{TAG:1,_0:n[1],_1:sn(n[0],{TAG:5,_0:1}),_2:n[3]}})),co=ca(ea(oa(na({TAG:5,_0:10}),Ea,na({TAG:2,_0:6}),la(ua(ta(va(na({TAG:5,_0:1})),ga),na({TAG:2,_0:8}),ma)),na({TAG:2,_0:7})),(function(n){var e=E(n[3],(function(n){var e=n[0];return[e[1],n[2],Gn(e[0])]}));return{TAG:2,_0:n[1],_1:e}})),oo),io=ca(ea(aa(na({TAG:5,_0:5}),ga,ea(fa(la(ta(va(na({TAG:5,_0:1})),ga))),(function(n){return E(n,(function(n){return[n[1],Gn(n[0])]}))})),Ga),(function(n){return{TAG:0,_0:n[1],_1:n[2],_2:n[3]}})),co),_o=ca(ea(ua(na({TAG:5,_0:11}),Ea,ea(ua(na({TAG:2,_0:6}),ra(io),na({TAG:2,_0:7})),(function(n){return n[1]}))),(function(n){return{TAG:3,_0:n[1],_1:n[2]}})),io);da.contents=_o.contents;var so=ra(da);function fo(n){var e,t=n.replace(/(\/\/[^\n]*)/g,""),r=Ku((e=t,kr(Array.from(e,(function(n){return fn(n,0)})))));if(void 0===r)return{TAG:1,_0:"could not tokenize"};var u=c(so.contents,kr(r[0]));if(void 0===u)return{TAG:1,_0:"could not parse"};var a,o=u[1];return Rr(o)?{TAG:0,_0:u[0]}:{TAG:1,_0:"could not parse near "+i(f((a=o)[0].slice(a[1],a[2]),0,5)," ",Yu)}}function lo(n,e){switch(0|e.TAG){case 0:return n===e._0;case 1:return wn(e._1,(function(e){return lo(n,e)}));case 2:var t=e._0;return 0!==t.TAG&&wn(ae.toArray(t._0),(function(e){return lo(n,e[1])}))}}function vo(n,e,t){if(lo(n,e))return{TAG:1,_0:_e({TAG:0,_0:n})+" occurs in "+_e(e)};var r=L(t,n);return void 0!==r?sn(r,e)?{TAG:0,_0:t}:{TAG:1,_0:_e(e)+" is not unifiable with "+_e(r)}:{TAG:0,_0:bn(t,n,e)}}function To(n,e){for(;;){var t=n;if(!t)return{TAG:0,_0:e};var r=t.tl,u=t.hd,a=u[1],o=u[0],c=0;switch(0|o.TAG){case 0:var i=o._0,_=0;switch(0|a.TAG){case 0:if(i===a._0){n=r;continue}_=3;break;case 1:case 2:_=3}if(3===_)return hn(vo(i,a,e),function(n){return function(e){return To(n,e)}}(r));break;case 1:var s=o._1;switch(0|a.TAG){case 0:c=1;break;case 1:var f=a._1;if(o._0===a._0&&s.length===f.length){n=g(Y(s,f),r,(function(n,t){return{hd:[pe(e,t[0]),pe(e,t[1])],tl:n}}));continue}c=2;break;case 2:c=2}break;case 2:var l=o._0;switch(0|a.TAG){case 0:c=1;break;case 1:c=2;break;case 2:var v=a._0;if(0===l.TAG){var d=l._0;if(0===v.TAG){if(d!==v._0)return{TAG:1,_0:"cannot unify "+_e(o)+" with "+_e(a)};n=r;continue}var T=Ne(d);if(void 0===T)return{TAG:1,_0:'undeclared struct "'+d+'"'};var G=To({hd:[{TAG:2,_0:{TAG:1,_0:v._0}},Se.toPartialStructType(T,ke())],tl:r},e);return 0===G.TAG?{TAG:0,_0:G._0}:{TAG:1,_0:"struct type "+_e(a)+" does not match "+d+": "+G._0}}var p=l._0;if(0===v.TAG){var h=v._0,b=Ne(h);if(void 0===b)return{TAG:1,_0:'undeclared struct "'+h+'"'};var w=To({hd:[{TAG:2,_0:{TAG:1,_0:p}},Se.toPartialStructType(b,ke())],tl:r},e);return 0===w.TAG?{TAG:0,_0:w._0}:{TAG:1,_0:"struct type "+_e(o)+" does not match "+h+": "+w._0}}var y=ae.toMap(v._0),S=ae.toArray(p);return hn(ye(E(S,function(n,e,t){return function(r){var u=r[0],a=A(t,u);return void 0!==a?{TAG:0,_0:[r[1],a]}:{TAG:1,_0:"struct type "+_e(e)+' is missing attribute "'+u+'" from type "'+_e(n)+'"'}}}(o,a,y)),(function(n){return n})),function(n,t,r,u){return function(a){var o={TAG:2,_0:{TAG:1,_0:ae.fromArray(m(gn(r,E(u,(function(n){return n[0]})))),ke())}};return To(En(Q(a),{hd:[ae.tail(t),o],tl:n}),e)}}(r,p,y,S))}}switch(c){case 1:return hn(vo(a._0,o,e),function(n){return function(e){return To(n,e)}}(r));case 2:return{TAG:1,_0:_e(o)+" is not unifiable with "+_e(a)}}}}function Go(n,e){return To({hd:[n,e],tl:0},void 0)}function Ao(n){var e=xn(Dn(Ie.structs),(function(e){return Cn(Go({TAG:2,_0:{TAG:1,_0:n}},Se.toPartialStructType(e,ke())),void 0,(function(n){return e}))}));return 1!==e.length?0===e.length?0:{TAG:1,_0:e}:{TAG:0,_0:e[0]}}var mo={ambiguousMatchesError:function(n,e){return"cannot infer struct type: inferred type "+ae.show(n,_e)+" matches "+i(e,", ",(function(n){return n.name}))},findMatchingStruct:Ao},po=Fn();function ho(n,e,t,r){var u=He.typeOf(t);Rn(po,u);var a=g(e,n,(function(n,e){return $n.addMono(n,e.contents.name,e.contents.ty)})),o=Yn(E(e,(function(n){return n.contents.ty})),u);return hn(go(a,t,u),(function(e){var t=pe(e,o),u=pe(e,r),a=ie(Ee(e,n),t);return Sn(Go(u,t),(function(n){return kn(po),[ge(n,e),pe(n,u),he(n,a)]}))}))}function go(n,e,t){return hn(Eo(n,e),(function(n){return Sn(Go(pe(n,t),pe(n,He.typeOf(e))),(function(e){return ge(e,n)}))}))}function Eo(n,e){switch(0|e.TAG){case 0:var t=De(function(n){return qn("number"==typeof n?Kn:0===n.TAG?Wn:Hn)}(e._0));return Go(He.typeOf(e),t);case 1:var r=e._3,u=e._2,a=e._1,o=e._0;return hn(Eo(n,a),(function(e){var t=Ee(e,n);return hn(Eo(t,r),(function(n){var t=ge(n,e),c=pe(t,Yn([He.typeOf(a),He.typeOf(r)],o)),i=De(function(n){return n>=5?n>=9?[[0],Yn([{TAG:0,_0:0},{TAG:0,_0:0}],Hn)]:qn(Yn([Wn,Wn],Hn)):qn(Yn([Wn,Wn],Wn))}(u));return Sn(Go(c,i),(function(n){return ge(n,t)}))}))}));case 2:var c=e._2,i=e._1,_=e._0,s=He.typeOf(c);return hn(Eo(n,c),(function(n){var e=pe(n,Yn([s],_)),t=De(function(n){switch(n){case 0:return qn(Yn([Wn],Wn));case 1:return qn(Yn([Hn],Hn));case 2:return[[0],Yn([(e={TAG:0,_0:0},{TAG:1,_0:"Ptr",_1:[e]})],{TAG:0,_0:0})]}var e}(i));return Sn(Go(e,t),(function(e){return ge(e,n)}))}));case 3:var f=e._0.contents,l=$n.get(n,f.name);if(void 0!==l)return Go(f.ty,De(l));var v=Ne(f.name);if(void 0===v)return{TAG:1,_0:'unbound variable: "'+f.name+'"'};var d={TAG:2,_0:{TAG:1,_0:ae.fromArray(E(v.staticFuncs,(function(n){var e=n.name;return[e.contents.name,e.contents.ty]})),ke())}};return Go(f.ty,d);case 4:var T=e._1,G=e._0,m=We.typeOfExpr(G),p=We.typeOfExpr(T);return hn(Eo(n,T),(function(e){var t=Ee(e,n),r=pe(e,m);return hn(go(t,G,r),(function(n){var t=ge(n,e),u=pe(n,r),a=pe(t,p);return Sn(Go(u,a),(function(n){return ge(n,t)}))}))}));case 5:return Sn(ho(n,e._1,e._2,e._0),(function(n){return n[0]}));case 6:var h=e._4,b=e._3,w=e._0,y=e._2.contents,S=He.typeOf(b);return hn(Eo(n,b),(function(e){var t=Ee(e,n),r=pe(e,S),u=pe(e,w),a=ie($n.remove(t,y.name),r),o=$n.add(t,y.name,a);return hn(go(o,h,u),(function(n){var t=ge(n,e);return Sn(Go(pe(t,S),pe(t,y.ty)),(function(n){return ge(n,t)}))}))}));case 7:var I=e._4,k=e._3,x=e._2,F=e._0,R=e._1.contents,N=He.typeOf(k);Rn(po,N);var C=Yn(E(x,(function(n){return n.contents.ty})),N),L=g(x,n,(function(n,e){return $n.addMono(n,e.contents.name,e.contents.ty)})),O=$n.addMono(L,R.name,C);return hn(go(O,k,N),(function(n){var e=Ee(n,O),t=pe(n,C),r=pe(n,F),u=$n.add(e,R.name,ie(e,t));return hn(go(u,I,r),(function(e){var r=ge(e,n);return Sn(Go(R.ty,pe(e,t)),(function(n){return kn(po),ge(n,r)}))}))}));case 8:var U=e._2,z=E(U,He.typeOf),M=Yn(z,e._0);return Sn(hn(go(n,e._1,M),(function(e){return g(Y(U,z),{TAG:0,_0:[e,Ee(e,n)]},(function(n,e){var t=e[1],r=e[0];return hn(n,(function(n){var e=n[1],u=n[0],a=pe(u,t);return Sn(go(e,r,a),(function(n){return[ge(n,u),Ee(n,e)]}))}))}))})),(function(n){return n[0]}));case 9:var P=e._2,V=e._0;return hn(g(e._1,{TAG:0,_0:[void 0,n]},(function(n,e){return hn(n,(function(n){var t=n[1],r=n[0];return Sn(function(n,e){return Eo(n,e._0)}(t,e),(function(n){return[ge(n,r),Ee(n,t)]}))}))})),(function(e){var t=e[0];return void 0!==P?hn(Eo(Ee(t,n),P),(function(n){var e=He.typeOf(P),r=ge(n,t);return Sn(Go(pe(r,V),pe(r,e)),(function(n){return ge(n,r)}))})):Sn(Go(pe(t,V),Kn),(function(n){return ge(n,t)}))}));case 10:var j=e._3,B=e._2,Z=e._0;return hn(go(n,e._1,Hn),(function(e){var t=Ee(e,n),r=pe(e,Z);return hn(go(t,B,r),(function(n){var u=Ee(n,t),a=pe(n,r),o=ge(n,e);return Sn(go(u,j,a),(function(n){return ge(n,o)}))}))}));case 11:var q=e._1,$=He.typeOf(q);return hn(Eo(n,e._0),(function(e){var t=pe(e,$),r=Ee(e,n);return Sn(go(r,q,t),(function(n){return ge(n,e)}))}));case 12:var W=Nn(po);return void 0!==W?go(n,D(e._0,{TAG:0,_0:0},(function(n){return n})),W):{TAG:1,_0:"'return' used outside of a function"};case 13:return go(n,e._0,e._1);case 14:var H=g(e._0,{TAG:0,_0:[undefined,n]},(function(n,e){return hn(n,(function(n){var t=n[1],r=n[0];return hn(Eo(t,e),(function(n){return{TAG:0,_0:[ge(n,r),Ee(n,t)]}}))}))}));return Sn(H,(function(n){return n[0]}));case 15:var K=e._1,J=e._0,Q=Ne(J);if(void 0===Q)return{TAG:1,_0:'undeclared struct "'+J+'"'};var nn=Q.attributes,rn=g(tn(nn,(function(n){return X(n.impl)})),{TAG:0,_0:[n,undefined]},(function(n,e){var t=e.ty,r=e.name;return hn(n,(function(n){var e=n[1],u=n[0],a=en(K,(function(n){return n[0]===r}));return void 0!==a?hn(go(u,a[1],t),(function(n){return{TAG:0,_0:[Ee(n,u),ge(n,e)]}})):{TAG:1,_0:'missing attribute "'+r+'" for struct "'+J+'"'}}))})),un=be(K,(function(n){var e=n[0];return wn(nn,(function(n){return n.name===e}))?void 0:e}));return void 0!==un?{TAG:1,_0:'extraneous attribute: "'+un+'" for struct "'+J+'"'}:Sn(rn,(function(n){return n[1]}));case 16:var an=e._2,on=e._1,cn=e._0;return hn(Eo(n,on),(function(t){var r=We.typeOfExpr(on),u=pe(t,r),a=function(t){return Ln(u,pe(t,r))?go(Ee(t,n),e,pe(t,cn)):{TAG:0,_0:t}};switch(0|u.TAG){case 0:case 1:break;case 2:var o=u._0;if(0===o.TAG){var c=o._0,i=Ne(c);if(void 0===i)return{TAG:1,_0:'undeclared struct: "'+c+'"'};var _=en(i.attributes,(function(n){return n.name===an}));if(void 0===_)return{TAG:1,_0:'attribute "'+an+'" does not exist on struct "'+c+'"'};var s=D(_.impl,_.ty,(function(n){return n[0].contents.ty}));return Sn(Go(pe(t,cn),pe(t,s)),(function(n){return ge(n,t)}))}var f=o._0,l=A(ae.toMap(f),an);if(void 0!==l)return Sn(Go(pe(t,cn),pe(t,l)),(function(n){return ge(n,t)}));var v=ae.insert(f,an,cn),d=pe(t,{TAG:2,_0:{TAG:1,_0:v}}),T=Ao(v);if("number"!=typeof T)return 0===T.TAG?hn(Go(u,{TAG:2,_0:{TAG:0,_0:T._0.name}}),(function(n){return a(ge(n,t))})):hn(Go(u,d),(function(n){return a(ge(n,t))}));var G=0;switch(0|r.TAG){case 0:return{TAG:0,_0:ge(bn(undefined,r._0,d),t)};case 1:case 2:G=2}if(2===G)return Sn(Go(r,d),(function(n){return ge(n,t)}))}var m=ke(),p=ae.insert(ae.make({TAG:0,_0:m}),an,cn),h=pe(t,{TAG:2,_0:{TAG:1,_0:p}}),g=Ao(p);return"number"==typeof g?{TAG:1,_0:"no struct declaration matches type "+_e(h)}:0===g.TAG?hn(Go(u,{TAG:2,_0:{TAG:0,_0:g._0.name}}),(function(n){return a(ge(n,t))})):hn(Go(u,h),(function(n){return a(ge(n,t))}))}))}}function bo(n,e){return n+"_"+e}function wo(n,e){switch(0|e.TAG){case 0:var t=e._0;return Sn(ho(n,E(e._1,(function(n){return n[0]})),e._2,t.contents.ty),(function(e){var r=e[0];return[Ee(r,$n.addMono(n,t.contents.name,t.contents.ty)),r]}));case 1:var r=e._0;return Sn(go(n,e._2,r.contents.ty),(function(e){return[Ee(e,$n.addMono(n,r.contents.name,r.contents.ty)),e]}));case 2:return{TAG:0,_0:[n,undefined]};case 3:var u=e._0,a=Ne(u);return void 0!==a?g(e._1,{TAG:0,_0:[n,undefined]},(function(e,t){var r=t[2],o=t[1],c=t[0];return hn(e,(function(e){var t=e[1],i=e[0];c.contents.newName=bo(u,c.contents.name);var _,s=D(an(o,0),[!1,!1],(function(n){return"self"===n[0].contents.name?[!0,n[1]]:[!1,!1]}));if(s[0]){Se.addImplementation(a,c,s[1]);var f,l=sn(o,[])?[]:In(o,1),v={TAG:2,_0:{TAG:0,_0:u}},d=an(o,0);if(void 0!==d){var T=d[0];T.contents.ty=v,f=$n.addMono(i,T.contents.name,v)}else f=i;_=[f,l]}else Se.addStaticFunc(a,c),_=[n,o];return hn(wo(_[0],{TAG:0,_0:c,_1:_[1],_2:r}),(function(n){var e=ge(n[1],t);return Re(e,c),{TAG:0,_0:[$n.remove(n[0],c.contents.name),e]}}))}))})):{TAG:1,_0:'cannot implement for unknown type "'+u+'"'}}}function yo(n){return yn(po),g(n,{TAG:0,_0:[$n.empty,undefined]},(function(n,e){return hn(n,(function(n){var t=n[1];return Sn(wo(n[0],e),(function(n){return[n[0],ge(n[1],t)]}))}))}))}var So=h("CompilerExn.InvalidTypeConversion"),Io=h("CompilerExn.InvalidFunctionSignature"),ko=h("CompilerExn.VariableNotFound"),xo=h("CompilerExn.EmptyFunctionStack"),Do=h("CompilerExn.CannotReassignImmutableValue"),Fo=h("CompilerExn.FunctionNotFound"),Ro=h("CompilerExn.Unimplemented"),No=h("CompilerExn.UnsupportedGlobalInitializer"),Co=h("CompilerExn.InvalidTypeAssertion"),Lo=h("CompilerExn.DerefUsedOutsideOfUnsafeBlock"),Xo=h("CompilerExn.UndeclaredStruct"),Oo=h("CompilerExn.InvalidAttributeAccess"),Uo=h("CompilerExn.StructTypeNotMatched"),zo=h("CompilerExn.AmibguousStruct");function Mo(n){return n.RE_EXN_ID===So?"unsupported type: "+_e(n._1):n.RE_EXN_ID===Io?"invalid function signature: "+_e(n._1):n.RE_EXN_ID===ko?'variable "'+n._1+'" not found':n.RE_EXN_ID===xo?"Function stack is empty":n.RE_EXN_ID===Do?'cannot mutate "'+n._1+'" as it is behind an immutable binding':n.RE_EXN_ID===Fo?'no function named "'+n._1+'" found':n.RE_EXN_ID===Ro?"unimplemented: "+n._1:n.RE_EXN_ID===No?"unsupported global initializer: "+He.show(void 0,n._1):n.RE_EXN_ID===Co?"invalid type assertion from "+_e(n._1)+" to "+_e(n._2):n.RE_EXN_ID===Lo?"the deref operator can only be used in an unsafe block":n.RE_EXN_ID===ee.UnkownTypeSize?"unknown type size: "+_e(n._1):n.RE_EXN_ID===Xo?'undeclared struct "'+n._1+'"':n.RE_EXN_ID===Oo?n._1+' does not exist for type "'+_e(n._2)+'"':n.RE_EXN_ID===Uo?"No struct declaration matches type "+_e(n._1):n.RE_EXN_ID===zo?mo.ambiguousMatchesError(n._1,n._2):n.RE_EXN_ID===We.UndeclaredIdentifer?'identifier "'+n._1+'" not found':n.RE_EXN_ID===We.UnexpectedDeclarationInImplBlock?"unexpected declaration in impl block: "+Ke.show(void 0,n._1):n.RE_EXN_ID===We.UnreachableLetStmt?"unreachable: let statement found in Core.fromStmt":"unexpected compiler exception"}function Po(n){if(0===n.TAG){var e=n._0,t=Ne(e);if(void 0!==t)return t;throw{RE_EXN_ID:Xo,_1:e,Error:new Error}}var r=n._0,u=mo.findMatchingStruct(r);if("number"==typeof u)throw{RE_EXN_ID:Uo,_1:{TAG:2,_0:n},Error:new Error};if(0===u.TAG)return u._0;throw{RE_EXN_ID:zo,_1:r,_2:u._0,Error:new Error}}function Vo(n){switch(0|n.TAG){case 0:throw{RE_EXN_ID:So,_1:n,Error:new Error};case 1:switch(n._0){case"()":if(0!==n._1.length)throw{RE_EXN_ID:So,_1:n,Error:new Error};return[];case"Fun":case"Ptr":return[0];case"Tuple":return rn(E(n._1,Vo));case"bool":case"u32":break;case"u64":if(0!==n._1.length)throw{RE_EXN_ID:So,_1:n,Error:new Error};return[1];default:throw{RE_EXN_ID:So,_1:n,Error:new Error}}if(0!==n._1.length)throw{RE_EXN_ID:So,_1:n,Error:new Error};return[0];case 2:return 0===Po(n._0).size?[]:[0]}}function jo(n,e){switch(0|e.TAG){case 1:if("Tuple"===e._0){var t=rn(E(e._1,Vo)),r={_0:[],_1:t};return{TAG:1,_0:Sr.getOrAddSignature(n,r),_1:[[],t]}}}var u=Vo(e),a=u.length;if(1!==a){if(0===a)return 0;throw{RE_EXN_ID:Ro,_1:"wasmBlockReturnTypeOf for "+_e(e),Error:new Error}}return{TAG:0,_0:u[0]}}function Bo(n){switch(0|n.TAG){case 1:if("Fun"===n._0){var e=n._1,t=e.slice(0,e.length-1|0),r=an(e,e.length-1|0);return Un(St.Signature.make,rn(E(t,Vo)),D(r,[],Vo))}throw{RE_EXN_ID:Io,_1:n,Error:new Error};case 0:case 2:throw{RE_EXN_ID:Io,_1:n,Error:new Error}}}function Zo(n,e,t){return{name:n,locals:[],params:tn(e,(function(n){return!ee.isZeroSizedType(n[1])})),ret:t,instructions:[]}}function qo(n,e){n.instructions.push(e)}function $o(n){var e,t,r,u,a=Bo(Yn(E(n.params,(function(n){return n[1]})),n.ret)),o=c(St.Local.fromTypes,rn(E(n.locals,(function(n){return E(Vo(n.ty),(function(e){return[n.name,e]}))})))),i=Un(St.Body.make,o,(e=void 0,t=n.instructions,r=void 0!==e?e:3,u={contents:t.length},r>0?s(function(n,e,t){for(;;){var r=t,a=e,o=n;if(o){var c=o.hd,i=0;if("number"==typeof c)switch(c){case 2:var _=o.tl;if(_&&3===_.hd){n={hd:2,tl:_.tl};continue}break;case 9:var s=o.tl;if(s&&9===s.hd){n=s.tl;continue}break;case 10:var f=o.tl;if(f&&9===f.hd){n={hd:14,tl:f.tl};continue}break;case 14:var l=o.tl;if(l&&9===l.hd){n={hd:10,tl:l.tl};continue}break;case 18:var v=o.tl;if(v&&9===v.hd){n={hd:36,tl:v.tl};continue}break;case 19:var d=o.tl;if(d&&9===d.hd){n={hd:37,tl:d.tl};continue}break;case 24:var T=o.tl;if(T&&9===T.hd){n={hd:30,tl:T.tl};continue}break;case 25:var G=o.tl;if(G&&9===G.hd){n={hd:31,tl:G.tl};continue}break;case 30:var A=o.tl;if(A&&9===A.hd){n={hd:24,tl:A.tl};continue}break;case 31:var m=o.tl;if(m&&9===m.hd){n={hd:25,tl:m.tl};continue}break;case 36:var p=o.tl;if(p&&9===p.hd){n={hd:18,tl:p.tl};continue}break;case 37:var h=o.tl;if(h&&9===h.hd){n={hd:19,tl:h.tl};continue}}else switch(0|c.TAG){case 0:var g=c._0,E=0,b=o.tl;if(b){var w=b.hd;if("number"==typeof w){if(3===w){n=b.tl;continue}E=3}else switch(0|w.TAG){case 0:var y=b.tl;if(y){var S=y.hd;if("number"==typeof S){var I=w._0;if(43===S){n={hd:{TAG:0,_0:mn(g,I)},tl:y.tl};continue}if(S<15)switch(S){case 4:n={hd:{TAG:0,_0:g+I|0},tl:y.tl};continue;case 5:n={hd:{TAG:0,_0:g-I|0},tl:y.tl};continue;case 6:n={hd:{TAG:0,_0:Math.imul(g,I)},tl:y.tl};continue;case 7:n={hd:{TAG:0,_0:An(g,I)},tl:y.tl};continue;case 10:n={hd:{TAG:0,_0:g===I?1:0},tl:y.tl};continue;case 0:case 1:case 2:case 3:case 8:case 9:case 11:case 12:case 13:break;case 14:n={hd:{TAG:0,_0:g===I?0:1},tl:y.tl};continue}}}break;case 15:n={hd:{TAG:14,_0:g},tl:b.tl};continue;default:E=3}}if(3===E&&0===g){var k=o.tl;if(10===k.hd){n={hd:9,tl:k.tl};continue}}break;case 1:case 2:case 3:case 9:case 11:i=2;break;case 12:var x=o.tl;if(x){var D=x.hd;if("number"!=typeof D&&11===D.TAG){var F=c._0;if(F===D._0){n={hd:{TAG:13,_0:F},tl:x.tl};continue}}}break;case 13:var R=o.tl;if(R&&3===R.hd){n={hd:{TAG:12,_0:c._0},tl:R.tl};continue}}if(2===i){var N=o.tl;if(N&&3===N.hd){n=N.tl;continue}}e={hd:c,tl:a},n=o.tl}else{var C=on(a),L=pn(C);if(!(r>1&&L<u.contents))return C;u.contents=L,t=r-1|0,e=0,n=C}}}(Q(t),0,r)):t));return St.make(n.name,a,i)}function Wo(n,e,t,r,u){return{name:n,mutability:e,ty:t,index:r,init:u}}function Ho(n){var e=Nn(n.funcStack);if(void 0!==e)return e;throw{RE_EXN_ID:xo,Error:new Error}}function Ko(n,e){return t=n.funcs,z(M(t,(function(n){return n.name===e})),(function(n){return[l(t,n),n]}));var t}function Yo(n,e){var t=Nn(n.blockStack);if(void 0!==t&&!(e<=0)){var r=t.shadowStackDelta;return r.contents=r.contents+e|0,qo(Ho(n),{TAG:9,_0:n.stackTop.index}),qo(Ho(n),{TAG:0,_0:e}),qo(Ho(n),5),qo(Ho(n),{TAG:10,_0:n.stackTop.index})}}function Jo(n){var e=Nn(n.blockStack);return void 0!==e&&e.isUnsafe}function Qo(n,e){return n.scopeDepth=n.scopeDepth+1|0,Rn(n.blockStack,{isUnsafe:e||Jo(n),shadowStackDelta:{contents:0}})}function nc(n){n.scopeDepth=n.scopeDepth-1|0,function(n,e){var t=Nn(n.blockStack);if(void 0!==t&&!(e<=0)){var r=t.shadowStackDelta;r.contents=r.contents-e|0,qo(Ho(n),{TAG:9,_0:n.stackTop.index}),qo(Ho(n),{TAG:0,_0:e}),qo(Ho(n),4),qo(Ho(n),{TAG:10,_0:n.stackTop.index})}}(n,D(Nn(n.blockStack),0,(function(n){return n.shadowStackDelta.contents}))),kn(n.blockStack)}function ec(n,e,t,r){var u=function(n,e,t,r,u){return n.locals.push(function(n,e,t,r){return{name:n,depth:e,ty:t,isMutable:r}}(e,r,t,u)),(n.params.length+n.locals.length|0)-1|0}(Ho(n),e,t,n.scopeDepth,r);return qo(Ho(n),{TAG:12,_0:u})}function tc(n,e,t,r,u){var a=Mn(n.globals),o=Wo(e,t,r,a,u);return Z(n.globals,e,o),a}function rc(n,e){var t=function(n,e){var t=M(n.params,(function(n){return n[0]===e}));if(void 0!==t)return[t,l(n.params,t)[2]];var r=we(n.locals,(function(n){return n.name===e}));return void 0!==r?[n.params.length+r|0,l(n.locals,r).isMutable]:void 0}(Ho(n),e);return void 0!==t?{TAG:0,_0:t[0],_1:t[1]}:z(q(n.globals,e),(function(n){return{TAG:1,_0:n.index,_1:1===n.mutability}}))}function uc(n){return"number"==typeof n?void 0:0===n.TAG?{TAG:0,_0:n._0}:{TAG:0,_0:n._0?1:0}}function ac(n){if(!Jo(n))throw{RE_EXN_ID:Lo,Error:new Error}}function oc(n,e,t){switch(0|e.TAG){case 0:case 1:return{TAG:1,_0:{RE_EXN_ID:Oo,_1:t,_2:e}};case 2:var r=Po(e._0),u=en(r.attributes,(function(n){return n.name===t}));if(void 0===u)return{TAG:1,_0:{RE_EXN_ID:Oo,_1:t,_2:e}};var a=u.impl;if(void 0===a)return{TAG:0,_0:{TAG:0,_0:{offset:u.offset,ty:u.ty,size:u.size,mut:u.mut}}};var o=Ko(n,bo(r.name,a[0].contents.name));return void 0!==o?{TAG:0,_0:{TAG:1,_0:[o[0],o[1],a[1]]}}:{TAG:1,_0:{RE_EXN_ID:Oo,_1:t,_2:e}}}}function cc(n){return Fe(void 0,"__lambda"+String(n.funcs.length)+"__")}function ic(n,e){for(;;){var t=e;switch(0|t.TAG){case 3:var r=t._0,u=rc(n,r.contents.newName);if(void 0!==u)return u._1?void 0:r.contents.name;throw{RE_EXN_ID:ko,_1:r.contents.name,Error:new Error};case 16:var a=t._2,o=t._1,c=oc(n,We.typeOfExpr(o),a);if(0===c.TAG){var i=c._0;if(0!==i.TAG)return;if(!i._0.mut)return a;e=o;continue}throw c._0;default:return}}}function _c(n,e){for(;;){var t=e;switch(0|t.TAG){case 0:var r=uc(t._0);return void 0!==r?qo(Ho(n),r):void 0;case 1:var u,a=t._2,o=t._1;if(ee.isZeroSizedType(We.typeOfExpr(o))){e={TAG:0,_0:{TAG:1,_0:9===a}};continue}switch(a){case 0:u=4;break;case 1:u=5;break;case 2:u=6;break;case 3:u=7;break;case 4:u=43;break;case 5:u=31;break;case 6:u=19;break;case 7:u=37;break;case 8:u=25;break;case 9:u=10;break;case 10:u=14}return _c(n,o),_c(n,t._3),qo(Ho(n),u);case 2:var c;switch(t._1){case 0:throw{RE_EXN_ID:Ro,_1:"u32 negation is not handled",Error:new Error};case 1:c=9;break;case 2:ac(n),c={TAG:16,_0:0,_1:0}}return _c(n,t._2),qo(Ho(n),c);case 3:var i=t._0;if(ee.isZeroSizedType(i.contents.ty))return;var _=rc(n,i.contents.newName);if(void 0!==_)return 0===_.TAG?qo(Ho(n),{TAG:11,_0:_._0}):qo(Ho(n),{TAG:9,_0:_._0});throw{RE_EXN_ID:ko,_1:i.contents.name,Error:new Error};case 4:var s=t._1,f=t._0;if(ee.isZeroSizedType(We.typeOfExpr(s)))return;switch(0|f.TAG){case 2:if(f._1>=2){ac(n),_c(n,f._2),_c(n,s);var l={TAG:17,_0:ee.sizeLog2(We.typeOfExpr(s)),_1:0};return qo(Ho(n),l)}throw{RE_EXN_ID:Ro,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error};case 3:var v=f._0,T=rc(n,v.contents.newName);if(void 0!==T){var G;if(T._1)return G=0===T.TAG?{TAG:12,_0:T._0}:{TAG:10,_0:T._0},_c(n,s),qo(Ho(n),G);throw{RE_EXN_ID:Do,_1:v.contents.name,Error:new Error}}throw{RE_EXN_ID:ko,_1:v.contents.name,Error:new Error};case 16:var A=f._2,m=f._1,p=oc(n,We.typeOfExpr(m),A);if(0===p.TAG){var h=p._0;if(0===h.TAG){var g=h._0;if(!g.mut)throw{RE_EXN_ID:Do,_1:A,Error:new Error};var b=ic(n,m);if(void 0!==b)throw{RE_EXN_ID:Do,_1:b,Error:new Error};return g.size>0?(_c(n,m),_c(n,s),qo(Ho(n),{TAG:17,_0:0,_1:g.offset})):void 0}throw{RE_EXN_ID:Ro,_1:"cannot reassign "+A+" for type "+_e(We.typeOfExpr(m)),Error:new Error}}throw p._0;default:throw{RE_EXN_ID:Ro,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error}}case 5:var w=cc(n),y=fc(n,w,E(t._1,(function(n){return[n,!1]})),t._2);return qo(Ho(n),{TAG:0,_0:y});case 6:var S=t._3,I=t._2.contents;ee.isZeroSizedType(We.typeOfExpr(S))||(_c(n,S),ec(n,I.name,I.ty,t._1)),e=t._4;continue;case 7:var k=cc(n);t._1.contents.newName=k.contents.name,fc(n,k,E(t._2,(function(n){return[n,!1]})),t._3),e=t._4;continue;case 8:var x=t._2,F=t._1,R=function(e,t){return function(r){j(t,(function(e){return _c(n,e)}));var u=Bo(We.typeOfExpr(e)),a=Sr.getOrAddSignature(n.mod,u);return _c(n,e),qo(Ho(n),{TAG:15,_0:a,_1:0})}}(F,x),N=function(e){return function(t,r){var u=void 0!==r?d([r],e):e;return j(Y(u,t.params),(function(e){var t=e[1];if(t[2]&&Jn(t[1])&&Gn(ic(n,e[0])))throw{RE_EXN_ID:Do,_1:t[0],Error:new Error}}))}}(x);switch(0|F.TAG){case 3:var C=F._0;if(void 0!==rc(n,C.contents.newName))return R(void 0);var L=Ko(n,C.contents.newName);if(void 0!==L)return N(L[0],void 0),j(x,(function(e){return _c(n,e)})),qo(Ho(n),{TAG:14,_0:L[1]});throw{RE_EXN_ID:Fo,_1:C.contents.name,Error:new Error};case 16:var O,U=F._2,z=F._1;if(3===z.TAG){var M=z._0.contents.name;if(void 0!==Ne(M)){var P=Ko(n,bo(M,U));if(void 0===P)throw{RE_EXN_ID:Ro,_1:'static function "'+U+'" does not exists on struct '+M,Error:new Error};O=[!1,P[0],P[1]]}else O=[!0,void 0,void 0]}else O=[!0,void 0,void 0];var V,B=O[2],Z=O[1],q=O[0];if(void 0!==Z)V=Z;else{var $=oc(n,We.typeOfExpr(z),U);if(0!==$.TAG)throw $._0;var W=$._0;V=0===W.TAG?void 0:W._0[0]}return D(V,void 0,function(n,e){return function(t){return N(t,e?n:void 0)}}(z,q)),q&&_c(n,z),void 0!==B?(j(x,(function(e){return _c(n,e)})),qo(Ho(n),{TAG:14,_0:B})):R(void 0);default:return R(void 0)}case 9:var H=t._2;return Qo(n,1===t._3),j(t._1,(function(e){return sc(n,e)})),void 0!==H&&_c(n,H),nc(n);case 10:var K=t._3,J=jo(n.mod,t._0);return _c(n,t._1),qo(Ho(n),{TAG:4,_0:J}),_c(n,t._2),Ln(K,{TAG:0,_0:0})&&(qo(Ho(n),0),_c(n,K)),qo(Ho(n),1);case 11:return qo(Ho(n),{TAG:7,_0:0}),qo(Ho(n),{TAG:8,_0:0}),_c(n,t._0),qo(Ho(n),9),qo(Ho(n),{TAG:5,_0:1}),_c(n,t._1),qo(Ho(n),{TAG:6,_0:0}),qo(Ho(n),1),qo(Ho(n),1);case 12:var Q=t._0;return void 0!==Q&&_c(n,Q),qo(Ho(n),2);case 13:var nn=t._2,en=t._1;if(!sn(en,nn))switch(0|en.TAG){case 1:switch(en._0){case"Ptr":var tn=en._1;if(1!==tn.length)throw{RE_EXN_ID:Co,_1:en,_2:nn,Error:new Error};var rn=tn[0];switch(0|rn.TAG){case 1:if("u32"!==rn._0)throw{RE_EXN_ID:Co,_1:en,_2:nn,Error:new Error};if(0!==rn._1.length)throw{RE_EXN_ID:Co,_1:en,_2:nn,Error:new Error};switch(0|nn.TAG){case 1:if("u32"!==nn._0)throw{RE_EXN_ID:Co,_1:en,_2:nn,Error:new Error};if(0!==nn._1.length)throw{RE_EXN_ID:Co,_1:en,_2:nn,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:Co,_1:en,_2:nn,Error:new Error}}break;case 0:case 2:throw{RE_EXN_ID:Co,_1:en,_2:nn,Error:new Error}}break;case"u32":if(0!==en._1.length)throw{RE_EXN_ID:Co,_1:en,_2:nn,Error:new Error};switch(0|nn.TAG){case 1:if("Ptr"!==nn._0)throw{RE_EXN_ID:Co,_1:en,_2:nn,Error:new Error};if(1!==nn._1.length)throw{RE_EXN_ID:Co,_1:en,_2:nn,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:Co,_1:en,_2:nn,Error:new Error}}break;default:throw{RE_EXN_ID:Co,_1:en,_2:nn,Error:new Error}}break;case 0:case 2:throw{RE_EXN_ID:Co,_1:en,_2:nn,Error:new Error}}e=t._0;continue;case 14:return j(t._0,(function(e){return _c(n,e)}));case 15:var un=t._1,an=ln(Ne(t._0)),on=an.size;Yo(n,on),j(Y(an.attributes,un),(function(e){var t=e[0],r=t.ty;if(t.mut&&Jn(r)){var u=ic(n,e[1][1]);if(void 0!==u)throw{RE_EXN_ID:Do,_1:u,Error:new Error}}if(X(t.impl)&&ee.size(r)>0)return qo(Ho(n),{TAG:9,_0:n.stackTop.index})})),on>0&&qo(Ho(n),{TAG:9,_0:n.stackTop.index});return j(un,function(e){return function(t){var r=t[1],u=function(t){_c(n,r),qo(Ho(n),{TAG:17,_0:0,_1:e.contents}),e.contents=e.contents+t|0},a=He.typeOf(r);switch(0|a.TAG){case 0:break;case 1:var o=0;switch(a._0){case"()":if(0===a._1.length)return;break;case"Fun":return u(4);case"Ptr":if(1===a._1.length)return u(4);break;case"bool":case"u32":o=2}if(2===o&&0===a._1.length)return u(4);break;case 2:return Po(a._0),u(4)}throw{RE_EXN_ID:Ro,_1:"cannot store "+_e(a)+" in the shadow stack",Error:new Error}}}({contents:0}));case 16:var cn=t._1,_n=oc(n,We.typeOfExpr(cn),t._2);if(0===_n.TAG){var fn=_n._0;if(0===fn.TAG){var vn=fn._0;return ee.isZeroSizedType(vn.ty)?void 0:(_c(n,cn),qo(Ho(n),{TAG:16,_0:0,_1:vn.offset}))}var dn=fn._0;if(dn[2]){var Tn=ic(n,cn);if(void 0!==Tn)throw{RE_EXN_ID:Do,_1:Tn,Error:new Error}}return qo(Ho(n),{TAG:0,_0:dn[1]})}throw _n._0}}}function sc(n,e){var t=e._0;return _c(n,t),j(Vo(He.typeOf(t)),(function(e){return qo(Ho(n),3)}))}function fc(n,e,t,r){var u=E(t,(function(n){var e=n[0];return[e.contents.name,e.contents.ty,n[1]||!Jn(e.contents.ty)]})),a=Zo(e.contents.newName,u,He.typeOf(r)),o=n.funcs.push(a)-1|0;return Rn(n.funcStack,a),_c(n,r),qo(Ho(n),1),kn(n.funcStack),o}function lc(n,e){switch(0|e.TAG){case 0:return void fc(n,e._0,e._1,e._2);case 1:var t=e._1,r=e._0;Qo(n,!1);var u=function(n,e){var t=Zo("__isolated__",[],We.typeOfExpr(e));return Rn(n.funcStack,t),_c(n,e),kn(n.funcStack),t}(n,e._2).instructions;if(1===u.length){var a=u[0];if("number"!=typeof a&&0===a.TAG)return void tc(n,r.contents.name,t?1:2,0,c(dr.Initializer.fromInstructions,[{TAG:0,_0:a._0}]))}zn(n.globalsInitializer.instructions,"push",[u]);var o=tc(n,r.contents.name,t?1:0,0,c(dr.Initializer.fromInstructions,[{TAG:0,_0:0}]));return void n.globalsInitializer.instructions.push({TAG:10,_0:o});case 2:return;case 3:return j(e._1,(function(e){return lc(n,{TAG:0,_0:e[0],_1:e[1],_2:e[2]})}))}}function vc(n){var e={mod:Sr.make(void 0),funcs:[],scopeDepth:0,funcStack:Fn(),globals:V(1),globalsInitializer:Zo("__initGlobals__",[],Kn),stackTop:Wo("__STACK_TOP__",1,0,0,c(dr.Initializer.fromInstructions,[{TAG:0,_0:65535}])),blockStack:Fn()};Z(e.globals,e.stackTop.name,e.stackTop);try{j(n,(function(n){return lc(e,n)})),Sr.addMemory(e.mod,pr.make(Yt.make(6,void 0))),j(Xn(Dn(e.globals),(function(n,e){return n.index-e.index|0})),(function(n){var t,r,u,a=(r=(t=n).init,u=t.mutability,z(t.ty,(function(n){return dr.make(2!==u,n,r)})));if(void 0!==a)return Sr.addGlobal(e.mod,a)}));var t=or.fromFuncRefs(0,_n(e.funcs,(function(n,e){return n})));Sr.addElement(e.mod,t),Sr.addTable(e.mod,nr.make(0,Yt.makeExact(e.funcs.length)));var r=e.funcs.length,u=0===e.globalsInitializer.instructions.length;return u||(e.globalsInitializer.instructions.push(1),e.funcs.push(e.globalsInitializer)),j(e.funcs,(function(n){"main"!==n.name||u||n.instructions.unshift({TAG:14,_0:r});var t=$o(n);Sr.addExportedFunc(e.mod,n.name,t[1],t[2])})),{TAG:0,_0:e.mod}}catch(a){return{TAG:1,_0:Mo(On(a))}}}var dc=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",compile:function(n){try{return hn(fo(n),(function(n){var e=E(n,Ke.from);return hn(yo(e),(function(n){var t,r=n[1];t=r,j(B(Ie.renaming),(function(n){return Re(t,n)}));var u=E(e,(function(n){return Ke.subst(r,n)}));return Sn(vc(u),(function(n){return[n,Sr.encodeAsUint8Array(n)]}))}))}))}catch(e){return{TAG:1,_0:Mo(On(e))}}}});const Tc={0:"I32",1:"I64",2:"F32",3:"F64"},Gc={0:"Else",1:"End",2:"Return",3:"Drop",4:"AddI32",5:"SubI32",6:"MulI32",7:"DivI32Unsigned",8:"DivI32Signed",9:"EqzI32",10:"EqI32",11:"EqI64",12:"EqF32",13:"EqF64",14:"NeI32",15:"NeI64",16:"NeF32",17:"NeF64",18:"LeI32Signed",19:"LeI32Unsigned",20:"LeI64Signed",21:"LeI64Unsigned",22:"LeF32",23:"LeF64",24:"GeI32Signed",25:"GeI32Unsigned",26:"GeI64Signed",27:"GeI64Unsigned",28:"GeF32",29:"GeF64",30:"LtI32Signed",31:"LtI32Unsigned",32:"LtI64Signed",33:"LtI64Unsigned",34:"LtF32",35:"LtF64",36:"GtI32Signed",37:"GtI32Unsigned",38:"GtI64Signed",39:"GtI64Unsigned",40:"GtF32",41:"GtF64",42:"RemI32Signed",43:"RemI32Unsigned",44:"And"},Ac={0:"FuncRef",1:"ExternRef"},mc={0:"Func",1:"Table",2:"Memory",3:"Global"},pc={0:"Void"},hc=dc,gc=function(n){const e=hc.compile(n);return 0===e.TAG?{tag:"Ok",value:[{typeSection:e._0[0].typeSection.map((function(n){return[n._0.map((function(n){return Tc[n]})),n._1.map((function(n){return Tc[n]}))]})),funcSection:e._0[0].funcSection,tableSection:e._0[0].tableSection.map((function(n){return[Ac[n[0]],n[1]]})),memorySection:e._0[0].memorySection,globalSection:e._0[0].globalSection.map((function(n){return[Tc[n[0]],n[1],n[2].map((function(n){return"object"==typeof n?0===n.TAG?{tag:"ConstI32",value:n._0}:1===n.TAG?{tag:"ConstI64",value:n._0}:2===n.TAG?{tag:"ConstF32",value:n._0}:3===n.TAG?{tag:"ConstF64",value:n._0}:4===n.TAG?{tag:"If",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Tc[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Tc[n]})),n._0._1[1].map((function(n){return Tc[n]}))]]}:pc[n._0]}:5===n.TAG?{tag:"BranchIf",value:n._0}:6===n.TAG?{tag:"Branch",value:n._0}:7===n.TAG?{tag:"Block",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Tc[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Tc[n]})),n._0._1[1].map((function(n){return Tc[n]}))]]}:pc[n._0]}:8===n.TAG?{tag:"Loop",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Tc[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Tc[n]})),n._0._1[1].map((function(n){return Tc[n]}))]]}:pc[n._0]}:9===n.TAG?{tag:"GetGlobal",value:n._0}:10===n.TAG?{tag:"SetGlobal",value:n._0}:11===n.TAG?{tag:"GetLocal",value:n._0}:12===n.TAG?{tag:"SetLocal",value:n._0}:13===n.TAG?{tag:"TeeLocal",value:n._0}:14===n.TAG?{tag:"Call",value:n._0}:15===n.TAG?{tag:"CallIndirect",value:[n._0,n._1]}:16===n.TAG?{tag:"LoadI32",value:[n._0,n._1]}:{tag:"StoreI32",value:[n._0,n._1]}:Gc[n]}))]})),exportSection:e._0[0].exportSection.map((function(n){return{name:n.name,kind:mc[n.kind],index:n.index}})),elementSection:e._0[0].elementSection,codeSection:e._0[0].codeSection.map((function(n){return[n[0].map((function(n){return[n[0],Tc[n[1]]]})),n[1].map((function(n){return"object"==typeof n?0===n.TAG?{tag:"ConstI32",value:n._0}:1===n.TAG?{tag:"ConstI64",value:n._0}:2===n.TAG?{tag:"ConstF32",value:n._0}:3===n.TAG?{tag:"ConstF64",value:n._0}:4===n.TAG?{tag:"If",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Tc[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Tc[n]})),n._0._1[1].map((function(n){return Tc[n]}))]]}:pc[n._0]}:5===n.TAG?{tag:"BranchIf",value:n._0}:6===n.TAG?{tag:"Branch",value:n._0}:7===n.TAG?{tag:"Block",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Tc[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Tc[n]})),n._0._1[1].map((function(n){return Tc[n]}))]]}:pc[n._0]}:8===n.TAG?{tag:"Loop",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Tc[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Tc[n]})),n._0._1[1].map((function(n){return Tc[n]}))]]}:pc[n._0]}:9===n.TAG?{tag:"GetGlobal",value:n._0}:10===n.TAG?{tag:"SetGlobal",value:n._0}:11===n.TAG?{tag:"GetLocal",value:n._0}:12===n.TAG?{tag:"SetLocal",value:n._0}:13===n.TAG?{tag:"TeeLocal",value:n._0}:14===n.TAG?{tag:"Call",value:n._0}:15===n.TAG?{tag:"CallIndirect",value:[n._0,n._1]}:16===n.TAG?{tag:"LoadI32",value:[n._0,n._1]}:{tag:"StoreI32",value:[n._0,n._1]}:Gc[n]}))]})),funcs:e._0[0].funcs.map((function(n){return[n[0],[n[1]._0.map((function(n){return Tc[n]})),n[1]._1.map((function(n){return Tc[n]}))],[n[2][0].map((function(n){return[n[0],Tc[n[1]]]})),n[2][1].map((function(n){return"object"==typeof n?0===n.TAG?{tag:"ConstI32",value:n._0}:1===n.TAG?{tag:"ConstI64",value:n._0}:2===n.TAG?{tag:"ConstF32",value:n._0}:3===n.TAG?{tag:"ConstF64",value:n._0}:4===n.TAG?{tag:"If",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Tc[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Tc[n]})),n._0._1[1].map((function(n){return Tc[n]}))]]}:pc[n._0]}:5===n.TAG?{tag:"BranchIf",value:n._0}:6===n.TAG?{tag:"Branch",value:n._0}:7===n.TAG?{tag:"Block",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Tc[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Tc[n]})),n._0._1[1].map((function(n){return Tc[n]}))]]}:pc[n._0]}:8===n.TAG?{tag:"Loop",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Tc[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Tc[n]})),n._0._1[1].map((function(n){return Tc[n]}))]]}:pc[n._0]}:9===n.TAG?{tag:"GetGlobal",value:n._0}:10===n.TAG?{tag:"SetGlobal",value:n._0}:11===n.TAG?{tag:"GetLocal",value:n._0}:12===n.TAG?{tag:"SetLocal",value:n._0}:13===n.TAG?{tag:"TeeLocal",value:n._0}:14===n.TAG?{tag:"Call",value:n._0}:15===n.TAG?{tag:"CallIndirect",value:[n._0,n._1]}:16===n.TAG?{tag:"LoadI32",value:[n._0,n._1]}:{tag:"StoreI32",value:[n._0,n._1]}:Gc[n]}))]]})),importsCount:e._0[0].importsCount},e._0[1]]}:{tag:"Error",value:e._0}},Ec={0:"I32",1:"I64",2:"F32",3:"F64"},bc={I32:0,I64:1,F32:2,F64:3},wc={Else:0,End:1,Return:2,Drop:3,AddI32:4,SubI32:5,MulI32:6,DivI32Unsigned:7,DivI32Signed:8,EqzI32:9,EqI32:10,EqI64:11,EqF32:12,EqF64:13,NeI32:14,NeI64:15,NeF32:16,NeF64:17,LeI32Signed:18,LeI32Unsigned:19,LeI64Signed:20,LeI64Unsigned:21,LeF32:22,LeF64:23,GeI32Signed:24,GeI32Unsigned:25,GeI64Signed:26,GeI64Unsigned:27,GeF32:28,GeF64:29,LtI32Signed:30,LtI32Unsigned:31,LtI64Signed:32,LtI64Unsigned:33,LtF32:34,LtF64:35,GtI32Signed:36,GtI32Unsigned:37,GtI64Signed:38,GtI64Unsigned:39,GtF32:40,GtF64:41,RemI32Signed:42,RemI32Unsigned:43,And:44},yc={FuncRef:0,ExternRef:1},Sc={Func:0,Table:1,Memory:2,Global:3},Ic={Void:0},kc=Ir;kc.uleb128,kc.sleb128,kc.Vec.encode,kc.Vec.encodeMany,kc.F32.encode,kc.F64.encode,kc.Func.Signature.funcTypeCode,kc.Func.Signature.empty._0.map((function(n){return Ec[n]})),kc.Func.Signature.empty._1.map((function(n){return Ec[n]})),kc.FuncSection.make,kc.FuncSection.encode,kc.Str.encode,kc.Limits.makeExact,kc.Elem.show,kc.Elem.encode,kc.ElementSection.make,kc.ElementSection.show,kc.ElementSection.encode,kc.MemorySection.make;kc.F32,kc.F64,kc.Vec,kc.Str;const xc=({theme:n,code:e,onChange:t})=>Pn.createElement(Vn,{mode:"rust",width:"100vw",height:"calc(100vh - 39px)",value:e,theme:n,enableLiveAutocompletion:!0,onChange:t,fontSize:16,editorProps:{$blockScrolling:!0},setOptions:{tabSize:2}}),Dc=({theme:n,text:e})=>Pn.createElement(Vn,{mode:"text",width:"100vw",height:"calc(100vh - 39px)",value:e,theme:n,enableLiveAutocompletion:!0,onChange:()=>null,fontSize:16,editorProps:{$blockScrolling:!0},setOptions:{showLineNumbers:!0,tabSize:2}}),Fc={dark:{backgroundColor:"#1c1c1c",color:"white",borderColor:"#3b3b3b"},light:{backgroundColor:"white",color:"black",borderColor:"black"}},Rc=n=>((n,r)=>e(n,t(r)))(((n,e)=>{for(var t in e||(e={}))u.call(e,t)&&o(n,t,e[t]);if(r)for(var t of r(e))a.call(e,t)&&o(n,t,e[t]);return n})({},n?Fc.dark:Fc.light),{borderWidth:"2px",borderStyle:"solid",fontSize:"20px",margin:"4px",borderRadius:"4px"}),Nc=({children:n,onClick:e,isDark:t})=>Pn.createElement("button",{onClick:e,style:Rc(t)},n);const Cc={"Prime sieve":"\nlet SIZEOF_U32 = 4;\n\nstruct Array {\n  start: Ptr<u32>,\n  mut length: u32,\n}\n\nimpl Array {\n  fn read(self, n) unsafe {\n    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>)\n  }\n\n  fn write(self, n, val) unsafe {\n    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>) = val;\n  }\n\n  fn push(mut self, val) {\n    self.write(self.length, val);\n    self.length = self.length + 1;\n  }\n}\n\nstruct Sieve {\n  mut primes: Array,\n  mut current: u32\n}\n\nimpl Sieve {\n  fn clear(mut self) {\n    self.primes.length = 0;\n    // 2 is the first prime\n    self.primes.push(2);\n    self.current = 1;\n  }\n\n  fn isPrime(mut self, n) {\n    mut i = 0;\n    mut p = self.primes.read(i);\n\n    while p * p <= n {\n      if n % p == 0 { return false; }\n      i = i + 1;\n      p = self.primes.read(i);\n    }\n\n    // n is prime\n    // add it to the sieve\n    self.primes.push(n);\n\n    true\n  }\n\n  fn nextPrime(mut self) {\n    self.current = self.current + 2;\n\n    while !self.isPrime(self.current) {\n      self.current = self.current + 2;\n    }\n\n    self.current\n  }\n\n  // count the prime numbers <= m\n  fn countUpTo(mut self, m) {\n    self.clear();\n\n    while self.current <= m {\n      self.nextPrime();\n    }\n\n    self.primes.length - 1\n  }\n}\n\n// right after the shadow stack\nlet PRIMES_START = 64 * 1024;\n\nfn main() {\n  mut sieve = Sieve {\n    primes: Array {\n      start: PRIMES_START as Ptr<u32>,\n      length: 0\n    },\n    current: 0\n  };\n\n  sieve.countUpTo(1000000)\n}",Factorial:"\nfn fact(n) {\n  let aux = (n, acc) -> if n == 0 { acc } else { aux(n - 1, n * acc) };\n  aux(n, 1)\n}\n\nfn main() {\n  fact(11)\n}",Fibonacci:"\nfn fib(n) {\n  let fib_aux = (n, a, b) -> {\n    if n == 0 { return a; }\n    if n == 1 { return b; }\n    fib_aux(n - 1, b, a + b)\n  };\n\n  fib_aux(n, 0, 1)\n}\n\nfn main() {\n  fib(83)\n}",Pointers:"\nlet SIZEOF_U32 = 4;\n\nfn read_u32(addr) unsafe {\n  *((addr * SIZEOF_U32) as Ptr<u32>)\n}\n\nfn write_u32(addr, val) unsafe {\n  *((addr * SIZEOF_U32) as Ptr<u32>) = val;\n}\n\nfn main() {\n  let square = n -> n * n;\n\n  mut i = 0;\n  while i < 100 {\n    write_u32(i, square(i));\n    i = i + 1;\n  }\n\n  read_u32(42) // 1764\n}",Primes:"\nfn isEven(n) {\n  n % 2 == 0\n}\n\nfn isPrime(n) {\n  if n < 2 { return false; }\n  if n == 2 { return true; }\n  if isEven(n) { return false; }\n\n  mut i = 3;\n\n  while i * i <= n {\n    if n % i == 0 { return false; }\n    i = i + 2;\n  }\n\n  true\n}\n\nfn countPrimesLessThan(m) {\n  mut i = m;\n  mut count = 0;\n\n  while i > 1 {\n    if isPrime(i) {\n      count = count + 1;\n    }\n\n    i = i - 1;\n  }\n\n  count\n}\n\nfn main() {\n  countPrimesLessThan(1000000)\n}",Structs:"\nstruct MinMax {\n  mut min: u32,\n  mut max: u32\n}\n\nimpl MinMax {\n  fn reset(mut self) {\n    self.min = 0;\n    self.max = 0;\n  }\n\n  fn resetStatic(mut m) {\n    m.reset();\n  }\n}\n\nfn main() {\n  mut m = MinMax {\n    min: 17,\n    max: 22\n  };\n\n  MinMax.resetStatic(m);\n  \n  m.min + m.max == 0\n}","Lambda (kind of)":"\nfn main() {\n  let twice = (f, x) -> f(f(x));\n  \n  twice(n -> n * n, 7)\n}",Vector:"\nstruct BumpAllocator {\n  mut head: u32\n}\n\nimpl BumpAllocator {\n  fn allocate(mut self, bytes) {\n    let addr = self.head as Ptr<u32>;\n    self.head = self.head + bytes;\n    addr\n  }\n  \n  // do nothing!\n  fn free(mut self, addr) { }\n}\n\nmut allocator = BumpAllocator { head: 64 * 1024 };\n\nlet SIZEOF_U32 = 4;\n\nstruct Vec {\n  mut start: Ptr<u32>,\n  mut length: u32,\n  mut capacity: u32 \n}\n\nimpl Vec {\n  fn read(self, index) unsafe {\n    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>)\n  }\n\n  fn write(mut self, index, value) unsafe {\n    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>) = value;\n  }\n\n  fn grow(mut self) unsafe {\n    let newCap = if self.capacity == 0 { 8 } else { self.capacity * 2 };\n    let newStart = allocator.allocate(newCap * SIZEOF_U32);\n\n    // copy the data from the old array to the new one\n    mut i = 0;\n    while i < self.length {\n      *(((newStart as u32) + (i * SIZEOF_U32)) as Ptr<u32>) = self.read(i);\n      i = i + 1;\n    }\n\n    allocator.free(self.start);\n    self.start = newStart;\n    self.capacity = newCap;\n  }\n\n  fn push(mut self, val) unsafe {\n    if self.length + 1 > self.capacity {\n      self.grow();\n    }\n\n    self.write(self.length, val);\n    self.length = self.length + 1;\n  }\n\n  fn pop(mut self) unsafe {\n    if self.length > 0 {\n      self.length = self.length - 1;\n      self.read(self.length)\n    } else {\n      // until we have Option<T>\n      4294967295 // -1\n    }\n  }\n}\n\nfn main() {\n  mut vec = Vec {\n    start: 0 as Ptr<u32>,\n    length: 0,\n    capacity: 0\n  };\n\n  mut i = 0;\n  while i < 1000 {\n    vec.push(i);\n    i = i + 1;\n  }\n\n  (vec.length, vec.capacity, vec.read(723))\n}"},Lc=({onSelect:n,isDark:e,defaultSample:t})=>{const[r,u]=jn.exports.useState(t);return jn.exports.useEffect((()=>{n(Cc[r])}),[]),Pn.createElement("select",{value:r,style:Rc(e),onChange:e=>{const t=e.target.value;u(t),n(Cc[t])}},Object.entries(Cc).map((([n,e])=>Pn.createElement("option",{key:n},n))))},Xc=({onRun:n,onDisassemble:e,isDark:t,toggleDarkMode:r,onSelectSample:u})=>Pn.createElement("div",{style:{display:"flex",flexDirection:"row",backgroundColor:t?"black":"white",borderBottom:"2px solid silver"}},Pn.createElement(Nc,{isDark:t,onClick:n},"Run"),Pn.createElement(Nc,{isDark:t,onClick:e},"Disassemble"),Pn.createElement(Lc,{isDark:t,onSelect:u,defaultSample:"Prime sieve"}),Pn.createElement(Nc,{isDark:t,onClick:r},(t?"Light":"Dark")+" Mode")),Oc=({children:n})=>Pn.createElement("div",{style:{background:"silver",cursor:"col-resize",width:"100%",height:"100%",outline:"none",overflow:"hidden"}},n);function Uc(){const[n,e]=jn.exports.useState(""),[t,r]=jn.exports.useState(""),[u,a]=jn.exports.useState((new Date).getHours()>=20||(new Date).getHours()<=9),o=u?"terminal":"github",c=jn.exports.useCallback((async()=>{try{const e=gc(n);if("Ok"===e.tag){r("running...");const n=await(async n=>{const e=await WebAssembly.compile(n),t=await WebAssembly.instantiate(e);if("main"in t.exports)return t.exports.main();throw new Error("main function not found, exported functions are: "+Object.keys(t.exports).join(", "))})(e.value[1]);r(String(n))}else r(e.value)}catch(e){r(`${e}`)}}),[n,r]),i=jn.exports.useCallback((()=>{try{const t=gc(n);if("Ok"===t.tag){const[n]=t.value;r((e=n,kc.Module.show({typeSection:e.typeSection.map((function(n){return{TAG:0,_0:n[0].map((function(n){return bc[n]})),_1:n[1].map((function(n){return bc[n]}))}})),funcSection:e.funcSection,tableSection:e.tableSection.map((function(n){return[yc[n[0]],[n[1][0],null==n[1][1]?void 0:n[1][1]]]})),memorySection:e.memorySection.map((function(n){return[n[0],null==n[1]?void 0:n[1]]})),globalSection:e.globalSection.map((function(n){return[bc[n[0]],n[1],n[2].map((function(n){return"object"==typeof n?"ConstI32"===n.tag?{TAG:0,_0:n.value}:"ConstI64"===n.tag?{TAG:1,_0:n.value}:"ConstF32"===n.tag?{TAG:2,_0:n.value}:"ConstF64"===n.tag?{TAG:3,_0:n.value}:"If"===n.tag?{TAG:4,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:bc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return bc[n]})),n.value.value[1][1].map((function(n){return bc[n]}))]}:Ic[n.value]}:"BranchIf"===n.tag?{TAG:5,_0:n.value}:"Branch"===n.tag?{TAG:6,_0:n.value}:"Block"===n.tag?{TAG:7,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:bc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return bc[n]})),n.value.value[1][1].map((function(n){return bc[n]}))]}:Ic[n.value]}:"Loop"===n.tag?{TAG:8,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:bc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return bc[n]})),n.value.value[1][1].map((function(n){return bc[n]}))]}:Ic[n.value]}:"GetGlobal"===n.tag?{TAG:9,_0:n.value}:"SetGlobal"===n.tag?{TAG:10,_0:n.value}:"GetLocal"===n.tag?{TAG:11,_0:n.value}:"SetLocal"===n.tag?{TAG:12,_0:n.value}:"TeeLocal"===n.tag?{TAG:13,_0:n.value}:"Call"===n.tag?{TAG:14,_0:n.value}:"CallIndirect"===n.tag?{TAG:15,_0:n.value[0],_1:n.value[1]}:"LoadI32"===n.tag?{TAG:16,_0:n.value[0],_1:n.value[1]}:{TAG:17,_0:n.value[0],_1:n.value[1]}:wc[n]}))]})),exportSection:e.exportSection.map((function(n){return{name:n.name,kind:Sc[n.kind],index:n.index}})),elementSection:e.elementSection,codeSection:e.codeSection.map((function(n){return[n[0].map((function(n){return[n[0],bc[n[1]]]})),n[1].map((function(n){return"object"==typeof n?"ConstI32"===n.tag?{TAG:0,_0:n.value}:"ConstI64"===n.tag?{TAG:1,_0:n.value}:"ConstF32"===n.tag?{TAG:2,_0:n.value}:"ConstF64"===n.tag?{TAG:3,_0:n.value}:"If"===n.tag?{TAG:4,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:bc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return bc[n]})),n.value.value[1][1].map((function(n){return bc[n]}))]}:Ic[n.value]}:"BranchIf"===n.tag?{TAG:5,_0:n.value}:"Branch"===n.tag?{TAG:6,_0:n.value}:"Block"===n.tag?{TAG:7,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:bc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return bc[n]})),n.value.value[1][1].map((function(n){return bc[n]}))]}:Ic[n.value]}:"Loop"===n.tag?{TAG:8,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:bc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return bc[n]})),n.value.value[1][1].map((function(n){return bc[n]}))]}:Ic[n.value]}:"GetGlobal"===n.tag?{TAG:9,_0:n.value}:"SetGlobal"===n.tag?{TAG:10,_0:n.value}:"GetLocal"===n.tag?{TAG:11,_0:n.value}:"SetLocal"===n.tag?{TAG:12,_0:n.value}:"TeeLocal"===n.tag?{TAG:13,_0:n.value}:"Call"===n.tag?{TAG:14,_0:n.value}:"CallIndirect"===n.tag?{TAG:15,_0:n.value[0],_1:n.value[1]}:"LoadI32"===n.tag?{TAG:16,_0:n.value[0],_1:n.value[1]}:{TAG:17,_0:n.value[0],_1:n.value[1]}:wc[n]}))]})),funcs:e.funcs.map((function(n){return[n[0],{TAG:0,_0:n[1][0].map((function(n){return bc[n]})),_1:n[1][1].map((function(n){return bc[n]}))},[n[2][0].map((function(n){return[n[0],bc[n[1]]]})),n[2][1].map((function(n){return"object"==typeof n?"ConstI32"===n.tag?{TAG:0,_0:n.value}:"ConstI64"===n.tag?{TAG:1,_0:n.value}:"ConstF32"===n.tag?{TAG:2,_0:n.value}:"ConstF64"===n.tag?{TAG:3,_0:n.value}:"If"===n.tag?{TAG:4,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:bc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return bc[n]})),n.value.value[1][1].map((function(n){return bc[n]}))]}:Ic[n.value]}:"BranchIf"===n.tag?{TAG:5,_0:n.value}:"Branch"===n.tag?{TAG:6,_0:n.value}:"Block"===n.tag?{TAG:7,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:bc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return bc[n]})),n.value.value[1][1].map((function(n){return bc[n]}))]}:Ic[n.value]}:"Loop"===n.tag?{TAG:8,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:bc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return bc[n]})),n.value.value[1][1].map((function(n){return bc[n]}))]}:Ic[n.value]}:"GetGlobal"===n.tag?{TAG:9,_0:n.value}:"SetGlobal"===n.tag?{TAG:10,_0:n.value}:"GetLocal"===n.tag?{TAG:11,_0:n.value}:"SetLocal"===n.tag?{TAG:12,_0:n.value}:"TeeLocal"===n.tag?{TAG:13,_0:n.value}:"Call"===n.tag?{TAG:14,_0:n.value}:"CallIndirect"===n.tag?{TAG:15,_0:n.value[0],_1:n.value[1]}:"LoadI32"===n.tag?{TAG:16,_0:n.value[0],_1:n.value[1]}:{TAG:17,_0:n.value[0],_1:n.value[1]}:wc[n]}))]]})),importsCount:e.importsCount})))}else r(t.value)}catch(t){r(`${t}`)}var e}),[n,r]);return Pn.createElement("div",{style:{display:"flex",flexDirection:"column"}},Pn.createElement(Xc,{onRun:c,onDisassemble:i,toggleDarkMode:()=>a(!u),isDark:u,onSelectSample:n=>e(n)}),Pn.createElement(Bn.exports.Split,{splitterSize:"10px",renderSplitter:()=>Pn.createElement(Oc,null)},Pn.createElement(xc,{theme:o,code:n,onChange:e}),Pn.createElement(Dc,{theme:o,text:t})))}Zn.render(Pn.createElement(Pn.StrictMode,null,Pn.createElement(Uc,null)),document.getElementById("root"));
