import{c as Q,a as _n,j as w,r as Ka,m as on,g as De,b as jt,d as v,z as Re,k as pt,e as kr,f as it,t as Ze,h as Ya,i as Fr,l as zn,n as Nr,_ as m,s as Dr,o as Ha,p as Qa,q as Zt,u as Rr,v as $r,w as pn,x as Wt,y as me,A as fn,B as ya,C as Ia,D as Lr,E as Jt,F as xa,G as no,H as eo,I as to,J as ro,K as uo,L as ao,M as Cr,N as pe,O as P,P as ne,Q as y,R as oo,S as Ur,T as Ln,U as io,V as Kt,W as Mr,X as co,Y as Jn,Z as _o,$ as fo,a0 as ee,a1 as Xr,a2 as At,a3 as Or,a4 as Vr,a5 as so,a6 as St,a7 as lo,a8 as bt,a9 as vo,aa as To,ab as Go,ac as F,ad as go,ae as ho,af as zr,ag as Yt,ah as Eo,ai as J,aj as wo,ak as ct,al as mo,am as Br,an as Ht,ao as _t,ap as We,aq as po,ar as Pr,as as Ao,at as ft,au as qr,av as So,aw as bo,ax as kt,ay as ko,az as Fo}from"./vendor.263d8ae4.js";const No=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))u(a);new MutationObserver(a=>{for(const t of a)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const t={};return a.integrity&&(t.integrity=a.integrity),a.referrerpolicy&&(t.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?t.credentials="include":a.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function u(a){if(a.ep)return;a.ep=!0;const t=r(a);fetch(a.href,t)}};No();function sn(n){var e=[],r=function(u){for(;;){var a=u,t=a&127,o=a>>>7;if(o!==0){e.push(t|128),u=o;continue}e.push(t);return}};return r(n),e}function jr(n){var e=[],r=function(u){for(;;){var a=u,t=a&127,o=a>>7;if(o===0&&(t&64)==0||o===-1&&(t&64)!=0){e.push(t);return}e.push(t|128),u=o}};return r(n|0),e}function st(n){return Q(sn(n.length),n)}function Bn(n){return Q(sn(n.length),_n(n))}var Do={encode:st,encodeMany:Bn};function Zr(n){var e=new DataView(new ArrayBuffer(4));return e.setFloat32(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3)]}var Ro={encode:Zr};function Wr(n){var e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3),e.getUint8(4),e.getUint8(5),e.getUint8(6),e.getUint8(7)]}var $o={encode:Wr};function Lo(n){return n}function te(n,e){return Q([n],st(e))}function re(n){var e;switch(n){case 0:e="custom";break;case 1:e="type";break;case 2:e="import";break;case 3:e="function";break;case 4:e="table";break;case 5:e="memory";break;case 6:e="global";break;case 7:e="export";break;case 8:e="start";break;case 9:e="element";break;case 10:e="code";break;case 11:e="data";break}return"["+e+"]"}var Co={id:Lo,encode:te,show:re};function Je(n){switch(n){case 0:return 127;case 1:return 126;case 2:return 125;case 3:return 124}}function Ke(n){switch(n){case 0:return"i32";case 1:return"i64";case 2:return"f32";case 3:return"f64"}}var Uo={encode:Je,show:Ke};function Jr(n){return typeof n=="number"?[64]:n.TAG===0?[Je(n._0)]:sn(n._0)}function Mo(n){return typeof n=="number"?"void":n.TAG===0?Ke(n._0):"type "+String(n._0)}var Xo={encode:Jr,show:Mo};function Qt(n){if(typeof n=="number")switch(n){case 0:return[5,"else"];case 1:return[11,"end"];case 2:return[15,"return"];case 3:return[26,"drop"];case 4:return[106,"i32.add"];case 5:return[107,"i32.sub"];case 6:return[108,"i32.mul"];case 7:return[110,"i32.div_s"];case 8:return[109,"i32.div_u"];case 9:return[69,"i32.eqz"];case 10:return[70,"i32.eq"];case 11:return[81,"i64.eq"];case 12:return[91,"f32.eq"];case 13:return[97,"f64.eq"];case 14:return[71,"i32.ne"];case 15:return[82,"i64.ne"];case 16:return[92,"f32.ne"];case 17:return[98,"f64.ne"];case 18:return[76,"i32.le_s"];case 19:return[77,"i32.le_u"];case 20:return[87,"i64.le_s"];case 21:return[88,"i64.le_u"];case 22:return[95,"f32.le"];case 23:return[101,"f64.le"];case 24:return[78,"i32.ge_s"];case 25:return[79,"i32.ge_u"];case 26:return[89,"i64.ge_s"];case 27:return[90,"i64.ge_u"];case 28:return[96,"f32.ge"];case 29:return[102,"f64.ge"];case 30:return[72,"i32.lt_s"];case 31:return[73,"i32.lt_u"];case 32:return[83,"i64.lt_s"];case 33:return[84,"i64.lt_u"];case 34:return[93,"f32.lt"];case 35:return[99,"f64.lt"];case 36:return[74,"i32.gt_s"];case 37:return[75,"i32.gt_u"];case 38:return[85,"i64.gt_s"];case 39:return[86,"i64.gt_u"];case 40:return[94,"f32.gt"];case 41:return[100,"f64.gt"];case 42:return[111,"i32.rem_s"];case 43:return[112,"i32.rem_u"];case 44:return[113,"i32.and"];case 45:return[114,"i32.or"];case 46:return[116,"i32.shl"];case 47:return[117,"i32.shr_s"];case 48:return[118,"i32.shr_u"]}else switch(n.TAG|0){case 0:return[65,"i32.const "+String(n._0)];case 1:return[66,"i64.const "+String(n._0)];case 2:return[67,"i64.const "+String(n._0)];case 3:return[68,"i64.const "+String(n._0)];case 4:return[4,"if"];case 5:return[13,"br_if "+String(n._0)];case 6:return[12,"br "+String(n._0)];case 7:return[2,"block"];case 8:return[3,"loop"];case 9:return[35,"global.get "+String(n._0)];case 10:return[36,"global.set "+String(n._0)];case 11:return[32,"local.get "+String(n._0)];case 12:return[33,"local.set "+String(n._0)];case 13:return[34,"local.tee "+String(n._0)];case 14:return[16,"call "+String(n._0)];case 15:return[17,"call_indirect [typeIndex="+String(n._0)+", tableIndex="+String(n._1)+"]"];case 16:return[40,"i32.load (alignment="+String(n._0)+", offset="+String(n._1)+")"];case 17:return[54,"i32.store (alignment="+String(n._0)+", offset="+String(n._1)+")"]}}function ue(n){return Qt(n)[0]}function Kr(n){if(typeof n=="number")switch(n){case 0:case 1:return-1;default:return 0}else switch(n.TAG|0){case 4:case 7:case 8:return 1;default:return 0}}function Ft(n,e,r,u){var a=n!==void 0?n:{contents:0},t=Qt(e),o=Kr(e),i=w(Ka(0,a.contents+(o<0?o:0)|0),"  ",function(l){return""});a.contents=a.contents+o|0,e===0&&(a.contents=a.contents+1|0);var _,s=0;if(typeof e=="number")_="";else switch(e.TAG|0){case 11:case 12:case 13:s=1;break;case 14:_="<"+on(De(r,e._0),"??",function(l){return l})+">";break;default:_=""}return s===1&&(_="<"+on(De(u,e._0),"??",function(l){return l})+">"),i+t[1]+" "+_}function Ye(n){var e=0;if(typeof n=="number")return[ue(n)];switch(n.TAG|0){case 0:case 1:e=1;break;case 2:return Q([ue(n)],Zr(n._0));case 3:return Q([ue(n)],Wr(n._0));case 5:case 6:e=3;break;case 4:case 7:case 8:e=2;break;case 9:case 10:case 11:case 12:case 13:e=4;break;case 14:return Q([ue(n)],sn(n._0));case 15:return _n([[ue(n)],sn(n._0),sn(n._1)]);case 16:case 17:e=5;break}switch(e){case 1:return Q([ue(n)],jr(n._0));case 2:return Q([ue(n)],Jr(n._0));case 3:case 4:return Q([ue(n)],sn(n._0));case 5:return _n([[ue(n)],sn(n._0),sn(n._1)])}}var Oo={info:Qt,opcode:ue,identationDelta:Kr,show:Ft,encode:Ye};function Vo(n,e){return{_0:n,_1:e}}var zo=[],Bo=[],Po={_0:zo,_1:Bo};function Yr(n){return _n([[96],st(v(n._0,Je)),st(v(n._1,Je))])}function Hr(n){var e=n._1,r=n._0,u=w(r,", ",Ke),a=w(e,", ",Ke);if(r.length===1){var t=e.length;if(t===1)return u+" -> "+a;if(t===0)return u+" -> ()"}var o=e.length;return o!==1?o!==0?"("+u+") -> ("+a+")":"("+u+") -> ()":"("+u+") -> "+a}var qo={funcTypeCode:96,make:Vo,empty:Po,encode:Yr,show:Hr};function jo(n){var e=function(u,a){for(;;){var t=a,o=u;if(!o)return t;var i=o.tl,_=o.hd,s=_[1],l=_[0];if(t){var g=t.tl,d=t.hd,R=d[1],j=d[0];if(zn(s,R)){a={hd:[{hd:l,tl:j},R],tl:g},u=i;continue}a={hd:[{hd:l,tl:0},s],tl:{hd:[j,R],tl:g}},u=i;continue}a={hd:[{hd:l,tl:0},s],tl:0},u=i}},r=kr(e(it(n),0));return Ze(Ya(r,function(u){return[Nr(Ze(u[0])),u[1]]}))}function Qr(n){return Q(sn(n[0].length),[Je(n[1])])}function yr(n){return"local ["+w(n[0],", ",function(e){return e})+"] "+Ke(n[1])}var Zo={fromTypes:jo,encode:Qr,show:yr};function Wo(n,e){return[n,e]}function Ir(n){var e=Bn(v(n[0],Qr)),r=_n(v(n[1],Ye));return _n([[e.length+r.length|0],e,r])}function xr(n,e,r){var u=n[0],a={contents:1},t=Fr(r._0,function(s,l){return"param["+String(s)+"]"}),o=Q(t,_n(v(u,function(s){return s[0]}))),i=w(u,`
`,yr),_=w(n[1],`
`,function(s){return Ft(a,s,e,o)});return u.length===0?_:i+`
`+_}var Jo={make:Wo,encode:Ir,show:xr};function Ko(n,e,r){return[n,e,r]}var lt={Signature:qo,Local:Zo,Body:Jo,make:Ko};function Yo(n){return[]}function yt(n,e){var r=jt(n,function(u){return zn(u,e)});return r!==void 0?r:(n.push(e),n.length-1|0)}function nu(n){return te(1,Bn(v(n,Yr)))}function eu(n){return re(1)+`
`+w(n,`
`,Hr)}var Ho={make:Yo,getOrAdd:yt,encode:nu,show:eu};function Qo(n){return[]}function tu(n,e){return n.push(e),n.length-1|0}function ru(n){return te(3,Bn(v(n,sn)))}function uu(n,e){return re(3)+`
`+w(Re(n,e),`
`,function(r){return r[1]+": "+String(r[0])})}var yo={make:Qo,addSignature:tu,encode:ru,show:uu};function Nt(n){return st(v(n.split(""),function(e){return e.charCodeAt(0)|0}))}var Io={encode:Nt};function xo(n){return[n]}function au(n){switch(n){case 0:return"func";case 1:return"table";case 2:return"memory";case 3:return"global"}}var ni={encode:xo,show:au};function ei(n,e,r){return{name:n,kind:e,index:r}}function ou(n){return _n([Nt(n.name),[n.kind],sn(n.index)])}function iu(n){return"export "+au(n.kind)+" "+n.name+" (index: "+String(n.index)+")"}var ti={ExternalKind:ni,make:ei,encode:ou,show:iu};function ri(n){return[]}function ui(n,e){n.push(e)}function cu(n){return te(7,Bn(v(n,ou)))}function _u(n){return re(7)+`
`+w(n,`
`,iu)}var ai={make:ri,add:ui,encode:cu,show:_u};function oi(n){return n?"externref":"funcref"}function ii(n){return n?111:112}var ci={show:oi,encode:ii};function It(n){return"{ min: "+String(n[0])+", max: "+on(n[1],"?",function(e){return String(e)})+" }"}function _i(n,e){return[n,e]}function fi(n){return[n,n]}function Dt(n){var e=n[1],r=n[0];return e!==void 0?_n([[1],sn(r),sn(e)]):Q([0],sn(r))}var xt={show:It,make:_i,makeExact:fi,encode:Dt};function si(n,e){return[n,e]}function fu(n){return Q([n[0]?111:112],Dt(n[1]))}function su(n){return"table "+(n[0]?"externref":"funcref")+" "+It(n[1])}var lu={make:si,encode:fu,show:su};function li(n){return[]}function vi(n,e){n.push(e)}function vu(n){return re(4)+`
`+w(n,`
`,su)}function du(n){return te(4,Bn(v(n,fu)))}var di={make:li,add:vi,show:vu,encode:du};function Ti(n,e){var r=n!==void 0?n:0;return{offset:r,funcIndices:e}}function Tu(n){return"elem funcref ("+w(n.funcIndices," ",function(e){return String(e)})+") (offset="+String(n.offset)+")"}function Gu(n){return _n([[0],Ye({TAG:0,_0:n.offset}),Ye(1),Bn(v(n.funcIndices,sn))])}var gu={fromFuncRefs:Ti,show:Tu,encode:Gu};function Gi(n){return[]}function gi(n,e){n.push(e)}function hu(n){return re(9)+`
`+w(n,`
`,Tu)}function Eu(n){return te(9,Bn(v(n,Gu)))}var hi={make:Gi,add:gi,show:hu,encode:Eu};function Ei(n){return n}function wu(n){return Q(_n(v(n,Ye)),Ye(1))}function mu(n){if(n.length!==1)return`
`+w(n,`
`,function(r){return"  "+Ft(void 0,r,[],[])})+`
end`;var e=n[0];return Ft(void 0,e,[],[])}var wi={fromInstructions:Ei,encode:wu,show:mu};function mi(n,e,r){return[e,n,r]}function pu(n){return"global "+(n[1]?"mutable":"immutable")+" "+Ke(n[0])+" = "+mu(n[2])}function Au(n){return Q([Je(n[0]),n[1]?1:0],wu(n[2]))}var vt={Initializer:wi,make:mi,show:pu,encode:Au};function pi(n){return[]}function Ai(n,e){n.push(e)}function Su(n){return re(6)+`
`+w(n,`
`,pu)}function bu(n){return te(6,Bn(v(n,Au)))}var Si={make:pi,add:Ai,show:Su,encode:bu};function bi(n){return n}function ku(n){return"memory "+It(n)}var Fu={make:bi,show:ku,encode:Dt};function ki(n){return[]}function Nu(n,e){return n.push(e)-1|0}function Du(n){return re(5)+`
`+w(n,`
`,ku)}function Ru(n){return te(5,Bn(v(n,Dt)))}var Fi={make:ki,add:Nu,show:Du,encode:Ru},Ni={};function $u(n){return _n([[0],sn(n._0)])}function Lu(n){return"func (index: "+String(n._0)+")"}var Di={make:void 0,encode:$u,show:Lu};function Cu(n){return _n([Nt(n.moduleName),Nt(n.entityName),$u(n.desc)])}function Ri(n,e,r){return{moduleName:n,entityName:e,desc:r}}function Uu(n){return"import "+Lu(n.desc)+" "+n.moduleName+"."+n.entityName}var Mu={ImportDesc:Di,encode:Cu,make:Ri,show:Uu};function $i(n){return[]}function Xu(n,e){return n.push(e)-1|0}function Ou(n){return te(2,Bn(v(n,Cu)))}function Vu(n){return re(2)+`
`+w(n,`
`,Uu)}function Li(n){return n.length}var Ci={make:$i,add:Xu,encode:Ou,show:Vu,count:Li};function Ui(n){return[]}function zu(n,e){return n.push(e),n.length-1|0}function Bu(n){return te(10,Bn(v(n,Ir)))}function Pu(n,e,r){var u=v(pt(e,function(t){return!0}),function(t){return t.entityName}),a=Q(u,v(r,function(t){return t[0]}));return re(10)+`
`+w(Re(n,r),`

`,function(t){var o=t[1];return o[0]+`
`+xr(t[0],a,o[1])})}var Mi={make:Ui,addFunc:zu,encode:Bu,show:Pu};function Xi(n){return{typeSection:[],importSection:[],funcSection:[],tableSection:[],memorySection:[],globalSection:[],exportSection:[],elementSection:[],codeSection:[],funcs:[]}}function Oi(n,e){return yt(n.typeSection,e)}function qu(n,e,r,u){var a=yt(n.typeSection,r);return tu(n.funcSection,a),n.funcs.push([e,r,u]),zu(n.codeSection,u)+n.importSection.length|0}function Vi(n,e,r,u){var a=qu(n,e,r,u),t={name:e,kind:0,index:a};return n.exportSection.push(t),a}function zi(n,e){n.tableSection.push(e)}function Bi(n,e){n.elementSection.push(e)}function Pi(n,e){n.globalSection.push(e)}function qi(n,e){return Nu(n.memorySection,e)}function ji(n,e){return Xu(n.importSection,e)}function ju(n){return _n([[0,97,115,109,1,0,0,0],nu(n.typeSection),Ou(n.importSection),ru(n.funcSection),du(n.tableSection),Ru(n.memorySection),bu(n.globalSection),cu(n.exportSection),Eu(n.elementSection),Bu(n.codeSection)])}function Zi(n){return(e=>Uint8Array.from(e))(ju(n))}function Wi(n){return w([eu(n.typeSection),Vu(n.importSection),uu(n.funcSection,v(n.funcs,function(e){return e[0]})),vu(n.tableSection),Du(n.memorySection),Su(n.globalSection),_u(n.exportSection),hu(n.elementSection),Pu(n.codeSection,n.importSection,n.funcs)],`

`,function(e){return e})}var Pn={make:Xi,getOrAddSignature:Oi,addFunc:qu,addExportedFunc:Vi,addTable:zi,addElement:Bi,addGlobal:Pi,addMemory:qi,addImport:ji,encode:ju,encodeAsUint8Array:Zi,show:Wi},Ji=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uleb128:sn,sleb128:jr,Vec:Do,F32:Ro,F64:$o,Section:Co,ValueType:Uo,BlockReturnType:Xo,Inst:Oo,Func:lt,TypeSection:Ho,FuncSection:yo,Str:Io,ExportEntry:ti,ExportSection:ai,ReferenceType:ci,Limits:xt,Table:lu,TableSection:di,Elem:gu,ElementSection:hi,Global:vt,GlobalSection:Si,Memory:Fu,MemorySection:Fi,Import:Ni,ImportEntry:Mu,ImportSection:Ci,CodeSection:Mi,Module:Pn});const nr={Else:0,End:1,Return:2,Drop:3,AddI32:4,SubI32:5,MulI32:6,DivI32Unsigned:7,DivI32Signed:8,EqzI32:9,EqI32:10,EqI64:11,EqF32:12,EqF64:13,NeI32:14,NeI64:15,NeF32:16,NeF64:17,LeI32Signed:18,LeI32Unsigned:19,LeI64Signed:20,LeI64Unsigned:21,LeF32:22,LeF64:23,GeI32Signed:24,GeI32Unsigned:25,GeI64Signed:26,GeI64Unsigned:27,GeF32:28,GeF64:29,LtI32Signed:30,LtI32Unsigned:31,LtI64Signed:32,LtI64Unsigned:33,LtF32:34,LtF64:35,GtI32Signed:36,GtI32Unsigned:37,GtI64Signed:38,GtI64Unsigned:39,GtF32:40,GtF64:41,RemI32Signed:42,RemI32Unsigned:43,AndI32:44,OrI32:45,ShlI32:46,ShrI32Signed:47,ShrI32Unsigned:48},Zu={"0":"I32","1":"I64","2":"F32","3":"F64"},N={I32:0,I64:1,F32:2,F64:3},Ki={FuncRef:0,ExternRef:1},Yi={Func:0,Table:1,Memory:2,Global:3},se={Void:0},K=Ji;K.uleb128;K.sleb128;K.Vec.encode;K.Vec.encodeMany;K.F32.encode;K.F64.encode;K.Func.Signature.funcTypeCode;K.Func.Signature.empty._0.map(function(e){return Zu[e]}),K.Func.Signature.empty._1.map(function(e){return Zu[e]});K.FuncSection.make;K.FuncSection.encode;K.Str.encode;K.Limits.makeExact;K.Elem.show;K.Elem.encode;K.ElementSection.make;K.ElementSection.show;K.ElementSection.encode;K.MemorySection.make;K.ImportEntry.ImportDesc.make;const Hi=function(n){return K.Module.show({typeSection:n.typeSection.map(function(u){return{TAG:0,_0:u[0].map(function(t){return N[t]}),_1:u[1].map(function(t){return N[t]})}}),importSection:n.importSection.map(function(u){return{moduleName:u.moduleName,entityName:u.entityName,desc:{TAG:0,_0:u.desc.value}}}),funcSection:n.funcSection,tableSection:n.tableSection.map(function(u){return[Ki[u[0]],[u[1][0],u[1][1]==null?void 0:u[1][1]]]}),memorySection:n.memorySection.map(function(u){return[u[0],u[1]==null?void 0:u[1]]}),globalSection:n.globalSection.map(function(u){return[N[u[0]],u[1],u[2].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:{TAG:17,_0:t.value[0],_1:t.value[1]}:nr[t]})]}),exportSection:n.exportSection.map(function(u){return{name:u.name,kind:Yi[u.kind],index:u.index}}),elementSection:n.elementSection,codeSection:n.codeSection.map(function(u){return[u[0].map(function(t){return[t[0],N[t[1]]]}),u[1].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:{TAG:17,_0:t.value[0],_1:t.value[1]}:nr[t]})]}),funcs:n.funcs.map(function(u){return[u[0],{TAG:0,_0:u[1][0].map(function(t){return N[t]}),_1:u[1][1].map(function(t){return N[t]})},[u[2][0].map(function(t){return[t[0],N[t[1]]]}),u[2][1].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:{TAG:17,_0:t.value[0],_1:t.value[1]}:nr[t]})]]})})};K.F32;K.F64;K.Vec;K.Str;function Qi(n,e,r){return m(e,m(n,r))}function He(n){return[[],n]}var yi=Dr;function Ii(n,e,r){return Dr(n,e,[[],r])}var xi=Ha,nc=Qa,ec=Zt;function tc(n,e){var r=w(Rr($r(n,e)),`
`,function(u){return"  "+u[0]+": "+u[1]});return`{
`+r+`
}`}var Xn={empty:void 0,add:yi,addMono:Ii,remove:xi,has:nc,get:ec,show:tc},rc=[],ae={TAG:1,_0:"u32",_1:rc},uc=[],On={TAG:1,_0:"bool",_1:uc},ac=[],Ae={TAG:1,_0:"()",_1:ac};function Dn(n,e){return{TAG:1,_0:"Fun",_1:Q(n,[e])}}function oc(n){return{TAG:1,_0:"Tuple",_1:n}}function ic(n){return{TAG:1,_0:"Ptr",_1:[n]}}function er(n){switch(n.TAG|0){case 0:case 1:return!1;case 2:return!0}}var $e=fn("Types.Size.UnkownTypeSize");function Rt(n){for(;;){var e=n;switch(e.TAG|0){case 0:throw{RE_EXN_ID:$e,_1:e,Error:new Error};case 1:switch(e._0){case"()":if(e._1.length===0)return 0;throw{RE_EXN_ID:$e,_1:e,Error:new Error};case"Mut":var r=e._1;if(r.length!==1)throw{RE_EXN_ID:$e,_1:e,Error:new Error};n=r[0];continue;case"Fun":case"Ptr":return 4;case"Tuple":return pn(v(e._1,Rt),0,function(u,a){return u+a|0});case"bool":case"u32":break;case"u64":if(e._1.length===0)return 8;throw{RE_EXN_ID:$e,_1:e,Error:new Error};default:throw{RE_EXN_ID:$e,_1:e,Error:new Error}}if(e._1.length===0)return 4;throw{RE_EXN_ID:$e,_1:e,Error:new Error};case 2:return 4}}}function cc(n){return Math.ceil(Math.log2(Rt(n)))|0}function _c(n){return Rt(n)===0}var oe={UnkownTypeSize:$e,size:Rt,sizeLog2:cc,isZeroSizedType:_c};function fc(n){return{TAG:0,_0:n}}function tr(n,e,r){if(n.TAG===0)return{TAG:1,_0:[e,r],_1:{TAG:0,_0:n._0}};var u=n._1,a=n._0,t=a[1],o=a[0];return e<o?{TAG:1,_0:[e,r],_1:{TAG:1,_0:[o,t],_1:u}}:{TAG:1,_0:[o,t],_1:tr(u,e,r)}}function sc(n){for(;;){var e=n;if(e.TAG===0)return e._0;n=e._1}}function lc(n,e){return pn(n,{TAG:0,_0:{TAG:0,_0:e}},function(r,u){return tr(r,u[0],u[1])})}function rr(n){var e=function(r,u){for(;;){var a=u,t=r;if(t.TAG===0){var o=t._0;switch(o.TAG|0){case 0:case 1:return a;case 2:var i=o._0;if(i.TAG===0)return a;var _=i._0;if(_.TAG===0)return a;u={hd:_._0,tl:a},r=_._1;continue}}else{u={hd:t._0,tl:a},r=t._1;continue}}};return Ze(e(n,0))}function vc(n){return ya(rr(n))}function Wu(n,e){if(n.TAG===0){var r=m(e,n._0);switch(r.TAG|0){case 0:case 1:return{TAG:0,_0:r};case 2:var u=r._0;return u.TAG===0?{TAG:0,_0:r}:u._0}}else{var a=n._0;return{TAG:1,_0:[a[0],m(e,a[1])],_1:Wu(n._1,e)}}}function Ju(n,e){var r=function(u,a){for(;;){var t=a,o=u;if(o.TAG===0)return Nr(Ze({hd:"..."+m(e,o._0),tl:t}));var i=o._0;a={hd:i[0]+": "+m(e,i[1]),tl:t},u=o._1}};return"{ "+w(r(n,0),", ",function(u){return u})+" }"}var Vn={make:fc,insert:tr,tail:sc,fromArray:lc,toArray:rr,toMap:vc,map:Wu,show:Ju};function $t(n){switch(n.TAG|0){case 0:return no(void 0,n._0);case 1:return pn(v(n._1,$t),void 0,Jt);case 2:var e=n._0;return e.TAG===0?void 0:pn(v(rr(e._0),function(r){return Qi(function(u){return u[1]},$t,r)}),void 0,Jt)}}function dc(n){return Lr($t(n[1]),eo(n[0]))}function Tc(n){return pn(v(xa(n),dc),void 0,Jt)}function ur(n,e){var r=Ia(Lr($t(e),Tc(n)));return[r,e]}function Gc(n){var e=String.fromCharCode(97+n%26|0),r=n/26|0;return r===0?e:e+String(r)}function A(n){switch(n.TAG|0){case 0:return Gc(n._0);case 1:var e=n._1,r=n._0;if(e.length===0)return r;switch(r){case"Fun":var u=Wt(e,0,e.length-1|0),a=me(e,e.length-1|0);if(u.length!==1)return"("+w(u,", ",A)+") -> "+A(a);var t=u[0];return A(t)+" -> "+A(a);case"Tuple":return"("+w(e,", ",A)+")";default:return r+"<"+w(e,", ",A)+">"}case 2:var o=n._0;return o.TAG===0?o._0:Ju(o._0,A)}}function Ku(n){switch(n){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/";case 4:return"%";case 5:return"<";case 6:return"<=";case 7:return">";case 8:return">=";case 9:return"==";case 10:return"!=";case 11:return"&&";case 12:return"||";case 13:return"&";case 14:return"|";case 15:return"<<";case 16:return">>"}}var gc={show:Ku};function Yu(n){switch(n){case 0:return"-";case 1:return"!";case 2:return"*"}}var hc={show:Yu};function Hu(n){return typeof n=="number"?"()":n.TAG===0?String(n._0):n._0?"true":"false"}var Ec={show:Hu};function X(n){switch(n.TAG|0){case 0:return Hu(n._0);case 1:return Yu(n._0)+X(n._1);case 2:return"("+X(n._0)+" "+Ku(n._1)+" "+X(n._2)+")";case 3:return n._0;case 4:return X(n._0)+" = "+X(n._1);case 5:var e=n._1,r=n._0,u=r.length;if(u!==1)return u!==0?"("+w(r,", ",function(i){return i})+") -> "+X(e):"() -> "+X(e);var a=r[0];return a+" -> "+X(e);case 6:return"let "+n._0+" = "+X(n._1)+" in "+X(n._2);case 7:return"("+X(n._0)+")("+w(n._1,", ",X)+")";case 8:return(n._2===1?"unsafe ":"")+`{
`+w(Q(v(n._0,Qu),on(n._1,[],function(i){return[X(i)]})),`;
`,function(i){return"  "+i})+`
}`;case 9:var t=n._2,o="if "+X(n._0)+" "+X(n._1);return t!==void 0?o+" else "+X(t):o;case 10:return"while "+X(n._0)+" "+X(n._1);case 11:return"return "+on(n._0,"",X);case 12:return X(n._0)+" as "+A(n._1);case 13:return"("+w(n._0,", ",X)+")";case 14:return n._0+` {
`+w(n._1,", ",function(i){return i[0]+": "+X(i[1])})+`
}`;case 15:return X(n._0)+"."+n._1}}function ar(n){switch(n.TAG|0){case 0:return"fn "+n._0+"("+w(n._1,", ",function(e){return(e[1]?"mut ":"")+e[0]})+") "+X(n._2);case 1:return(n._1?"mut":"let")+" "+n._0+" = "+X(n._2);case 2:return"struct "+n._0+` {
`+w(n._1,`,
`,function(e){return(e[2]?"mut ":"")+e[0]+": "+A(e[1])})+`
}`;case 3:return n._0+` {
`+w(n._1,`

`,ar)+`
}`;case 4:return"extern fn "+n.name+"("+w(n.args,", ",function(e){return(e[2]?"mut ":"")+e[0]+": "+A(e[1])})+") -> "+A(n.ret)}}function Qu(n){return n.TAG===0?(n._1?"mut":"let")+" "+n._0+" = "+X(n._2):X(n._0)}var wc={showExpr:X,showDecl:ar,showStmt:Qu},mc={show:ar};function h(n,e){for(;;){var r=e;switch(r.TAG|0){case 0:var u=r._0,a=Cr(n,u);if(a===void 0)return{TAG:0,_0:u};e=a;continue;case 1:return{TAG:1,_0:r._0,_1:v(r._1,function(i){return h(n,i)})};case 2:var t=r._0,o;return o=t.TAG===0?{TAG:0,_0:t._0}:{TAG:1,_0:Vn.map(t._0,function(i){return h(n,i)})},{TAG:2,_0:o}}}}function yu(n,e){var r=e[0];return[r,h(ao(n,r),e[1])]}function $(n,e){return to(ro(e,function(r){return h(n,r)}),n,function(r,u,a){return uo(a,u)})}function ln(n,e){return $r(e,function(r){return yu(n,r)})}var Qe;function or(n,e){for(var r,u=0;pe(r)&&u<n.length;){var a=m(e,me(n,u));a!==void 0&&(r=P(ne(a))),u=u+1|0}return r}function Iu(n,e){for(var r,u=n.length-1|0;pe(r)&&u>=0;)m(e,me(n,u))?r=u:u=u-1|0;return r}function pc(n,e){for(var r=[],u=!1,a=0;u===!1&&a<n.length;){var t=me(n,a);t!==void 0?r.push(m(e,ne(t))):u=!0,a=a+1|0}if(!u)return r}function Ac(n,e){for(var r=[],u,a=0;pe(u)&&a<n.length;){var t=me(n,a);t.TAG===0?r.push(m(e,t._0)):u=P(t._0),a=a+1|0}var o=u;return o!==void 0?{TAG:1,_0:ne(o)}:{TAG:0,_0:r}}function xu(n,e){return y(jt(n,e),function(r){return[me(n,r),r]})}function Sc(n){return"struct "+n.name+`{
`+w(n.attributes,`,
`,function(e){return"  "+e.name+": "+A(e.ty)})+`
}`}function bc(n,e){return{TAG:2,_0:{TAG:1,_0:Vn.fromArray(v(n.attributes,function(r){return[r.name,r.ty]}),e)}}}function kc(n,e){var r={contents:0},u=[];return Ln(e,function(a){var t=a[1],o=oe.size(t);u.push({name:a[0],mut:a[2],offset:r.contents,ty:t,size:o,impl:void 0}),r.contents=r.contents+o|0}),{name:n,attributes:u,size:r.contents,staticFuncs:[]}}function Fc(n,e,r){n.attributes.push({name:e.contents.name,mut:!1,offset:0,ty:e.contents.ty,size:0,impl:[e,r]})}function Nc(n,e){n.staticFuncs.push({name:e})}var ye={show:Sc,toPartialStructType:bc,make:kc,addImplementation:Fc,addStaticFunc:Nc},qn={tyVarIndex:0,identifiers:[],renaming:oo(10),structs:Ur(5)};function le(n){var e=qn.tyVarIndex;return qn.tyVarIndex=qn.tyVarIndex+1|0,e}function ir(n){return{TAG:0,_0:le()}}function Lt(n){var e=n[0],r=v(e,function(u){return{TAG:0,_0:le()}});return h(fo(Re(e,r)),n[1])}function Kn(n,e){var r=n!==void 0?ne(n):void 0,u=qn.identifiers.length;qn.identifiers.push(e);var a={contents:{name:e,newName:e,index:u,ty:r!==void 0?r:{TAG:0,_0:le()}}};return co(qn.renaming,u,a),a}function Dc(n){return Jn(Iu(qn.identifiers,function(e){return e===n}),function(e){return _o(qn.renaming,e)})}function na(n,e){e.contents.ty=h(n,e.contents.ty)}function ea(n){return Ln(io(qn.renaming),function(e){return na(n,e)})}function Rc(n){return Kt(qn.structs,n.name,n)}function Yn(n){return Mr(qn.structs,n)}function ve(n){switch(n.TAG|0){case 0:var e=n._0;return typeof e=="number"?Ae:e.TAG===0?ae:On;case 3:return n._0.contents.ty;case 4:case 11:return Ae;case 12:return on(n._0,Ae,ve);case 13:return n._2;case 14:return oc(v(n._0,ve));case 15:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return n._0}}function $c(n){return ve(n._0)}function O(n,e){var r=n!==void 0?ne(n):void 0,u=function(d,R){return r!==void 0?"("+R+": "+A(h(ne(r),d))+")":R},a=function(d){return O(P(r),d)};switch(e.TAG|0){case 0:return u(ve(e),Ec.show(e._0));case 1:return u(e._0,"("+O(P(r),e._1)+" "+gc.show(e._2)+" "+O(P(r),e._3)+")");case 2:return u(e._0,"("+hc.show(e._1)+O(P(r),e._2)+")");case 3:var t=e._0;return u(t.contents.ty,t.contents.name);case 4:var o=e._1;return u(ve(o),O(P(r),e._0)+" = "+O(P(r),o));case 5:return u(e._0,"("+w(e._1,", ",function(d){return d.contents.name})+") -> "+O(P(r),e._2));case 6:return u(e._0,(e._1?"mut":"let")+" "+e._2.contents.name+" = "+O(P(r),e._3)+` in
`+O(P(r),e._4));case 7:return u(e._0,"let rec "+e._1.contents.name+" ("+w(e._2,", ",function(d){return d.contents.name})+") = "+O(P(r),e._3)+` in
`+O(P(r),e._4));case 8:return u(e._0,"("+O(P(r),e._1)+")("+w(e._2,", ",a)+")");case 9:var i=e._2,_=P(r);return u(e._0,(e._3===1?"unsafe ":"")+`{
`+w(Q(v(e._1,function(d){return ta(_,d)}),on(i,[],function(d){return[O(void 0,d)]})),`;
`,function(d){return"  "+d})+(pe(i)?"; ":"")+`
}`);case 10:return u(e._0,"if "+O(P(r),e._1)+" "+O(P(r),e._2)+" else "+O(P(r),e._3));case 11:return u(Ae,"while "+O(void 0,e._0)+" "+O(void 0,e._1));case 12:var s=P(r);return"return "+u(ve(e),on(e._0,"",function(d){return O(s,d)}));case 13:var l=e._0;return u(ve(l),O(void 0,l))+" as "+A(e._2);case 14:var g=P(r);return"("+w(e._0,", ",function(d){return O(g,d)})+")";case 15:return e._0+` {
`+w(e._1,`,
`,function(d){return d[0]+": "+O(void 0,d[1])})+`
}`;case 16:return u(e._0,O(void 0,e._1)+"."+e._2)}}function ta(n,e){var r=n!==void 0?ne(n):void 0;return O(P(r),e._0)}function cr(n,e){var r=n!==void 0?ne(n):void 0,u=function(s,l){return r!==void 0?"("+l+": "+A(h(ne(r),s))+")":l};switch(e.TAG|0){case 0:var a=e._1,t=e._0,o;if(r!==void 0){var i=ne(r);o=w(a,", ",function(s){var l=s[0];return(s[1]?"mut ":"")+(l.contents.name+": "+A(h(i,l.contents.ty)))})}else o=w(a,", ",function(s){return(s[1]?"mut ":"")+s[0].contents.name});return u(t.contents.ty,"fn "+t.contents.name+"("+o+") "+O(P(r),e._2));case 1:var _=e._0;return u(_.contents.ty,(e._1?"mut":"let")+" "+_.contents.name+" = "+O(P(r),e._2));case 2:return wc.showDecl({TAG:2,_0:e._0,_1:e._1});case 3:return"impl "+e._0+` {
`+w(e._1,`

`,function(s){return cr(void 0,{TAG:0,_0:s[0],_1:s[1],_2:s[2]})})+`
}`;case 4:return"extern fn "+e.name.contents.name+"("+w(e.args,", ",function(s){var l=s[0];return(s[1]?"mut ":"")+l.contents.name+": "+A(l.contents.ty)})+") -> "+A(e.ret)}}var ra=fn("Core.CoreAst.UnexpectedDeclarationInImplBlock"),ua=fn("Core.CoreAst.UndeclaredIdentifer"),aa=fn("Core.CoreAst.UnreachableLetStmt");function _r(n,e,r,u,a){return r.TAG===5?{TAG:7,_0:r._0,_1:n,_2:r._1,_3:r._2,_4:u}:{TAG:6,_0:a,_1:e,_2:n,_3:r,_4:u}}function V(n){var e={LAZY_DONE:!1,VAL:function(){return ir()}};switch(n.TAG|0){case 0:return{TAG:0,_0:n._0};case 1:return{TAG:2,_0:ee(e),_1:n._0,_2:V(n._1)};case 2:return{TAG:1,_0:ee(e),_1:V(n._0),_2:n._1,_3:V(n._2)};case 3:var r=n._0,u=Dc(r);if(u!==void 0)return{TAG:3,_0:u};var a=Yn(r);if(a!==void 0)return{TAG:3,_0:Kn(void 0,r)};throw{RE_EXN_ID:ua,_1:r,Error:new Error};case 4:return{TAG:4,_0:V(n._0),_1:V(n._1)};case 5:var t=n._1,o=n._0;if(o.length===0)return{TAG:5,_0:ee(e),_1:[Kn(void 0,"__x")],_2:V(t)};var i=P(void 0);return{TAG:5,_0:ee(e),_1:v(o,function(g){return Kn(i,g)}),_2:V(t)};case 6:return _r(Kn(void 0,n._0),!1,V(n._1),V(n._2),ee(e));case 7:return{TAG:8,_0:ee(e),_1:V(n._0),_2:v(n._1,V)};case 8:var _=n._2,s=n._1,l=function(g){if(!g)return y(s,V);var d=g.hd;if(d.TAG!==0)return{TAG:9,_0:ee(e),_1:[oa(d)],_2:l(g.tl),_3:_};var R=d._3;return _r(Kn(void 0,d._0),d._1,V(d._2),on(l(g.tl),{TAG:0,_0:0},function(j){return j}),R!==void 0?R:ir())};return{TAG:9,_0:ee(e),_1:[],_2:l(it(n._0)),_3:_};case 9:return{TAG:10,_0:ee(e),_1:V(n._0),_2:V(n._1),_3:on(n._2,{TAG:0,_0:0},V)};case 10:return{TAG:11,_0:V(n._0),_1:V(n._1)};case 11:return{TAG:12,_0:y(n._0,V)};case 12:return{TAG:13,_0:V(n._0),_1:ee(e),_2:n._1};case 13:return{TAG:14,_0:v(n._0,V)};case 14:return{TAG:15,_0:n._0,_1:v(n._1,function(g){return[g[0],V(g[1])]})};case 15:return{TAG:16,_0:ir(),_1:V(n._0),_2:n._1}}}function oa(n){if(n.TAG!==0)return{_0:V(n._0)};throw{RE_EXN_ID:aa,Error:new Error}}function fr(n){switch(n.TAG|0){case 0:var e=v(n._1,function(o){return[Kn(P(void 0),o[0]),o[1]]});return{TAG:0,_0:Kn(void 0,n._0),_1:e,_2:V(n._2)};case 1:return{TAG:1,_0:Kn(void 0,n._0),_1:n._1,_2:V(n._2)};case 2:var r=n._1,u=n._0;return Rc(ye.make(u,r)),{TAG:2,_0:u,_1:r};case 3:var a=v(v(n._1,fr),function(o){if(o.TAG===0)return[o._0,o._1,o._2];throw{RE_EXN_ID:ra,_1:o,Error:new Error}});return{TAG:3,_0:n._0,_1:a};case 4:var t=v(n.args,function(o){return[Kn(P(o[1]),o[0]),o[2]]});return{TAG:4,name:Kn(void 0,n.name),args:t,ret:n.ret}}}function Z(n,e){var r=function(i){return Z(n,i)};switch(e.TAG|0){case 0:return{TAG:0,_0:e._0};case 1:return{TAG:1,_0:h(n,e._0),_1:Z(n,e._1),_2:e._2,_3:Z(n,e._3)};case 2:return{TAG:2,_0:h(n,e._0),_1:e._1,_2:Z(n,e._2)};case 3:return{TAG:3,_0:e._0};case 4:return{TAG:4,_0:Z(n,e._0),_1:Z(n,e._1)};case 5:return{TAG:5,_0:h(n,e._0),_1:e._1,_2:Z(n,e._2)};case 6:return{TAG:6,_0:h(n,e._0),_1:e._1,_2:e._2,_3:Z(n,e._3),_4:Z(n,e._4)};case 7:return{TAG:7,_0:h(n,e._0),_1:e._1,_2:e._2,_3:Z(n,e._3),_4:Z(n,e._4)};case 8:return{TAG:8,_0:h(n,e._0),_1:Z(n,e._1),_2:v(e._2,r)};case 9:return{TAG:9,_0:h(n,e._0),_1:v(e._1,function(i){return ia(n,i)}),_2:y(e._2,r),_3:e._3};case 10:return{TAG:10,_0:h(n,e._0),_1:Z(n,e._1),_2:Z(n,e._2),_3:Z(n,e._3)};case 11:return{TAG:11,_0:Z(n,e._0),_1:Z(n,e._1)};case 12:return{TAG:12,_0:y(e._0,r)};case 13:return{TAG:13,_0:Z(n,e._0),_1:h(n,e._1),_2:h(n,e._2)};case 14:return{TAG:14,_0:v(e._0,r)};case 15:var u=e._1,a=e._0,t=Yn(a);if(t===void 0)return Xr('unreachable: undeclared struct "'+a+"'");var o=pc(v(pt(t.attributes,function(i){return pe(i.impl)}),function(i){var _=i.name;return At(u,function(s){return s[0]===_})}),function(i){return[i[0],Z(n,i[1])]});return o!==void 0?{TAG:15,_0:a,_1:o}:Xr('unreachable: missing attribute for struct "'+a+'"');case 16:return{TAG:16,_0:h(n,e._0),_1:Z(n,e._1),_2:e._2}}}function ia(n,e){return{_0:Z(n,e._0)}}function ca(n,e){switch(e.TAG|0){case 0:return{TAG:0,_0:e._0,_1:e._1,_2:Z(n,e._2)};case 1:return{TAG:1,_0:e._0,_1:e._1,_2:Z(n,e._2)};case 3:return{TAG:3,_0:e._0,_1:v(e._1,function(r){return[r[0],r[1],Z(n,r[2])]})};case 2:case 4:return e}}var gn={typeOfExpr:ve,typeOfStmt:$c,showExpr:O,showStmt:ta,showDecl:cr,UnexpectedDeclarationInImplBlock:ra,UndeclaredIdentifer:ua,UnreachableLetStmt:aa,rewriteLetIn:_r,fromExpr:V,fromStmt:oa,fromDecl:fr,substExpr:Z,substStmt:ia,substDecl:ca},Rn={show:O,from:V,subst:Z,typeOf:ve},Se={show:cr,from:fr,subst:ca};function _a(n){return[n,0,n.length]}function Lc(n){return _a(Array.from(n,function(e){return Or(e,0)}))}function fa(n,e){var r=e[2],u=n!==void 0?n:1;return[e[0],Math.min(e[1]+u|0,r),r]}function sr(n){return De(n[0],n[1])}function lr(n){return fa(1,n)}function vr(n){return n[1]===n[2]}function Cc(n){return n[0].slice(n[1],n[2])}function Ie(n,e){var r=sr(e);if(r!==void 0&&m(n,r))return[r,fa(void 0,e)]}function I(n){return function(e){return Ie(function(r){return r===n},e)}}function sa(n){return n>=97?n<=122:!1}function Uc(n){return n>=65?n<=90:!1}function Mc(n){return sa(n)?!0:Uc(n)}function la(n){return n>=48?n<=57:!1}function Xc(n){return Mc(n)?!0:la(n)}function Oc(n){return Ie(sa,n)}function Vc(n){return Ie(la,n)}function dr(n){return Ie(Xc,n)}function zc(n){return n>13||n<9?n===32:!(n===12||n===11)}function Bc(n){return Ie(zc,n)}function E(n,e,r){return y(m(n,r),function(u){return[m(e,u[0]),u[1]]})}function Ct(n,e,r){for(;;){var u=n,a=r,t=u!==void 0?u:[];if(vr(a))return[t,a];var o=m(e,a);if(o===void 0)return[t,a];t.push(o[0]),r=o[1],n=t}}function va(n){return Ct(void 0,Bc,n)}function dt(n,e,r){return Jn(m(n,r),function(u){var a=u[0];return y(m(e,u[1]),function(t){return[[a,t[0]],t[1]]})})}function da(n){return function(e){return E(function(r){return dt(n,function(u){return Ct(void 0,n,u)},r)},function(r){return Q([r[0]],r[1])},e)}}function Pc(n,e,r,u){return Jn(dt(n,e,u),function(a){var t=a[0],o=t[1],i=t[0];return y(m(r,a[1]),function(_){return[[i,o,_[0]],_[1]]})})}function Ta(n){if(!n)return function(a){return[0,a]};var e=n.hd,r=Ta(n.tl),u=function(a){return dt(e,r,a)};return function(a){return E(u,function(t){return{hd:t[0],tl:t[1]}},a)}}function Ga(n,e,r){var u=m(n,r);return u!==void 0?[u[0],u[1]]:m(e,r)}function Tt(n,e){return or(n,function(r){return m(r,e)})}function q(n){var e=Array.from(n,function(u){var a=Or(u,0);return function(t){return Ie(function(o){return o===a},t)}}),r=Ta(it(e));return function(u){return E(r,function(a){return n},u)}}function qc(n,e){var r=m(n,e);if(r===void 0)return[void 0,lr(e)]}var jc=da(Vc);function Zc(n){return E(jc,function(e){return{TAG:0,_0:Vr(so(w(e,"",function(r){return St(1,r)})))}},n)}var Wc=q("false");function Jc(n){return E(Wc,function(e){return{TAG:1,_0:!1}},n)}var Kc=q("true");function Yc(n){return E(Kc,function(e){return{TAG:1,_0:!0}},n)}function Hc(n){return Ga(Yc,Jc,n)}var Qc=[dr,I(95),I(39)];function yc(n){return Tt(Qc,n)}function Ic(n){return Ct(void 0,yc,n)}var xc=I(95);function n_(n){return Ga(Oc,xc,n)}function e_(n){return dt(n_,Ic,n)}function t_(n){return E(e_,function(e){return{TAG:3,_0:St(1,e[0])+w(e[1],"",function(r){return St(1,r)})}},n)}var r_=[dr,I(95)],u_=da(function(n){return Tt(r_,n)});function a_(n){return E(u_,function(e){return{TAG:4,_0:w(e,"",function(r){return St(1,r)})}},n)}var o_=q("let"),i_=q("mut"),c_=q("in"),__=q("if"),f_=q("else"),s_=q("fn"),l_=q("while"),v_=q("return"),d_=q("as"),T_=q("unsafe"),G_=q("struct"),g_=q("impl"),h_=q("extern"),E_=[function(n){return E(o_,function(e){return{TAG:5,_0:0}},n)},function(n){return E(i_,function(e){return{TAG:5,_0:1}},n)},function(n){return E(c_,function(e){return{TAG:5,_0:2}},n)},function(n){return E(__,function(e){return{TAG:5,_0:3}},n)},function(n){return E(f_,function(e){return{TAG:5,_0:4}},n)},function(n){return E(s_,function(e){return{TAG:5,_0:5}},n)},function(n){return E(l_,function(e){return{TAG:5,_0:6}},n)},function(n){return E(v_,function(e){return{TAG:5,_0:7}},n)},function(n){return E(d_,function(e){return{TAG:5,_0:8}},n)},function(n){return E(T_,function(e){return{TAG:5,_0:9}},n)},function(n){return E(G_,function(e){return{TAG:5,_0:10}},n)},function(n){return E(g_,function(e){return{TAG:5,_0:11}},n)},function(n){return E(h_,function(e){return{TAG:5,_0:12}},n)}];function w_(n){return Tt(E_,n)}function m_(n){return dt(w_,function(e){return qc(dr,e)},n)}function p_(n){return E(m_,function(e){return e[0]},n)}var A_=q("->"),S_=q("=="),b_=q("!="),k_=q("&&"),F_=q("||"),N_=q("+="),D_=q("-="),R_=q("*="),$_=q("/="),L_=q("%="),C_=I(43),U_=I(45),M_=I(42),X_=I(47),O_=I(37),V_=q("<="),z_=q(">="),B_=I(60),P_=I(62),q_=I(40),j_=I(41),Z_=I(44),W_=I(59),J_=I(61),K_=I(123),Y_=I(125),H_=I(58),Q_=I(33),y_=I(46),I_=I(38),x_=I(124),n0=[function(n){return E(A_,function(e){return{TAG:2,_0:5}},n)},function(n){return E(S_,function(e){return{TAG:2,_0:14}},n)},function(n){return E(b_,function(e){return{TAG:2,_0:15}},n)},function(n){return E(k_,function(e){return{TAG:2,_0:23}},n)},function(n){return E(F_,function(e){return{TAG:2,_0:25}},n)},function(n){return E(N_,function(e){return{TAG:2,_0:26}},n)},function(n){return E(D_,function(e){return{TAG:2,_0:27}},n)},function(n){return E(R_,function(e){return{TAG:2,_0:28}},n)},function(n){return E($_,function(e){return{TAG:2,_0:29}},n)},function(n){return E(L_,function(e){return{TAG:2,_0:30}},n)},function(n){return E(C_,function(e){return{TAG:2,_0:9}},n)},function(n){return E(U_,function(e){return{TAG:2,_0:10}},n)},function(n){return E(M_,function(e){return{TAG:2,_0:11}},n)},function(n){return E(X_,function(e){return{TAG:2,_0:12}},n)},function(n){return E(O_,function(e){return{TAG:2,_0:13}},n)},function(n){return E(V_,function(e){return{TAG:2,_0:17}},n)},function(n){return E(z_,function(e){return{TAG:2,_0:19}},n)},function(n){return E(B_,function(e){return{TAG:2,_0:16}},n)},function(n){return E(P_,function(e){return{TAG:2,_0:18}},n)},function(n){return E(q_,function(e){return{TAG:2,_0:0}},n)},function(n){return E(j_,function(e){return{TAG:2,_0:1}},n)},function(n){return E(Z_,function(e){return{TAG:2,_0:2}},n)},function(n){return E(W_,function(e){return{TAG:2,_0:3}},n)},function(n){return E(J_,function(e){return{TAG:2,_0:4}},n)},function(n){return E(K_,function(e){return{TAG:2,_0:6}},n)},function(n){return E(Y_,function(e){return{TAG:2,_0:7}},n)},function(n){return E(H_,function(e){return{TAG:2,_0:8}},n)},function(n){return E(Q_,function(e){return{TAG:2,_0:20}},n)},function(n){return E(y_,function(e){return{TAG:2,_0:21}},n)},function(n){return E(I_,function(e){return{TAG:2,_0:22}},n)},function(n){return E(x_,function(e){return{TAG:2,_0:24}},n)}];function e0(n){return Tt(n0,n)}var t0=[Zc,Hc,p_,e0,t_,a_];function r0(n){return Tt(t0,n)}function u0(n){return Ct(void 0,function(e){return E(function(r){return Pc(va,r0,va,r)},function(r){return r[1]},e)},n)}function a0(n){switch(n){case 0:return"(";case 1:return")";case 2:return",";case 3:return";";case 4:return"=";case 5:return"->";case 6:return"{";case 7:return"}";case 8:return":";case 9:return"+";case 10:return"-";case 11:return"*";case 12:return"/";case 13:return"%";case 14:return"==";case 15:return"!=";case 16:return"<";case 17:return"<=";case 18:return">";case 19:return">=";case 20:return"!";case 21:return".";case 22:return"&";case 23:return"&&";case 24:return"|";case 25:return"||";case 26:return"+=";case 27:return"-=";case 28:return"*=";case 29:return"/=";case 30:return"%="}}function o0(n){switch(n){case 0:return"let";case 1:return"mut";case 2:return"in";case 3:return"if";case 4:return"else";case 5:return"fn";case 6:return"while";case 7:return"return";case 8:return"as";case 9:return"unsafe";case 10:return"struct";case 11:return"impl";case 12:return"extern"}}function i0(n){switch(n.TAG|0){case 0:return String(n._0);case 1:return n._0?"true":"false";case 2:return a0(n._0);case 3:case 4:return n._0;case 5:return o0(n._0)}}function Ut(n){return{contents:function(e){return Jn(sr(e),function(r){if(m(n,r))return[r,lr(e)]})}}}function xe(n){return{contents:function(e){return Jn(sr(e),function(r){return y(m(n,r),function(u){return[u,lr(e)]})})}}}function c0(n,e){return{contents:function(r){var u=m(n.contents,r);if(u!==void 0){var a=u[1];return y(m(e,u[0]),function(t){return[t,a]})}}}}function f(n){return Ut(function(e){return zn(e,n)})}function G(n,e){return{contents:function(r){return y(m(n.contents,r),function(u){return[m(e,u[0]),u[1]]})}}}function an(n,e){return{contents:function(r){return Jn(m(n.contents,r),function(u){var a=u[0];return y(m(e.contents,u[1]),function(t){return[[a,t[0]],t[1]]})})}}}function Gt(n){var e=function(r){return{contents:function(u){if(vr(u))return[0,u];var a=m(r.contents,u);if(a===void 0)return[0,u];var t=a[0];return y(m(e(r).contents,a[1]),function(o){return[{hd:t,tl:o[0]},o[1]]})}}};return G(e(n),Ze)}function _0(n){return G(an(n,Gt(n)),function(e){return Q([e[0]],e[1])})}function de(n,e,r){return{contents:function(u){return Jn(m(an(n,e).contents,u),function(a){var t=a[0],o=t[1],i=t[0];return y(m(r.contents,a[1]),function(_){return[[i,o,_[0]],_[1]]})})}}}function Le(n,e,r,u){return{contents:function(a){return Jn(m(de(n,e,r).contents,a),function(t){var o=t[0],i=o[2],_=o[1],s=o[0];return y(m(u.contents,t[1]),function(l){return[[s,_,i,l[0]],l[1]]})})}}}function gt(n,e,r,u,a){return{contents:function(t){return Jn(m(Le(n,e,r,u).contents,t),function(o){var i=o[0],_=i[3],s=i[2],l=i[1],g=i[0];return y(m(a.contents,o[1]),function(d){return[[g,l,s,_,d[0]],d[1]]})})}}}function ga(n,e,r,u,a,t){return{contents:function(o){return Jn(m(gt(n,e,r,u,a).contents,o),function(i){var _=i[0],s=_[4],l=_[3],g=_[2],d=_[1],R=_[0];return y(m(t.contents,i[1]),function(j){return[[R,d,g,l,s,j[0]],j[1]]})})}}}function f0(n,e,r,u,a,t,o){return{contents:function(i){return Jn(m(ga(n,e,r,u,a,t).contents,i),function(_){var s=_[0],l=s[5],g=s[4],d=s[3],R=s[2],j=s[1],rn=s[0];return y(m(o.contents,_[1]),function(en){return[[rn,j,R,d,g,l,en[0]],en[1]]})})}}}function z(n,e){return{contents:function(r){var u=m(n.contents,r);return u!==void 0?[u[0],u[1]]:m(e.contents,r)}}}function Ce(n){return{contents:function(e){return or(n,function(r){return m(r.contents,e)})}}}function ha(n,e,r){return G(an(n,Gt(e)),function(u){var a=u[1],t=u[0];return zn(a,[])?t:pn(a,t,r)})}function Ue(n,e,r){return ha(n,an(e,n),function(u,a){return lo(r,u,a[0],a[1])})}function be(n){return G(de(Ut(function(e){return zn(e,{TAG:2,_0:0})}),n,Ut(function(e){return zn(e,{TAG:2,_0:1})})),function(e){return e[1]})}function s0(n,e){var r=function(u,a){var t=m(n.contents,u);if(t===void 0)return[a,u];var o=t[1];return a.push(t[0]),on(m(e.contents,o),[a,o],function(i){return r(i[1],a)})};return{contents:function(u){return r(u,[])}}}function Te(n){return s0(n,Ut(function(e){return zn(e,{TAG:2,_0:2})}))}function ie(n){return z(G(n,function(e){return P(e)}),{contents:function(e){return[void 0,e]}})}var Ea=an,wa={contents:function(n){}},vn={contents:function(n){}},nt={contents:function(n){}},ma={contents:function(n){}},ce={contents:function(n){}},l0=xe(function(n){if(n.TAG===0)return{TAG:0,_0:{TAG:0,_0:n._0}}}),v0=xe(function(n){if(n.TAG===1)return{TAG:0,_0:{TAG:1,_0:n._0}}}),Hn=xe(function(n){if(n.TAG===3)return n._0}),Mt=xe(function(n){if(n.TAG===4)return n._0}),Tr=xe(function(n){switch(n.TAG|0){case 3:case 4:return n._0;default:return}}),d0=G(an(f({TAG:2,_0:0}),f({TAG:2,_0:1})),function(n){return Ae}),T0=z(d0,xe(function(n){switch(n.TAG|0){case 3:switch(n._0){case"bool":return On;case"u32":return ae;default:return}case 4:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return}})),pa=z(T0,be(ce)),G0=z(G(de(z(be(Te(ce)),G(pa,function(n){return[n]})),f({TAG:2,_0:5}),ce),function(n){return Dn(n[0],n[2])}),pa),g0=z(G(Le(Mt,f({TAG:2,_0:16}),Te(ce),f({TAG:2,_0:18})),function(n){return{TAG:1,_0:n[0],_1:n[2]}}),G0);ce.contents=g0.contents;var h0=G(an(Tr,ie(an(f({TAG:2,_0:8}),ce))),function(n){return[n[0],y(n[1],function(e){return e[1]})]}),E0=G(z(Hn,Tr),function(n){return{TAG:3,_0:n}}),w0=G(an(f({TAG:2,_0:0}),f({TAG:2,_0:1})),function(n){return{TAG:0,_0:0}}),m0=G(be(Le(vn,f({TAG:2,_0:2}),vn,ie(an(f({TAG:2,_0:2}),Te(vn))))),function(n){var e=Q([n[0],n[2]],on(n[3],[],function(r){return r[1]}));return{TAG:13,_0:e}}),Aa=Ce([l0,v0,w0,E0,m0,be(vn)]),Sa=z(ha(Aa,an(f({TAG:2,_0:21}),Hn),function(n,e){return{TAG:15,_0:n,_1:e[1]}}),Aa),ba=z(G(an(Sa,_0(be(Te(vn)))),function(n){return pn(n[1],n[0],function(e,r){return{TAG:7,_0:e,_1:r}})}),Sa),p0=Ce([G(f({TAG:2,_0:11}),function(n){return 2}),G(f({TAG:2,_0:10}),function(n){return 0}),G(f({TAG:2,_0:20}),function(n){return 1})]),A0=z(G(f({TAG:2,_0:9}),function(n){return 0}),G(f({TAG:2,_0:10}),function(n){return 1})),S0=Ce([G(f({TAG:2,_0:11}),function(n){return 2}),G(f({TAG:2,_0:12}),function(n){return 3}),G(f({TAG:2,_0:13}),function(n){return 4})]),b0=Ce([G(f({TAG:2,_0:23}),function(n){return 11}),G(f({TAG:2,_0:25}),function(n){return 12})]),k0=Ce([G(f({TAG:2,_0:22}),function(n){return 13}),G(f({TAG:2,_0:24}),function(n){return 14}),G(Ea(f({TAG:2,_0:16}),f({TAG:2,_0:16})),function(n){return 15}),G(Ea(f({TAG:2,_0:18}),f({TAG:2,_0:18})),function(n){return 16})]),F0=Ce([G(f({TAG:2,_0:16}),function(n){return 5}),G(f({TAG:2,_0:17}),function(n){return 6}),G(f({TAG:2,_0:18}),function(n){return 7}),G(f({TAG:2,_0:19}),function(n){return 8})]),N0=z(G(f({TAG:2,_0:14}),function(n){return 9}),G(f({TAG:2,_0:15}),function(n){return 10})),D0=z(G(an(p0,ba),function(n){return{TAG:1,_0:n[0],_1:n[1]}}),ba),R0=Ue(D0,S0,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),$0=Ue(R0,A0,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),L0=Ue($0,b0,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),C0=Ue(L0,k0,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),U0=Ue(C0,F0,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),M0=Ue(U0,N0,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),X0=z(G(Le(f({TAG:5,_0:3}),vn,nt,ie(an(f({TAG:5,_0:4}),nt))),function(n){return{TAG:9,_0:n[1],_1:n[2],_2:y(n[3],function(e){return e[1]})}}),M0),O0=z(G(de(f({TAG:5,_0:6}),vn,nt),function(n){return{TAG:10,_0:n[1],_1:n[2]}}),X0),V0=z(G(ga(f({TAG:5,_0:0}),Hn,f({TAG:2,_0:4}),vn,f({TAG:5,_0:2}),vn),function(n){return{TAG:6,_0:n[1],_1:n[3],_2:n[5]}}),O0),z0=z(be(Te(Hn)),G(Hn,function(n){return[n]})),B0=z(G(de(z0,f({TAG:2,_0:5}),vn),function(n){return{TAG:5,_0:n[0],_1:n[2]}}),V0),P0=c0(vn,function(n){switch(n.TAG|0){case 9:case 10:return[!0,{TAG:1,_0:n}];default:return}});nt.contents=z(G(gt(ie(f({TAG:5,_0:9})),f({TAG:2,_0:6}),Gt(z(G(ma,function(n){return[!1,n]}),P0)),ie(vn),f({TAG:2,_0:7})),function(n){var e=n[3],r=n[2],u=v(r,function(i){return i[1]}),a=on(n[0],0,function(i){return 1}),t=De(r,r.length-1|0);if(t===void 0)return{TAG:8,_0:u,_1:e,_2:a};var o=t[1];return o.TAG===0||!(t[0]&&pe(e))?{TAG:8,_0:u,_1:e,_2:a}:{TAG:8,_0:Wt(u,0,r.length-1|0),_1:o._0,_2:a}}),B0).contents;var q0=z(G(Le(Mt,f({TAG:2,_0:6}),Te(de(Hn,f({TAG:2,_0:8}),vn)),f({TAG:2,_0:7})),function(n){return{TAG:14,_0:n[0],_1:v(n[2],function(e){return[e[0],e[2]]})}}),nt),j0=Ce([G(f({TAG:2,_0:4}),function(n){return"eq"}),G(f({TAG:2,_0:26}),function(n){return"plusEq"}),G(f({TAG:2,_0:27}),function(n){return"minusEq"}),G(f({TAG:2,_0:28}),function(n){return"starEq"}),G(f({TAG:2,_0:29}),function(n){return"divEq"}),G(f({TAG:2,_0:30}),function(n){return"modEq"})]),Z0=Ue(q0,j0,function(n,e,r){return e==="minusEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:1,_2:r}}:e==="divEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:3,_2:r}}:e==="eq"?{TAG:4,_0:n,_1:r}:e==="starEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:2,_2:r}}:e==="modEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:4,_2:r}}:{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:0,_2:r}}}),W0=z(G(an(f({TAG:5,_0:7}),ie(vn)),function(n){return{TAG:11,_0:n[1]}}),Z0),J0=G(an(W0,ie(an(f({TAG:5,_0:8}),ce))),function(n){var e=n[1],r=n[0];return e!==void 0?{TAG:12,_0:r,_1:e[1]}:r});vn.contents=J0.contents;var K0=G(an(vn,f({TAG:2,_0:3})),function(n){return{TAG:1,_0:n[0]}}),Y0=z(G(gt(z(f({TAG:5,_0:0}),f({TAG:5,_0:1})),h0,f({TAG:2,_0:4}),vn,f({TAG:2,_0:3})),function(n){var e=n[1];return{TAG:0,_0:e[0],_1:zn(n[0],{TAG:5,_0:1}),_2:n[3],_3:e[1]}}),K0);ma.contents=Y0.contents;var H0=G(gt(z(f({TAG:5,_0:0}),f({TAG:5,_0:1})),Tr,f({TAG:2,_0:4}),vn,f({TAG:2,_0:3})),function(n){return{TAG:1,_0:n[1],_1:zn(n[0],{TAG:5,_0:1}),_2:n[3]}}),Q0=z(G(gt(f({TAG:5,_0:10}),Mt,f({TAG:2,_0:6}),Te(de(an(ie(f({TAG:5,_0:1})),Hn),f({TAG:2,_0:8}),ce)),f({TAG:2,_0:7})),function(n){var e=v(n[3],function(r){var u=r[0];return[u[1],r[2],bt(u[0])]});return{TAG:2,_0:n[1],_1:e}}),H0),ka=z(G(Le(f({TAG:5,_0:5}),Hn,G(be(Te(an(ie(f({TAG:5,_0:1})),Hn))),function(n){return v(n,function(e){return[e[1],bt(e[0])]})}),nt),function(n){return{TAG:0,_0:n[1],_1:n[2],_2:n[3]}}),Q0),y0=z(G(f0(f({TAG:5,_0:12}),f({TAG:5,_0:5}),Hn,be(G(Te(Le(ie(f({TAG:5,_0:1})),Hn,f({TAG:2,_0:8}),ce)),function(n){return v(n,function(e){return[e[1],e[3],bt(e[0])]})})),f({TAG:2,_0:5}),ce,f({TAG:2,_0:3})),function(n){return{TAG:4,name:n[2],args:n[3],ret:n[5]}}),ka),I0=z(G(de(f({TAG:5,_0:11}),Mt,G(de(f({TAG:2,_0:6}),Gt(ka),f({TAG:2,_0:7})),function(n){return n[1]})),function(n){return{TAG:3,_0:n[1],_1:n[2]}}),y0);wa.contents=I0.contents;var x0=Gt(wa);function Xt(n){var e=n.replace(/(\/\/[^\n]*)/g,""),r=u0(Lc(e));if(r===void 0)return{TAG:1,_0:"could not tokenize"};var u=m(x0.contents,_a(r[0]));if(u===void 0)return{TAG:1,_0:"could not parse"};var a=u[1];if(vr(a))return{TAG:0,_0:u[0]};var t=w(Wt(Cc(a),0,5)," ",i0);return{TAG:1,_0:"could not parse near "+t}}function nf(n,e){var r=n!==void 0?n:3,u={contents:e.length},a=function(t,o,i){for(;;){var _=i,s=o,l=t;if(l){var g=l.hd,d=0;if(typeof g=="number")switch(g){case 2:var R=l.tl;if(R&&R.hd===3){t={hd:2,tl:R.tl};continue}break;case 9:var j=l.tl;if(j&&j.hd===9){t=j.tl;continue}break;case 10:var rn=l.tl;if(rn&&rn.hd===9){t={hd:14,tl:rn.tl};continue}break;case 14:var en=l.tl;if(en&&en.hd===9){t={hd:10,tl:en.tl};continue}break;case 18:var dn=l.tl;if(dn&&dn.hd===9){t={hd:36,tl:dn.tl};continue}break;case 19:var Sn=l.tl;if(Sn&&Sn.hd===9){t={hd:37,tl:Sn.tl};continue}break;case 24:var Tn=l.tl;if(Tn&&Tn.hd===9){t={hd:30,tl:Tn.tl};continue}break;case 25:var hn=l.tl;if(hn&&hn.hd===9){t={hd:31,tl:hn.tl};continue}break;case 30:var En=l.tl;if(En&&En.hd===9){t={hd:24,tl:En.tl};continue}break;case 31:var Gn=l.tl;if(Gn&&Gn.hd===9){t={hd:25,tl:Gn.tl};continue}break;case 36:var cn=l.tl;if(cn&&cn.hd===9){t={hd:18,tl:cn.tl};continue}break;case 37:var x=l.tl;if(x&&x.hd===9){t={hd:19,tl:x.tl};continue}break}else switch(g.TAG|0){case 0:var B=g._0,Un=0,bn=l.tl;if(bn){var wn=bn.hd;if(typeof wn=="number"){if(wn===3){t=bn.tl;continue}Un=3}else switch(wn.TAG|0){case 0:var nn=bn.tl;if(nn){var kn=nn.hd;if(typeof kn=="number"){var Mn=wn._0;if(kn!==43){if(kn<15)switch(kn){case 4:t={hd:{TAG:0,_0:B+Mn|0},tl:nn.tl};continue;case 5:t={hd:{TAG:0,_0:B-Mn|0},tl:nn.tl};continue;case 6:t={hd:{TAG:0,_0:Math.imul(B,Mn)},tl:nn.tl};continue;case 7:t={hd:{TAG:0,_0:vo(B,Mn)},tl:nn.tl};continue;case 10:t={hd:{TAG:0,_0:B===Mn?1:0},tl:nn.tl};continue;case 0:case 1:case 2:case 3:case 8:case 9:case 11:case 12:case 13:break;case 14:t={hd:{TAG:0,_0:B===Mn?0:1},tl:nn.tl};continue}}else{t={hd:{TAG:0,_0:To(B,Mn)},tl:nn.tl};continue}}}break;case 15:t={hd:{TAG:14,_0:B},tl:bn.tl};continue;default:Un=3}}if(Un===3&&B===0){var _e=l.tl;if(_e.hd===10){t={hd:9,tl:_e.tl};continue}}break;case 1:case 2:case 3:case 9:case 11:d=2;break;case 12:var yn=l.tl;if(yn){var jn=yn.hd;if(typeof jn!="number"&&jn.TAG===11){var Oe=g._0;if(Oe===jn._0){t={hd:{TAG:13,_0:Oe},tl:yn.tl};continue}}}break;case 13:var Zn=l.tl;if(Zn&&Zn.hd===3){t={hd:{TAG:12,_0:g._0},tl:Zn.tl};continue}break}if(d===2){var In=l.tl;if(In&&In.hd===3){t=In.tl;continue}}o={hd:g,tl:s},t=l.tl;continue}var fe=kr(s),xn=Go(fe);if(!(_>1&&xn<u.contents))return fe;u.contents=xn,i=_-1|0,o=0,t=fe}};return r>0?Ze(a(it(e),0,r)):e}function Gr(n,e){switch(e.TAG|0){case 0:return n===e._0;case 1:return Yt(e._1,function(u){return Gr(n,u)});case 2:var r=e._0;return r.TAG===0?!1:Yt(Vn.toArray(r._0),function(u){return Gr(n,u[1])})}}function Fa(n,e,r){if(Gr(n,e))return{TAG:1,_0:A({TAG:0,_0:n})+" occurs in "+A(e)};var u=Cr(r,n);return u!==void 0?zn(u,e)?{TAG:0,_0:r}:{TAG:1,_0:A(e)+" is not unifiable with "+A(u)}:{TAG:0,_0:zr(r,n,e)}}function et(n,e){for(;;){var r=n;if(!r)return{TAG:0,_0:e};var u=r.tl,a=r.hd,t=a[1],o=a[0],i=0;switch(o.TAG|0){case 0:var _=o._0,s=0;switch(t.TAG|0){case 0:if(_===t._0){n=u;continue}s=3;break;case 1:case 2:s=3;break}if(s===3)return F(Fa(_,t,e),function(x){return function(B){return et(x,B)}}(u));break;case 1:var l=o._1;switch(t.TAG|0){case 0:i=1;break;case 1:var g=t._1;if(o._0===t._0&&l.length===g.length){var d=pn(Re(l,g),u,function(x,B){return{hd:[h(e,B[0]),h(e,B[1])],tl:x}});n=d;continue}i=2;break;case 2:i=2;break}break;case 2:var R=o._0;switch(t.TAG|0){case 0:i=1;break;case 1:i=2;break;case 2:var j=t._0;if(R.TAG===0){var rn=R._0;if(j.TAG===0){if(rn!==j._0)return{TAG:1,_0:"cannot unify "+A(o)+" with "+A(t)};n=u;continue}var en=Yn(rn);if(en===void 0)return{TAG:1,_0:'undeclared struct "'+rn+'"'};var dn=et({hd:[{TAG:2,_0:{TAG:1,_0:j._0}},ye.toPartialStructType(en,le())],tl:u},e);return dn.TAG===0?{TAG:0,_0:dn._0}:{TAG:1,_0:"struct type "+A(t)+" does not match "+rn+": "+dn._0}}var Sn=R._0;if(j.TAG===0){var Tn=j._0,hn=Yn(Tn);if(hn===void 0)return{TAG:1,_0:'undeclared struct "'+Tn+'"'};var En=et({hd:[{TAG:2,_0:{TAG:1,_0:Sn}},ye.toPartialStructType(hn,le())],tl:u},e);return En.TAG===0?{TAG:0,_0:En._0}:{TAG:1,_0:"struct type "+A(o)+" does not match "+Tn+": "+En._0}}var Gn=Vn.toMap(j._0),cn=Vn.toArray(Sn);return F(Ac(v(cn,function(x,B,Un){return function(bn){var wn=bn[0],nn=Zt(Un,wn);return nn!==void 0?{TAG:0,_0:[bn[1],nn]}:{TAG:1,_0:"struct type "+A(B)+' is missing attribute "'+wn+'" from type "'+A(x)+'"'}}}(o,t,Gn)),function(x){return x}),function(x,B,Un,bn){return function(wn){var nn={TAG:2,_0:{TAG:1,_0:Vn.fromArray(Rr(go(Un,v(bn,function(kn){return kn[0]}))),le())}};return et(ho(it(wn),{hd:[Vn.tail(B),nn],tl:x}),e)}}(u,Sn,Gn,cn))}break}switch(i){case 1:return F(Fa(t._0,o,e),function(x){return function(B){return et(x,B)}}(u));case 2:return{TAG:1,_0:A(o)+" is not unifiable with "+A(t)}}}}function tn(n,e){return et({hd:[n,e],tl:0},void 0)}function ef(n){var e;return e=typeof n=="number"?Ae:n.TAG===0?ae:On,He(e)}function tf(n){var e=0;if(n>=5)switch(n){case 5:case 6:case 7:case 8:e=2;break;case 9:case 10:e=3;break;case 11:case 12:return He(Dn([On,On],On));case 13:case 14:case 15:case 16:e=1;break}else e=1;switch(e){case 1:return He(Dn([ae,ae],ae));case 2:return He(Dn([ae,ae],On));case 3:return[[0],Dn([{TAG:0,_0:0},{TAG:0,_0:0}],On)]}}function rf(n){switch(n){case 0:return He(Dn([ae],ae));case 1:return He(Dn([On],On));case 2:return[[0],Dn([ic({TAG:0,_0:0})],{TAG:0,_0:0})]}}function uf(n,e){return"cannot infer struct type: inferred type "+Vn.show(n,A)+" matches "+w(e,", ",function(r){return r.name})}function gr(n){var e=mo(Br(qn.structs),function(u){return po(tn({TAG:2,_0:{TAG:1,_0:n}},ye.toPartialStructType(u,le())),void 0,function(a){return u})});if(e.length!==1)return e.length===0?0:{TAG:1,_0:e};var r=e[0];return{TAG:0,_0:r}}var Na={ambiguousMatchesError:uf,findMatchingStruct:gr},tt=Ht();function Da(n,e,r,u){var a=Rn.typeOf(r);_t(tt,a);var t=pn(e,n,function(i,_){return Xn.addMono(i,_.contents.name,_.contents.ty)}),o=Dn(v(e,function(i){return i.contents.ty}),a);return F(An(t,r,a),function(i){var _=h(i,o),s=h(i,u),l=ln(i,n),g=ur(l,_);return J(tn(s,_),function(d){ct(tt);var R=$(d,i);return[R,h(d,s),yu(d,g)]})})}function An(n,e,r){return F(Qn(n,e),function(u){return J(tn(h(u,r),h(u,Rn.typeOf(e))),function(a){return $(a,u)})})}function Qn(n,e){switch(e.TAG|0){case 0:var r=Lt(ef(e._0));return tn(Rn.typeOf(e),r);case 1:var u=e._3,a=e._2,t=e._1,o=e._0;return F(Qn(n,t),function(c){var T=ln(c,n);return F(Qn(T,u),function(p){var b=$(p,c),L=h(b,Dn([Rn.typeOf(t),Rn.typeOf(u)],o)),C=Lt(tf(a));return J(tn(L,C),function(Y){return $(Y,b)})})});case 2:var i=e._2,_=e._1,s=e._0,l=Rn.typeOf(i);return F(Qn(n,i),function(c){var T=h(c,Dn([l],s)),p=Lt(rf(_));return J(tn(T,p),function(b){return $(b,c)})});case 3:var g=e._0.contents,d=Xn.get(n,g.name);if(d!==void 0)return tn(g.ty,Lt(d));var R=Yn(g.name);if(R===void 0)return{TAG:1,_0:'unbound variable: "'+g.name+'"'};var j={TAG:2,_0:{TAG:1,_0:Vn.fromArray(v(R.staticFuncs,function(c){var T=c.name;return[T.contents.name,T.contents.ty]}),le())}};return tn(g.ty,j);case 4:var rn=e._1,en=e._0,dn=gn.typeOfExpr(en),Sn=gn.typeOfExpr(rn);return F(Qn(n,rn),function(c){var T=ln(c,n),p=h(c,dn);return F(An(T,en,p),function(b){var L=$(b,c),C=h(b,p),Y=h(L,Sn);return J(tn(C,Y),function(H){return $(H,L)})})});case 5:return J(Da(n,e._1,e._2,e._0),function(c){return c[0]});case 6:var Tn=e._4,hn=e._3,En=e._0,Gn=e._2.contents,cn=Rn.typeOf(hn);return F(Qn(n,hn),function(c){var T=ln(c,n),p=h(c,cn),b=h(c,En),L=ur(Xn.remove(T,Gn.name),p),C=Xn.add(T,Gn.name,L);return F(An(C,Tn,b),function(Y){var H=$(Y,c);return J(tn(h(H,cn),h(H,Gn.ty)),function($n){return $($n,H)})})});case 7:var x=e._4,B=e._3,Un=e._2,bn=e._0,wn=e._1.contents,nn=Rn.typeOf(B);_t(tt,nn);var kn=Dn(v(Un,function(c){return c.contents.ty}),nn),Mn=pn(Un,n,function(c,T){return Xn.addMono(c,T.contents.name,T.contents.ty)}),_e=Xn.addMono(Mn,wn.name,kn);return F(An(_e,B,nn),function(c){var T=ln(c,_e),p=h(c,kn),b=h(c,bn),L=Xn.add(T,wn.name,ur(T,p));return F(An(L,x,b),function(C){var Y=$(C,c);return J(tn(wn.ty,h(C,p)),function(H){return ct(tt),$(H,Y)})})});case 8:var yn=e._2,jn=v(yn,Rn.typeOf),Oe=Dn(jn,e._0);return J(F(An(n,e._1,Oe),function(c){return pn(Re(yn,jn),{TAG:0,_0:[c,ln(c,n)]},function(T,p){var b=p[1],L=p[0];return F(T,function(C){var Y=C[1],H=C[0],$n=h(H,b);return J(An(Y,L,$n),function(Wn){return[$(Wn,H),ln(Wn,Y)]})})})}),function(c){return c[0]});case 9:var Zn=e._2,In=e._0;return F(pn(e._1,{TAG:0,_0:[void 0,n]},function(c,T){return F(c,function(p){var b=p[1],L=p[0];return J(af(b,T),function(C){return[$(C,L),ln(C,b)]})})}),function(c){var T=c[0];return Zn!==void 0?F(Qn(ln(T,n),Zn),function(p){var b=Rn.typeOf(Zn),L=$(p,T);return J(tn(h(L,In),h(L,b)),function(C){return $(C,L)})}):J(tn(h(T,In),Ae),function(p){return $(p,T)})});case 10:var fe=e._3,xn=e._2,ge=e._0;return F(An(n,e._1,On),function(c){var T=ln(c,n),p=h(c,ge);return F(An(T,xn,p),function(b){var L=ln(b,T),C=h(b,p),Y=$(b,c);return J(An(L,fe,C),function(H){return $(H,Y)})})});case 11:var Ve=e._1,qt=Rn.typeOf(Ve);return F(Qn(n,e._0),function(c){var T=h(c,qt),p=ln(c,n);return J(An(p,Ve,T),function(b){return $(b,c)})});case 12:var ze=We(tt);return ze!==void 0?An(n,on(e._0,{TAG:0,_0:0},function(c){return c}),ze):{TAG:1,_0:"'return' used outside of a function"};case 13:return An(n,e._0,e._1);case 14:var Et=pn(e._0,{TAG:0,_0:[Qe,n]},function(c,T){return F(c,function(p){var b=p[1],L=p[0];return F(Qn(b,T),function(C){var Y=$(C,L),H=ln(C,b);return{TAG:0,_0:[Y,H]}})})});return J(Et,function(c){return c[0]});case 15:var ut=e._1,Fe=e._0,Be=Yn(Fe);if(Be===void 0)return{TAG:1,_0:'undeclared struct "'+Fe+'"'};var Pe=Be.attributes,wt=pn(pt(Pe,function(c){return pe(c.impl)}),{TAG:0,_0:[n,Qe]},function(c,T){var p=T.ty,b=T.name;return F(c,function(L){var C=L[1],Y=L[0],H=At(ut,function($n){return $n[0]===b});return H!==void 0?F(An(Y,H[1],p),function($n){var Wn=ln($n,Y),we=$($n,C);return{TAG:0,_0:[Wn,we]}}):{TAG:1,_0:'missing attribute "'+b+'" for struct "'+Fe+'"'}})}),at=or(ut,function(c){var T=c[0];if(!Yt(Pe,function(p){return p.name===T}))return T});return at!==void 0?{TAG:1,_0:'extraneous attribute: "'+at+'" for struct "'+Fe+'"'}:J(wt,function(c){return c[1]});case 16:var he=e._2,mt=e._1,Ee=e._0;return F(Qn(n,mt),function(c){var T=gn.typeOfExpr(mt),p=h(c,T),b=function(U){return Pr(p,h(U,T))?An(ln(U,n),e,h(U,Ee)):{TAG:0,_0:U}};switch(p.TAG|0){case 0:case 1:break;case 2:var L=p._0;if(L.TAG===0){var C=L._0,Y=Yn(C);if(Y===void 0)return{TAG:1,_0:'undeclared struct: "'+C+'"'};var H=At(Y.attributes,function(U){return U.name===he});if(H===void 0)return{TAG:1,_0:'attribute "'+he+'" does not exist on struct "'+C+'"'};var $n=on(H.impl,H.ty,function(U){return U[0].contents.ty});return J(tn(h(c,Ee),h(c,$n)),function(U){return $(U,c)})}var Wn=L._0,we=Zt(Vn.toMap(Wn),he);if(we!==void 0)return J(tn(h(c,Ee),h(c,we)),function(U){return $(U,c)});var ot=Vn.insert(Wn,he,Ee),qe=h(c,{TAG:2,_0:{TAG:1,_0:ot}}),je=gr(ot);if(typeof je!="number")return je.TAG===0?F(tn(p,{TAG:2,_0:{TAG:0,_0:je._0.name}}),function(U){return b($(U,c))}):F(tn(p,qe),function(U){return b($(U,c))});var M=0;switch(T.TAG|0){case 0:return{TAG:0,_0:$(zr(Qe,T._0,qe),c)};case 1:case 2:M=2;break}if(M===2)return J(tn(T,qe),function(U){return $(U,c)});break}var Fn=le(),mn=Vn.insert(Vn.make({TAG:0,_0:Fn}),he,Ee),un=h(c,{TAG:2,_0:{TAG:1,_0:mn}}),Nn=gr(mn);return typeof Nn=="number"?{TAG:1,_0:"no struct declaration matches type "+A(un)}:Nn.TAG===0?F(tn(p,{TAG:2,_0:{TAG:0,_0:Nn._0.name}}),function(U){return b($(U,c))}):F(tn(p,un),function(U){return b($(U,c))})})}}function af(n,e){return Qn(n,e._0)}function hr(n,e){return n+"_"+e}function Ra(n,e){switch(e.TAG|0){case 0:var r=e._0;return J(Da(n,v(e._1,function(_){return _[0]}),e._2,r.contents.ty),function(_){var s=_[0];return[ln(s,Xn.addMono(n,r.contents.name,r.contents.ty)),s]});case 1:var u=e._0;return J(An(n,e._2,u.contents.ty),function(_){return[ln(_,Xn.addMono(n,u.contents.name,u.contents.ty)),_]});case 2:return{TAG:0,_0:[n,Qe]};case 3:var a=e._0,t=Yn(a);return t!==void 0?pn(e._1,{TAG:0,_0:[n,Qe]},function(_,s){var l=s[2],g=s[1],d=s[0];return F(_,function(R){var j=R[1],rn=R[0];d.contents.newName=hr(a,d.contents.name);var en=on(De(g,0),[!1,!1],function(cn){return cn[0].contents.name==="self"?[!0,cn[1]]:[!1,!1]}),dn;if(en[0]){ye.addImplementation(t,d,en[1]);var Sn=zn(g,[])?[]:wo(g,1),Tn={TAG:2,_0:{TAG:0,_0:a}},hn=De(g,0),En;if(hn!==void 0){var Gn=hn[0];Gn.contents.ty=Tn,En=Xn.addMono(rn,Gn.contents.name,Tn)}else En=rn;dn=[En,Sn]}else ye.addStaticFunc(t,d),dn=[n,g];return F(Ra(dn[0],{TAG:0,_0:d,_1:dn[1],_2:l}),function(cn){var x=$(cn[1],j);na(x,d);var B=Xn.remove(cn[0],d.contents.name);return{TAG:0,_0:[B,x]}})})}):{TAG:1,_0:'cannot implement for unknown type "'+a+'"'};case 4:var o=e.name,i=Dn(v(e.args,function(_){return _[0].contents.ty}),e.ret);return J(tn(o.contents.ty,i),function(_){return[ln(_,Xn.addMono(n,o.contents.name,o.contents.ty)),_]})}}function $a(n){return Eo(tt),pn(n,{TAG:0,_0:[Xn.empty,Qe]},function(e,r){return F(e,function(u){var a=u[1];return J(Ra(u[0],r),function(t){return[t[0],$(t[1],a)]})})})}var rt=fn("CompilerExn.InvalidTypeConversion"),Er=fn("CompilerExn.InvalidFunctionSignature"),Ot=fn("CompilerExn.VariableNotFound"),La=fn("CompilerExn.EmptyFunctionStack"),Me=fn("CompilerExn.CannotReassignImmutableValue"),Ca=fn("CompilerExn.FunctionNotFound"),ke=fn("CompilerExn.Unimplemented"),of=fn("CompilerExn.UnsupportedGlobalInitializer"),Cn=fn("CompilerExn.InvalidTypeAssertion"),Ua=fn("CompilerExn.DerefUsedOutsideOfUnsafeBlock"),Ma=fn("CompilerExn.UndeclaredStruct"),Vt=fn("CompilerExn.InvalidAttributeAccess"),Xa=fn("CompilerExn.StructTypeNotMatched"),Oa=fn("CompilerExn.AmibguousStruct");function ht(n){return n.RE_EXN_ID===rt?"unsupported type: "+A(n._1):n.RE_EXN_ID===Er?"invalid function signature: "+A(n._1):n.RE_EXN_ID===Ot?'variable "'+n._1+'" not found':n.RE_EXN_ID===La?"Function stack is empty":n.RE_EXN_ID===Me?'cannot mutate "'+n._1+'" as it is behind an immutable binding':n.RE_EXN_ID===Ca?'no function named "'+n._1+'" found':n.RE_EXN_ID===ke?"unimplemented: "+n._1:n.RE_EXN_ID===of?"unsupported global initializer: "+Rn.show(void 0,n._1):n.RE_EXN_ID===Cn?"invalid type assertion from "+A(n._1)+" to "+A(n._2):n.RE_EXN_ID===Ua?"the deref operator can only be used in an unsafe block":n.RE_EXN_ID===oe.UnkownTypeSize?"unknown type size: "+A(n._1):n.RE_EXN_ID===Ma?'undeclared struct "'+n._1+'"':n.RE_EXN_ID===Vt?n._1+' does not exist for type "'+A(n._2)+'"':n.RE_EXN_ID===Xa?"No struct declaration matches type "+A(n._1):n.RE_EXN_ID===Oa?Na.ambiguousMatchesError(n._1,n._2):n.RE_EXN_ID===gn.UndeclaredIdentifer?'identifier "'+n._1+'" not found':n.RE_EXN_ID===gn.UnexpectedDeclarationInImplBlock?"unexpected declaration in impl block: "+Se.show(void 0,n._1):n.RE_EXN_ID===gn.UnreachableLetStmt?"unreachable: let statement found in Core.fromStmt":"unexpected compiler exception"}function cf(n,e,r,u){return{name:n,depth:e,ty:r,isMutable:u}}function wr(n){if(n.TAG===0){var e=n._0,r=Yn(e);if(r!==void 0)return r;throw{RE_EXN_ID:Ma,_1:e,Error:new Error}}var u=n._0,a=Na.findMatchingStruct(u);if(typeof a=="number")throw{RE_EXN_ID:Xa,_1:{TAG:2,_0:n},Error:new Error};if(a.TAG===0)return a._0;throw{RE_EXN_ID:Oa,_1:u,_2:a._0,Error:new Error}}function Xe(n){switch(n.TAG|0){case 0:throw{RE_EXN_ID:rt,_1:n,Error:new Error};case 1:switch(n._0){case"()":if(n._1.length!==0)throw{RE_EXN_ID:rt,_1:n,Error:new Error};return[];case"Fun":case"Ptr":return[0];case"Tuple":return _n(v(n._1,Xe));case"bool":case"u32":break;case"u64":if(n._1.length!==0)throw{RE_EXN_ID:rt,_1:n,Error:new Error};return[1];default:throw{RE_EXN_ID:rt,_1:n,Error:new Error}}if(n._1.length!==0)throw{RE_EXN_ID:rt,_1:n,Error:new Error};return[0];case 2:var e=wr(n._0);return e.size===0?[]:[0]}}function _f(n,e){switch(e.TAG|0){case 1:if(e._0==="Tuple"){var r=_n(v(e._1,Xe)),u=[],a={_0:u,_1:r},t=Pn.getOrAddSignature(n,a);return{TAG:1,_0:t,_1:[[],r]}}break}var o=Xe(e),i=o.length;if(i!==1){if(i===0)return 0;throw{RE_EXN_ID:ke,_1:"wasmBlockReturnTypeOf for "+A(e),Error:new Error}}var _=o[0];return{TAG:0,_0:_}}function mr(n){switch(n.TAG|0){case 1:if(n._0==="Fun"){var e=n._1,r=e.slice(0,e.length-1|0),u=De(e,e.length-1|0);return qr(lt.Signature.make,_n(v(r,Xe)),on(u,[],Xe))}throw{RE_EXN_ID:Er,_1:n,Error:new Error};case 0:case 2:throw{RE_EXN_ID:Er,_1:n,Error:new Error}}}function pr(n,e,r){return{name:n,locals:[],params:pt(e,function(u){return!oe.isZeroSizedType(u[1])}),ret:r,instructions:[]}}function k(n,e){n.instructions.push(e)}function ff(n,e,r,u,a){return n.locals.push(cf(e,u,r,a)),(n.params.length+n.locals.length|0)-1|0}function sf(n,e){var r=jt(n.params,function(t){return t[0]===e});if(r!==void 0){var u=me(n.params,r);return[r,u[2]]}var a=Iu(n.locals,function(t){return t.name===e});if(a!==void 0)return[n.params.length+a|0,me(n.locals,a).isMutable]}function lf(n){var e=mr(Dn(v(n.params,function(a){return a[1]}),n.ret)),r=m(lt.Local.fromTypes,_n(v(n.locals,function(a){return v(Xe(a.ty),function(t){return[a.name,t]})}))),u=qr(lt.Body.make,r,nf(void 0,n.instructions));return lt.make(n.name,e,u)}function Va(n,e,r,u,a){return{name:n,mutability:e,ty:r,index:u,init:a}}function vf(n){var e=n.init,r=n.mutability;return y(n.ty,function(u){return vt.make(r!==2,u,e)})}function S(n){var e=We(n.funcStack);if(e!==void 0)return e;throw{RE_EXN_ID:La,Error:new Error}}function Ar(n,e){return y(xu(n.funcs,function(r){return r.name===e}),function(r){var u=n.externFuncs.length;return[r[0],u+r[1]|0]})}function df(n,e){return xu(n.externFuncs,function(r){return r.name===e})}function Tf(n,e){var r=We(n.blockStack);if(r!==void 0&&!(e<=0)){var u=r.shadowStackDelta;return u.contents=u.contents+e|0,k(S(n),{TAG:9,_0:n.stackTop.index}),k(S(n),{TAG:0,_0:e}),k(S(n),5),k(S(n),{TAG:10,_0:n.stackTop.index})}}function Gf(n,e){var r=We(n.blockStack);if(r!==void 0&&!(e<=0)){var u=r.shadowStackDelta;return u.contents=u.contents-e|0,k(S(n),{TAG:9,_0:n.stackTop.index}),k(S(n),{TAG:0,_0:e}),k(S(n),4),k(S(n),{TAG:10,_0:n.stackTop.index})}}function za(n){var e=We(n.blockStack);return e!==void 0?e.isUnsafe:!1}function Ba(n,e){return n.scopeDepth=n.scopeDepth+1|0,_t(n.blockStack,{isUnsafe:e||za(n),shadowStackDelta:{contents:0}})}function gf(n){n.scopeDepth=n.scopeDepth-1|0,Gf(n,on(We(n.blockStack),0,function(e){return e.shadowStackDelta.contents})),ct(n.blockStack)}function hf(n,e,r,u){var a=S(n),t=ff(a,e,r,n.scopeDepth,u);return k(S(n),{TAG:12,_0:t})}function Pa(n,e,r,u,a){var t=bo(n.globals),o=Va(e,r,u,t,a);return Kt(n.globals,e,o),t}function zt(n,e){var r=S(n),u=sf(r,e);return u!==void 0?{TAG:0,_0:u[0],_1:u[1]}:y(Mr(n.globals,e),function(a){return{TAG:1,_0:a.index,_1:a.mutability===1}})}function Ef(n){if(typeof n!="number")return n.TAG===0?{TAG:0,_0:n._0}:{TAG:0,_0:n._0?1:0}}function qa(n){if(!za(n))throw{RE_EXN_ID:Ua,Error:new Error}}function Bt(n,e,r){switch(e.TAG|0){case 0:case 1:return{TAG:1,_0:{RE_EXN_ID:Vt,_1:r,_2:e}};case 2:var u=wr(e._0),a=At(u.attributes,function(i){return i.name===r});if(a===void 0)return{TAG:1,_0:{RE_EXN_ID:Vt,_1:r,_2:e}};var t=a.impl;if(t===void 0)return{TAG:0,_0:{TAG:0,_0:{offset:a.offset,ty:a.ty,size:a.size,mut:a.mut}}};var o=Ar(n,hr(u.name,t[0].contents.name));return o!==void 0?{TAG:0,_0:{TAG:1,_0:[o[0],o[1],t[1]]}}:{TAG:1,_0:{RE_EXN_ID:Vt,_1:r,_2:e}}}}function ja(n){return Kn(void 0,"__lambda"+String(n.funcs.length)+"__")}function Pt(n,e){for(;;){var r=e;switch(r.TAG|0){case 3:var u=r._0,a=zt(n,u.contents.newName);if(a!==void 0)return a._1?void 0:u.contents.name;throw{RE_EXN_ID:Ot,_1:u.contents.name,Error:new Error};case 16:var t=r._2,o=r._1,i=Bt(n,gn.typeOfExpr(o),t);if(i.TAG===0){var _=i._0;if(_.TAG!==0)return;if(!_._0.mut)return t;e=o;continue}throw i._0;default:return}}}function W(n,e){for(;;){var r=e;switch(r.TAG|0){case 0:var u=Ef(r._0);return u!==void 0?k(S(n),u):void 0;case 1:var a=r._3,t=r._2,o=r._1;if(oe.isZeroSizedType(gn.typeOfExpr(o))){e={TAG:0,_0:{TAG:1,_0:t===9}};continue}var i=function(M,Fn){return function(un){return W(n,M),W(n,Fn),k(S(n),un)}}(o,a);switch(t){case 0:return i(4);case 1:return i(5);case 2:return i(6);case 3:return i(7);case 4:return i(43);case 5:return i(31);case 6:return i(19);case 7:return i(37);case 8:return i(25);case 9:return i(10);case 10:return i(14);case 11:e={TAG:10,_0:On,_1:o,_2:a,_3:{TAG:0,_0:{TAG:1,_0:!1}}};continue;case 12:e={TAG:10,_0:On,_1:o,_2:{TAG:0,_0:{TAG:1,_0:!0}},_3:a};continue;case 13:return i(44);case 14:return i(45);case 15:return i(46);case 16:return i(48)}case 2:var _;switch(r._1){case 0:throw{RE_EXN_ID:ke,_1:"u32 negation is not handled",Error:new Error};case 1:_=9;break;case 2:qa(n),_={TAG:16,_0:0,_1:0};break}return W(n,r._2),k(S(n),_);case 3:var s=r._0;if(oe.isZeroSizedType(s.contents.ty))return;var l=zt(n,s.contents.newName);if(l!==void 0)return l.TAG===0?k(S(n),{TAG:11,_0:l._0}):k(S(n),{TAG:9,_0:l._0});throw{RE_EXN_ID:Ot,_1:s.contents.name,Error:new Error};case 4:var g=r._1,d=r._0;if(oe.isZeroSizedType(gn.typeOfExpr(g)))return;switch(d.TAG|0){case 2:if(d._1>=2){qa(n),W(n,d._2),W(n,g);var R=oe.sizeLog2(gn.typeOfExpr(g)),j={TAG:17,_0:R,_1:0};return k(S(n),j)}throw{RE_EXN_ID:ke,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error};case 3:var rn=d._0,en=zt(n,rn.contents.newName);if(en!==void 0){if(en._1){var dn;return dn=en.TAG===0?{TAG:12,_0:en._0}:{TAG:10,_0:en._0},W(n,g),k(S(n),dn)}throw{RE_EXN_ID:Me,_1:rn.contents.name,Error:new Error}}throw{RE_EXN_ID:Ot,_1:rn.contents.name,Error:new Error};case 16:var Sn=d._2,Tn=d._1,hn=Bt(n,gn.typeOfExpr(Tn),Sn);if(hn.TAG===0){var En=hn._0;if(En.TAG===0){var Gn=En._0;if(!Gn.mut)throw{RE_EXN_ID:Me,_1:Sn,Error:new Error};var cn=Pt(n,Tn);if(cn!==void 0)throw{RE_EXN_ID:Me,_1:cn,Error:new Error};return Gn.size>0?(W(n,Tn),W(n,g),k(S(n),{TAG:17,_0:0,_1:Gn.offset})):void 0}throw{RE_EXN_ID:ke,_1:"cannot reassign "+Sn+" for type "+A(gn.typeOfExpr(Tn)),Error:new Error}}throw hn._0;default:throw{RE_EXN_ID:ke,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error}}case 5:var x=ja(n),B=Sr(n,x,v(r._1,function(M){return[M,!1]}),r._2);return k(S(n),{TAG:0,_0:B});case 6:var Un=r._3,bn=r._2.contents;oe.isZeroSizedType(gn.typeOfExpr(Un))||(W(n,Un),hf(n,bn.name,bn.ty,r._1)),e=r._4;continue;case 7:var wn=ja(n);r._1.contents.newName=wn.contents.name,Sr(n,wn,v(r._2,function(M){return[M,!1]}),r._3),e=r._4;continue;case 8:var nn=r._2,kn=r._1,Mn=function(M){return function(mn){return Ln(M,function(un){return W(n,un)}),k(S(n),{TAG:14,_0:mn})}}(nn),_e=function(M,Fn){return function(un){Ln(Fn,function(Ja){return W(n,Ja)});var Nn=gn.typeOfExpr(M),U=mr(Nn),Ne=Pn.getOrAddSignature(n.mod,U);return W(n,M),k(S(n),{TAG:15,_0:Ne,_1:0})}}(kn,nn),yn=function(M){return function(mn,un){var Nn=un!==void 0?Q([un],M):M;return Ln(Re(Nn,mn),function(U){var Ne=U[1];if(!!(Ne[2]&&er(Ne[1])&&bt(Pt(n,U[0]))))throw{RE_EXN_ID:Me,_1:Ne[0],Error:new Error}})}}(nn);switch(kn.TAG|0){case 3:var jn=kn._0,Oe=zt(n,jn.contents.newName);if(Oe!==void 0)return _e(void 0);var Zn=Ar(n,jn.contents.newName);if(Zn!==void 0)return yn(Zn[0].params,void 0),Mn(Zn[1]);var In=df(n,jn.contents.newName);if(In!==void 0)return yn(In[0].args,void 0),Mn(In[1]);throw{RE_EXN_ID:Ca,_1:jn.contents.name,Error:new Error};case 16:var fe=kn._2,xn=kn._1,ge;if(xn.TAG===3){var Ve=xn._0.contents.name,qt=Yn(Ve);if(qt!==void 0){var ze=Ar(n,hr(Ve,fe));if(ze!==void 0)ge=[!1,ze[0],ze[1]];else throw{RE_EXN_ID:ke,_1:'static function "'+fe+'" does not exists on struct '+Ve,Error:new Error}}else ge=[!0,void 0,void 0]}else ge=[!0,void 0,void 0];var Et=ge[2],ut=ge[1],Fe=ge[0],Be;if(ut!==void 0)Be=ut;else{var Pe=Bt(n,gn.typeOfExpr(xn),fe);if(Pe.TAG===0){var wt=Pe._0;Be=wt.TAG===0?void 0:wt._0[0]}else throw Pe._0}return on(Be,void 0,function(M,Fn){return function(mn){var un=Fn?M:void 0;return yn(mn.params,un)}}(xn,Fe)),Fe&&W(n,xn),Et!==void 0?Mn(Et):_e(void 0);default:return _e(void 0)}case 9:var at=r._2;return Ba(n,r._3===1),Ln(r._1,function(M){return wf(n,M)}),at!==void 0&&W(n,at),gf(n);case 10:var he=r._3,mt=_f(n.mod,r._0);return W(n,r._1),k(S(n),{TAG:4,_0:mt}),W(n,r._2),Pr(he,{TAG:0,_0:0})&&(k(S(n),0),W(n,he)),k(S(n),1);case 11:return k(S(n),{TAG:7,_0:0}),k(S(n),{TAG:8,_0:0}),W(n,r._0),k(S(n),9),k(S(n),{TAG:5,_0:1}),W(n,r._1),k(S(n),{TAG:6,_0:0}),k(S(n),1),k(S(n),1);case 12:var Ee=r._0;return Ee!==void 0&&W(n,Ee),k(S(n),2);case 13:var c=r._2,T=r._1;if(!zn(T,c))switch(T.TAG|0){case 1:switch(T._0){case"Ptr":var p=T._1;if(p.length!==1)throw{RE_EXN_ID:Cn,_1:T,_2:c,Error:new Error};var b=p[0];switch(b.TAG|0){case 1:if(b._0==="u32"){if(b._1.length!==0)throw{RE_EXN_ID:Cn,_1:T,_2:c,Error:new Error};switch(c.TAG|0){case 1:if(c._0==="u32"){if(c._1.length!==0)throw{RE_EXN_ID:Cn,_1:T,_2:c,Error:new Error}}else throw{RE_EXN_ID:Cn,_1:T,_2:c,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:Cn,_1:T,_2:c,Error:new Error}}}else throw{RE_EXN_ID:Cn,_1:T,_2:c,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:Cn,_1:T,_2:c,Error:new Error}}break;case"u32":if(T._1.length!==0)throw{RE_EXN_ID:Cn,_1:T,_2:c,Error:new Error};switch(c.TAG|0){case 1:if(c._0==="Ptr"){if(c._1.length!==1)throw{RE_EXN_ID:Cn,_1:T,_2:c,Error:new Error}}else throw{RE_EXN_ID:Cn,_1:T,_2:c,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:Cn,_1:T,_2:c,Error:new Error}}break;default:throw{RE_EXN_ID:Cn,_1:T,_2:c,Error:new Error}}break;case 0:case 2:throw{RE_EXN_ID:Cn,_1:T,_2:c,Error:new Error}}e=r._0;continue;case 14:return Ln(r._0,function(M){return W(n,M)});case 15:var L=r._1,C=Vr(Yn(r._0)),Y=C.size;Tf(n,Y),Ln(Re(C.attributes,L),function(M){var Fn=M[0],mn=Fn.ty;if(Fn.mut&&er(mn)){var un=Pt(n,M[1][1]);if(un!==void 0)throw{RE_EXN_ID:Me,_1:un,Error:new Error}}if(pe(Fn.impl)&&oe.size(mn)>0)return k(S(n),{TAG:9,_0:n.stackTop.index})}),Y>0&&k(S(n),{TAG:9,_0:n.stackTop.index});var H={contents:0};return Ln(L,function(M){return function(Fn){var mn=Fn[1],un=function(Ne){W(n,mn),k(S(n),{TAG:17,_0:0,_1:M.contents}),M.contents=M.contents+Ne|0},Nn=Rn.typeOf(mn);switch(Nn.TAG|0){case 0:break;case 1:var U=0;switch(Nn._0){case"()":if(Nn._1.length===0)return;break;case"Fun":return un(4);case"Ptr":if(Nn._1.length===1)return un(4);break;case"bool":case"u32":U=2;break}if(U===2&&Nn._1.length===0)return un(4);break;case 2:return wr(Nn._0),un(4)}throw{RE_EXN_ID:ke,_1:"cannot store "+A(Nn)+" in the shadow stack",Error:new Error}}}(H));case 16:var $n=r._1,Wn=Bt(n,gn.typeOfExpr($n),r._2);if(Wn.TAG===0){var we=Wn._0;if(we.TAG===0){var ot=we._0;return oe.isZeroSizedType(ot.ty)?void 0:(W(n,$n),k(S(n),{TAG:16,_0:0,_1:ot.offset}))}var qe=we._0;if(qe[2]){var je=Pt(n,$n);if(je!==void 0)throw{RE_EXN_ID:Me,_1:je,Error:new Error}}return k(S(n),{TAG:0,_0:qe[1]})}throw Wn._0}}}function wf(n,e){var r=e._0;return W(n,r),Ln(Xe(Rn.typeOf(r)),function(u){return k(S(n),3)})}function Sr(n,e,r,u){var a=v(r,function(i){var _=i[0];return[_.contents.name,_.contents.ty,i[1]||!er(_.contents.ty)]}),t=pr(e.contents.newName,a,Rn.typeOf(u)),o=n.funcs.push(t)-1|0;return _t(n.funcStack,t),W(n,u),k(S(n),1),ct(n.funcStack),o}function mf(n,e){var r=pr("__isolated__",[],gn.typeOfExpr(e));return _t(n.funcStack,r),W(n,e),ct(n.funcStack),r}function Za(n,e){switch(e.TAG|0){case 0:Sr(n,e._0,e._1,e._2);return;case 1:var r=e._1,u=e._0;Ba(n,!1);var a=mf(n,e._2),t=a.instructions;if(t.length===1){var o=t[0];if(typeof o!="number"&&o.TAG===0){Pa(n,u.contents.name,r?1:2,0,m(vt.Initializer.fromInstructions,[{TAG:0,_0:o._0}]));return}}So(n.globalsInitializer.instructions,"push",[t]);var i=Pa(n,u.contents.name,r?1:0,0,m(vt.Initializer.fromInstructions,[{TAG:0,_0:0}]));n.globalsInitializer.instructions.push({TAG:10,_0:i});return;case 2:return;case 3:return Ln(e._1,function(g){return Za(n,{TAG:0,_0:g[0],_1:g[1],_2:g[2]})});case 4:var _=e.name,s=mr(_.contents.ty),l=Pn.getOrAddSignature(n.mod,s);Pn.addImport(n.mod,Mu.make("index",_.contents.name,{_0:l})),n.externFuncs.push({name:_.contents.name,args:v(e.args,function(g){var d=g[0];return[d.contents.name,d.contents.ty,g[1]]}),ret:e.ret});return}}function pf(n){var e={mod:Pn.make(void 0),funcs:[],scopeDepth:0,funcStack:Ht(),globals:Ur(1),globalsInitializer:pr("__initGlobals__",[],Ae),stackTop:Va("__STACK_TOP__",1,0,0,m(vt.Initializer.fromInstructions,[{TAG:0,_0:65535}])),blockStack:Ht(),externFuncs:[]};Kt(e.globals,e.stackTop.name,e.stackTop);try{Ln(n,function(o){return Za(e,o)}),Pn.addMemory(e.mod,Fu.make(xt.make(6,void 0))),Ln(Ao(Br(e.globals),function(o,i){return o.index-i.index|0}),function(o){var i=vf(o);if(i!==void 0)return Pn.addGlobal(e.mod,i)});var r=gu.fromFuncRefs(0,Fr(e.funcs,function(o,i){return o}));Pn.addElement(e.mod,r),Pn.addTable(e.mod,lu.make(0,xt.makeExact(e.funcs.length)));var u=e.funcs.length,a=e.globalsInitializer.instructions.length===0;return a||(e.globalsInitializer.instructions.push(1),e.funcs.push(e.globalsInitializer)),Ln(e.funcs,function(o){o.name==="main"&&!a&&o.instructions.unshift({TAG:14,_0:u});var i=lf(o);Pn.addExportedFunc(e.mod,o.name,i[1],i[2])}),{TAG:0,_0:e.mod}}catch(o){var t=ft(o);return{TAG:1,_0:ht(t)}}}function Af(n){try{return F(Xt(n),function(r){var u=v(r,Se.from);return F($a(u),function(a){var t=a[1];ea(t);var o=v(u,function(i){return Se.subst(t,i)});return J(pf(o),function(i){var _=Pn.encodeAsUint8Array(i);return[i,_]})})})}catch(r){var e=ft(r);return{TAG:1,_0:ht(e)}}}function Sf(n){try{var e=Xt(n);return e.TAG===0?{TAG:0,_0:w(e._0,`

`,function(u){return mc.show(u)})}:{TAG:1,_0:e._0}}catch(u){var r=ft(u);return{TAG:1,_0:ht(r)}}}function bf(n){try{var e=Xt(n);if(e.TAG!==0)return{TAG:1,_0:e._0};var r=v(e._0,Se.from);return{TAG:0,_0:w(r,`

`,function(a){return Se.show(void 0,a)})}}catch(a){var u=ft(a);return{TAG:1,_0:ht(u)}}}function kf(n){try{var e=Xt(n);if(e.TAG!==0)return{TAG:1,_0:e._0};var r=v(e._0,Se.from),u=$a(r);if(u.TAG!==0)return{TAG:1,_0:u._0};var a=u._0[1];ea(a);var t=v(r,function(i){return Se.subst(a,i)});return{TAG:0,_0:w(t,`

`,function(i){return Se.show(void 0,i)})}}catch(i){var o=ft(i);return{TAG:1,_0:ht(o)}}}var Ff={debugAst:Sf,debugCoreAst:bf,debugTypes:kf},Nf=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",compile:Af,Debug:Ff});const br={"0":"Else","1":"End","2":"Return","3":"Drop","4":"AddI32","5":"SubI32","6":"MulI32","7":"DivI32Unsigned","8":"DivI32Signed","9":"EqzI32","10":"EqI32","11":"EqI64","12":"EqF32","13":"EqF64","14":"NeI32","15":"NeI64","16":"NeF32","17":"NeF64","18":"LeI32Signed","19":"LeI32Unsigned","20":"LeI64Signed","21":"LeI64Unsigned","22":"LeF32","23":"LeF64","24":"GeI32Signed","25":"GeI32Unsigned","26":"GeI64Signed","27":"GeI64Unsigned","28":"GeF32","29":"GeF64","30":"LtI32Signed","31":"LtI32Unsigned","32":"LtI64Signed","33":"LtI64Unsigned","34":"LtF32","35":"LtF64","36":"GtI32Signed","37":"GtI32Unsigned","38":"GtI64Signed","39":"GtI64Unsigned","40":"GtF32","41":"GtF64","42":"RemI32Signed","43":"RemI32Unsigned","44":"AndI32","45":"OrI32","46":"ShlI32","47":"ShrI32Signed","48":"ShrI32Unsigned"},D={"0":"I32","1":"I64","2":"F32","3":"F64"},Df={"0":"FuncRef","1":"ExternRef"},Rf={"0":"Func","1":"Table","2":"Memory","3":"Global"},Ge={"0":"Void"},$f=Nf,Wa=function(n){const e=$f.compile(n);return e.TAG===0?{tag:"Ok",value:[{typeSection:e._0[0].typeSection.map(function(u){return[u._0.map(function(t){return D[t]}),u._1.map(function(t){return D[t]})]}),importSection:e._0[0].importSection.map(function(u){return{moduleName:u.moduleName,entityName:u.entityName,desc:{tag:"Func",value:u.desc._0}}}),funcSection:e._0[0].funcSection,tableSection:e._0[0].tableSection.map(function(u){return[Df[u[0]],u[1]]}),memorySection:e._0[0].memorySection,globalSection:e._0[0].globalSection.map(function(u){return[D[u[0]],u[1],u[2].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:{tag:"StoreI32",value:[t._0,t._1]}:br[t]})]}),exportSection:e._0[0].exportSection.map(function(u){return{name:u.name,kind:Rf[u.kind],index:u.index}}),elementSection:e._0[0].elementSection,codeSection:e._0[0].codeSection.map(function(u){return[u[0].map(function(t){return[t[0],D[t[1]]]}),u[1].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:{tag:"StoreI32",value:[t._0,t._1]}:br[t]})]}),funcs:e._0[0].funcs.map(function(u){return[u[0],[u[1]._0.map(function(t){return D[t]}),u[1]._1.map(function(t){return D[t]})],[u[2][0].map(function(t){return[t[0],D[t[1]]]}),u[2][1].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:{tag:"StoreI32",value:[t._0,t._1]}:br[t]})]]})},e._0[1]]}:{tag:"Error",value:e._0}};var Lf=`
let SIZEOF_U32 = 4;

struct Array {
  start: Ptr<u32>,
  mut length: u32,
}

impl Array {
  fn read(self, n) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>)
  }

  fn write(self, n, val) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>) = val;
  }

  fn push(mut self, val) {
    self.write(self.length, val);
    self.length += 1;
  }
}

struct Sieve {
  mut primes: Array,
  mut current: u32
}

impl Sieve {
  fn clear(mut self) {
    self.primes.length = 0;
    // 2 is the first prime
    self.primes.push(2);
    self.current = 1;
  }

  fn isPrime(mut self, n) {
    mut i = 0;
    mut p = self.primes.read(i);

    while p * p <= n {
      if n % p == 0 { return false; }
      i += 1;
      p = self.primes.read(i);
    }

    // n is prime
    // add it to the sieve
    self.primes.push(n);

    true
  }

  fn nextPrime(mut self) {
    self.current += 2;

    while !self.isPrime(self.current) {
      self.current += 2;
    }

    self.current
  }

  // count the prime numbers <= m
  fn countUpTo(mut self, m) {
    self.clear();

    while self.current <= m {
      self.nextPrime();
    }

    self.primes.length - 1
  }
}

// right after the shadow stack
let PRIMES_START = 64 * 1024;

fn main() {
  mut sieve = Sieve {
    primes: Array {
      start: PRIMES_START as Ptr<u32>,
      length: 0
    },
    current: 0
  };

  sieve.countUpTo(1000000)
}`,Cf=`
fn fact(n) {
  let aux = (n, acc) -> if n == 0 { acc } else { aux(n - 1, n * acc) };
  aux(n, 1)
}

fn main() {
  fact(11)
}`,Uf=`
fn fib(n) {
  let fib_aux = (n, a, b) -> {
    if n == 0 { return a; }
    if n == 1 { return b; }
    fib_aux(n - 1, b, a + b)
  };

  fib_aux(n, 0, 1)
}

fn main() {
  fib(83)
}`,Mf=`
let SIZEOF_U32 = 4;

fn read_u32(addr) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>)
}

fn write_u32(addr, val) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>) = val;
}

fn main() {
  let square = n -> n * n;

  mut i = 0;
  while i < 100 {
    write_u32(i, square(i));
    i += 1;
  }

  read_u32(42) // 1764
}`,Xf=`
fn isEven(n) {
  n & 1 == 0
}

fn isPrime(n) {
  if n < 2 { return false; }
  if n == 2 { return true; }
  if isEven(n) { return false; }

  mut i = 3;

  while i * i <= n {
    if n % i == 0 { return false; }
    i += 2;
  }

  true
}

fn countPrimesLessThan(m) {
  mut i = m;
  mut count = 0;

  while i > 1 {
    if isPrime(i) {
      count += 1;
    }

    i -= 1;
  }

  count
}

fn main() {
  countPrimesLessThan(1000000)
}`,Of=`
struct MinMax {
  mut min: u32,
  mut max: u32
}

impl MinMax {
  fn reset(mut self) {
    self.min = 0;
    self.max = 0;
  }

  fn resetStatic(mut m) {
    m.reset();
  }
}

fn main() {
  mut m = MinMax {
    min: 17,
    max: 22
  };

  MinMax.resetStatic(m);
  
  m.min + m.max == 0
}`,Vf=`
fn main() {
  let twice = (f, x) -> f(f(x));
  
  twice(n -> n * n, 7)
}`,zf=`
struct BumpAllocator {
  mut head: u32
}

impl BumpAllocator {
  fn allocate(mut self, bytes) {
    let addr = self.head as Ptr<u32>;
    self.head = self.head + bytes;
    addr
  }
  
  // do nothing!
  fn free(mut self, addr) { }
}

mut allocator = BumpAllocator { head: 64 * 1024 };

let SIZEOF_U32 = 4;

struct Vec {
  mut start: Ptr<u32>,
  mut length: u32,
  mut capacity: u32 
}

impl Vec {
  fn read(self, index) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>)
  }

  fn write(mut self, index, value) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>) = value;
  }

  fn grow(mut self) unsafe {
    let newCap = if self.capacity == 0 { 8 } else { self.capacity * 2 };
    let newStart = allocator.allocate(newCap * SIZEOF_U32);

    // copy the data from the old array to the new one
    mut i = 0;
    while i < self.length {
      *(((newStart as u32) + (i * SIZEOF_U32)) as Ptr<u32>) = self.read(i);
      i += 1;
    }

    allocator.free(self.start);
    self.start = newStart;
    self.capacity = newCap;
  }

  fn push(mut self, val) unsafe {
    if self.length + 1 > self.capacity {
      self.grow();
    }

    self.write(self.length, val);
    self.length += 1;
  }

  fn pop(mut self) unsafe {
    if self.length > 0 {
      self.length -= 1;
      self.read(self.length)
    } else {
      // until we have Option<T>
      4294967295 // -1
    }
  }
}

fn main() {
  mut vec = Vec {
    start: 0 as Ptr<u32>,
    length: 0,
    capacity: 0
  };

  mut i = 0;
  while i < 1000 {
    vec.push(i);
    i += 1;
  }

  (vec.length, vec.capacity, vec.read(723))
}`,Bf=`
fn digitsSquareSum(n) {
  let square = n -> n * n;
  mut sum = 0;

  while n > 0 {
    sum += square(n % 10);
    n /= 10;
  }

  sum
}

fn reaches89(n) {
  while n != 1 {
    if n == 89 { return true; }
    n = digitsSquareSum(n);
  }

  false
}

fn main() {
  mut i = 1;
  mut count = 0;
  while i < 10000000 {
    if reaches89(i) {
      count += 1;
    }

    i += 1;
  }

  count
}`,Pf=`
extern fn log(n: u32) -> ();
extern fn expectEqual(value: u32, expected: u32) -> ();

fn main() {
  mut i = 0;
  
  while i <= 10 {
    expectEqual(i, i);
    i += 1;
  }
}`;const qf={"Prime sieve":Lf,Factorial:Cf,Fibonacci:Uf,Pointers:Mf,Primes:Xf,Structs:Of,"Lambda (kind of)":Vf,Vector:zf,"Project Euler 92":Bf,"External functions":Pf},jf=async n=>{const e=await WebAssembly.compile(n),r=await WebAssembly.instantiate(e,{index:{log:console.log,expectEqual:(u,a)=>{if(u!==a)throw new Error(`[expectEqual] expected ${u}, got: ${a}`)}}});return"main"in r.exports?r.exports.main():"Error: main function not found, exported functions are: "+Object.keys(r.exports).join(", ")},Zf={Run:async(n,e)=>{e("running...");try{const r=Wa(n);if(r.tag==="Ok"){const u=await jf(r.value[1]);e(`${u}`)}else e(r.value)}catch(r){e(`${r}`)}},Disassemble:(n,e)=>{try{const r=Wa(n);if(r.tag==="Ok"){const[u]=r.value;e(Hi(u))}else e(r.value)}catch(r){e(`${r}`)}}},Wf=()=>kt.createElement(ko,{actions:Zf,samples:qf,aceMode:"rust"});Fo.render(kt.createElement(kt.StrictMode,null,kt.createElement(Wf,null)),document.getElementById("root"));
