import{c as Q,a as fn,j as g,r as Wa,m as un,g as De,b as jt,d as l,z as Re,k as mt,e as Ar,f as ut,t as Xe,h as Ja,i as kr,l as Bn,n as Fr,_ as h,s as Nr,o as Ka,p as Ya,q as qt,u as Dr,v as Rr,w as pn,x as Zt,y as Ee,A as sn,B as Ha,C as Qa,D as Lr,E as Wt,F as ya,G as Ia,H as xa,I as no,J as eo,K as to,L as ro,M as Cr,N as me,O as j,P as ee,Q as y,R as uo,S as $r,T as Ln,U as ao,V as Jt,W as Ur,X as oo,Y as Hn,Z as io,$ as co,a0 as te,a1 as Or,a2 as pt,a3 as Mr,a4 as Xr,a5 as _o,a6 as St,a7 as fo,a8 as bt,a9 as so,aa as lo,ab as vo,ac as F,ad as To,ae as Go,af as Vr,ag as Kt,ah as go,ai as K,aj as ho,ak as at,al as wo,am as Br,an as Yt,ao as ot,ap as Ve,aq as Eo,ar as zr,as as mo,at as it,au as Pr,av as po,aw as So,ax as At,ay as bo,az as Ao}from"./vendor.263d8ae4.js";const ko=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))u(a);new MutationObserver(a=>{for(const t of a)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const t={};return a.integrity&&(t.integrity=a.integrity),a.referrerpolicy&&(t.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?t.credentials="include":a.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function u(a){if(a.ep)return;a.ep=!0;const t=r(a);fetch(a.href,t)}};ko();function ln(n){var e=[],r=function(u){for(;;){var a=u,t=a&127,o=a>>>7;if(o!==0){e.push(t|128),u=o;continue}e.push(t);return}};return r(n),e}function jr(n){var e=[],r=function(u){for(;;){var a=u,t=a&127,o=a>>7;if(o===0&&(t&64)==0||o===-1&&(t&64)!=0){e.push(t);return}e.push(t|128),u=o}};return r(n|0),e}function ct(n){return Q(ln(n.length),n)}function zn(n){return Q(ln(n.length),fn(n))}var Fo={encode:ct,encodeMany:zn};function qr(n){var e=new DataView(new ArrayBuffer(4));return e.setFloat32(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3)]}var No={encode:qr};function Zr(n){var e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3),e.getUint8(4),e.getUint8(5),e.getUint8(6),e.getUint8(7)]}var Do={encode:Zr};function Ro(n){return n}function re(n,e){return Q([n],ct(e))}function ue(n){var e;switch(n){case 0:e="custom";break;case 1:e="type";break;case 2:e="import";break;case 3:e="function";break;case 4:e="table";break;case 5:e="memory";break;case 6:e="global";break;case 7:e="export";break;case 8:e="start";break;case 9:e="element";break;case 10:e="code";break;case 11:e="data";break}return"["+e+"]"}var Lo={id:Ro,encode:re,show:ue};function Be(n){switch(n){case 0:return 127;case 1:return 126;case 2:return 125;case 3:return 124}}function ze(n){switch(n){case 0:return"i32";case 1:return"i64";case 2:return"f32";case 3:return"f64"}}var Co={encode:Be,show:ze};function Wr(n){return typeof n=="number"?[64]:n.TAG===0?[Be(n._0)]:ln(n._0)}function $o(n){return typeof n=="number"?"void":n.TAG===0?ze(n._0):"type "+String(n._0)}var Uo={encode:Wr,show:$o};function Ht(n){if(typeof n=="number")switch(n){case 0:return[5,"else"];case 1:return[11,"end"];case 2:return[15,"return"];case 3:return[26,"drop"];case 4:return[106,"i32.add"];case 5:return[107,"i32.sub"];case 6:return[108,"i32.mul"];case 7:return[110,"i32.div_s"];case 8:return[109,"i32.div_u"];case 9:return[69,"i32.eqz"];case 10:return[70,"i32.eq"];case 11:return[81,"i64.eq"];case 12:return[91,"f32.eq"];case 13:return[97,"f64.eq"];case 14:return[71,"i32.ne"];case 15:return[82,"i64.ne"];case 16:return[92,"f32.ne"];case 17:return[98,"f64.ne"];case 18:return[76,"i32.le_s"];case 19:return[77,"i32.le_u"];case 20:return[87,"i64.le_s"];case 21:return[88,"i64.le_u"];case 22:return[95,"f32.le"];case 23:return[101,"f64.le"];case 24:return[78,"i32.ge_s"];case 25:return[79,"i32.ge_u"];case 26:return[89,"i64.ge_s"];case 27:return[90,"i64.ge_u"];case 28:return[96,"f32.ge"];case 29:return[102,"f64.ge"];case 30:return[72,"i32.lt_s"];case 31:return[73,"i32.lt_u"];case 32:return[83,"i64.lt_s"];case 33:return[84,"i64.lt_u"];case 34:return[93,"f32.lt"];case 35:return[99,"f64.lt"];case 36:return[74,"i32.gt_s"];case 37:return[75,"i32.gt_u"];case 38:return[85,"i64.gt_s"];case 39:return[86,"i64.gt_u"];case 40:return[94,"f32.gt"];case 41:return[100,"f64.gt"];case 42:return[111,"i32.rem_s"];case 43:return[112,"i32.rem_u"];case 44:return[113,"i32.and"]}else switch(n.TAG|0){case 0:return[65,"i32.const "+String(n._0)];case 1:return[66,"i64.const "+String(n._0)];case 2:return[67,"i64.const "+String(n._0)];case 3:return[68,"i64.const "+String(n._0)];case 4:return[4,"if"];case 5:return[13,"br_if "+String(n._0)];case 6:return[12,"br "+String(n._0)];case 7:return[2,"block"];case 8:return[3,"loop"];case 9:return[35,"global.get "+String(n._0)];case 10:return[36,"global.set "+String(n._0)];case 11:return[32,"local.get "+String(n._0)];case 12:return[33,"local.set "+String(n._0)];case 13:return[34,"local.tee "+String(n._0)];case 14:return[16,"call "+String(n._0)];case 15:return[17,"call_indirect [typeIndex="+String(n._0)+", tableIndex="+String(n._1)+"]"];case 16:return[40,"i32.load (alignment="+String(n._0)+", offset="+String(n._1)+")"];case 17:return[54,"i32.store (alignment="+String(n._0)+", offset="+String(n._1)+")"]}}function ae(n){return Ht(n)[0]}function Jr(n){if(typeof n=="number")switch(n){case 0:case 1:return-1;default:return 0}else switch(n.TAG|0){case 4:case 7:case 8:return 1;default:return 0}}function kt(n,e,r,u){var a=n!==void 0?n:{contents:0},t=Ht(e),o=Jr(e),i=g(Wa(0,a.contents+(o<0?o:0)|0),"  ",function(s){return""});a.contents=a.contents+o|0,e===0&&(a.contents=a.contents+1|0);var _,f=0;if(typeof e=="number")_="";else switch(e.TAG|0){case 11:case 12:case 13:f=1;break;case 14:_="<"+un(De(r,e._0),"??",function(s){return s})+">";break;default:_=""}return f===1&&(_="<"+un(De(u,e._0),"??",function(s){return s})+">"),i+t[1]+" "+_}function Pe(n){var e=0;if(typeof n=="number")return[ae(n)];switch(n.TAG|0){case 0:case 1:e=1;break;case 2:return Q([ae(n)],qr(n._0));case 3:return Q([ae(n)],Zr(n._0));case 5:case 6:e=3;break;case 4:case 7:case 8:e=2;break;case 9:case 10:case 11:case 12:case 13:e=4;break;case 14:return Q([ae(n)],ln(n._0));case 15:return fn([[ae(n)],ln(n._0),ln(n._1)]);case 16:case 17:e=5;break}switch(e){case 1:return Q([ae(n)],jr(n._0));case 2:return Q([ae(n)],Wr(n._0));case 3:case 4:return Q([ae(n)],ln(n._0));case 5:return fn([[ae(n)],ln(n._0),ln(n._1)])}}var Oo={info:Ht,opcode:ae,identationDelta:Jr,show:kt,encode:Pe};function Mo(n,e){return{_0:n,_1:e}}var Xo=[],Vo=[],Bo={_0:Xo,_1:Vo};function Kr(n){return fn([[96],ct(l(n._0,Be)),ct(l(n._1,Be))])}function Yr(n){var e=n._1,r=n._0,u=g(r,", ",ze),a=g(e,", ",ze);if(r.length===1){var t=e.length;if(t===1)return u+" -> "+a;if(t===0)return u+" -> ()"}var o=e.length;return o!==1?o!==0?"("+u+") -> ("+a+")":"("+u+") -> ()":"("+u+") -> "+a}var zo={funcTypeCode:96,make:Mo,empty:Bo,encode:Kr,show:Yr};function Po(n){var e=function(u,a){for(;;){var t=a,o=u;if(!o)return t;var i=o.tl,_=o.hd,f=_[1],s=_[0];if(t){var T=t.tl,d=t.hd,R=d[1],O=d[0];if(Bn(f,R)){a={hd:[{hd:s,tl:O},R],tl:T},u=i;continue}a={hd:[{hd:s,tl:0},f],tl:{hd:[O,R],tl:T}},u=i;continue}a={hd:[{hd:s,tl:0},f],tl:0},u=i}},r=Ar(e(ut(n),0));return Xe(Ja(r,function(u){return[Fr(Xe(u[0])),u[1]]}))}function Hr(n){return Q(ln(n[0].length),[Be(n[1])])}function Qr(n){return"local ["+g(n[0],", ",function(e){return e})+"] "+ze(n[1])}var jo={fromTypes:Po,encode:Hr,show:Qr};function qo(n,e){return[n,e]}function yr(n){var e=zn(l(n[0],Hr)),r=fn(l(n[1],Pe));return fn([[e.length+r.length|0],e,r])}function Ir(n,e,r){var u=n[0],a={contents:1},t=kr(r._0,function(f,s){return"param["+String(f)+"]"}),o=Q(t,fn(l(u,function(f){return f[0]}))),i=g(u,`
`,Qr),_=g(n[1],`
`,function(f){return kt(a,f,e,o)});return u.length===0?_:i+`
`+_}var Zo={make:qo,encode:yr,show:Ir};function Wo(n,e,r){return[n,e,r]}var _t={Signature:zo,Local:jo,Body:Zo,make:Wo};function Jo(n){return[]}function Qt(n,e){var r=jt(n,function(u){return Bn(u,e)});return r!==void 0?r:(n.push(e),n.length-1|0)}function xr(n){return re(1,zn(l(n,Kr)))}function nu(n){return ue(1)+`
`+g(n,`
`,Yr)}var Ko={make:Jo,getOrAdd:Qt,encode:xr,show:nu};function Yo(n){return[]}function eu(n,e){return n.push(e),n.length-1|0}function tu(n){return re(3,zn(l(n,ln)))}function ru(n,e){return ue(3)+`
`+g(Re(n,e),`
`,function(r){return r[1]+": "+String(r[0])})}var Ho={make:Yo,addSignature:eu,encode:tu,show:ru};function Ft(n){return ct(l(n.split(""),function(e){return e.charCodeAt(0)|0}))}var Qo={encode:Ft};function yo(n){return[n]}function uu(n){switch(n){case 0:return"func";case 1:return"table";case 2:return"memory";case 3:return"global"}}var Io={encode:yo,show:uu};function xo(n,e,r){return{name:n,kind:e,index:r}}function au(n){return fn([Ft(n.name),[n.kind],ln(n.index)])}function ou(n){return"export "+uu(n.kind)+" "+n.name+" (index: "+String(n.index)+")"}var ni={ExternalKind:Io,make:xo,encode:au,show:ou};function ei(n){return[]}function ti(n,e){n.push(e)}function iu(n){return re(7,zn(l(n,au)))}function cu(n){return ue(7)+`
`+g(n,`
`,ou)}var ri={make:ei,add:ti,encode:iu,show:cu};function ui(n){return n?"externref":"funcref"}function ai(n){return n?111:112}var oi={show:ui,encode:ai};function yt(n){return"{ min: "+String(n[0])+", max: "+un(n[1],"?",function(e){return String(e)})+" }"}function ii(n,e){return[n,e]}function ci(n){return[n,n]}function Nt(n){var e=n[1],r=n[0];return e!==void 0?fn([[1],ln(r),ln(e)]):Q([0],ln(r))}var It={show:yt,make:ii,makeExact:ci,encode:Nt};function _i(n,e){return[n,e]}function _u(n){return Q([n[0]?111:112],Nt(n[1]))}function fu(n){return"table "+(n[0]?"externref":"funcref")+" "+yt(n[1])}var su={make:_i,encode:_u,show:fu};function fi(n){return[]}function si(n,e){n.push(e)}function lu(n){return ue(4)+`
`+g(n,`
`,fu)}function vu(n){return re(4,zn(l(n,_u)))}var li={make:fi,add:si,show:lu,encode:vu};function vi(n,e){var r=n!==void 0?n:0;return{offset:r,funcIndices:e}}function du(n){return"elem funcref ("+g(n.funcIndices," ",function(e){return String(e)})+") (offset="+String(n.offset)+")"}function Tu(n){return fn([[0],Pe({TAG:0,_0:n.offset}),Pe(1),zn(l(n.funcIndices,ln))])}var Gu={fromFuncRefs:vi,show:du,encode:Tu};function di(n){return[]}function Ti(n,e){n.push(e)}function gu(n){return ue(9)+`
`+g(n,`
`,du)}function hu(n){return re(9,zn(l(n,Tu)))}var Gi={make:di,add:Ti,show:gu,encode:hu};function gi(n){return n}function wu(n){return Q(fn(l(n,Pe)),Pe(1))}function Eu(n){if(n.length!==1)return`
`+g(n,`
`,function(r){return"  "+kt(void 0,r,[],[])})+`
end`;var e=n[0];return kt(void 0,e,[],[])}var hi={fromInstructions:gi,encode:wu,show:Eu};function wi(n,e,r){return[e,n,r]}function mu(n){return"global "+(n[1]?"mutable":"immutable")+" "+ze(n[0])+" = "+Eu(n[2])}function pu(n){return Q([Be(n[0]),n[1]?1:0],wu(n[2]))}var ft={Initializer:hi,make:wi,show:mu,encode:pu};function Ei(n){return[]}function mi(n,e){n.push(e)}function Su(n){return ue(6)+`
`+g(n,`
`,mu)}function bu(n){return re(6,zn(l(n,pu)))}var pi={make:Ei,add:mi,show:Su,encode:bu};function Si(n){return n}function Au(n){return"memory "+yt(n)}var ku={make:Si,show:Au,encode:Nt};function bi(n){return[]}function Fu(n,e){return n.push(e)-1|0}function Nu(n){return ue(5)+`
`+g(n,`
`,Au)}function Du(n){return re(5,zn(l(n,Nt)))}var Ai={make:bi,add:Fu,show:Nu,encode:Du},ki={};function Ru(n){return fn([[0],ln(n._0)])}function Lu(n){return"func (index: "+String(n._0)+")"}var Fi={make:void 0,encode:Ru,show:Lu};function Cu(n){return fn([Ft(n.moduleName),Ft(n.entityName),Ru(n.desc)])}function Ni(n,e,r){return{moduleName:n,entityName:e,desc:r}}function $u(n){return"import "+Lu(n.desc)+" "+n.moduleName+"."+n.entityName}var Uu={ImportDesc:Fi,encode:Cu,make:Ni,show:$u};function Di(n){return[]}function Ou(n,e){return n.push(e)-1|0}function Mu(n){return re(2,zn(l(n,Cu)))}function Xu(n){return ue(2)+`
`+g(n,`
`,$u)}function Ri(n){return n.length}var Li={make:Di,add:Ou,encode:Mu,show:Xu,count:Ri};function Ci(n){return[]}function Vu(n,e){return n.push(e),n.length-1|0}function Bu(n){return re(10,zn(l(n,yr)))}function zu(n,e,r){var u=l(mt(e,function(t){return!0}),function(t){return t.entityName}),a=Q(u,l(r,function(t){return t[0]}));return ue(10)+`
`+g(Re(n,r),`

`,function(t){var o=t[1];return o[0]+`
`+Ir(t[0],a,o[1])})}var $i={make:Ci,addFunc:Vu,encode:Bu,show:zu};function Ui(n){return{typeSection:[],importSection:[],funcSection:[],tableSection:[],memorySection:[],globalSection:[],exportSection:[],elementSection:[],codeSection:[],funcs:[]}}function Oi(n,e){return Qt(n.typeSection,e)}function Pu(n,e,r,u){var a=Qt(n.typeSection,r);return eu(n.funcSection,a),n.funcs.push([e,r,u]),Vu(n.codeSection,u)+n.importSection.length|0}function Mi(n,e,r,u){var a=Pu(n,e,r,u),t={name:e,kind:0,index:a};return n.exportSection.push(t),a}function Xi(n,e){n.tableSection.push(e)}function Vi(n,e){n.elementSection.push(e)}function Bi(n,e){n.globalSection.push(e)}function zi(n,e){return Fu(n.memorySection,e)}function Pi(n,e){return Ou(n.importSection,e)}function ju(n){return fn([[0,97,115,109,1,0,0,0],xr(n.typeSection),Mu(n.importSection),tu(n.funcSection),vu(n.tableSection),Du(n.memorySection),bu(n.globalSection),iu(n.exportSection),hu(n.elementSection),Bu(n.codeSection)])}function ji(n){return(e=>Uint8Array.from(e))(ju(n))}function qi(n){return g([nu(n.typeSection),Xu(n.importSection),ru(n.funcSection,l(n.funcs,function(e){return e[0]})),lu(n.tableSection),Nu(n.memorySection),Su(n.globalSection),cu(n.exportSection),gu(n.elementSection),zu(n.codeSection,n.importSection,n.funcs)],`

`,function(e){return e})}var Pn={make:Ui,getOrAddSignature:Oi,addFunc:Pu,addExportedFunc:Mi,addTable:Xi,addElement:Vi,addGlobal:Bi,addMemory:zi,addImport:Pi,encode:ju,encodeAsUint8Array:ji,show:qi},Zi=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uleb128:ln,sleb128:jr,Vec:Fo,F32:No,F64:Do,Section:Lo,ValueType:Co,BlockReturnType:Uo,Inst:Oo,Func:_t,TypeSection:Ko,FuncSection:Ho,Str:Qo,ExportEntry:ni,ExportSection:ri,ReferenceType:oi,Limits:It,Table:su,TableSection:li,Elem:Gu,ElementSection:Gi,Global:ft,GlobalSection:pi,Memory:ku,MemorySection:Ai,Import:ki,ImportEntry:Uu,ImportSection:Li,CodeSection:$i,Module:Pn});const qu={"0":"I32","1":"I64","2":"F32","3":"F64"},N={I32:0,I64:1,F32:2,F64:3},xt={Else:0,End:1,Return:2,Drop:3,AddI32:4,SubI32:5,MulI32:6,DivI32Unsigned:7,DivI32Signed:8,EqzI32:9,EqI32:10,EqI64:11,EqF32:12,EqF64:13,NeI32:14,NeI64:15,NeF32:16,NeF64:17,LeI32Signed:18,LeI32Unsigned:19,LeI64Signed:20,LeI64Unsigned:21,LeF32:22,LeF64:23,GeI32Signed:24,GeI32Unsigned:25,GeI64Signed:26,GeI64Unsigned:27,GeF32:28,GeF64:29,LtI32Signed:30,LtI32Unsigned:31,LtI64Signed:32,LtI64Unsigned:33,LtF32:34,LtF64:35,GtI32Signed:36,GtI32Unsigned:37,GtI64Signed:38,GtI64Unsigned:39,GtF32:40,GtF64:41,RemI32Signed:42,RemI32Unsigned:43,And:44},Wi={FuncRef:0,ExternRef:1},Ji={Func:0,Table:1,Memory:2,Global:3},se={Void:0},Y=Zi;Y.uleb128;Y.sleb128;Y.Vec.encode;Y.Vec.encodeMany;Y.F32.encode;Y.F64.encode;Y.Func.Signature.funcTypeCode;Y.Func.Signature.empty._0.map(function(e){return qu[e]}),Y.Func.Signature.empty._1.map(function(e){return qu[e]});Y.FuncSection.make;Y.FuncSection.encode;Y.Str.encode;Y.Limits.makeExact;Y.Elem.show;Y.Elem.encode;Y.ElementSection.make;Y.ElementSection.show;Y.ElementSection.encode;Y.MemorySection.make;Y.ImportEntry.ImportDesc.make;const Ki=function(n){return Y.Module.show({typeSection:n.typeSection.map(function(u){return{TAG:0,_0:u[0].map(function(t){return N[t]}),_1:u[1].map(function(t){return N[t]})}}),importSection:n.importSection.map(function(u){return{moduleName:u.moduleName,entityName:u.entityName,desc:{TAG:0,_0:u.desc.value}}}),funcSection:n.funcSection,tableSection:n.tableSection.map(function(u){return[Wi[u[0]],[u[1][0],u[1][1]==null?void 0:u[1][1]]]}),memorySection:n.memorySection.map(function(u){return[u[0],u[1]==null?void 0:u[1]]}),globalSection:n.globalSection.map(function(u){return[N[u[0]],u[1],u[2].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:{TAG:17,_0:t.value[0],_1:t.value[1]}:xt[t]})]}),exportSection:n.exportSection.map(function(u){return{name:u.name,kind:Ji[u.kind],index:u.index}}),elementSection:n.elementSection,codeSection:n.codeSection.map(function(u){return[u[0].map(function(t){return[t[0],N[t[1]]]}),u[1].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:{TAG:17,_0:t.value[0],_1:t.value[1]}:xt[t]})]}),funcs:n.funcs.map(function(u){return[u[0],{TAG:0,_0:u[1][0].map(function(t){return N[t]}),_1:u[1][1].map(function(t){return N[t]})},[u[2][0].map(function(t){return[t[0],N[t[1]]]}),u[2][1].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:{TAG:17,_0:t.value[0],_1:t.value[1]}:xt[t]})]]})})};Y.F32;Y.F64;Y.Vec;Y.Str;function Yi(n,e,r){return h(e,h(n,r))}function st(n){return[[],n]}var Hi=Nr;function Qi(n,e,r){return Nr(n,e,[[],r])}var yi=Ka,Ii=Ya,xi=qt;function nc(n,e){var r=g(Dr(Rr(n,e)),`
`,function(u){return"  "+u[0]+": "+u[1]});return`{
`+r+`
}`}var Xn={empty:void 0,add:Hi,addMono:Qi,remove:yi,has:Ii,get:xi,show:nc},ec=[],oe={TAG:1,_0:"u32",_1:ec},tc=[],pe={TAG:1,_0:"bool",_1:tc},rc=[],Se={TAG:1,_0:"()",_1:rc};function Cn(n,e){return{TAG:1,_0:"Fun",_1:Q(n,[e])}}function uc(n){return{TAG:1,_0:"Tuple",_1:n}}function ac(n){return{TAG:1,_0:"Ptr",_1:[n]}}function nr(n){switch(n.TAG|0){case 0:case 1:return!1;case 2:return!0}}var Le=sn("Types.Size.UnkownTypeSize");function Dt(n){for(;;){var e=n;switch(e.TAG|0){case 0:throw{RE_EXN_ID:Le,_1:e,Error:new Error};case 1:switch(e._0){case"()":if(e._1.length===0)return 0;throw{RE_EXN_ID:Le,_1:e,Error:new Error};case"Mut":var r=e._1;if(r.length!==1)throw{RE_EXN_ID:Le,_1:e,Error:new Error};n=r[0];continue;case"Fun":case"Ptr":return 4;case"Tuple":return pn(l(e._1,Dt),0,function(u,a){return u+a|0});case"bool":case"u32":break;case"u64":if(e._1.length===0)return 8;throw{RE_EXN_ID:Le,_1:e,Error:new Error};default:throw{RE_EXN_ID:Le,_1:e,Error:new Error}}if(e._1.length===0)return 4;throw{RE_EXN_ID:Le,_1:e,Error:new Error};case 2:return 4}}}function oc(n){return Math.ceil(Math.log2(Dt(n)))|0}function ic(n){return Dt(n)===0}var ie={UnkownTypeSize:Le,size:Dt,sizeLog2:oc,isZeroSizedType:ic};function cc(n){return{TAG:0,_0:n}}function er(n,e,r){if(n.TAG===0)return{TAG:1,_0:[e,r],_1:{TAG:0,_0:n._0}};var u=n._1,a=n._0,t=a[1],o=a[0];return e<o?{TAG:1,_0:[e,r],_1:{TAG:1,_0:[o,t],_1:u}}:{TAG:1,_0:[o,t],_1:er(u,e,r)}}function _c(n){for(;;){var e=n;if(e.TAG===0)return e._0;n=e._1}}function fc(n,e){return pn(n,{TAG:0,_0:{TAG:0,_0:e}},function(r,u){return er(r,u[0],u[1])})}function tr(n){var e=function(r,u){for(;;){var a=u,t=r;if(t.TAG===0){var o=t._0;switch(o.TAG|0){case 0:case 1:return a;case 2:var i=o._0;if(i.TAG===0)return a;var _=i._0;if(_.TAG===0)return a;u={hd:_._0,tl:a},r=_._1;continue}}else{u={hd:t._0,tl:a},r=t._1;continue}}};return Xe(e(n,0))}function sc(n){return Ha(tr(n))}function Zu(n,e){if(n.TAG===0){var r=h(e,n._0);switch(r.TAG|0){case 0:case 1:return{TAG:0,_0:r};case 2:var u=r._0;return u.TAG===0?{TAG:0,_0:r}:u._0}}else{var a=n._0;return{TAG:1,_0:[a[0],h(e,a[1])],_1:Zu(n._1,e)}}}function Wu(n,e){var r=function(u,a){for(;;){var t=a,o=u;if(o.TAG===0)return Fr(Xe({hd:"..."+h(e,o._0),tl:t}));var i=o._0;a={hd:i[0]+": "+h(e,i[1]),tl:t},u=o._1}};return"{ "+g(r(n,0),", ",function(u){return u})+" }"}var Vn={make:cc,insert:er,tail:_c,fromArray:fc,toArray:tr,toMap:sc,map:Zu,show:Wu};function Rt(n){switch(n.TAG|0){case 0:return Ia(void 0,n._0);case 1:return pn(l(n._1,Rt),void 0,Wt);case 2:var e=n._0;return e.TAG===0?void 0:pn(l(tr(e._0),function(r){return Yi(function(u){return u[1]},Rt,r)}),void 0,Wt)}}function lc(n){return Lr(Rt(n[1]),xa(n[0]))}function vc(n){return pn(l(ya(n),lc),void 0,Wt)}function rr(n,e){var r=Qa(Lr(Rt(e),vc(n)));return[r,e]}function dc(n){var e=String.fromCharCode(97+n%26|0),r=n/26|0;return r===0?e:e+String(r)}function S(n){switch(n.TAG|0){case 0:return dc(n._0);case 1:var e=n._1,r=n._0;if(e.length===0)return r;switch(r){case"Fun":var u=Zt(e,0,e.length-1|0),a=Ee(e,e.length-1|0);if(u.length!==1)return"("+g(u,", ",S)+") -> "+S(a);var t=u[0];return S(t)+" -> "+S(a);case"Tuple":return"("+g(e,", ",S)+")";default:return r+"<"+g(e,", ",S)+">"}case 2:var o=n._0;return o.TAG===0?o._0:Wu(o._0,S)}}function Ju(n){switch(n){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/";case 4:return"%";case 5:return"<";case 6:return"<=";case 7:return">";case 8:return">=";case 9:return"==";case 10:return"!="}}var Tc={show:Ju};function Ku(n){switch(n){case 0:return"-";case 1:return"!";case 2:return"*"}}var Gc={show:Ku};function Yu(n){return typeof n=="number"?"()":n.TAG===0?String(n._0):n._0?"true":"false"}var gc={show:Yu};function V(n){switch(n.TAG|0){case 0:return Yu(n._0);case 1:return Ku(n._0)+V(n._1);case 2:return"("+V(n._0)+" "+Ju(n._1)+" "+V(n._2)+")";case 3:return n._0;case 4:return V(n._0)+" = "+V(n._1);case 5:var e=n._1,r=n._0,u=r.length;if(u!==1)return u!==0?"("+g(r,", ",function(i){return i})+") -> "+V(e):"() -> "+V(e);var a=r[0];return a+" -> "+V(e);case 6:return"let "+n._0+" = "+V(n._1)+" in "+V(n._2);case 7:return"("+V(n._0)+")("+g(n._1,", ",V)+")";case 8:return(n._2===1?"unsafe ":"")+`{
`+g(Q(l(n._0,Hu),un(n._1,[],function(i){return[V(i)]})),`;
`,function(i){return"  "+i})+`
}`;case 9:var t=n._2,o="if "+V(n._0)+" "+V(n._1);return t!==void 0?o+" else "+V(t):o;case 10:return"while "+V(n._0)+" "+V(n._1);case 11:return"return "+un(n._0,"",V);case 12:return V(n._0)+" as "+S(n._1);case 13:return"("+g(n._0,", ",V)+")";case 14:return n._0+` {
`+g(n._1,", ",function(i){return i[0]+": "+V(i[1])})+`
}`;case 15:return V(n._0)+"."+n._1}}function ur(n){switch(n.TAG|0){case 0:return"fn "+n._0+"("+g(n._1,", ",function(e){return(e[1]?"mut ":"")+e[0]})+") "+V(n._2);case 1:return(n._1?"mut":"let")+" "+n._0+" = "+V(n._2);case 2:return"struct "+n._0+` {
`+g(n._1,`,
`,function(e){return(e[2]?"mut ":"")+e[0]+": "+S(e[1])})+`
}`;case 3:return n._0+` {
`+g(n._1,`

`,ur)+`
}`;case 4:return"extern fn "+n.name+"("+g(n.args,", ",function(e){return(e[2]?"mut ":"")+e[0]+": "+S(e[1])})+") -> "+S(n.ret)}}function Hu(n){return n.TAG===0?(n._1?"mut":"let")+" "+n._0+" = "+V(n._2):V(n._0)}var hc={showExpr:V,showDecl:ur,showStmt:Hu},wc={show:ur};function G(n,e){for(;;){var r=e;switch(r.TAG|0){case 0:var u=r._0,a=Cr(n,u);if(a===void 0)return{TAG:0,_0:u};e=a;continue;case 1:return{TAG:1,_0:r._0,_1:l(r._1,function(i){return G(n,i)})};case 2:var t=r._0,o;return o=t.TAG===0?{TAG:0,_0:t._0}:{TAG:1,_0:Vn.map(t._0,function(i){return G(n,i)})},{TAG:2,_0:o}}}}function Qu(n,e){var r=e[0];return[r,G(ro(n,r),e[1])]}function L(n,e){return no(eo(e,function(r){return G(n,r)}),n,function(r,u,a){return to(a,u)})}function vn(n,e){return Rr(e,function(r){return Qu(n,r)})}var je;function ar(n,e){for(var r,u=0;me(r)&&u<n.length;){var a=h(e,Ee(n,u));a!==void 0&&(r=j(ee(a))),u=u+1|0}return r}function yu(n,e){for(var r,u=n.length-1|0;me(r)&&u>=0;)h(e,Ee(n,u))?r=u:u=u-1|0;return r}function Ec(n,e){for(var r=[],u=!1,a=0;u===!1&&a<n.length;){var t=Ee(n,a);t!==void 0?r.push(h(e,ee(t))):u=!0,a=a+1|0}if(!u)return r}function mc(n,e){for(var r=[],u,a=0;me(u)&&a<n.length;){var t=Ee(n,a);t.TAG===0?r.push(h(e,t._0)):u=j(t._0),a=a+1|0}var o=u;return o!==void 0?{TAG:1,_0:ee(o)}:{TAG:0,_0:r}}function Iu(n,e){return y(jt(n,e),function(r){return[Ee(n,r),r]})}function pc(n){return"struct "+n.name+`{
`+g(n.attributes,`,
`,function(e){return"  "+e.name+": "+S(e.ty)})+`
}`}function Sc(n,e){return{TAG:2,_0:{TAG:1,_0:Vn.fromArray(l(n.attributes,function(r){return[r.name,r.ty]}),e)}}}function bc(n,e){var r={contents:0},u=[];return Ln(e,function(a){var t=a[1],o=ie.size(t);u.push({name:a[0],mut:a[2],offset:r.contents,ty:t,size:o,impl:void 0}),r.contents=r.contents+o|0}),{name:n,attributes:u,size:r.contents,staticFuncs:[]}}function Ac(n,e,r){n.attributes.push({name:e.contents.name,mut:!1,offset:0,ty:e.contents.ty,size:0,impl:[e,r]})}function kc(n,e){n.staticFuncs.push({name:e})}var qe={show:pc,toPartialStructType:Sc,make:bc,addImplementation:Ac,addStaticFunc:kc},jn={tyVarIndex:0,identifiers:[],renaming:uo(10),structs:$r(5)};function le(n){var e=jn.tyVarIndex;return jn.tyVarIndex=jn.tyVarIndex+1|0,e}function or(n){return{TAG:0,_0:le()}}function Lt(n){var e=n[0],r=l(e,function(u){return{TAG:0,_0:le()}});return G(co(Re(e,r)),n[1])}function Qn(n,e){var r=n!==void 0?ee(n):void 0,u=jn.identifiers.length;jn.identifiers.push(e);var a={contents:{name:e,newName:e,index:u,ty:r!==void 0?r:{TAG:0,_0:le()}}};return oo(jn.renaming,u,a),a}function Fc(n){return Hn(yu(jn.identifiers,function(e){return e===n}),function(e){return io(jn.renaming,e)})}function xu(n,e){e.contents.ty=G(n,e.contents.ty)}function na(n){return Ln(ao(jn.renaming),function(e){return xu(n,e)})}function Nc(n){return Jt(jn.structs,n.name,n)}function yn(n){return Ur(jn.structs,n)}function ve(n){switch(n.TAG|0){case 0:var e=n._0;return typeof e=="number"?Se:e.TAG===0?oe:pe;case 3:return n._0.contents.ty;case 4:case 11:return Se;case 12:return un(n._0,Se,ve);case 13:return n._2;case 14:return uc(l(n._0,ve));case 15:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return n._0}}function Dc(n){return ve(n._0)}function B(n,e){var r=n!==void 0?ee(n):void 0,u=function(d,R){return r!==void 0?"("+R+": "+S(G(ee(r),d))+")":R},a=function(d){return B(j(r),d)};switch(e.TAG|0){case 0:return u(ve(e),gc.show(e._0));case 1:return u(e._0,"("+B(j(r),e._1)+" "+Tc.show(e._2)+" "+B(j(r),e._3)+")");case 2:return u(e._0,"("+Gc.show(e._1)+B(j(r),e._2)+")");case 3:var t=e._0;return u(t.contents.ty,t.contents.name);case 4:var o=e._1;return u(ve(o),B(j(r),e._0)+" = "+B(j(r),o));case 5:return u(e._0,"("+g(e._1,", ",function(d){return d.contents.name})+") -> "+B(j(r),e._2));case 6:return u(e._0,(e._1?"mut":"let")+" "+e._2.contents.name+" = "+B(j(r),e._3)+` in
`+B(j(r),e._4));case 7:return u(e._0,"let rec "+e._1.contents.name+" ("+g(e._2,", ",function(d){return d.contents.name})+") = "+B(j(r),e._3)+` in
`+B(j(r),e._4));case 8:return u(e._0,"("+B(j(r),e._1)+")("+g(e._2,", ",a)+")");case 9:var i=e._2,_=j(r);return u(e._0,(e._3===1?"unsafe ":"")+`{
`+g(Q(l(e._1,function(d){return ea(_,d)}),un(i,[],function(d){return[B(void 0,d)]})),`;
`,function(d){return"  "+d})+(me(i)?"; ":"")+`
}`);case 10:return u(e._0,"if "+B(j(r),e._1)+" "+B(j(r),e._2)+" else "+B(j(r),e._3));case 11:return u(Se,"while "+B(void 0,e._0)+" "+B(void 0,e._1));case 12:var f=j(r);return"return "+u(ve(e),un(e._0,"",function(d){return B(f,d)}));case 13:var s=e._0;return u(ve(s),B(void 0,s))+" as "+S(e._2);case 14:var T=j(r);return"("+g(e._0,", ",function(d){return B(T,d)})+")";case 15:return e._0+` {
`+g(e._1,`,
`,function(d){return d[0]+": "+B(void 0,d[1])})+`
}`;case 16:return u(e._0,B(void 0,e._1)+"."+e._2)}}function ea(n,e){var r=n!==void 0?ee(n):void 0;return B(j(r),e._0)}function ir(n,e){var r=n!==void 0?ee(n):void 0,u=function(f,s){return r!==void 0?"("+s+": "+S(G(ee(r),f))+")":s};switch(e.TAG|0){case 0:var a=e._1,t=e._0,o;if(r!==void 0){var i=ee(r);o=g(a,", ",function(f){var s=f[0];return(f[1]?"mut ":"")+(s.contents.name+": "+S(G(i,s.contents.ty)))})}else o=g(a,", ",function(f){return(f[1]?"mut ":"")+f[0].contents.name});return u(t.contents.ty,"fn "+t.contents.name+"("+o+") "+B(j(r),e._2));case 1:var _=e._0;return u(_.contents.ty,(e._1?"mut":"let")+" "+_.contents.name+" = "+B(j(r),e._2));case 2:return hc.showDecl({TAG:2,_0:e._0,_1:e._1});case 3:return"impl "+e._0+` {
`+g(e._1,`

`,function(f){return ir(void 0,{TAG:0,_0:f[0],_1:f[1],_2:f[2]})})+`
}`;case 4:return"extern fn "+e.name.contents.name+"("+g(e.args,", ",function(f){var s=f[0];return(f[1]?"mut ":"")+s.contents.name+": "+S(s.contents.ty)})+") -> "+S(e.ret)}}var ta=sn("Core.CoreAst.UnexpectedDeclarationInImplBlock"),ra=sn("Core.CoreAst.UndeclaredIdentifer"),ua=sn("Core.CoreAst.UnreachableLetStmt");function cr(n,e,r,u,a){return r.TAG===5?{TAG:7,_0:r._0,_1:n,_2:r._1,_3:r._2,_4:u}:{TAG:6,_0:a,_1:e,_2:n,_3:r,_4:u}}function z(n){var e={LAZY_DONE:!1,VAL:function(){return or()}};switch(n.TAG|0){case 0:return{TAG:0,_0:n._0};case 1:return{TAG:2,_0:te(e),_1:n._0,_2:z(n._1)};case 2:return{TAG:1,_0:te(e),_1:z(n._0),_2:n._1,_3:z(n._2)};case 3:var r=n._0,u=Fc(r);if(u!==void 0)return{TAG:3,_0:u};var a=yn(r);if(a!==void 0)return{TAG:3,_0:Qn(void 0,r)};throw{RE_EXN_ID:ra,_1:r,Error:new Error};case 4:return{TAG:4,_0:z(n._0),_1:z(n._1)};case 5:var t=n._1,o=n._0;if(o.length===0)return{TAG:5,_0:te(e),_1:[Qn(void 0,"__x")],_2:z(t)};var i=j(void 0);return{TAG:5,_0:te(e),_1:l(o,function(T){return Qn(i,T)}),_2:z(t)};case 6:return cr(Qn(void 0,n._0),!1,z(n._1),z(n._2),te(e));case 7:return{TAG:8,_0:te(e),_1:z(n._0),_2:l(n._1,z)};case 8:var _=n._2,f=n._1,s=function(T){if(!T)return y(f,z);var d=T.hd;if(d.TAG!==0)return{TAG:9,_0:te(e),_1:[aa(d)],_2:s(T.tl),_3:_};var R=d._3;return cr(Qn(void 0,d._0),d._1,z(d._2),un(s(T.tl),{TAG:0,_0:0},function(O){return O}),R!==void 0?R:or())};return{TAG:9,_0:te(e),_1:[],_2:s(ut(n._0)),_3:_};case 9:return{TAG:10,_0:te(e),_1:z(n._0),_2:z(n._1),_3:un(n._2,{TAG:0,_0:0},z)};case 10:return{TAG:11,_0:z(n._0),_1:z(n._1)};case 11:return{TAG:12,_0:y(n._0,z)};case 12:return{TAG:13,_0:z(n._0),_1:te(e),_2:n._1};case 13:return{TAG:14,_0:l(n._0,z)};case 14:return{TAG:15,_0:n._0,_1:l(n._1,function(T){return[T[0],z(T[1])]})};case 15:return{TAG:16,_0:or(),_1:z(n._0),_2:n._1}}}function aa(n){if(n.TAG!==0)return{_0:z(n._0)};throw{RE_EXN_ID:ua,Error:new Error}}function _r(n){switch(n.TAG|0){case 0:var e=l(n._1,function(o){return[Qn(j(void 0),o[0]),o[1]]});return{TAG:0,_0:Qn(void 0,n._0),_1:e,_2:z(n._2)};case 1:return{TAG:1,_0:Qn(void 0,n._0),_1:n._1,_2:z(n._2)};case 2:var r=n._1,u=n._0;return Nc(qe.make(u,r)),{TAG:2,_0:u,_1:r};case 3:var a=l(l(n._1,_r),function(o){if(o.TAG===0)return[o._0,o._1,o._2];throw{RE_EXN_ID:ta,_1:o,Error:new Error}});return{TAG:3,_0:n._0,_1:a};case 4:var t=l(n.args,function(o){return[Qn(j(o[1]),o[0]),o[2]]});return{TAG:4,name:Qn(void 0,n.name),args:t,ret:n.ret}}}function Z(n,e){var r=function(i){return Z(n,i)};switch(e.TAG|0){case 0:return{TAG:0,_0:e._0};case 1:return{TAG:1,_0:G(n,e._0),_1:Z(n,e._1),_2:e._2,_3:Z(n,e._3)};case 2:return{TAG:2,_0:G(n,e._0),_1:e._1,_2:Z(n,e._2)};case 3:return{TAG:3,_0:e._0};case 4:return{TAG:4,_0:Z(n,e._0),_1:Z(n,e._1)};case 5:return{TAG:5,_0:G(n,e._0),_1:e._1,_2:Z(n,e._2)};case 6:return{TAG:6,_0:G(n,e._0),_1:e._1,_2:e._2,_3:Z(n,e._3),_4:Z(n,e._4)};case 7:return{TAG:7,_0:G(n,e._0),_1:e._1,_2:e._2,_3:Z(n,e._3),_4:Z(n,e._4)};case 8:return{TAG:8,_0:G(n,e._0),_1:Z(n,e._1),_2:l(e._2,r)};case 9:return{TAG:9,_0:G(n,e._0),_1:l(e._1,function(i){return oa(n,i)}),_2:y(e._2,r),_3:e._3};case 10:return{TAG:10,_0:G(n,e._0),_1:Z(n,e._1),_2:Z(n,e._2),_3:Z(n,e._3)};case 11:return{TAG:11,_0:Z(n,e._0),_1:Z(n,e._1)};case 12:return{TAG:12,_0:y(e._0,r)};case 13:return{TAG:13,_0:Z(n,e._0),_1:G(n,e._1),_2:G(n,e._2)};case 14:return{TAG:14,_0:l(e._0,r)};case 15:var u=e._1,a=e._0,t=yn(a);if(t===void 0)return Or('unreachable: undeclared struct "'+a+"'");var o=Ec(l(mt(t.attributes,function(i){return me(i.impl)}),function(i){var _=i.name;return pt(u,function(f){return f[0]===_})}),function(i){return[i[0],Z(n,i[1])]});return o!==void 0?{TAG:15,_0:a,_1:o}:Or('unreachable: missing attribute for struct "'+a+'"');case 16:return{TAG:16,_0:G(n,e._0),_1:Z(n,e._1),_2:e._2}}}function oa(n,e){return{_0:Z(n,e._0)}}function ia(n,e){switch(e.TAG|0){case 0:return{TAG:0,_0:e._0,_1:e._1,_2:Z(n,e._2)};case 1:return{TAG:1,_0:e._0,_1:e._1,_2:Z(n,e._2)};case 3:return{TAG:3,_0:e._0,_1:l(e._1,function(r){return[r[0],r[1],Z(n,r[2])]})};case 2:case 4:return e}}var hn={typeOfExpr:ve,typeOfStmt:Dc,showExpr:B,showStmt:ea,showDecl:ir,UnexpectedDeclarationInImplBlock:ta,UndeclaredIdentifer:ra,UnreachableLetStmt:ua,rewriteLetIn:cr,fromExpr:z,fromStmt:aa,fromDecl:_r,substExpr:Z,substStmt:oa,substDecl:ia},kn={show:B,from:z,subst:Z,typeOf:ve},be={show:ir,from:_r,subst:ia};function ca(n){return[n,0,n.length]}function Rc(n){return ca(Array.from(n,function(e){return Mr(e,0)}))}function _a(n,e){var r=e[2],u=n!==void 0?n:1;return[e[0],Math.min(e[1]+u|0,r),r]}function fr(n){return De(n[0],n[1])}function sr(n){return _a(1,n)}function lr(n){return n[1]===n[2]}function Lc(n){return n[0].slice(n[1],n[2])}function Ze(n,e){var r=fr(e);if(r!==void 0&&h(n,r))return[r,_a(void 0,e)]}function en(n){return function(e){return Ze(function(r){return r===n},e)}}function fa(n){return n>=97?n<=122:!1}function Cc(n){return n>=65?n<=90:!1}function $c(n){return fa(n)?!0:Cc(n)}function sa(n){return n>=48?n<=57:!1}function Uc(n){return $c(n)?!0:sa(n)}function Oc(n){return Ze(fa,n)}function Mc(n){return Ze(sa,n)}function vr(n){return Ze(Uc,n)}function Xc(n){return n>13||n<9?n===32:!(n===12||n===11)}function Vc(n){return Ze(Xc,n)}function p(n,e,r){return y(h(n,r),function(u){return[h(e,u[0]),u[1]]})}function Ct(n,e,r){for(;;){var u=n,a=r,t=u!==void 0?u:[];if(lr(a))return[t,a];var o=h(e,a);if(o===void 0)return[t,a];t.push(o[0]),r=o[1],n=t}}function la(n){return Ct(void 0,Vc,n)}function lt(n,e,r){return Hn(h(n,r),function(u){var a=u[0];return y(h(e,u[1]),function(t){return[[a,t[0]],t[1]]})})}function va(n){return function(e){return p(function(r){return lt(n,function(u){return Ct(void 0,n,u)},r)},function(r){return Q([r[0]],r[1])},e)}}function Bc(n,e,r,u){return Hn(lt(n,e,u),function(a){var t=a[0],o=t[1],i=t[0];return y(h(r,a[1]),function(_){return[[i,o,_[0]],_[1]]})})}function da(n){if(!n)return function(a){return[0,a]};var e=n.hd,r=da(n.tl),u=function(a){return lt(e,r,a)};return function(a){return p(u,function(t){return{hd:t[0],tl:t[1]}},a)}}function Ta(n,e,r){var u=h(n,r);return u!==void 0?[u[0],u[1]]:h(e,r)}function vt(n,e){return ar(n,function(r){return h(r,e)})}function rn(n){var e=Array.from(n,function(u){var a=Mr(u,0);return function(t){return Ze(function(o){return o===a},t)}}),r=da(ut(e));return function(u){return p(r,function(a){return n},u)}}function zc(n,e){var r=h(n,e);if(r===void 0)return[void 0,sr(e)]}var Pc=va(Mc);function jc(n){return p(Pc,function(e){return{TAG:0,_0:Xr(_o(g(e,"",function(r){return St(1,r)})))}},n)}var qc=rn("false");function Zc(n){return p(qc,function(e){return{TAG:1,_0:!1}},n)}var Wc=rn("true");function Jc(n){return p(Wc,function(e){return{TAG:1,_0:!0}},n)}function Kc(n){return Ta(Jc,Zc,n)}var Yc=[vr,en(95),en(39)];function Hc(n){return vt(Yc,n)}function Qc(n){return Ct(void 0,Hc,n)}var yc=en(95);function Ic(n){return Ta(Oc,yc,n)}function xc(n){return lt(Ic,Qc,n)}function n0(n){return p(xc,function(e){return{TAG:3,_0:St(1,e[0])+g(e[1],"",function(r){return St(1,r)})}},n)}var e0=[vr,en(95)],t0=va(function(n){return vt(e0,n)});function r0(n){return p(t0,function(e){return{TAG:4,_0:g(e,"",function(r){return St(1,r)})}},n)}var u0=rn("let"),a0=rn("mut"),o0=rn("in"),i0=rn("if"),c0=rn("else"),_0=rn("fn"),f0=rn("while"),s0=rn("return"),l0=rn("as"),v0=rn("unsafe"),d0=rn("struct"),T0=rn("impl"),G0=rn("extern"),g0=[function(n){return p(u0,function(e){return{TAG:5,_0:0}},n)},function(n){return p(a0,function(e){return{TAG:5,_0:1}},n)},function(n){return p(o0,function(e){return{TAG:5,_0:2}},n)},function(n){return p(i0,function(e){return{TAG:5,_0:3}},n)},function(n){return p(c0,function(e){return{TAG:5,_0:4}},n)},function(n){return p(_0,function(e){return{TAG:5,_0:5}},n)},function(n){return p(f0,function(e){return{TAG:5,_0:6}},n)},function(n){return p(s0,function(e){return{TAG:5,_0:7}},n)},function(n){return p(l0,function(e){return{TAG:5,_0:8}},n)},function(n){return p(v0,function(e){return{TAG:5,_0:9}},n)},function(n){return p(d0,function(e){return{TAG:5,_0:10}},n)},function(n){return p(T0,function(e){return{TAG:5,_0:11}},n)},function(n){return p(G0,function(e){return{TAG:5,_0:12}},n)}];function h0(n){return vt(g0,n)}function w0(n){return lt(h0,function(e){return zc(vr,e)},n)}function E0(n){return p(w0,function(e){return e[0]},n)}var m0=rn("->"),p0=rn("=="),S0=rn("!="),b0=en(43),A0=en(45),k0=en(42),F0=en(47),N0=en(37),D0=rn("<="),R0=rn(">="),L0=en(60),C0=en(62),$0=en(40),U0=en(41),O0=en(44),M0=en(59),X0=en(61),V0=en(123),B0=en(125),z0=en(58),P0=en(33),j0=en(46),q0=[function(n){return p(m0,function(e){return{TAG:2,_0:5}},n)},function(n){return p(p0,function(e){return{TAG:2,_0:14}},n)},function(n){return p(S0,function(e){return{TAG:2,_0:15}},n)},function(n){return p(b0,function(e){return{TAG:2,_0:9}},n)},function(n){return p(A0,function(e){return{TAG:2,_0:10}},n)},function(n){return p(k0,function(e){return{TAG:2,_0:11}},n)},function(n){return p(F0,function(e){return{TAG:2,_0:12}},n)},function(n){return p(N0,function(e){return{TAG:2,_0:13}},n)},function(n){return p(D0,function(e){return{TAG:2,_0:17}},n)},function(n){return p(R0,function(e){return{TAG:2,_0:19}},n)},function(n){return p(L0,function(e){return{TAG:2,_0:16}},n)},function(n){return p(C0,function(e){return{TAG:2,_0:18}},n)},function(n){return p($0,function(e){return{TAG:2,_0:0}},n)},function(n){return p(U0,function(e){return{TAG:2,_0:1}},n)},function(n){return p(O0,function(e){return{TAG:2,_0:2}},n)},function(n){return p(M0,function(e){return{TAG:2,_0:3}},n)},function(n){return p(X0,function(e){return{TAG:2,_0:4}},n)},function(n){return p(V0,function(e){return{TAG:2,_0:6}},n)},function(n){return p(B0,function(e){return{TAG:2,_0:7}},n)},function(n){return p(z0,function(e){return{TAG:2,_0:8}},n)},function(n){return p(P0,function(e){return{TAG:2,_0:20}},n)},function(n){return p(j0,function(e){return{TAG:2,_0:21}},n)}];function Z0(n){return vt(q0,n)}var W0=[jc,Kc,E0,Z0,n0,r0];function J0(n){return vt(W0,n)}function K0(n){return Ct(void 0,function(e){return p(function(r){return Bc(la,J0,la,r)},function(r){return r[1]},e)},n)}function Y0(n){switch(n){case 0:return"(";case 1:return")";case 2:return",";case 3:return";";case 4:return"=";case 5:return"->";case 6:return"{";case 7:return"}";case 8:return":";case 9:return"+";case 10:return"-";case 11:return"*";case 12:return"/";case 13:return"%";case 14:return"==";case 15:return"!=";case 16:return"<";case 17:return"<=";case 18:return">";case 19:return">=";case 20:return"!";case 21:return"."}}function H0(n){switch(n){case 0:return"let";case 1:return"mut";case 2:return"in";case 3:return"if";case 4:return"else";case 5:return"fn";case 6:return"while";case 7:return"return";case 8:return"as";case 9:return"unsafe";case 10:return"struct";case 11:return"impl";case 12:return"extern"}}function Q0(n){switch(n.TAG|0){case 0:return String(n._0);case 1:return n._0?"true":"false";case 2:return Y0(n._0);case 3:case 4:return n._0;case 5:return H0(n._0)}}function $t(n){return{contents:function(e){return Hn(fr(e),function(r){if(h(n,r))return[r,sr(e)]})}}}function We(n){return{contents:function(e){return Hn(fr(e),function(r){return y(h(n,r),function(u){return[u,sr(e)]})})}}}function y0(n,e){return{contents:function(r){var u=h(n.contents,r);if(u!==void 0){var a=u[1];return y(h(e,u[0]),function(t){return[t,a]})}}}}function v(n){return $t(function(e){return Bn(e,n)})}function w(n,e){return{contents:function(r){return y(h(n.contents,r),function(u){return[h(e,u[0]),u[1]]})}}}function an(n,e){return{contents:function(r){return Hn(h(n.contents,r),function(u){var a=u[0];return y(h(e.contents,u[1]),function(t){return[[a,t[0]],t[1]]})})}}}function dt(n){var e=function(r){return{contents:function(u){if(lr(u))return[0,u];var a=h(r.contents,u);if(a===void 0)return[0,u];var t=a[0];return y(h(e(r).contents,a[1]),function(o){return[{hd:t,tl:o[0]},o[1]]})}}};return w(e(n),Xe)}function I0(n){return w(an(n,dt(n)),function(e){return Q([e[0]],e[1])})}function de(n,e,r){return{contents:function(u){return Hn(h(an(n,e).contents,u),function(a){var t=a[0],o=t[1],i=t[0];return y(h(r.contents,a[1]),function(_){return[[i,o,_[0]],_[1]]})})}}}function Ce(n,e,r,u){return{contents:function(a){return Hn(h(de(n,e,r).contents,a),function(t){var o=t[0],i=o[2],_=o[1],f=o[0];return y(h(u.contents,t[1]),function(s){return[[f,_,i,s[0]],s[1]]})})}}}function Tt(n,e,r,u,a){return{contents:function(t){return Hn(h(Ce(n,e,r,u).contents,t),function(o){var i=o[0],_=i[3],f=i[2],s=i[1],T=i[0];return y(h(a.contents,o[1]),function(d){return[[T,s,f,_,d[0]],d[1]]})})}}}function Ga(n,e,r,u,a,t){return{contents:function(o){return Hn(h(Tt(n,e,r,u,a).contents,o),function(i){var _=i[0],f=_[4],s=_[3],T=_[2],d=_[1],R=_[0];return y(h(t.contents,i[1]),function(O){return[[R,d,T,s,f,O[0]],O[1]]})})}}}function x0(n,e,r,u,a,t,o){return{contents:function(i){return Hn(h(Ga(n,e,r,u,a,t).contents,i),function(_){var f=_[0],s=f[5],T=f[4],d=f[3],R=f[2],O=f[1],I=f[0];return y(h(o.contents,_[1]),function(on){return[[I,O,R,d,T,s,on[0]],on[1]]})})}}}function P(n,e){return{contents:function(r){var u=h(n.contents,r);return u!==void 0?[u[0],u[1]]:h(e.contents,r)}}}function Ut(n){return{contents:function(e){return ar(n,function(r){return h(r.contents,e)})}}}function ga(n,e,r){return w(an(n,dt(e)),function(u){var a=u[1],t=u[0];return Bn(a,[])?t:pn(a,t,r)})}function Gt(n,e,r){return ga(n,an(e,n),function(u,a){return fo(r,u,a[0],a[1])})}function Ae(n){return w(de($t(function(e){return Bn(e,{TAG:2,_0:0})}),n,$t(function(e){return Bn(e,{TAG:2,_0:1})})),function(e){return e[1]})}function n_(n,e){var r=function(u,a){var t=h(n.contents,u);if(t===void 0)return[a,u];var o=t[1];return a.push(t[0]),un(h(e.contents,o),[a,o],function(i){return r(i[1],a)})};return{contents:function(u){return r(u,[])}}}function Te(n){return n_(n,$t(function(e){return Bn(e,{TAG:2,_0:2})}))}function ce(n){return P(w(n,function(e){return j(e)}),{contents:function(e){return[void 0,e]}})}var ha={contents:function(n){}},dn={contents:function(n){}},Je={contents:function(n){}},wa={contents:function(n){}},_e={contents:function(n){}},e_=We(function(n){if(n.TAG===0)return{TAG:0,_0:{TAG:0,_0:n._0}}}),t_=We(function(n){if(n.TAG===1)return{TAG:0,_0:{TAG:1,_0:n._0}}}),In=We(function(n){if(n.TAG===3)return n._0}),Ot=We(function(n){if(n.TAG===4)return n._0}),dr=We(function(n){switch(n.TAG|0){case 3:case 4:return n._0;default:return}}),r_=w(an(v({TAG:2,_0:0}),v({TAG:2,_0:1})),function(n){return Se}),u_=P(r_,We(function(n){switch(n.TAG|0){case 3:switch(n._0){case"bool":return pe;case"u32":return oe;default:return}case 4:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return}})),Ea=P(u_,Ae(_e)),a_=P(w(de(P(Ae(Te(_e)),w(Ea,function(n){return[n]})),v({TAG:2,_0:5}),_e),function(n){return Cn(n[0],n[2])}),Ea),o_=P(w(Ce(Ot,v({TAG:2,_0:16}),Te(_e),v({TAG:2,_0:18})),function(n){return{TAG:1,_0:n[0],_1:n[2]}}),a_);_e.contents=o_.contents;var i_=w(an(dr,ce(an(v({TAG:2,_0:8}),_e))),function(n){return[n[0],y(n[1],function(e){return e[1]})]}),c_=w(P(In,dr),function(n){return{TAG:3,_0:n}}),__=w(an(v({TAG:2,_0:0}),v({TAG:2,_0:1})),function(n){return{TAG:0,_0:0}}),f_=w(Ae(Ce(dn,v({TAG:2,_0:2}),dn,ce(an(v({TAG:2,_0:2}),Te(dn))))),function(n){var e=Q([n[0],n[2]],un(n[3],[],function(r){return r[1]}));return{TAG:13,_0:e}}),ma=Ut([e_,t_,__,c_,f_,Ae(dn)]),pa=P(ga(ma,an(v({TAG:2,_0:21}),In),function(n,e){return{TAG:15,_0:n,_1:e[1]}}),ma),Sa=P(w(an(pa,I0(Ae(Te(dn)))),function(n){return pn(n[1],n[0],function(e,r){return{TAG:7,_0:e,_1:r}})}),pa),s_=Ut([w(v({TAG:2,_0:11}),function(n){return 2}),w(v({TAG:2,_0:10}),function(n){return 0}),w(v({TAG:2,_0:20}),function(n){return 1})]),l_=P(w(v({TAG:2,_0:9}),function(n){return 0}),w(v({TAG:2,_0:10}),function(n){return 1})),v_=Ut([w(v({TAG:2,_0:11}),function(n){return 2}),w(v({TAG:2,_0:12}),function(n){return 3}),w(v({TAG:2,_0:13}),function(n){return 4})]),d_=Ut([w(v({TAG:2,_0:16}),function(n){return 5}),w(v({TAG:2,_0:17}),function(n){return 6}),w(v({TAG:2,_0:18}),function(n){return 7}),w(v({TAG:2,_0:19}),function(n){return 8})]),T_=P(w(v({TAG:2,_0:14}),function(n){return 9}),w(v({TAG:2,_0:15}),function(n){return 10})),G_=P(w(an(s_,Sa),function(n){return{TAG:1,_0:n[0],_1:n[1]}}),Sa),g_=Gt(G_,v_,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),h_=Gt(g_,l_,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),w_=Gt(h_,d_,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),E_=Gt(w_,T_,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),m_=P(w(Ce(v({TAG:5,_0:3}),dn,Je,ce(an(v({TAG:5,_0:4}),Je))),function(n){return{TAG:9,_0:n[1],_1:n[2],_2:y(n[3],function(e){return e[1]})}}),E_),p_=P(w(de(v({TAG:5,_0:6}),dn,Je),function(n){return{TAG:10,_0:n[1],_1:n[2]}}),m_),S_=P(w(Ga(v({TAG:5,_0:0}),In,v({TAG:2,_0:4}),dn,v({TAG:5,_0:2}),dn),function(n){return{TAG:6,_0:n[1],_1:n[3],_2:n[5]}}),p_),b_=P(Ae(Te(In)),w(In,function(n){return[n]})),A_=P(w(de(b_,v({TAG:2,_0:5}),dn),function(n){return{TAG:5,_0:n[0],_1:n[2]}}),S_),k_=y0(dn,function(n){switch(n.TAG|0){case 9:case 10:return[!0,{TAG:1,_0:n}];default:return}});Je.contents=P(w(Tt(ce(v({TAG:5,_0:9})),v({TAG:2,_0:6}),dt(P(w(wa,function(n){return[!1,n]}),k_)),ce(dn),v({TAG:2,_0:7})),function(n){var e=n[3],r=n[2],u=l(r,function(i){return i[1]}),a=un(n[0],0,function(i){return 1}),t=De(r,r.length-1|0);if(t===void 0)return{TAG:8,_0:u,_1:e,_2:a};var o=t[1];return o.TAG===0||!(t[0]&&me(e))?{TAG:8,_0:u,_1:e,_2:a}:{TAG:8,_0:Zt(u,0,r.length-1|0),_1:o._0,_2:a}}),A_).contents;var F_=P(w(Ce(Ot,v({TAG:2,_0:6}),Te(de(In,v({TAG:2,_0:8}),dn)),v({TAG:2,_0:7})),function(n){return{TAG:14,_0:n[0],_1:l(n[2],function(e){return[e[0],e[2]]})}}),Je),N_=Gt(F_,v({TAG:2,_0:4}),function(n,e,r){return{TAG:4,_0:n,_1:r}}),D_=P(w(an(v({TAG:5,_0:7}),ce(dn)),function(n){return{TAG:11,_0:n[1]}}),N_),R_=w(an(D_,ce(an(v({TAG:5,_0:8}),_e))),function(n){var e=n[1],r=n[0];return e!==void 0?{TAG:12,_0:r,_1:e[1]}:r});dn.contents=R_.contents;var L_=w(an(dn,v({TAG:2,_0:3})),function(n){return{TAG:1,_0:n[0]}}),C_=P(w(Tt(P(v({TAG:5,_0:0}),v({TAG:5,_0:1})),i_,v({TAG:2,_0:4}),dn,v({TAG:2,_0:3})),function(n){var e=n[1];return{TAG:0,_0:e[0],_1:Bn(n[0],{TAG:5,_0:1}),_2:n[3],_3:e[1]}}),L_);wa.contents=C_.contents;var $_=w(Tt(P(v({TAG:5,_0:0}),v({TAG:5,_0:1})),dr,v({TAG:2,_0:4}),dn,v({TAG:2,_0:3})),function(n){return{TAG:1,_0:n[1],_1:Bn(n[0],{TAG:5,_0:1}),_2:n[3]}}),U_=P(w(Tt(v({TAG:5,_0:10}),Ot,v({TAG:2,_0:6}),Te(de(an(ce(v({TAG:5,_0:1})),In),v({TAG:2,_0:8}),_e)),v({TAG:2,_0:7})),function(n){var e=l(n[3],function(r){var u=r[0];return[u[1],r[2],bt(u[0])]});return{TAG:2,_0:n[1],_1:e}}),$_),ba=P(w(Ce(v({TAG:5,_0:5}),In,w(Ae(Te(an(ce(v({TAG:5,_0:1})),In))),function(n){return l(n,function(e){return[e[1],bt(e[0])]})}),Je),function(n){return{TAG:0,_0:n[1],_1:n[2],_2:n[3]}}),U_),O_=P(w(x0(v({TAG:5,_0:12}),v({TAG:5,_0:5}),In,Ae(w(Te(Ce(ce(v({TAG:5,_0:1})),In,v({TAG:2,_0:8}),_e)),function(n){return l(n,function(e){return[e[1],e[3],bt(e[0])]})})),v({TAG:2,_0:5}),_e,v({TAG:2,_0:3})),function(n){return{TAG:4,name:n[2],args:n[3],ret:n[5]}}),ba),M_=P(w(de(v({TAG:5,_0:11}),Ot,w(de(v({TAG:2,_0:6}),dt(ba),v({TAG:2,_0:7})),function(n){return n[1]})),function(n){return{TAG:3,_0:n[1],_1:n[2]}}),O_);ha.contents=M_.contents;var X_=dt(ha);function Mt(n){var e=n.replace(/(\/\/[^\n]*)/g,""),r=K0(Rc(e));if(r===void 0)return{TAG:1,_0:"could not tokenize"};var u=h(X_.contents,ca(r[0]));if(u===void 0)return{TAG:1,_0:"could not parse"};var a=u[1];if(lr(a))return{TAG:0,_0:u[0]};var t=g(Zt(Lc(a),0,5)," ",Q0);return{TAG:1,_0:"could not parse near "+t}}function V_(n,e){var r=n!==void 0?n:3,u={contents:e.length},a=function(t,o,i){for(;;){var _=i,f=o,s=t;if(s){var T=s.hd,d=0;if(typeof T=="number")switch(T){case 2:var R=s.tl;if(R&&R.hd===3){t={hd:2,tl:R.tl};continue}break;case 9:var O=s.tl;if(O&&O.hd===9){t=O.tl;continue}break;case 10:var I=s.tl;if(I&&I.hd===9){t={hd:14,tl:I.tl};continue}break;case 14:var on=s.tl;if(on&&on.hd===9){t={hd:10,tl:on.tl};continue}break;case 18:var cn=s.tl;if(cn&&cn.hd===9){t={hd:36,tl:cn.tl};continue}break;case 19:var wn=s.tl;if(wn&&wn.hd===9){t={hd:37,tl:wn.tl};continue}break;case 24:var En=s.tl;if(En&&En.hd===9){t={hd:30,tl:En.tl};continue}break;case 25:var bn=s.tl;if(bn&&bn.hd===9){t={hd:31,tl:bn.tl};continue}break;case 30:var Tn=s.tl;if(Tn&&Tn.hd===9){t={hd:24,tl:Tn.tl};continue}break;case 31:var mn=s.tl;if(mn&&mn.hd===9){t={hd:25,tl:mn.tl};continue}break;case 36:var Gn=s.tl;if(Gn&&Gn.hd===9){t={hd:18,tl:Gn.tl};continue}break;case 37:var x=s.tl;if(x&&x.hd===9){t={hd:19,tl:x.tl};continue}break}else switch(T.TAG|0){case 0:var M=T._0,Un=0,An=s.tl;if(An){var gn=An.hd;if(typeof gn=="number"){if(gn===3){t=An.tl;continue}Un=3}else switch(gn.TAG|0){case 0:var H=An.tl;if(H){var On=H.hd;if(typeof On=="number"){var Mn=gn._0;if(On!==43){if(On<15)switch(On){case 4:t={hd:{TAG:0,_0:M+Mn|0},tl:H.tl};continue;case 5:t={hd:{TAG:0,_0:M-Mn|0},tl:H.tl};continue;case 6:t={hd:{TAG:0,_0:Math.imul(M,Mn)},tl:H.tl};continue;case 7:t={hd:{TAG:0,_0:so(M,Mn)},tl:H.tl};continue;case 10:t={hd:{TAG:0,_0:M===Mn?1:0},tl:H.tl};continue;case 0:case 1:case 2:case 3:case 8:case 9:case 11:case 12:case 13:break;case 14:t={hd:{TAG:0,_0:M===Mn?0:1},tl:H.tl};continue}}else{t={hd:{TAG:0,_0:lo(M,Mn)},tl:H.tl};continue}}}break;case 15:t={hd:{TAG:14,_0:M},tl:An.tl};continue;default:Un=3}}if(Un===3&&M===0){var fe=s.tl;if(fe.hd===10){t={hd:9,tl:fe.tl};continue}}break;case 1:case 2:case 3:case 9:case 11:d=2;break;case 12:var qn=s.tl;if(qn){var ge=qn.hd;if(typeof ge!="number"&&ge.TAG===11){var he=T._0;if(he===ge._0){t={hd:{TAG:13,_0:he},tl:qn.tl};continue}}}break;case 13:var Zn=s.tl;if(Zn&&Zn.hd===3){t={hd:{TAG:12,_0:T._0},tl:Zn.tl};continue}break}if(d===2){var ne=s.tl;if(ne&&ne.hd===3){t=ne.tl;continue}}o={hd:T,tl:f},t=s.tl;continue}var Wn=Ar(f),Jn=vo(Wn);if(!(_>1&&Jn<u.contents))return Wn;u.contents=Jn,i=_-1|0,o=0,t=Wn}};return r>0?Xe(a(ut(e),0,r)):e}function Tr(n,e){switch(e.TAG|0){case 0:return n===e._0;case 1:return Kt(e._1,function(u){return Tr(n,u)});case 2:var r=e._0;return r.TAG===0?!1:Kt(Vn.toArray(r._0),function(u){return Tr(n,u[1])})}}function Aa(n,e,r){if(Tr(n,e))return{TAG:1,_0:S({TAG:0,_0:n})+" occurs in "+S(e)};var u=Cr(r,n);return u!==void 0?Bn(u,e)?{TAG:0,_0:r}:{TAG:1,_0:S(e)+" is not unifiable with "+S(u)}:{TAG:0,_0:Vr(r,n,e)}}function Ke(n,e){for(;;){var r=n;if(!r)return{TAG:0,_0:e};var u=r.tl,a=r.hd,t=a[1],o=a[0],i=0;switch(o.TAG|0){case 0:var _=o._0,f=0;switch(t.TAG|0){case 0:if(_===t._0){n=u;continue}f=3;break;case 1:case 2:f=3;break}if(f===3)return F(Aa(_,t,e),function(x){return function(M){return Ke(x,M)}}(u));break;case 1:var s=o._1;switch(t.TAG|0){case 0:i=1;break;case 1:var T=t._1;if(o._0===t._0&&s.length===T.length){var d=pn(Re(s,T),u,function(x,M){return{hd:[G(e,M[0]),G(e,M[1])],tl:x}});n=d;continue}i=2;break;case 2:i=2;break}break;case 2:var R=o._0;switch(t.TAG|0){case 0:i=1;break;case 1:i=2;break;case 2:var O=t._0;if(R.TAG===0){var I=R._0;if(O.TAG===0){if(I!==O._0)return{TAG:1,_0:"cannot unify "+S(o)+" with "+S(t)};n=u;continue}var on=yn(I);if(on===void 0)return{TAG:1,_0:'undeclared struct "'+I+'"'};var cn=Ke({hd:[{TAG:2,_0:{TAG:1,_0:O._0}},qe.toPartialStructType(on,le())],tl:u},e);return cn.TAG===0?{TAG:0,_0:cn._0}:{TAG:1,_0:"struct type "+S(t)+" does not match "+I+": "+cn._0}}var wn=R._0;if(O.TAG===0){var En=O._0,bn=yn(En);if(bn===void 0)return{TAG:1,_0:'undeclared struct "'+En+'"'};var Tn=Ke({hd:[{TAG:2,_0:{TAG:1,_0:wn}},qe.toPartialStructType(bn,le())],tl:u},e);return Tn.TAG===0?{TAG:0,_0:Tn._0}:{TAG:1,_0:"struct type "+S(o)+" does not match "+En+": "+Tn._0}}var mn=Vn.toMap(O._0),Gn=Vn.toArray(wn);return F(mc(l(Gn,function(x,M,Un){return function(An){var gn=An[0],H=qt(Un,gn);return H!==void 0?{TAG:0,_0:[An[1],H]}:{TAG:1,_0:"struct type "+S(M)+' is missing attribute "'+gn+'" from type "'+S(x)+'"'}}}(o,t,mn)),function(x){return x}),function(x,M,Un,An){return function(gn){var H={TAG:2,_0:{TAG:1,_0:Vn.fromArray(Dr(To(Un,l(An,function(On){return On[0]}))),le())}};return Ke(Go(ut(gn),{hd:[Vn.tail(M),H],tl:x}),e)}}(u,wn,mn,Gn))}break}switch(i){case 1:return F(Aa(t._0,o,e),function(x){return function(M){return Ke(x,M)}}(u));case 2:return{TAG:1,_0:S(o)+" is not unifiable with "+S(t)}}}}function tn(n,e){return Ke({hd:[n,e],tl:0},void 0)}function B_(n){var e;return e=typeof n=="number"?Se:n.TAG===0?oe:pe,st(e)}function z_(n){return n>=5?n>=9?[[0],Cn([{TAG:0,_0:0},{TAG:0,_0:0}],pe)]:st(Cn([oe,oe],pe)):st(Cn([oe,oe],oe))}function P_(n){switch(n){case 0:return st(Cn([oe],oe));case 1:return st(Cn([pe],pe));case 2:return[[0],Cn([ac({TAG:0,_0:0})],{TAG:0,_0:0})]}}function j_(n,e){return"cannot infer struct type: inferred type "+Vn.show(n,S)+" matches "+g(e,", ",function(r){return r.name})}function Gr(n){var e=wo(Br(jn.structs),function(u){return Eo(tn({TAG:2,_0:{TAG:1,_0:n}},qe.toPartialStructType(u,le())),void 0,function(a){return u})});if(e.length!==1)return e.length===0?0:{TAG:1,_0:e};var r=e[0];return{TAG:0,_0:r}}var ka={ambiguousMatchesError:j_,findMatchingStruct:Gr},Ye=Yt();function Fa(n,e,r,u){var a=kn.typeOf(r);ot(Ye,a);var t=pn(e,n,function(i,_){return Xn.addMono(i,_.contents.name,_.contents.ty)}),o=Cn(l(e,function(i){return i.contents.ty}),a);return F(Sn(t,r,a),function(i){var _=G(i,o),f=G(i,u),s=vn(i,n),T=rr(s,_);return K(tn(f,_),function(d){at(Ye);var R=L(d,i);return[R,G(d,f),Qu(d,T)]})})}function Sn(n,e,r){return F(xn(n,e),function(u){return K(tn(G(u,r),G(u,kn.typeOf(e))),function(a){return L(a,u)})})}function xn(n,e){switch(e.TAG|0){case 0:var r=Lt(B_(e._0));return tn(kn.typeOf(e),r);case 1:var u=e._3,a=e._2,t=e._1,o=e._0;return F(xn(n,t),function(c){var E=vn(c,n);return F(xn(E,u),function(m){var A=L(m,c),C=G(A,Cn([kn.typeOf(t),kn.typeOf(u)],o)),$=Lt(z_(a));return K(tn(C,$),function(nn){return L(nn,A)})})});case 2:var i=e._2,_=e._1,f=e._0,s=kn.typeOf(i);return F(xn(n,i),function(c){var E=G(c,Cn([s],f)),m=Lt(P_(_));return K(tn(E,m),function(A){return L(A,c)})});case 3:var T=e._0.contents,d=Xn.get(n,T.name);if(d!==void 0)return tn(T.ty,Lt(d));var R=yn(T.name);if(R===void 0)return{TAG:1,_0:'unbound variable: "'+T.name+'"'};var O={TAG:2,_0:{TAG:1,_0:Vn.fromArray(l(R.staticFuncs,function(c){var E=c.name;return[E.contents.name,E.contents.ty]}),le())}};return tn(T.ty,O);case 4:var I=e._1,on=e._0,cn=hn.typeOfExpr(on),wn=hn.typeOfExpr(I);return F(xn(n,I),function(c){var E=vn(c,n),m=G(c,cn);return F(Sn(E,on,m),function(A){var C=L(A,c),$=G(A,m),nn=G(C,wn);return K(tn($,nn),function(J){return L(J,C)})})});case 5:return K(Fa(n,e._1,e._2,e._0),function(c){return c[0]});case 6:var En=e._4,bn=e._3,Tn=e._0,mn=e._2.contents,Gn=kn.typeOf(bn);return F(xn(n,bn),function(c){var E=vn(c,n),m=G(c,Gn),A=G(c,Tn),C=rr(Xn.remove(E,mn.name),m),$=Xn.add(E,mn.name,C);return F(Sn($,En,A),function(nn){var J=L(nn,c);return K(tn(G(J,Gn),G(J,mn.ty)),function(Fn){return L(Fn,J)})})});case 7:var x=e._4,M=e._3,Un=e._2,An=e._0,gn=e._1.contents,H=kn.typeOf(M);ot(Ye,H);var On=Cn(l(Un,function(c){return c.contents.ty}),H),Mn=pn(Un,n,function(c,E){return Xn.addMono(c,E.contents.name,E.contents.ty)}),fe=Xn.addMono(Mn,gn.name,On);return F(Sn(fe,M,H),function(c){var E=vn(c,fe),m=G(c,On),A=G(c,An),C=Xn.add(E,gn.name,rr(E,m));return F(Sn(C,x,A),function($){var nn=L($,c);return K(tn(gn.ty,G($,m)),function(J){return at(Ye),L(J,nn)})})});case 8:var qn=e._2,ge=l(qn,kn.typeOf),he=Cn(ge,e._0);return K(F(Sn(n,e._1,he),function(c){return pn(Re(qn,ge),{TAG:0,_0:[c,vn(c,n)]},function(E,m){var A=m[1],C=m[0];return F(E,function($){var nn=$[1],J=$[0],Fn=G(J,A);return K(Sn(nn,C,Fn),function(Kn){return[L(Kn,J),vn(Kn,nn)]})})})}),function(c){return c[0]});case 9:var Zn=e._2,ne=e._0;return F(pn(e._1,{TAG:0,_0:[void 0,n]},function(c,E){return F(c,function(m){var A=m[1],C=m[0];return K(q_(A,E),function($){return[L($,C),vn($,A)]})})}),function(c){var E=c[0];return Zn!==void 0?F(xn(vn(E,n),Zn),function(m){var A=kn.typeOf(Zn),C=L(m,E);return K(tn(G(C,ne),G(C,A)),function($){return L($,C)})}):K(tn(G(E,ne),Se),function(m){return L(m,E)})});case 10:var Wn=e._3,Jn=e._2,Qe=e._0;return F(Sn(n,e._1,pe),function(c){var E=vn(c,n),m=G(c,Qe);return F(Sn(E,Jn,m),function(A){var C=vn(A,E),$=G(A,m),nn=L(A,c);return K(Sn(C,Wn,$),function(J){return L(J,nn)})})});case 11:var ht=e._1,ye=kn.typeOf(ht);return F(xn(n,e._0),function(c){var E=G(c,ye),m=vn(c,n);return K(Sn(m,ht,E),function(A){return L(A,c)})});case 12:var Ie=Ve(Ye);return Ie!==void 0?Sn(n,un(e._0,{TAG:0,_0:0},function(c){return c}),Ie):{TAG:1,_0:"'return' used outside of a function"};case 13:return Sn(n,e._0,e._1);case 14:var wt=pn(e._0,{TAG:0,_0:[je,n]},function(c,E){return F(c,function(m){var A=m[1],C=m[0];return F(xn(A,E),function($){var nn=L($,C),J=vn($,A);return{TAG:0,_0:[nn,J]}})})});return K(wt,function(c){return c[0]});case 15:var xe=e._1,we=e._0,Oe=yn(we);if(Oe===void 0)return{TAG:1,_0:'undeclared struct "'+we+'"'};var nt=Oe.attributes,Et=pn(mt(nt,function(c){return me(c.impl)}),{TAG:0,_0:[n,je]},function(c,E){var m=E.ty,A=E.name;return F(c,function(C){var $=C[1],nn=C[0],J=pt(xe,function(Fn){return Fn[0]===A});return J!==void 0?F(Sn(nn,J[1],m),function(Fn){var Kn=vn(Fn,nn),Ne=L(Fn,$);return{TAG:0,_0:[Kn,Ne]}}):{TAG:1,_0:'missing attribute "'+A+'" for struct "'+we+'"'}})}),et=ar(xe,function(c){var E=c[0];if(!Kt(nt,function(m){return m.name===E}))return E});return et!==void 0?{TAG:1,_0:'extraneous attribute: "'+et+'" for struct "'+we+'"'}:K(Et,function(c){return c[1]});case 16:var Fe=e._2,tt=e._1,q=e._0;return F(xn(n,tt),function(c){var E=hn.typeOfExpr(tt),m=G(c,E),A=function(U){return zr(m,G(U,E))?Sn(vn(U,n),e,G(U,q)):{TAG:0,_0:U}};switch(m.TAG|0){case 0:case 1:break;case 2:var C=m._0;if(C.TAG===0){var $=C._0,nn=yn($);if(nn===void 0)return{TAG:1,_0:'undeclared struct: "'+$+'"'};var J=pt(nn.attributes,function(U){return U.name===Fe});if(J===void 0)return{TAG:1,_0:'attribute "'+Fe+'" does not exist on struct "'+$+'"'};var Fn=un(J.impl,J.ty,function(U){return U[0].contents.ty});return K(tn(G(c,q),G(c,Fn)),function(U){return L(U,c)})}var Kn=C._0,Ne=qt(Vn.toMap(Kn),Fe);if(Ne!==void 0)return K(tn(G(c,q),G(c,Ne)),function(U){return L(U,c)});var rt=Vn.insert(Kn,Fe,q),Me=G(c,{TAG:2,_0:{TAG:1,_0:rt}}),X=Gr(rt);if(typeof X!="number")return X.TAG===0?F(tn(m,{TAG:2,_0:{TAG:0,_0:X._0.name}}),function(U){return A(L(U,c))}):F(tn(m,Me),function(U){return A(L(U,c))});var Nn=0;switch(E.TAG|0){case 0:return{TAG:0,_0:L(Vr(je,E._0,Me),c)};case 1:case 2:Nn=2;break}if(Nn===2)return K(tn(E,Me),function(U){return L(U,c)});break}var Dn=le(),_n=Vn.insert(Vn.make({TAG:0,_0:Dn}),Fe,q),Rn=G(c,{TAG:2,_0:{TAG:1,_0:_n}}),Yn=Gr(_n);return typeof Yn=="number"?{TAG:1,_0:"no struct declaration matches type "+S(Rn)}:Yn.TAG===0?F(tn(m,{TAG:2,_0:{TAG:0,_0:Yn._0.name}}),function(U){return A(L(U,c))}):F(tn(m,Rn),function(U){return A(L(U,c))})})}}function q_(n,e){return xn(n,e._0)}function gr(n,e){return n+"_"+e}function Na(n,e){switch(e.TAG|0){case 0:var r=e._0;return K(Fa(n,l(e._1,function(_){return _[0]}),e._2,r.contents.ty),function(_){var f=_[0];return[vn(f,Xn.addMono(n,r.contents.name,r.contents.ty)),f]});case 1:var u=e._0;return K(Sn(n,e._2,u.contents.ty),function(_){return[vn(_,Xn.addMono(n,u.contents.name,u.contents.ty)),_]});case 2:return{TAG:0,_0:[n,je]};case 3:var a=e._0,t=yn(a);return t!==void 0?pn(e._1,{TAG:0,_0:[n,je]},function(_,f){var s=f[2],T=f[1],d=f[0];return F(_,function(R){var O=R[1],I=R[0];d.contents.newName=gr(a,d.contents.name);var on=un(De(T,0),[!1,!1],function(Gn){return Gn[0].contents.name==="self"?[!0,Gn[1]]:[!1,!1]}),cn;if(on[0]){qe.addImplementation(t,d,on[1]);var wn=Bn(T,[])?[]:ho(T,1),En={TAG:2,_0:{TAG:0,_0:a}},bn=De(T,0),Tn;if(bn!==void 0){var mn=bn[0];mn.contents.ty=En,Tn=Xn.addMono(I,mn.contents.name,En)}else Tn=I;cn=[Tn,wn]}else qe.addStaticFunc(t,d),cn=[n,T];return F(Na(cn[0],{TAG:0,_0:d,_1:cn[1],_2:s}),function(Gn){var x=L(Gn[1],O);xu(x,d);var M=Xn.remove(Gn[0],d.contents.name);return{TAG:0,_0:[M,x]}})})}):{TAG:1,_0:'cannot implement for unknown type "'+a+'"'};case 4:var o=e.name,i=Cn(l(e.args,function(_){return _[0].contents.ty}),e.ret);return K(tn(o.contents.ty,i),function(_){return[vn(_,Xn.addMono(n,o.contents.name,o.contents.ty)),_]})}}function Da(n){return go(Ye),pn(n,{TAG:0,_0:[Xn.empty,je]},function(e,r){return F(e,function(u){var a=u[1];return K(Na(u[0],r),function(t){return[t[0],L(t[1],a)]})})})}var He=sn("CompilerExn.InvalidTypeConversion"),hr=sn("CompilerExn.InvalidFunctionSignature"),Xt=sn("CompilerExn.VariableNotFound"),Ra=sn("CompilerExn.EmptyFunctionStack"),$e=sn("CompilerExn.CannotReassignImmutableValue"),La=sn("CompilerExn.FunctionNotFound"),ke=sn("CompilerExn.Unimplemented"),Z_=sn("CompilerExn.UnsupportedGlobalInitializer"),$n=sn("CompilerExn.InvalidTypeAssertion"),Ca=sn("CompilerExn.DerefUsedOutsideOfUnsafeBlock"),$a=sn("CompilerExn.UndeclaredStruct"),Vt=sn("CompilerExn.InvalidAttributeAccess"),Ua=sn("CompilerExn.StructTypeNotMatched"),Oa=sn("CompilerExn.AmibguousStruct");function gt(n){return n.RE_EXN_ID===He?"unsupported type: "+S(n._1):n.RE_EXN_ID===hr?"invalid function signature: "+S(n._1):n.RE_EXN_ID===Xt?'variable "'+n._1+'" not found':n.RE_EXN_ID===Ra?"Function stack is empty":n.RE_EXN_ID===$e?'cannot mutate "'+n._1+'" as it is behind an immutable binding':n.RE_EXN_ID===La?'no function named "'+n._1+'" found':n.RE_EXN_ID===ke?"unimplemented: "+n._1:n.RE_EXN_ID===Z_?"unsupported global initializer: "+kn.show(void 0,n._1):n.RE_EXN_ID===$n?"invalid type assertion from "+S(n._1)+" to "+S(n._2):n.RE_EXN_ID===Ca?"the deref operator can only be used in an unsafe block":n.RE_EXN_ID===ie.UnkownTypeSize?"unknown type size: "+S(n._1):n.RE_EXN_ID===$a?'undeclared struct "'+n._1+'"':n.RE_EXN_ID===Vt?n._1+' does not exist for type "'+S(n._2)+'"':n.RE_EXN_ID===Ua?"No struct declaration matches type "+S(n._1):n.RE_EXN_ID===Oa?ka.ambiguousMatchesError(n._1,n._2):n.RE_EXN_ID===hn.UndeclaredIdentifer?'identifier "'+n._1+'" not found':n.RE_EXN_ID===hn.UnexpectedDeclarationInImplBlock?"unexpected declaration in impl block: "+be.show(void 0,n._1):n.RE_EXN_ID===hn.UnreachableLetStmt?"unreachable: let statement found in Core.fromStmt":"unexpected compiler exception"}function W_(n,e,r,u){return{name:n,depth:e,ty:r,isMutable:u}}function wr(n){if(n.TAG===0){var e=n._0,r=yn(e);if(r!==void 0)return r;throw{RE_EXN_ID:$a,_1:e,Error:new Error}}var u=n._0,a=ka.findMatchingStruct(u);if(typeof a=="number")throw{RE_EXN_ID:Ua,_1:{TAG:2,_0:n},Error:new Error};if(a.TAG===0)return a._0;throw{RE_EXN_ID:Oa,_1:u,_2:a._0,Error:new Error}}function Ue(n){switch(n.TAG|0){case 0:throw{RE_EXN_ID:He,_1:n,Error:new Error};case 1:switch(n._0){case"()":if(n._1.length!==0)throw{RE_EXN_ID:He,_1:n,Error:new Error};return[];case"Fun":case"Ptr":return[0];case"Tuple":return fn(l(n._1,Ue));case"bool":case"u32":break;case"u64":if(n._1.length!==0)throw{RE_EXN_ID:He,_1:n,Error:new Error};return[1];default:throw{RE_EXN_ID:He,_1:n,Error:new Error}}if(n._1.length!==0)throw{RE_EXN_ID:He,_1:n,Error:new Error};return[0];case 2:var e=wr(n._0);return e.size===0?[]:[0]}}function J_(n,e){switch(e.TAG|0){case 1:if(e._0==="Tuple"){var r=fn(l(e._1,Ue)),u=[],a={_0:u,_1:r},t=Pn.getOrAddSignature(n,a);return{TAG:1,_0:t,_1:[[],r]}}break}var o=Ue(e),i=o.length;if(i!==1){if(i===0)return 0;throw{RE_EXN_ID:ke,_1:"wasmBlockReturnTypeOf for "+S(e),Error:new Error}}var _=o[0];return{TAG:0,_0:_}}function Er(n){switch(n.TAG|0){case 1:if(n._0==="Fun"){var e=n._1,r=e.slice(0,e.length-1|0),u=De(e,e.length-1|0);return Pr(_t.Signature.make,fn(l(r,Ue)),un(u,[],Ue))}throw{RE_EXN_ID:hr,_1:n,Error:new Error};case 0:case 2:throw{RE_EXN_ID:hr,_1:n,Error:new Error}}}function mr(n,e,r){return{name:n,locals:[],params:mt(e,function(u){return!ie.isZeroSizedType(u[1])}),ret:r,instructions:[]}}function k(n,e){n.instructions.push(e)}function K_(n,e,r,u,a){return n.locals.push(W_(e,u,r,a)),(n.params.length+n.locals.length|0)-1|0}function Y_(n,e){var r=jt(n.params,function(t){return t[0]===e});if(r!==void 0){var u=Ee(n.params,r);return[r,u[2]]}var a=yu(n.locals,function(t){return t.name===e});if(a!==void 0)return[n.params.length+a|0,Ee(n.locals,a).isMutable]}function H_(n){var e=Er(Cn(l(n.params,function(a){return a[1]}),n.ret)),r=h(_t.Local.fromTypes,fn(l(n.locals,function(a){return l(Ue(a.ty),function(t){return[a.name,t]})}))),u=Pr(_t.Body.make,r,V_(void 0,n.instructions));return _t.make(n.name,e,u)}function Ma(n,e,r,u,a){return{name:n,mutability:e,ty:r,index:u,init:a}}function Q_(n){var e=n.init,r=n.mutability;return y(n.ty,function(u){return ft.make(r!==2,u,e)})}function b(n){var e=Ve(n.funcStack);if(e!==void 0)return e;throw{RE_EXN_ID:Ra,Error:new Error}}function pr(n,e){return y(Iu(n.funcs,function(r){return r.name===e}),function(r){var u=n.externFuncs.length;return[r[0],u+r[1]|0]})}function y_(n,e){return Iu(n.externFuncs,function(r){return r.name===e})}function I_(n,e){var r=Ve(n.blockStack);if(r!==void 0&&!(e<=0)){var u=r.shadowStackDelta;return u.contents=u.contents+e|0,k(b(n),{TAG:9,_0:n.stackTop.index}),k(b(n),{TAG:0,_0:e}),k(b(n),5),k(b(n),{TAG:10,_0:n.stackTop.index})}}function x_(n,e){var r=Ve(n.blockStack);if(r!==void 0&&!(e<=0)){var u=r.shadowStackDelta;return u.contents=u.contents-e|0,k(b(n),{TAG:9,_0:n.stackTop.index}),k(b(n),{TAG:0,_0:e}),k(b(n),4),k(b(n),{TAG:10,_0:n.stackTop.index})}}function Xa(n){var e=Ve(n.blockStack);return e!==void 0?e.isUnsafe:!1}function Va(n,e){return n.scopeDepth=n.scopeDepth+1|0,ot(n.blockStack,{isUnsafe:e||Xa(n),shadowStackDelta:{contents:0}})}function nf(n){n.scopeDepth=n.scopeDepth-1|0,x_(n,un(Ve(n.blockStack),0,function(e){return e.shadowStackDelta.contents})),at(n.blockStack)}function ef(n,e,r,u){var a=b(n),t=K_(a,e,r,n.scopeDepth,u);return k(b(n),{TAG:12,_0:t})}function Ba(n,e,r,u,a){var t=So(n.globals),o=Ma(e,r,u,t,a);return Jt(n.globals,e,o),t}function Bt(n,e){var r=b(n),u=Y_(r,e);return u!==void 0?{TAG:0,_0:u[0],_1:u[1]}:y(Ur(n.globals,e),function(a){return{TAG:1,_0:a.index,_1:a.mutability===1}})}function tf(n){if(typeof n!="number")return n.TAG===0?{TAG:0,_0:n._0}:{TAG:0,_0:n._0?1:0}}function za(n){if(!Xa(n))throw{RE_EXN_ID:Ca,Error:new Error}}function zt(n,e,r){switch(e.TAG|0){case 0:case 1:return{TAG:1,_0:{RE_EXN_ID:Vt,_1:r,_2:e}};case 2:var u=wr(e._0),a=pt(u.attributes,function(i){return i.name===r});if(a===void 0)return{TAG:1,_0:{RE_EXN_ID:Vt,_1:r,_2:e}};var t=a.impl;if(t===void 0)return{TAG:0,_0:{TAG:0,_0:{offset:a.offset,ty:a.ty,size:a.size,mut:a.mut}}};var o=pr(n,gr(u.name,t[0].contents.name));return o!==void 0?{TAG:0,_0:{TAG:1,_0:[o[0],o[1],t[1]]}}:{TAG:1,_0:{RE_EXN_ID:Vt,_1:r,_2:e}}}}function Pa(n){return Qn(void 0,"__lambda"+String(n.funcs.length)+"__")}function Pt(n,e){for(;;){var r=e;switch(r.TAG|0){case 3:var u=r._0,a=Bt(n,u.contents.newName);if(a!==void 0)return a._1?void 0:u.contents.name;throw{RE_EXN_ID:Xt,_1:u.contents.name,Error:new Error};case 16:var t=r._2,o=r._1,i=zt(n,hn.typeOfExpr(o),t);if(i.TAG===0){var _=i._0;if(_.TAG!==0)return;if(!_._0.mut)return t;e=o;continue}throw i._0;default:return}}}function W(n,e){for(;;){var r=e;switch(r.TAG|0){case 0:var u=tf(r._0);return u!==void 0?k(b(n),u):void 0;case 1:var a=r._2,t=r._1;if(ie.isZeroSizedType(hn.typeOfExpr(t))){e={TAG:0,_0:{TAG:1,_0:a===9}};continue}var o;switch(a){case 0:o=4;break;case 1:o=5;break;case 2:o=6;break;case 3:o=7;break;case 4:o=43;break;case 5:o=31;break;case 6:o=19;break;case 7:o=37;break;case 8:o=25;break;case 9:o=10;break;case 10:o=14;break}return W(n,t),W(n,r._3),k(b(n),o);case 2:var i;switch(r._1){case 0:throw{RE_EXN_ID:ke,_1:"u32 negation is not handled",Error:new Error};case 1:i=9;break;case 2:za(n),i={TAG:16,_0:0,_1:0};break}return W(n,r._2),k(b(n),i);case 3:var _=r._0;if(ie.isZeroSizedType(_.contents.ty))return;var f=Bt(n,_.contents.newName);if(f!==void 0)return f.TAG===0?k(b(n),{TAG:11,_0:f._0}):k(b(n),{TAG:9,_0:f._0});throw{RE_EXN_ID:Xt,_1:_.contents.name,Error:new Error};case 4:var s=r._1,T=r._0;if(ie.isZeroSizedType(hn.typeOfExpr(s)))return;switch(T.TAG|0){case 2:if(T._1>=2){za(n),W(n,T._2),W(n,s);var d=ie.sizeLog2(hn.typeOfExpr(s)),R={TAG:17,_0:d,_1:0};return k(b(n),R)}throw{RE_EXN_ID:ke,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error};case 3:var O=T._0,I=Bt(n,O.contents.newName);if(I!==void 0){if(I._1){var on;return on=I.TAG===0?{TAG:12,_0:I._0}:{TAG:10,_0:I._0},W(n,s),k(b(n),on)}throw{RE_EXN_ID:$e,_1:O.contents.name,Error:new Error}}throw{RE_EXN_ID:Xt,_1:O.contents.name,Error:new Error};case 16:var cn=T._2,wn=T._1,En=zt(n,hn.typeOfExpr(wn),cn);if(En.TAG===0){var bn=En._0;if(bn.TAG===0){var Tn=bn._0;if(!Tn.mut)throw{RE_EXN_ID:$e,_1:cn,Error:new Error};var mn=Pt(n,wn);if(mn!==void 0)throw{RE_EXN_ID:$e,_1:mn,Error:new Error};return Tn.size>0?(W(n,wn),W(n,s),k(b(n),{TAG:17,_0:0,_1:Tn.offset})):void 0}throw{RE_EXN_ID:ke,_1:"cannot reassign "+cn+" for type "+S(hn.typeOfExpr(wn)),Error:new Error}}throw En._0;default:throw{RE_EXN_ID:ke,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error}}case 5:var Gn=Pa(n),x=Sr(n,Gn,l(r._1,function(X){return[X,!1]}),r._2);return k(b(n),{TAG:0,_0:x});case 6:var M=r._3,Un=r._2.contents;ie.isZeroSizedType(hn.typeOfExpr(M))||(W(n,M),ef(n,Un.name,Un.ty,r._1)),e=r._4;continue;case 7:var An=Pa(n);r._1.contents.newName=An.contents.name,Sr(n,An,l(r._2,function(X){return[X,!1]}),r._3),e=r._4;continue;case 8:var gn=r._2,H=r._1,On=function(X){return function(Dn){return Ln(X,function(_n){return W(n,_n)}),k(b(n),{TAG:14,_0:Dn})}}(gn),Mn=function(X,Nn){return function(_n){Ln(Nn,function(Za){return W(n,Za)});var Rn=hn.typeOfExpr(X),Yn=Er(Rn),U=Pn.getOrAddSignature(n.mod,Yn);return W(n,X),k(b(n),{TAG:15,_0:U,_1:0})}}(H,gn),fe=function(X){return function(Dn,_n){var Rn=_n!==void 0?Q([_n],X):X;return Ln(Re(Rn,Dn),function(Yn){var U=Yn[1];if(!!(U[2]&&nr(U[1])&&bt(Pt(n,Yn[0]))))throw{RE_EXN_ID:$e,_1:U[0],Error:new Error}})}}(gn);switch(H.TAG|0){case 3:var qn=H._0,ge=Bt(n,qn.contents.newName);if(ge!==void 0)return Mn(void 0);var he=pr(n,qn.contents.newName);if(he!==void 0)return fe(he[0].params,void 0),On(he[1]);var Zn=y_(n,qn.contents.newName);if(Zn!==void 0)return fe(Zn[0].args,void 0),On(Zn[1]);throw{RE_EXN_ID:La,_1:qn.contents.name,Error:new Error};case 16:var ne=H._2,Wn=H._1,Jn;if(Wn.TAG===3){var Qe=Wn._0.contents.name,ht=yn(Qe);if(ht!==void 0){var ye=pr(n,gr(Qe,ne));if(ye!==void 0)Jn=[!1,ye[0],ye[1]];else throw{RE_EXN_ID:ke,_1:'static function "'+ne+'" does not exists on struct '+Qe,Error:new Error}}else Jn=[!0,void 0,void 0]}else Jn=[!0,void 0,void 0];var Ie=Jn[2],wt=Jn[1],xe=Jn[0],we;if(wt!==void 0)we=wt;else{var Oe=zt(n,hn.typeOfExpr(Wn),ne);if(Oe.TAG===0){var nt=Oe._0;we=nt.TAG===0?void 0:nt._0[0]}else throw Oe._0}return un(we,void 0,function(X,Nn){return function(Dn){var _n=Nn?X:void 0;return fe(Dn.params,_n)}}(Wn,xe)),xe&&W(n,Wn),Ie!==void 0?On(Ie):Mn(void 0);default:return Mn(void 0)}case 9:var Et=r._2;return Va(n,r._3===1),Ln(r._1,function(X){return rf(n,X)}),Et!==void 0&&W(n,Et),nf(n);case 10:var et=r._3,Fe=J_(n.mod,r._0);return W(n,r._1),k(b(n),{TAG:4,_0:Fe}),W(n,r._2),zr(et,{TAG:0,_0:0})&&(k(b(n),0),W(n,et)),k(b(n),1);case 11:return k(b(n),{TAG:7,_0:0}),k(b(n),{TAG:8,_0:0}),W(n,r._0),k(b(n),9),k(b(n),{TAG:5,_0:1}),W(n,r._1),k(b(n),{TAG:6,_0:0}),k(b(n),1),k(b(n),1);case 12:var tt=r._0;return tt!==void 0&&W(n,tt),k(b(n),2);case 13:var q=r._2,c=r._1;if(!Bn(c,q))switch(c.TAG|0){case 1:switch(c._0){case"Ptr":var E=c._1;if(E.length!==1)throw{RE_EXN_ID:$n,_1:c,_2:q,Error:new Error};var m=E[0];switch(m.TAG|0){case 1:if(m._0==="u32"){if(m._1.length!==0)throw{RE_EXN_ID:$n,_1:c,_2:q,Error:new Error};switch(q.TAG|0){case 1:if(q._0==="u32"){if(q._1.length!==0)throw{RE_EXN_ID:$n,_1:c,_2:q,Error:new Error}}else throw{RE_EXN_ID:$n,_1:c,_2:q,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:$n,_1:c,_2:q,Error:new Error}}}else throw{RE_EXN_ID:$n,_1:c,_2:q,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:$n,_1:c,_2:q,Error:new Error}}break;case"u32":if(c._1.length!==0)throw{RE_EXN_ID:$n,_1:c,_2:q,Error:new Error};switch(q.TAG|0){case 1:if(q._0==="Ptr"){if(q._1.length!==1)throw{RE_EXN_ID:$n,_1:c,_2:q,Error:new Error}}else throw{RE_EXN_ID:$n,_1:c,_2:q,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:$n,_1:c,_2:q,Error:new Error}}break;default:throw{RE_EXN_ID:$n,_1:c,_2:q,Error:new Error}}break;case 0:case 2:throw{RE_EXN_ID:$n,_1:c,_2:q,Error:new Error}}e=r._0;continue;case 14:return Ln(r._0,function(X){return W(n,X)});case 15:var A=r._1,C=Xr(yn(r._0)),$=C.size;I_(n,$),Ln(Re(C.attributes,A),function(X){var Nn=X[0],Dn=Nn.ty;if(Nn.mut&&nr(Dn)){var _n=Pt(n,X[1][1]);if(_n!==void 0)throw{RE_EXN_ID:$e,_1:_n,Error:new Error}}if(me(Nn.impl)&&ie.size(Dn)>0)return k(b(n),{TAG:9,_0:n.stackTop.index})}),$>0&&k(b(n),{TAG:9,_0:n.stackTop.index});var nn={contents:0};return Ln(A,function(X){return function(Nn){var Dn=Nn[1],_n=function(U){W(n,Dn),k(b(n),{TAG:17,_0:0,_1:X.contents}),X.contents=X.contents+U|0},Rn=kn.typeOf(Dn);switch(Rn.TAG|0){case 0:break;case 1:var Yn=0;switch(Rn._0){case"()":if(Rn._1.length===0)return;break;case"Fun":return _n(4);case"Ptr":if(Rn._1.length===1)return _n(4);break;case"bool":case"u32":Yn=2;break}if(Yn===2&&Rn._1.length===0)return _n(4);break;case 2:return wr(Rn._0),_n(4)}throw{RE_EXN_ID:ke,_1:"cannot store "+S(Rn)+" in the shadow stack",Error:new Error}}}(nn));case 16:var J=r._1,Fn=zt(n,hn.typeOfExpr(J),r._2);if(Fn.TAG===0){var Kn=Fn._0;if(Kn.TAG===0){var Ne=Kn._0;return ie.isZeroSizedType(Ne.ty)?void 0:(W(n,J),k(b(n),{TAG:16,_0:0,_1:Ne.offset}))}var rt=Kn._0;if(rt[2]){var Me=Pt(n,J);if(Me!==void 0)throw{RE_EXN_ID:$e,_1:Me,Error:new Error}}return k(b(n),{TAG:0,_0:rt[1]})}throw Fn._0}}}function rf(n,e){var r=e._0;return W(n,r),Ln(Ue(kn.typeOf(r)),function(u){return k(b(n),3)})}function Sr(n,e,r,u){var a=l(r,function(i){var _=i[0];return[_.contents.name,_.contents.ty,i[1]||!nr(_.contents.ty)]}),t=mr(e.contents.newName,a,kn.typeOf(u)),o=n.funcs.push(t)-1|0;return ot(n.funcStack,t),W(n,u),k(b(n),1),at(n.funcStack),o}function uf(n,e){var r=mr("__isolated__",[],hn.typeOfExpr(e));return ot(n.funcStack,r),W(n,e),at(n.funcStack),r}function ja(n,e){switch(e.TAG|0){case 0:Sr(n,e._0,e._1,e._2);return;case 1:var r=e._1,u=e._0;Va(n,!1);var a=uf(n,e._2),t=a.instructions;if(t.length===1){var o=t[0];if(typeof o!="number"&&o.TAG===0){Ba(n,u.contents.name,r?1:2,0,h(ft.Initializer.fromInstructions,[{TAG:0,_0:o._0}]));return}}po(n.globalsInitializer.instructions,"push",[t]);var i=Ba(n,u.contents.name,r?1:0,0,h(ft.Initializer.fromInstructions,[{TAG:0,_0:0}]));n.globalsInitializer.instructions.push({TAG:10,_0:i});return;case 2:return;case 3:return Ln(e._1,function(T){return ja(n,{TAG:0,_0:T[0],_1:T[1],_2:T[2]})});case 4:var _=e.name,f=Er(_.contents.ty),s=Pn.getOrAddSignature(n.mod,f);Pn.addImport(n.mod,Uu.make("index",_.contents.name,{_0:s})),n.externFuncs.push({name:_.contents.name,args:l(e.args,function(T){var d=T[0];return[d.contents.name,d.contents.ty,T[1]]}),ret:e.ret});return}}function af(n){var e={mod:Pn.make(void 0),funcs:[],scopeDepth:0,funcStack:Yt(),globals:$r(1),globalsInitializer:mr("__initGlobals__",[],Se),stackTop:Ma("__STACK_TOP__",1,0,0,h(ft.Initializer.fromInstructions,[{TAG:0,_0:65535}])),blockStack:Yt(),externFuncs:[]};Jt(e.globals,e.stackTop.name,e.stackTop);try{Ln(n,function(o){return ja(e,o)}),Pn.addMemory(e.mod,ku.make(It.make(6,void 0))),Ln(mo(Br(e.globals),function(o,i){return o.index-i.index|0}),function(o){var i=Q_(o);if(i!==void 0)return Pn.addGlobal(e.mod,i)});var r=Gu.fromFuncRefs(0,kr(e.funcs,function(o,i){return o}));Pn.addElement(e.mod,r),Pn.addTable(e.mod,su.make(0,It.makeExact(e.funcs.length)));var u=e.funcs.length,a=e.globalsInitializer.instructions.length===0;return a||(e.globalsInitializer.instructions.push(1),e.funcs.push(e.globalsInitializer)),Ln(e.funcs,function(o){o.name==="main"&&!a&&o.instructions.unshift({TAG:14,_0:u});var i=H_(o);Pn.addExportedFunc(e.mod,o.name,i[1],i[2])}),{TAG:0,_0:e.mod}}catch(o){var t=it(o);return{TAG:1,_0:gt(t)}}}function of(n){try{return F(Mt(n),function(r){var u=l(r,be.from);return F(Da(u),function(a){var t=a[1];na(t);var o=l(u,function(i){return be.subst(t,i)});return K(af(o),function(i){var _=Pn.encodeAsUint8Array(i);return[i,_]})})})}catch(r){var e=it(r);return{TAG:1,_0:gt(e)}}}function cf(n){try{var e=Mt(n);return e.TAG===0?{TAG:0,_0:g(e._0,`

`,function(u){return wc.show(u)})}:{TAG:1,_0:e._0}}catch(u){var r=it(u);return{TAG:1,_0:gt(r)}}}function _f(n){try{var e=Mt(n);if(e.TAG!==0)return{TAG:1,_0:e._0};var r=l(e._0,be.from);return{TAG:0,_0:g(r,`

`,function(a){return be.show(void 0,a)})}}catch(a){var u=it(a);return{TAG:1,_0:gt(u)}}}function ff(n){try{var e=Mt(n);if(e.TAG!==0)return{TAG:1,_0:e._0};var r=l(e._0,be.from),u=Da(r);if(u.TAG!==0)return{TAG:1,_0:u._0};var a=u._0[1];na(a);var t=l(r,function(i){return be.subst(a,i)});return{TAG:0,_0:g(t,`

`,function(i){return be.show(void 0,i)})}}catch(i){var o=it(i);return{TAG:1,_0:gt(o)}}}var sf={debugAst:cf,debugCoreAst:_f,debugTypes:ff},lf=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",compile:of,Debug:sf});const D={"0":"I32","1":"I64","2":"F32","3":"F64"},br={"0":"Else","1":"End","2":"Return","3":"Drop","4":"AddI32","5":"SubI32","6":"MulI32","7":"DivI32Unsigned","8":"DivI32Signed","9":"EqzI32","10":"EqI32","11":"EqI64","12":"EqF32","13":"EqF64","14":"NeI32","15":"NeI64","16":"NeF32","17":"NeF64","18":"LeI32Signed","19":"LeI32Unsigned","20":"LeI64Signed","21":"LeI64Unsigned","22":"LeF32","23":"LeF64","24":"GeI32Signed","25":"GeI32Unsigned","26":"GeI64Signed","27":"GeI64Unsigned","28":"GeF32","29":"GeF64","30":"LtI32Signed","31":"LtI32Unsigned","32":"LtI64Signed","33":"LtI64Unsigned","34":"LtF32","35":"LtF64","36":"GtI32Signed","37":"GtI32Unsigned","38":"GtI64Signed","39":"GtI64Unsigned","40":"GtF32","41":"GtF64","42":"RemI32Signed","43":"RemI32Unsigned","44":"And"},vf={"0":"FuncRef","1":"ExternRef"},df={"0":"Func","1":"Table","2":"Memory","3":"Global"},Ge={"0":"Void"},Tf=lf,qa=function(n){const e=Tf.compile(n);return e.TAG===0?{tag:"Ok",value:[{typeSection:e._0[0].typeSection.map(function(u){return[u._0.map(function(t){return D[t]}),u._1.map(function(t){return D[t]})]}),importSection:e._0[0].importSection.map(function(u){return{moduleName:u.moduleName,entityName:u.entityName,desc:{tag:"Func",value:u.desc._0}}}),funcSection:e._0[0].funcSection,tableSection:e._0[0].tableSection.map(function(u){return[vf[u[0]],u[1]]}),memorySection:e._0[0].memorySection,globalSection:e._0[0].globalSection.map(function(u){return[D[u[0]],u[1],u[2].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:{tag:"StoreI32",value:[t._0,t._1]}:br[t]})]}),exportSection:e._0[0].exportSection.map(function(u){return{name:u.name,kind:df[u.kind],index:u.index}}),elementSection:e._0[0].elementSection,codeSection:e._0[0].codeSection.map(function(u){return[u[0].map(function(t){return[t[0],D[t[1]]]}),u[1].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:{tag:"StoreI32",value:[t._0,t._1]}:br[t]})]}),funcs:e._0[0].funcs.map(function(u){return[u[0],[u[1]._0.map(function(t){return D[t]}),u[1]._1.map(function(t){return D[t]})],[u[2][0].map(function(t){return[t[0],D[t[1]]]}),u[2][1].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:{tag:"StoreI32",value:[t._0,t._1]}:br[t]})]]})},e._0[1]]}:{tag:"Error",value:e._0}};var Gf=`
let SIZEOF_U32 = 4;

struct Array {
  start: Ptr<u32>,
  mut length: u32,
}

impl Array {
  fn read(self, n) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>)
  }

  fn write(self, n, val) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>) = val;
  }

  fn push(mut self, val) {
    self.write(self.length, val);
    self.length = self.length + 1;
  }
}

struct Sieve {
  mut primes: Array,
  mut current: u32
}

impl Sieve {
  fn clear(mut self) {
    self.primes.length = 0;
    // 2 is the first prime
    self.primes.push(2);
    self.current = 1;
  }

  fn isPrime(mut self, n) {
    mut i = 0;
    mut p = self.primes.read(i);

    while p * p <= n {
      if n % p == 0 { return false; }
      i = i + 1;
      p = self.primes.read(i);
    }

    // n is prime
    // add it to the sieve
    self.primes.push(n);

    true
  }

  fn nextPrime(mut self) {
    self.current = self.current + 2;

    while !self.isPrime(self.current) {
      self.current = self.current + 2;
    }

    self.current
  }

  // count the prime numbers <= m
  fn countUpTo(mut self, m) {
    self.clear();

    while self.current <= m {
      self.nextPrime();
    }

    self.primes.length - 1
  }
}

// right after the shadow stack
let PRIMES_START = 64 * 1024;

fn main() {
  mut sieve = Sieve {
    primes: Array {
      start: PRIMES_START as Ptr<u32>,
      length: 0
    },
    current: 0
  };

  sieve.countUpTo(1000000)
}`,gf=`
fn fact(n) {
  let aux = (n, acc) -> if n == 0 { acc } else { aux(n - 1, n * acc) };
  aux(n, 1)
}

fn main() {
  fact(11)
}`,hf=`
fn fib(n) {
  let fib_aux = (n, a, b) -> {
    if n == 0 { return a; }
    if n == 1 { return b; }
    fib_aux(n - 1, b, a + b)
  };

  fib_aux(n, 0, 1)
}

fn main() {
  fib(83)
}`,wf=`
let SIZEOF_U32 = 4;

fn read_u32(addr) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>)
}

fn write_u32(addr, val) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>) = val;
}

fn main() {
  let square = n -> n * n;

  mut i = 0;
  while i < 100 {
    write_u32(i, square(i));
    i = i + 1;
  }

  read_u32(42) // 1764
}`,Ef=`
fn isEven(n) {
  n % 2 == 0
}

fn isPrime(n) {
  if n < 2 { return false; }
  if n == 2 { return true; }
  if isEven(n) { return false; }

  mut i = 3;

  while i * i <= n {
    if n % i == 0 { return false; }
    i = i + 2;
  }

  true
}

fn countPrimesLessThan(m) {
  mut i = m;
  mut count = 0;

  while i > 1 {
    if isPrime(i) {
      count = count + 1;
    }

    i = i - 1;
  }

  count
}

fn main() {
  countPrimesLessThan(1000000)
}`,mf=`
struct MinMax {
  mut min: u32,
  mut max: u32
}

impl MinMax {
  fn reset(mut self) {
    self.min = 0;
    self.max = 0;
  }

  fn resetStatic(mut m) {
    m.reset();
  }
}

fn main() {
  mut m = MinMax {
    min: 17,
    max: 22
  };

  MinMax.resetStatic(m);
  
  m.min + m.max == 0
}`,pf=`
fn main() {
  let twice = (f, x) -> f(f(x));
  
  twice(n -> n * n, 7)
}`,Sf=`
struct BumpAllocator {
  mut head: u32
}

impl BumpAllocator {
  fn allocate(mut self, bytes) {
    let addr = self.head as Ptr<u32>;
    self.head = self.head + bytes;
    addr
  }
  
  // do nothing!
  fn free(mut self, addr) { }
}

mut allocator = BumpAllocator { head: 64 * 1024 };

let SIZEOF_U32 = 4;

struct Vec {
  mut start: Ptr<u32>,
  mut length: u32,
  mut capacity: u32 
}

impl Vec {
  fn read(self, index) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>)
  }

  fn write(mut self, index, value) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>) = value;
  }

  fn grow(mut self) unsafe {
    let newCap = if self.capacity == 0 { 8 } else { self.capacity * 2 };
    let newStart = allocator.allocate(newCap * SIZEOF_U32);

    // copy the data from the old array to the new one
    mut i = 0;
    while i < self.length {
      *(((newStart as u32) + (i * SIZEOF_U32)) as Ptr<u32>) = self.read(i);
      i = i + 1;
    }

    allocator.free(self.start);
    self.start = newStart;
    self.capacity = newCap;
  }

  fn push(mut self, val) unsafe {
    if self.length + 1 > self.capacity {
      self.grow();
    }

    self.write(self.length, val);
    self.length = self.length + 1;
  }

  fn pop(mut self) unsafe {
    if self.length > 0 {
      self.length = self.length - 1;
      self.read(self.length)
    } else {
      // until we have Option<T>
      4294967295 // -1
    }
  }
}

fn main() {
  mut vec = Vec {
    start: 0 as Ptr<u32>,
    length: 0,
    capacity: 0
  };

  mut i = 0;
  while i < 1000 {
    vec.push(i);
    i = i + 1;
  }

  (vec.length, vec.capacity, vec.read(723))
}`,bf=`
fn digitsSquareSum(n) {
  let square = n -> n * n;
  mut sum = 0;

  while n > 0 {
    sum = sum + square(n % 10);
    n = n / 10;
  }

  sum
}

fn reaches89(n) {
  while n != 1 {
    if n == 89 { return true; }
    n = digitsSquareSum(n);
  }

  false
}

fn main() {
  mut i = 1;
  mut count = 0;
  while i < 10000000 {
    if reaches89(i) {
      count = count + 1;
    }

    i = i + 1;
  }

  count
}`,Af=`
extern fn log(n: u32) -> ();

fn main() {
  mut i = 0;
  
  while i <= 10 {
    log(i);
    i = i + 1;
  }
}`;const kf={"Prime sieve":Gf,Factorial:gf,Fibonacci:hf,Pointers:wf,Primes:Ef,Structs:mf,"Lambda (kind of)":pf,Vector:Sf,"Project Euler 92":bf,"External functions":Af},Ff=async n=>{const e=await WebAssembly.compile(n),r=await WebAssembly.instantiate(e,{index:{log:console.log}});return"main"in r.exports?r.exports.main():"Error: main function not found, exported functions are: "+Object.keys(r.exports).join(", ")},Nf={Run:async(n,e)=>{e("running...");try{const r=qa(n);if(r.tag==="Ok"){const u=await Ff(r.value[1]);e(`${u}`)}else e(r.value)}catch(r){e(`${r}`)}},Disassemble:(n,e)=>{try{const r=qa(n);if(r.tag==="Ok"){const[u]=r.value;e(Ki(u))}else e(r.value)}catch(r){e(`${r}`)}}},Df=()=>At.createElement(bo,{actions:Nf,samples:kf,aceMode:"rust"});Ao.render(At.createElement(At.StrictMode,null,At.createElement(Df,null)),document.getElementById("root"));
