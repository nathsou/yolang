import{c as nn,a as fn,j as w,r as ja,m as un,g as Ne,b as Xt,d as l,z as De,e as mr,f as rt,t as Me,h as qa,i as pr,k as Bn,l as Sr,_ as g,s as br,n as Za,o as Wa,p as Vt,q as Ar,u as kr,v as Bt,w as we,x as sn,y as pn,A as Ja,B as Ka,C as Fr,D as zt,E as Ya,F as Ha,G as Qa,H as ya,I as Ia,J as xa,K as no,L as Nr,M as me,N as j,O as ee,P as Q,Q as eo,R as Dr,S as Ln,T as to,U as Pt,V as Rr,W as ro,X as Hn,Y as uo,Z as ao,$ as te,a0 as Lr,a1 as ht,a2 as jt,a3 as $r,a4 as Cr,a5 as oo,a6 as Et,a7 as io,a8 as wt,a9 as co,aa as _o,ab as fo,ac as F,ad as so,ae as lo,af as Ur,ag as qt,ah as vo,ai as K,aj as To,ak as ut,al as Go,am as Or,an as Zt,ao as at,ap as Xe,aq as go,ar as Mr,as as ho,at as Xr,au as Vr,av as Eo,aw as wo,ax as mt,ay as mo,az as po}from"./vendor.386958ae.js";const So=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))u(a);new MutationObserver(a=>{for(const t of a)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const t={};return a.integrity&&(t.integrity=a.integrity),a.referrerpolicy&&(t.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?t.credentials="include":a.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function u(a){if(a.ep)return;a.ep=!0;const t=r(a);fetch(a.href,t)}};So();function ln(n){var e=[],r=function(u){for(;;){var a=u,t=a&127,o=a>>>7;if(o!==0){e.push(t|128),u=o;continue}e.push(t);return}};return r(n),e}function Br(n){var e=[],r=function(u){for(;;){var a=u,t=a&127,o=a>>7;if(o===0&&(t&64)==0||o===-1&&(t&64)!=0){e.push(t);return}e.push(t|128),u=o}};return r(n|0),e}function ot(n){return nn(ln(n.length),n)}function zn(n){return nn(ln(n.length),fn(n))}var bo={encode:ot,encodeMany:zn};function zr(n){var e=new DataView(new ArrayBuffer(4));return e.setFloat32(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3)]}var Ao={encode:zr};function Pr(n){var e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3),e.getUint8(4),e.getUint8(5),e.getUint8(6),e.getUint8(7)]}var ko={encode:Pr};function Fo(n){return n}function re(n,e){return nn([n],ot(e))}function ue(n){var e;switch(n){case 0:e="custom";break;case 1:e="type";break;case 2:e="import";break;case 3:e="function";break;case 4:e="table";break;case 5:e="memory";break;case 6:e="global";break;case 7:e="export";break;case 8:e="start";break;case 9:e="element";break;case 10:e="code";break;case 11:e="data";break}return"["+e+"]"}var No={id:Fo,encode:re,show:ue};function Ve(n){switch(n){case 0:return 127;case 1:return 126;case 2:return 125;case 3:return 124}}function Be(n){switch(n){case 0:return"i32";case 1:return"i64";case 2:return"f32";case 3:return"f64"}}var Do={encode:Ve,show:Be};function jr(n){return typeof n=="number"?[64]:n.TAG===0?[Ve(n._0)]:ln(n._0)}function Ro(n){return typeof n=="number"?"void":n.TAG===0?Be(n._0):"type "+String(n._0)}var Lo={encode:jr,show:Ro};function Wt(n){if(typeof n=="number")switch(n){case 0:return[5,"else"];case 1:return[11,"end"];case 2:return[15,"return"];case 3:return[26,"drop"];case 4:return[106,"i32.add"];case 5:return[107,"i32.sub"];case 6:return[108,"i32.mul"];case 7:return[110,"i32.div_s"];case 8:return[109,"i32.div_u"];case 9:return[69,"i32.eqz"];case 10:return[70,"i32.eq"];case 11:return[81,"i64.eq"];case 12:return[91,"f32.eq"];case 13:return[97,"f64.eq"];case 14:return[71,"i32.ne"];case 15:return[82,"i64.ne"];case 16:return[92,"f32.ne"];case 17:return[98,"f64.ne"];case 18:return[76,"i32.le_s"];case 19:return[77,"i32.le_u"];case 20:return[87,"i64.le_s"];case 21:return[88,"i64.le_u"];case 22:return[95,"f32.le"];case 23:return[101,"f64.le"];case 24:return[78,"i32.ge_s"];case 25:return[79,"i32.ge_u"];case 26:return[89,"i64.ge_s"];case 27:return[90,"i64.ge_u"];case 28:return[96,"f32.ge"];case 29:return[102,"f64.ge"];case 30:return[72,"i32.lt_s"];case 31:return[73,"i32.lt_u"];case 32:return[83,"i64.lt_s"];case 33:return[84,"i64.lt_u"];case 34:return[93,"f32.lt"];case 35:return[99,"f64.lt"];case 36:return[74,"i32.gt_s"];case 37:return[75,"i32.gt_u"];case 38:return[85,"i64.gt_s"];case 39:return[86,"i64.gt_u"];case 40:return[94,"f32.gt"];case 41:return[100,"f64.gt"];case 42:return[111,"i32.rem_s"];case 43:return[112,"i32.rem_u"];case 44:return[113,"i32.and"]}else switch(n.TAG|0){case 0:return[65,"i32.const "+String(n._0)];case 1:return[66,"i64.const "+String(n._0)];case 2:return[67,"i64.const "+String(n._0)];case 3:return[68,"i64.const "+String(n._0)];case 4:return[4,"if"];case 5:return[13,"br_if "+String(n._0)];case 6:return[12,"br "+String(n._0)];case 7:return[2,"block"];case 8:return[3,"loop"];case 9:return[35,"global.get "+String(n._0)];case 10:return[36,"global.set "+String(n._0)];case 11:return[32,"local.get "+String(n._0)];case 12:return[33,"local.set "+String(n._0)];case 13:return[34,"local.tee "+String(n._0)];case 14:return[16,"call "+String(n._0)];case 15:return[17,"call_indirect [typeIndex="+String(n._0)+", tableIndex="+String(n._1)+"]"];case 16:return[40,"i32.load (alignment="+String(n._0)+", offset="+String(n._1)+")"];case 17:return[54,"i32.store (alignment="+String(n._0)+", offset="+String(n._1)+")"]}}function ae(n){return Wt(n)[0]}function qr(n){if(typeof n=="number")switch(n){case 0:case 1:return-1;default:return 0}else switch(n.TAG|0){case 4:case 7:case 8:return 1;default:return 0}}function pt(n,e,r,u){var a=n!==void 0?n:{contents:0},t=Wt(e),o=qr(e),i=w(ja(0,a.contents+(o<0?o:0)|0),"  ",function(s){return""});a.contents=a.contents+o|0,e===0&&(a.contents=a.contents+1|0);var _,f=0;if(typeof e=="number")_="";else switch(e.TAG|0){case 11:case 12:case 13:f=1;break;case 14:_="<"+un(Ne(r,e._0),"??",function(s){return s})+">";break;default:_=""}return f===1&&(_="<"+un(Ne(u,e._0),"??",function(s){return s})+">"),i+t[1]+" "+_}function ze(n){var e=0;if(typeof n=="number")return[ae(n)];switch(n.TAG|0){case 0:case 1:e=1;break;case 2:return nn([ae(n)],zr(n._0));case 3:return nn([ae(n)],Pr(n._0));case 5:case 6:e=3;break;case 4:case 7:case 8:e=2;break;case 9:case 10:case 11:case 12:case 13:e=4;break;case 14:return nn([ae(n)],ln(n._0));case 15:return fn([[ae(n)],ln(n._0),ln(n._1)]);case 16:case 17:e=5;break}switch(e){case 1:return nn([ae(n)],Br(n._0));case 2:return nn([ae(n)],jr(n._0));case 3:case 4:return nn([ae(n)],ln(n._0));case 5:return fn([[ae(n)],ln(n._0),ln(n._1)])}}var $o={info:Wt,opcode:ae,identationDelta:qr,show:pt,encode:ze};function Co(n,e){return{_0:n,_1:e}}var Uo=[],Oo=[],Mo={_0:Uo,_1:Oo};function Zr(n){return fn([[96],ot(l(n._0,Ve)),ot(l(n._1,Ve))])}function Wr(n){var e=n._1,r=n._0,u=w(r,", ",Be),a=w(e,", ",Be);if(r.length===1){var t=e.length;if(t===1)return u+" -> "+a;if(t===0)return u+" -> ()"}var o=e.length;return o!==1?o!==0?"("+u+") -> ("+a+")":"("+u+") -> ()":"("+u+") -> "+a}var Xo={funcTypeCode:96,make:Co,empty:Mo,encode:Zr,show:Wr};function Vo(n){var e=function(u,a){for(;;){var t=a,o=u;if(!o)return t;var i=o.tl,_=o.hd,f=_[1],s=_[0];if(t){var T=t.tl,d=t.hd,R=d[1],M=d[0];if(Bn(f,R)){a={hd:[{hd:s,tl:M},R],tl:T},u=i;continue}a={hd:[{hd:s,tl:0},f],tl:{hd:[M,R],tl:T}},u=i;continue}a={hd:[{hd:s,tl:0},f],tl:0},u=i}},r=mr(e(rt(n),0));return Me(qa(r,function(u){return[Sr(Me(u[0])),u[1]]}))}function Jr(n){return nn(ln(n[0].length),[Ve(n[1])])}function Kr(n){return"local ["+w(n[0],", ",function(e){return e})+"] "+Be(n[1])}var Bo={fromTypes:Vo,encode:Jr,show:Kr};function zo(n,e){return[n,e]}function Yr(n){var e=zn(l(n[0],Jr)),r=fn(l(n[1],ze));return fn([[e.length+r.length|0],e,r])}function Hr(n,e,r){var u=n[0],a={contents:1},t=pr(r._0,function(f,s){return"param["+String(f)+"]"}),o=nn(t,fn(l(u,function(f){return f[0]}))),i=w(u,`
`,Kr),_=w(n[1],`
`,function(f){return pt(a,f,e,o)});return u.length===0?_:i+`
`+_}var Po={make:zo,encode:Yr,show:Hr};function jo(n,e,r){return[n,e,r]}var it={Signature:Xo,Local:Bo,Body:Po,make:jo};function qo(n){return[]}function Jt(n,e){var r=Xt(n,function(u){return Bn(u,e)});return r!==void 0?r:(n.push(e),n.length-1|0)}function Qr(n){return re(1,zn(l(n,Zr)))}function yr(n){return ue(1)+`
`+w(n,`
`,Wr)}var Zo={make:qo,getOrAdd:Jt,encode:Qr,show:yr};function Wo(n){return[]}function Ir(n,e){return n.push(e),n.length-1|0}function xr(n){return re(3,zn(l(n,ln)))}function nu(n,e){return ue(3)+`
`+w(De(n,e),`
`,function(r){return r[1]+": "+String(r[0])})}var Jo={make:Wo,addSignature:Ir,encode:xr,show:nu};function Ko(n){return[]}function eu(n,e){return n.push(e),n.length-1|0}function tu(n){return re(10,zn(l(n,Yr)))}function ru(n,e){var r=l(e,function(u){return u[0]});return ue(10)+`
`+w(De(n,e),`

`,function(u){var a=u[1];return a[0]+`
`+Hr(u[0],r,a[1])})}var Yo={make:Ko,addFunc:eu,encode:tu,show:ru};function St(n){return ot(l(n.split(""),function(e){return e.charCodeAt(0)|0}))}var Ho={encode:St};function Qo(n){return[n]}function uu(n){switch(n){case 0:return"func";case 1:return"table";case 2:return"memory";case 3:return"global"}}var yo={encode:Qo,show:uu};function Io(n,e,r){return{name:n,kind:e,index:r}}function au(n){return fn([St(n.name),[n.kind],ln(n.index)])}function ou(n){return"export "+uu(n.kind)+" "+n.name+" (index: "+String(n.index)+")"}var xo={ExternalKind:yo,make:Io,encode:au,show:ou};function ni(n){return[]}function ei(n,e){n.push(e)}function iu(n){return re(7,zn(l(n,au)))}function cu(n){return ue(7)+`
`+w(n,`
`,ou)}var ti={make:ni,add:ei,encode:iu,show:cu};function ri(n){return n?"externref":"funcref"}function ui(n){return n?111:112}var ai={show:ri,encode:ui};function Kt(n){return"{ min: "+String(n[0])+", max: "+un(n[1],"?",function(e){return String(e)})+" }"}function oi(n,e){return[n,e]}function ii(n){return[n,n]}function bt(n){var e=n[1],r=n[0];return e!==void 0?fn([[1],ln(r),ln(e)]):nn([0],ln(r))}var Yt={show:Kt,make:oi,makeExact:ii,encode:bt};function ci(n,e){return[n,e]}function _u(n){return nn([n[0]?111:112],bt(n[1]))}function fu(n){return"table "+(n[0]?"externref":"funcref")+" "+Kt(n[1])}var su={make:ci,encode:_u,show:fu};function _i(n){return[]}function fi(n,e){n.push(e)}function lu(n){return ue(4)+`
`+w(n,`
`,fu)}function vu(n){return re(4,zn(l(n,_u)))}var si={make:_i,add:fi,show:lu,encode:vu};function li(n,e){var r=n!==void 0?n:0;return{offset:r,funcIndices:e}}function du(n){return"elem funcref ("+w(n.funcIndices," ",function(e){return String(e)})+") (offset="+String(n.offset)+")"}function Tu(n){return fn([[0],ze({TAG:0,_0:n.offset}),ze(1),zn(l(n.funcIndices,ln))])}var Gu={fromFuncRefs:li,show:du,encode:Tu};function vi(n){return[]}function di(n,e){n.push(e)}function gu(n){return ue(9)+`
`+w(n,`
`,du)}function hu(n){return re(9,zn(l(n,Tu)))}var Ti={make:vi,add:di,show:gu,encode:hu};function Gi(n){return n}function Eu(n){return nn(fn(l(n,ze)),ze(1))}function wu(n){if(n.length!==1)return`
`+w(n,`
`,function(r){return"  "+pt(void 0,r,[],[])})+`
end`;var e=n[0];return pt(void 0,e,[],[])}var gi={fromInstructions:Gi,encode:Eu,show:wu};function hi(n,e,r){return[e,n,r]}function mu(n){return"global "+(n[1]?"mutable":"immutable")+" "+Be(n[0])+" = "+wu(n[2])}function pu(n){return nn([Ve(n[0]),n[1]?1:0],Eu(n[2]))}var ct={Initializer:gi,make:hi,show:mu,encode:pu};function Ei(n){return[]}function wi(n,e){n.push(e)}function Su(n){return ue(6)+`
`+w(n,`
`,mu)}function bu(n){return re(6,zn(l(n,pu)))}var mi={make:Ei,add:wi,show:Su,encode:bu};function pi(n){return n}function Au(n){return"memory "+Kt(n)}var ku={make:pi,show:Au,encode:bt};function Si(n){return[]}function Fu(n,e){return n.push(e)-1|0}function Nu(n){return ue(5)+`
`+w(n,`
`,Au)}function Du(n){return re(5,zn(l(n,bt)))}var bi={make:Si,add:Fu,show:Nu,encode:Du},Ai={};function Ru(n){return fn([[0],ln(n._0)])}function Lu(n){return"func (index: "+String(n._0)+")"}var ki={make:void 0,encode:Ru,show:Lu};function $u(n){return fn([St(n.moduleName),St(n.entityName),Ru(n.desc)])}function Fi(n,e,r){return{moduleName:n,entityName:e,desc:r}}function Cu(n){return"import "+Lu(n.desc)+" "+n.moduleName+"."+n.entityName+"}"}var Uu={ImportDesc:ki,encode:$u,make:Fi,show:Cu};function Ni(n){return[]}function Ou(n,e){return n.push(e)-1|0}function Mu(n){return re(2,zn(l(n,$u)))}function Xu(n){return ue(2)+`
`+w(n,`
`,Cu)}function Di(n){return n.length}var Ri={make:Ni,add:Ou,encode:Mu,show:Xu,count:Di};function Li(n){return{typeSection:[],importSection:[],funcSection:[],tableSection:[],memorySection:[],globalSection:[],exportSection:[],elementSection:[],codeSection:[],funcs:[]}}function $i(n,e){return Jt(n.typeSection,e)}function Vu(n,e,r,u){var a=Jt(n.typeSection,r);return Ir(n.funcSection,a),n.funcs.push([e,r,u]),eu(n.codeSection,u)+n.importSection.length|0}function Ci(n,e,r,u){var a=Vu(n,e,r,u),t={name:e,kind:0,index:a};return n.exportSection.push(t),a}function Ui(n,e){n.tableSection.push(e)}function Oi(n,e){n.elementSection.push(e)}function Mi(n,e){n.globalSection.push(e)}function Xi(n,e){return Fu(n.memorySection,e)}function Vi(n,e){return Ou(n.importSection,e)}function Bu(n){return fn([[0,97,115,109,1,0,0,0],Qr(n.typeSection),Mu(n.importSection),xr(n.funcSection),vu(n.tableSection),Du(n.memorySection),bu(n.globalSection),iu(n.exportSection),hu(n.elementSection),tu(n.codeSection)])}function Bi(n){return(e=>Uint8Array.from(e))(Bu(n))}function zi(n){return w([yr(n.typeSection),Xu(n.importSection),nu(n.funcSection,l(n.funcs,function(e){return e[0]})),lu(n.tableSection),Nu(n.memorySection),Su(n.globalSection),cu(n.exportSection),gu(n.elementSection),ru(n.codeSection,n.funcs)],`

`,function(e){return e})}var Pn={make:Li,getOrAddSignature:$i,addFunc:Vu,addExportedFunc:Ci,addTable:Ui,addElement:Oi,addGlobal:Mi,addMemory:Xi,addImport:Vi,encode:Bu,encodeAsUint8Array:Bi,show:zi},Pi=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uleb128:ln,sleb128:Br,Vec:bo,F32:Ao,F64:ko,Section:No,ValueType:Do,BlockReturnType:Lo,Inst:$o,Func:it,TypeSection:Zo,FuncSection:Jo,CodeSection:Yo,Str:Ho,ExportEntry:xo,ExportSection:ti,ReferenceType:ai,Limits:Yt,Table:su,TableSection:si,Elem:Gu,ElementSection:Ti,Global:ct,GlobalSection:mi,Memory:ku,MemorySection:bi,Import:Ai,ImportEntry:Uu,ImportSection:Ri,Module:Pn});const zu={"0":"I32","1":"I64","2":"F32","3":"F64"},N={I32:0,I64:1,F32:2,F64:3},Ht={Else:0,End:1,Return:2,Drop:3,AddI32:4,SubI32:5,MulI32:6,DivI32Unsigned:7,DivI32Signed:8,EqzI32:9,EqI32:10,EqI64:11,EqF32:12,EqF64:13,NeI32:14,NeI64:15,NeF32:16,NeF64:17,LeI32Signed:18,LeI32Unsigned:19,LeI64Signed:20,LeI64Unsigned:21,LeF32:22,LeF64:23,GeI32Signed:24,GeI32Unsigned:25,GeI64Signed:26,GeI64Unsigned:27,GeF32:28,GeF64:29,LtI32Signed:30,LtI32Unsigned:31,LtI64Signed:32,LtI64Unsigned:33,LtF32:34,LtF64:35,GtI32Signed:36,GtI32Unsigned:37,GtI64Signed:38,GtI64Unsigned:39,GtF32:40,GtF64:41,RemI32Signed:42,RemI32Unsigned:43,And:44},ji={FuncRef:0,ExternRef:1},qi={Func:0,Table:1,Memory:2,Global:3},se={Void:0},Y=Pi;Y.uleb128;Y.sleb128;Y.Vec.encode;Y.Vec.encodeMany;Y.F32.encode;Y.F64.encode;Y.Func.Signature.funcTypeCode;Y.Func.Signature.empty._0.map(function(e){return zu[e]}),Y.Func.Signature.empty._1.map(function(e){return zu[e]});Y.FuncSection.make;Y.FuncSection.encode;Y.Str.encode;Y.Limits.makeExact;Y.Elem.show;Y.Elem.encode;Y.ElementSection.make;Y.ElementSection.show;Y.ElementSection.encode;Y.MemorySection.make;Y.ImportEntry.ImportDesc.make;const Zi=function(n){return Y.Module.show({typeSection:n.typeSection.map(function(u){return{TAG:0,_0:u[0].map(function(t){return N[t]}),_1:u[1].map(function(t){return N[t]})}}),importSection:n.importSection.map(function(u){return{moduleName:u.moduleName,entityName:u.entityName,desc:{TAG:0,_0:u.desc.value}}}),funcSection:n.funcSection,tableSection:n.tableSection.map(function(u){return[ji[u[0]],[u[1][0],u[1][1]==null?void 0:u[1][1]]]}),memorySection:n.memorySection.map(function(u){return[u[0],u[1]==null?void 0:u[1]]}),globalSection:n.globalSection.map(function(u){return[N[u[0]],u[1],u[2].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:{TAG:17,_0:t.value[0],_1:t.value[1]}:Ht[t]})]}),exportSection:n.exportSection.map(function(u){return{name:u.name,kind:qi[u.kind],index:u.index}}),elementSection:n.elementSection,codeSection:n.codeSection.map(function(u){return[u[0].map(function(t){return[t[0],N[t[1]]]}),u[1].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:{TAG:17,_0:t.value[0],_1:t.value[1]}:Ht[t]})]}),funcs:n.funcs.map(function(u){return[u[0],{TAG:0,_0:u[1][0].map(function(t){return N[t]}),_1:u[1][1].map(function(t){return N[t]})},[u[2][0].map(function(t){return[t[0],N[t[1]]]}),u[2][1].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:N[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return N[i]}),t.value.value[1][1].map(function(i){return N[i]})]}:se[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:{TAG:17,_0:t.value[0],_1:t.value[1]}:Ht[t]})]]})})};Y.F32;Y.F64;Y.Vec;Y.Str;function Wi(n,e,r){return g(e,g(n,r))}function _t(n){return[[],n]}var Ji=br;function Ki(n,e,r){return br(n,e,[[],r])}var Yi=Za,Hi=Wa,Qi=Vt;function yi(n,e){var r=w(Ar(kr(n,e)),`
`,function(u){return"  "+u[0]+": "+u[1]});return`{
`+r+`
}`}var Xn={empty:void 0,add:Ji,addMono:Ki,remove:Yi,has:Hi,get:Qi,show:yi},Ii=[],oe={TAG:1,_0:"u32",_1:Ii},xi=[],pe={TAG:1,_0:"bool",_1:xi},nc=[],Se={TAG:1,_0:"()",_1:nc};function $n(n,e){return{TAG:1,_0:"Fun",_1:nn(n,[e])}}function ec(n){return{TAG:1,_0:"Tuple",_1:n}}function tc(n){return{TAG:1,_0:"Ptr",_1:[n]}}function Qt(n){switch(n.TAG|0){case 0:case 1:return!1;case 2:return!0}}var Re=sn("Types.Size.UnkownTypeSize");function At(n){for(;;){var e=n;switch(e.TAG|0){case 0:throw{RE_EXN_ID:Re,_1:e,Error:new Error};case 1:switch(e._0){case"()":if(e._1.length===0)return 0;throw{RE_EXN_ID:Re,_1:e,Error:new Error};case"Mut":var r=e._1;if(r.length!==1)throw{RE_EXN_ID:Re,_1:e,Error:new Error};n=r[0];continue;case"Fun":case"Ptr":return 4;case"Tuple":return pn(l(e._1,At),0,function(u,a){return u+a|0});case"bool":case"u32":break;case"u64":if(e._1.length===0)return 8;throw{RE_EXN_ID:Re,_1:e,Error:new Error};default:throw{RE_EXN_ID:Re,_1:e,Error:new Error}}if(e._1.length===0)return 4;throw{RE_EXN_ID:Re,_1:e,Error:new Error};case 2:return 4}}}function rc(n){return Math.ceil(Math.log2(At(n)))|0}function uc(n){return At(n)===0}var ie={UnkownTypeSize:Re,size:At,sizeLog2:rc,isZeroSizedType:uc};function ac(n){return{TAG:0,_0:n}}function yt(n,e,r){if(n.TAG===0)return{TAG:1,_0:[e,r],_1:{TAG:0,_0:n._0}};var u=n._1,a=n._0,t=a[1],o=a[0];return e<o?{TAG:1,_0:[e,r],_1:{TAG:1,_0:[o,t],_1:u}}:{TAG:1,_0:[o,t],_1:yt(u,e,r)}}function oc(n){for(;;){var e=n;if(e.TAG===0)return e._0;n=e._1}}function ic(n,e){return pn(n,{TAG:0,_0:{TAG:0,_0:e}},function(r,u){return yt(r,u[0],u[1])})}function It(n){var e=function(r,u){for(;;){var a=u,t=r;if(t.TAG===0){var o=t._0;switch(o.TAG|0){case 0:case 1:return a;case 2:var i=o._0;if(i.TAG===0)return a;var _=i._0;if(_.TAG===0)return a;u={hd:_._0,tl:a},r=_._1;continue}}else{u={hd:t._0,tl:a},r=t._1;continue}}};return Me(e(n,0))}function cc(n){return Ja(It(n))}function Pu(n,e){if(n.TAG===0){var r=g(e,n._0);switch(r.TAG|0){case 0:case 1:return{TAG:0,_0:r};case 2:var u=r._0;return u.TAG===0?{TAG:0,_0:r}:u._0}}else{var a=n._0;return{TAG:1,_0:[a[0],g(e,a[1])],_1:Pu(n._1,e)}}}function ju(n,e){var r=function(u,a){for(;;){var t=a,o=u;if(o.TAG===0)return Sr(Me({hd:"..."+g(e,o._0),tl:t}));var i=o._0;a={hd:i[0]+": "+g(e,i[1]),tl:t},u=o._1}};return"{ "+w(r(n,0),", ",function(u){return u})+" }"}var Vn={make:ac,insert:yt,tail:oc,fromArray:ic,toArray:It,toMap:cc,map:Pu,show:ju};function kt(n){switch(n.TAG|0){case 0:return Ha(void 0,n._0);case 1:return pn(l(n._1,kt),void 0,zt);case 2:var e=n._0;return e.TAG===0?void 0:pn(l(It(e._0),function(r){return Wi(function(u){return u[1]},kt,r)}),void 0,zt)}}function _c(n){return Fr(kt(n[1]),Qa(n[0]))}function fc(n){return pn(l(Ya(n),_c),void 0,zt)}function xt(n,e){var r=Ka(Fr(kt(e),fc(n)));return[r,e]}function sc(n){var e=String.fromCharCode(97+n%26|0),r=n/26|0;return r===0?e:e+String(r)}function S(n){switch(n.TAG|0){case 0:return sc(n._0);case 1:var e=n._1,r=n._0;if(e.length===0)return r;switch(r){case"Fun":var u=Bt(e,0,e.length-1|0),a=we(e,e.length-1|0);if(u.length!==1)return"("+w(u,", ",S)+") -> "+S(a);var t=u[0];return S(t)+" -> "+S(a);case"Tuple":return"("+w(e,", ",S)+")";default:return r+"<"+w(e,", ",S)+">"}case 2:var o=n._0;return o.TAG===0?o._0:ju(o._0,S)}}function qu(n){switch(n){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/";case 4:return"%";case 5:return"<";case 6:return"<=";case 7:return">";case 8:return">=";case 9:return"==";case 10:return"!="}}var lc={show:qu};function Zu(n){switch(n){case 0:return"-";case 1:return"!";case 2:return"*"}}var vc={show:Zu};function Wu(n){return typeof n=="number"?"()":n.TAG===0?String(n._0):n._0?"true":"false"}var dc={show:Wu};function O(n){switch(n.TAG|0){case 0:return Wu(n._0);case 1:return Zu(n._0)+O(n._1);case 2:return"("+O(n._0)+" "+qu(n._1)+" "+O(n._2)+")";case 3:return n._0;case 4:return O(n._0)+" = "+O(n._1);case 5:var e=n._1,r=n._0,u=r.length;if(u!==1)return u!==0?"("+w(r,", ",function(i){return i})+") -> "+O(e):"() -> "+O(e);var a=r[0];return a+" -> "+O(e);case 6:return"let "+n._0+" = "+O(n._1)+" in "+O(n._2);case 7:return"("+O(n._0)+")("+w(n._1,", ",O)+")";case 8:return(n._2===1?"unsafe ":"")+`{
`+w(nn(l(n._0,Ku),un(n._1,[],function(i){return[O(i)]})),`;
`,function(i){return"  "+i})+`}
}`;case 9:var t=n._2,o="if "+O(n._0)+" "+O(n._1);return t!==void 0?o+" else "+O(t):o;case 10:return"while "+O(n._0)+" "+O(n._1);case 11:return"return "+un(n._0,"",O);case 12:return O(n._0)+" as "+S(n._1);case 13:return"("+w(n._0,", ",O)+")";case 14:return n._0+` {
`+w(n._1,", ",function(i){return i[0]+": "+O(i[1])})+`
}`;case 15:return O(n._0)+"."+n._1}}function Ju(n){switch(n.TAG|0){case 0:return"fn "+n._0+"("+w(n._1,", ",function(e){return(e[1]?"mut ":"")+e[0]})+") "+O(n._2);case 1:return(n._1?"mut":"let")+" "+n._0+" = "+O(n._2);case 2:return"struct "+n._0+` {
`+w(n._1,`,
`,function(e){return(e[2]?"mut ":"")+e[0]+": "+S(e[1])})+`
}`;case 3:return n._0+` {
`+w(n._1,`

`,Ju)+`
}`;case 4:return"extern fn "+n.name+"("+w(n.args,", ",function(e){return(e[2]?"mut ":"")+e[0]+": "+S(e[1])})+") -> "+S(n.ret)}}function Ku(n){if(n.TAG!==0)return O(n._0)+";";var e=n._2,r=n._0;return n._1?"let mut "+r+" = "+O(e):"let "+r+" = "+O(e)}var Tc={showExpr:O,showDecl:Ju,showStmt:Ku};function G(n,e){for(;;){var r=e;switch(r.TAG|0){case 0:var u=r._0,a=Nr(n,u);if(a===void 0)return{TAG:0,_0:u};e=a;continue;case 1:return{TAG:1,_0:r._0,_1:l(r._1,function(i){return G(n,i)})};case 2:var t=r._0,o;return o=t.TAG===0?{TAG:0,_0:t._0}:{TAG:1,_0:Vn.map(t._0,function(i){return G(n,i)})},{TAG:2,_0:o}}}}function Yu(n,e){var r=e[0];return[r,G(no(n,r),e[1])]}function L(n,e){return ya(Ia(e,function(r){return G(n,r)}),n,function(r,u,a){return xa(a,u)})}function vn(n,e){return kr(e,function(r){return Yu(n,r)})}var Pe;function nr(n,e){for(var r,u=0;me(r)&&u<n.length;){var a=g(e,we(n,u));a!==void 0&&(r=j(ee(a))),u=u+1|0}return r}function Hu(n,e){for(var r,u=n.length-1|0;me(r)&&u>=0;)g(e,we(n,u))?r=u:u=u-1|0;return r}function Gc(n,e){for(var r=[],u=!1,a=0;u===!1&&a<n.length;){var t=we(n,a);t!==void 0?r.push(g(e,ee(t))):u=!0,a=a+1|0}if(!u)return r}function gc(n,e){for(var r=[],u,a=0;me(u)&&a<n.length;){var t=we(n,a);t.TAG===0?r.push(g(e,t._0)):u=j(t._0),a=a+1|0}var o=u;return o!==void 0?{TAG:1,_0:ee(o)}:{TAG:0,_0:r}}function Qu(n,e){return Q(Xt(n,e),function(r){return[we(n,r),r]})}function hc(n){return"struct "+n.name+`{
`+w(n.attributes,`,
`,function(e){return"  "+e.name+": "+S(e.ty)})+`
}`}function Ec(n,e){return{TAG:2,_0:{TAG:1,_0:Vn.fromArray(l(n.attributes,function(r){return[r.name,r.ty]}),e)}}}function wc(n,e){var r={contents:0},u=[];return Ln(e,function(a){var t=a[1],o=ie.size(t);u.push({name:a[0],mut:a[2],offset:r.contents,ty:t,size:o,impl:void 0}),r.contents=r.contents+o|0}),{name:n,attributes:u,size:r.contents,staticFuncs:[]}}function mc(n,e,r){n.attributes.push({name:e.contents.name,mut:!1,offset:0,ty:e.contents.ty,size:0,impl:[e,r]})}function pc(n,e){n.staticFuncs.push({name:e})}var je={show:hc,toPartialStructType:Ec,make:wc,addImplementation:mc,addStaticFunc:pc},jn={tyVarIndex:0,identifiers:[],renaming:eo(10),structs:Dr(5)};function le(n){var e=jn.tyVarIndex;return jn.tyVarIndex=jn.tyVarIndex+1|0,e}function er(n){return{TAG:0,_0:le()}}function Ft(n){var e=n[0],r=l(e,function(u){return{TAG:0,_0:le()}});return G(ao(De(e,r)),n[1])}function Qn(n,e){var r=n!==void 0?ee(n):void 0,u=jn.identifiers.length;jn.identifiers.push(e);var a={contents:{name:e,newName:e,index:u,ty:r!==void 0?r:{TAG:0,_0:le()}}};return ro(jn.renaming,u,a),a}function Sc(n){return Hn(Hu(jn.identifiers,function(e){return e===n}),function(e){return uo(jn.renaming,e)})}function yu(n,e){e.contents.ty=G(n,e.contents.ty)}function bc(n){return Ln(to(jn.renaming),function(e){return yu(n,e)})}function Ac(n){return Pt(jn.structs,n.name,n)}function yn(n){return Rr(jn.structs,n)}function ve(n){switch(n.TAG|0){case 0:var e=n._0;return typeof e=="number"?Se:e.TAG===0?oe:pe;case 3:return n._0.contents.ty;case 4:case 11:return Se;case 12:return un(n._0,Se,ve);case 13:return n._2;case 14:return ec(l(n._0,ve));case 15:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return n._0}}function kc(n){return ve(n._0)}function B(n,e){var r=n!==void 0?ee(n):void 0,u=function(d,R){return r!==void 0?"("+R+": "+S(G(ee(r),d))+")":R},a=function(d){return B(j(r),d)};switch(e.TAG|0){case 0:return u(ve(e),dc.show(e._0));case 1:return u(e._0,"("+B(j(r),e._1)+" "+lc.show(e._2)+" "+B(j(r),e._3)+")");case 2:return u(e._0,"("+vc.show(e._1)+B(j(r),e._2)+")");case 3:var t=e._0;return u(t.contents.ty,t.contents.name);case 4:var o=e._1;return u(ve(o),B(j(r),e._0)+" = "+B(j(r),o));case 5:return u(e._0,"("+w(e._1,", ",function(d){return d.contents.name})+") -> "+B(j(r),e._2));case 6:return u(e._0,"let "+(e._1?"mut":"")+" "+e._2.contents.name+" = "+B(j(r),e._3)+` in
`+B(j(r),e._4));case 7:return u(e._0,"let rec "+e._1.contents.name+" ("+w(e._2,", ",function(d){return d.contents.name})+") = "+B(j(r),e._3)+` in
`+B(j(r),e._4));case 8:return u(e._0,"("+B(j(r),e._1)+")("+w(e._2,", ",a)+")");case 9:var i=e._2,_=j(r);return u(e._0,(e._3===1?"unsafe ":"")+`{
`+w(nn(l(e._1,function(d){return Iu(_,d)}),un(i,[],function(d){return[B(void 0,d)]})),`;
`,function(d){return"  "+d})+(me(i)?"; ":"")+`
}`);case 10:return u(e._0,"if "+B(j(r),e._1)+" "+B(j(r),e._2)+" else "+B(j(r),e._3));case 11:return u(Se,"while "+B(void 0,e._0)+" "+B(void 0,e._1));case 12:var f=j(r);return"return "+u(ve(e),un(e._0,"",function(d){return B(f,d)}));case 13:var s=e._0;return u(ve(s),B(void 0,s))+" as "+S(e._2);case 14:var T=j(r);return"("+w(e._0,", ",function(d){return B(T,d)})+")";case 15:return e._0+` {
`+w(e._1,`,
`,function(d){return d[0]+": "+B(void 0,d[1])})+`
}`;case 16:return u(e._0,B(void 0,e._1)+"."+e._2)}}function Iu(n,e){var r=n!==void 0?ee(n):void 0;return B(j(r),e._0)}function tr(n,e){var r=n!==void 0?ee(n):void 0,u=function(f,s){return r!==void 0?"("+s+": "+S(G(ee(r),f))+")":s};switch(e.TAG|0){case 0:var a=e._1,t=e._0,o;if(r!==void 0){var i=ee(r);o=w(a,", ",function(f){var s=f[0];return(f[1]?"mut ":"")+(s.contents.name+": "+S(G(i,s.contents.ty)))})}else o=w(a,", ",function(f){return(f[1]?"mut ":"")+f[0].contents.name});return u(t.contents.ty,"fn "+t.contents.name+"("+o+") "+B(j(r),e._2));case 1:var _=e._0;return u(_.contents.ty,(e._1?"mut":"let")+" "+_.contents.name+" = "+B(j(r),e._2));case 2:return Tc.showDecl({TAG:2,_0:e._0,_1:e._1});case 3:return"impl "+e._0+` {
`+w(e._1,`

`,function(f){return tr(void 0,{TAG:0,_0:f[0],_1:f[1],_2:f[2]})})+`
}`;case 4:return"extern fn "+e.name.contents.name+"("+w(e.args,", ",function(f){var s=f[0];return(f[1]?"mut ":"")+s.contents.name+": "+S(s.contents.ty)})+") -> "+S(e.ret)}}var xu=sn("Core.CoreAst.UnexpectedDeclarationInImplBlock"),na=sn("Core.CoreAst.UndeclaredIdentifer"),ea=sn("Core.CoreAst.UnreachableLetStmt");function rr(n,e,r,u,a){return r.TAG===5?{TAG:7,_0:r._0,_1:n,_2:r._1,_3:r._2,_4:u}:{TAG:6,_0:a,_1:e,_2:n,_3:r,_4:u}}function z(n){var e={LAZY_DONE:!1,VAL:function(){return er()}};switch(n.TAG|0){case 0:return{TAG:0,_0:n._0};case 1:return{TAG:2,_0:te(e),_1:n._0,_2:z(n._1)};case 2:return{TAG:1,_0:te(e),_1:z(n._0),_2:n._1,_3:z(n._2)};case 3:var r=n._0,u=Sc(r);if(u!==void 0)return{TAG:3,_0:u};var a=yn(r);if(a!==void 0)return{TAG:3,_0:Qn(void 0,r)};throw{RE_EXN_ID:na,_1:r,Error:new Error};case 4:return{TAG:4,_0:z(n._0),_1:z(n._1)};case 5:var t=n._1,o=n._0;if(o.length===0)return{TAG:5,_0:te(e),_1:[Qn(void 0,"__x")],_2:z(t)};var i=j(void 0);return{TAG:5,_0:te(e),_1:l(o,function(T){return Qn(i,T)}),_2:z(t)};case 6:return rr(Qn(void 0,n._0),!1,z(n._1),z(n._2),te(e));case 7:return{TAG:8,_0:te(e),_1:z(n._0),_2:l(n._1,z)};case 8:var _=n._2,f=n._1,s=function(T){if(!T)return Q(f,z);var d=T.hd;if(d.TAG!==0)return{TAG:9,_0:te(e),_1:[ta(d)],_2:s(T.tl),_3:_};var R=d._3;return rr(Qn(void 0,d._0),d._1,z(d._2),un(s(T.tl),{TAG:0,_0:0},function(M){return M}),R!==void 0?R:er())};return{TAG:9,_0:te(e),_1:[],_2:s(rt(n._0)),_3:_};case 9:return{TAG:10,_0:te(e),_1:z(n._0),_2:z(n._1),_3:un(n._2,{TAG:0,_0:0},z)};case 10:return{TAG:11,_0:z(n._0),_1:z(n._1)};case 11:return{TAG:12,_0:Q(n._0,z)};case 12:return{TAG:13,_0:z(n._0),_1:te(e),_2:n._1};case 13:return{TAG:14,_0:l(n._0,z)};case 14:return{TAG:15,_0:n._0,_1:l(n._1,function(T){return[T[0],z(T[1])]})};case 15:return{TAG:16,_0:er(),_1:z(n._0),_2:n._1}}}function ta(n){if(n.TAG!==0)return{_0:z(n._0)};throw{RE_EXN_ID:ea,Error:new Error}}function ur(n){switch(n.TAG|0){case 0:var e=l(n._1,function(o){return[Qn(j(void 0),o[0]),o[1]]});return{TAG:0,_0:Qn(void 0,n._0),_1:e,_2:z(n._2)};case 1:return{TAG:1,_0:Qn(void 0,n._0),_1:n._1,_2:z(n._2)};case 2:var r=n._1,u=n._0;return Ac(je.make(u,r)),{TAG:2,_0:u,_1:r};case 3:var a=l(l(n._1,ur),function(o){if(o.TAG===0)return[o._0,o._1,o._2];throw{RE_EXN_ID:xu,_1:o,Error:new Error}});return{TAG:3,_0:n._0,_1:a};case 4:var t=l(n.args,function(o){return[Qn(j(o[1]),o[0]),o[2]]});return{TAG:4,name:Qn(void 0,n.name),args:t,ret:n.ret}}}function Z(n,e){var r=function(i){return Z(n,i)};switch(e.TAG|0){case 0:return{TAG:0,_0:e._0};case 1:return{TAG:1,_0:G(n,e._0),_1:Z(n,e._1),_2:e._2,_3:Z(n,e._3)};case 2:return{TAG:2,_0:G(n,e._0),_1:e._1,_2:Z(n,e._2)};case 3:return{TAG:3,_0:e._0};case 4:return{TAG:4,_0:Z(n,e._0),_1:Z(n,e._1)};case 5:return{TAG:5,_0:G(n,e._0),_1:e._1,_2:Z(n,e._2)};case 6:return{TAG:6,_0:G(n,e._0),_1:e._1,_2:e._2,_3:Z(n,e._3),_4:Z(n,e._4)};case 7:return{TAG:7,_0:G(n,e._0),_1:e._1,_2:e._2,_3:Z(n,e._3),_4:Z(n,e._4)};case 8:return{TAG:8,_0:G(n,e._0),_1:Z(n,e._1),_2:l(e._2,r)};case 9:return{TAG:9,_0:G(n,e._0),_1:l(e._1,function(i){return ra(n,i)}),_2:Q(e._2,r),_3:e._3};case 10:return{TAG:10,_0:G(n,e._0),_1:Z(n,e._1),_2:Z(n,e._2),_3:Z(n,e._3)};case 11:return{TAG:11,_0:Z(n,e._0),_1:Z(n,e._1)};case 12:return{TAG:12,_0:Q(e._0,r)};case 13:return{TAG:13,_0:Z(n,e._0),_1:G(n,e._1),_2:G(n,e._2)};case 14:return{TAG:14,_0:l(e._0,r)};case 15:var u=e._1,a=e._0,t=yn(a);if(t===void 0)return Lr('unreachable: undeclared struct "'+a+"'");var o=Gc(l(jt(t.attributes,function(i){return me(i.impl)}),function(i){var _=i.name;return ht(u,function(f){return f[0]===_})}),function(i){return[i[0],Z(n,i[1])]});return o!==void 0?{TAG:15,_0:a,_1:o}:Lr('unreachable: missing attribute for struct "'+a+'"');case 16:return{TAG:16,_0:G(n,e._0),_1:Z(n,e._1),_2:e._2}}}function ra(n,e){return{_0:Z(n,e._0)}}function ua(n,e){switch(e.TAG|0){case 0:return{TAG:0,_0:e._0,_1:e._1,_2:Z(n,e._2)};case 1:return{TAG:1,_0:e._0,_1:e._1,_2:Z(n,e._2)};case 3:return{TAG:3,_0:e._0,_1:l(e._1,function(r){return[r[0],r[1],Z(n,r[2])]})};case 2:case 4:return e}}var hn={typeOfExpr:ve,typeOfStmt:kc,showExpr:B,showStmt:Iu,showDecl:tr,UnexpectedDeclarationInImplBlock:xu,UndeclaredIdentifer:na,UnreachableLetStmt:ea,rewriteLetIn:rr,fromExpr:z,fromStmt:ta,fromDecl:ur,substExpr:Z,substStmt:ra,substDecl:ua},kn={show:B,from:z,subst:Z,typeOf:ve},ar={show:tr,from:ur,subst:ua};function aa(n){return[n,0,n.length]}function Fc(n){return aa(Array.from(n,function(e){return $r(e,0)}))}function oa(n,e){var r=e[2],u=n!==void 0?n:1;return[e[0],Math.min(e[1]+u|0,r),r]}function or(n){return Ne(n[0],n[1])}function ir(n){return oa(1,n)}function cr(n){return n[1]===n[2]}function Nc(n){return n[0].slice(n[1],n[2])}function qe(n,e){var r=or(e);if(r!==void 0&&g(n,r))return[r,oa(void 0,e)]}function en(n){return function(e){return qe(function(r){return r===n},e)}}function ia(n){return n>=97?n<=122:!1}function Dc(n){return n>=65?n<=90:!1}function Rc(n){return ia(n)?!0:Dc(n)}function ca(n){return n>=48?n<=57:!1}function Lc(n){return Rc(n)?!0:ca(n)}function $c(n){return qe(ia,n)}function Cc(n){return qe(ca,n)}function _r(n){return qe(Lc,n)}function Uc(n){return n>13||n<9?n===32:!(n===12||n===11)}function Oc(n){return qe(Uc,n)}function p(n,e,r){return Q(g(n,r),function(u){return[g(e,u[0]),u[1]]})}function Nt(n,e,r){for(;;){var u=n,a=r,t=u!==void 0?u:[];if(cr(a))return[t,a];var o=g(e,a);if(o===void 0)return[t,a];t.push(o[0]),r=o[1],n=t}}function _a(n){return Nt(void 0,Oc,n)}function ft(n,e,r){return Hn(g(n,r),function(u){var a=u[0];return Q(g(e,u[1]),function(t){return[[a,t[0]],t[1]]})})}function fa(n){return function(e){return p(function(r){return ft(n,function(u){return Nt(void 0,n,u)},r)},function(r){return nn([r[0]],r[1])},e)}}function Mc(n,e,r,u){return Hn(ft(n,e,u),function(a){var t=a[0],o=t[1],i=t[0];return Q(g(r,a[1]),function(_){return[[i,o,_[0]],_[1]]})})}function sa(n){if(!n)return function(a){return[0,a]};var e=n.hd,r=sa(n.tl),u=function(a){return ft(e,r,a)};return function(a){return p(u,function(t){return{hd:t[0],tl:t[1]}},a)}}function la(n,e,r){var u=g(n,r);return u!==void 0?[u[0],u[1]]:g(e,r)}function st(n,e){return nr(n,function(r){return g(r,e)})}function rn(n){var e=Array.from(n,function(u){var a=$r(u,0);return function(t){return qe(function(o){return o===a},t)}}),r=sa(rt(e));return function(u){return p(r,function(a){return n},u)}}function Xc(n,e){var r=g(n,e);if(r===void 0)return[void 0,ir(e)]}var Vc=fa(Cc);function Bc(n){return p(Vc,function(e){return{TAG:0,_0:Cr(oo(w(e,"",function(r){return Et(1,r)})))}},n)}var zc=rn("false");function Pc(n){return p(zc,function(e){return{TAG:1,_0:!1}},n)}var jc=rn("true");function qc(n){return p(jc,function(e){return{TAG:1,_0:!0}},n)}function Zc(n){return la(qc,Pc,n)}var Wc=[_r,en(95),en(39)];function Jc(n){return st(Wc,n)}function Kc(n){return Nt(void 0,Jc,n)}var Yc=en(95);function Hc(n){return la($c,Yc,n)}function Qc(n){return ft(Hc,Kc,n)}function yc(n){return p(Qc,function(e){return{TAG:3,_0:Et(1,e[0])+w(e[1],"",function(r){return Et(1,r)})}},n)}var Ic=[_r,en(95)],xc=fa(function(n){return st(Ic,n)});function n0(n){return p(xc,function(e){return{TAG:4,_0:w(e,"",function(r){return Et(1,r)})}},n)}var e0=rn("let"),t0=rn("mut"),r0=rn("in"),u0=rn("if"),a0=rn("else"),o0=rn("fn"),i0=rn("while"),c0=rn("return"),_0=rn("as"),f0=rn("unsafe"),s0=rn("struct"),l0=rn("impl"),v0=rn("extern"),d0=[function(n){return p(e0,function(e){return{TAG:5,_0:0}},n)},function(n){return p(t0,function(e){return{TAG:5,_0:1}},n)},function(n){return p(r0,function(e){return{TAG:5,_0:2}},n)},function(n){return p(u0,function(e){return{TAG:5,_0:3}},n)},function(n){return p(a0,function(e){return{TAG:5,_0:4}},n)},function(n){return p(o0,function(e){return{TAG:5,_0:5}},n)},function(n){return p(i0,function(e){return{TAG:5,_0:6}},n)},function(n){return p(c0,function(e){return{TAG:5,_0:7}},n)},function(n){return p(_0,function(e){return{TAG:5,_0:8}},n)},function(n){return p(f0,function(e){return{TAG:5,_0:9}},n)},function(n){return p(s0,function(e){return{TAG:5,_0:10}},n)},function(n){return p(l0,function(e){return{TAG:5,_0:11}},n)},function(n){return p(v0,function(e){return{TAG:5,_0:12}},n)}];function T0(n){return st(d0,n)}function G0(n){return ft(T0,function(e){return Xc(_r,e)},n)}function g0(n){return p(G0,function(e){return e[0]},n)}var h0=rn("->"),E0=rn("=="),w0=rn("!="),m0=en(43),p0=en(45),S0=en(42),b0=en(47),A0=en(37),k0=rn("<="),F0=rn(">="),N0=en(60),D0=en(62),R0=en(40),L0=en(41),$0=en(44),C0=en(59),U0=en(61),O0=en(123),M0=en(125),X0=en(58),V0=en(33),B0=en(46),z0=[function(n){return p(h0,function(e){return{TAG:2,_0:5}},n)},function(n){return p(E0,function(e){return{TAG:2,_0:14}},n)},function(n){return p(w0,function(e){return{TAG:2,_0:15}},n)},function(n){return p(m0,function(e){return{TAG:2,_0:9}},n)},function(n){return p(p0,function(e){return{TAG:2,_0:10}},n)},function(n){return p(S0,function(e){return{TAG:2,_0:11}},n)},function(n){return p(b0,function(e){return{TAG:2,_0:12}},n)},function(n){return p(A0,function(e){return{TAG:2,_0:13}},n)},function(n){return p(k0,function(e){return{TAG:2,_0:17}},n)},function(n){return p(F0,function(e){return{TAG:2,_0:19}},n)},function(n){return p(N0,function(e){return{TAG:2,_0:16}},n)},function(n){return p(D0,function(e){return{TAG:2,_0:18}},n)},function(n){return p(R0,function(e){return{TAG:2,_0:0}},n)},function(n){return p(L0,function(e){return{TAG:2,_0:1}},n)},function(n){return p($0,function(e){return{TAG:2,_0:2}},n)},function(n){return p(C0,function(e){return{TAG:2,_0:3}},n)},function(n){return p(U0,function(e){return{TAG:2,_0:4}},n)},function(n){return p(O0,function(e){return{TAG:2,_0:6}},n)},function(n){return p(M0,function(e){return{TAG:2,_0:7}},n)},function(n){return p(X0,function(e){return{TAG:2,_0:8}},n)},function(n){return p(V0,function(e){return{TAG:2,_0:20}},n)},function(n){return p(B0,function(e){return{TAG:2,_0:21}},n)}];function P0(n){return st(z0,n)}var j0=[Bc,Zc,g0,P0,yc,n0];function q0(n){return st(j0,n)}function Z0(n){return Nt(void 0,function(e){return p(function(r){return Mc(_a,q0,_a,r)},function(r){return r[1]},e)},n)}function W0(n){switch(n){case 0:return"(";case 1:return")";case 2:return",";case 3:return";";case 4:return"=";case 5:return"->";case 6:return"{";case 7:return"}";case 8:return":";case 9:return"+";case 10:return"-";case 11:return"*";case 12:return"/";case 13:return"%";case 14:return"==";case 15:return"!=";case 16:return"<";case 17:return"<=";case 18:return">";case 19:return">=";case 20:return"!";case 21:return"."}}function J0(n){switch(n){case 0:return"let";case 1:return"mut";case 2:return"in";case 3:return"if";case 4:return"else";case 5:return"fn";case 6:return"while";case 7:return"return";case 8:return"as";case 9:return"unsafe";case 10:return"struct";case 11:return"impl";case 12:return"extern"}}function K0(n){switch(n.TAG|0){case 0:return String(n._0);case 1:return n._0?"true":"false";case 2:return W0(n._0);case 3:case 4:return n._0;case 5:return J0(n._0)}}function Dt(n){return{contents:function(e){return Hn(or(e),function(r){if(g(n,r))return[r,ir(e)]})}}}function Ze(n){return{contents:function(e){return Hn(or(e),function(r){return Q(g(n,r),function(u){return[u,ir(e)]})})}}}function Y0(n,e){return{contents:function(r){var u=g(n.contents,r);if(u!==void 0){var a=u[1];return Q(g(e,u[0]),function(t){return[t,a]})}}}}function v(n){return Dt(function(e){return Bn(e,n)})}function h(n,e){return{contents:function(r){return Q(g(n.contents,r),function(u){return[g(e,u[0]),u[1]]})}}}function an(n,e){return{contents:function(r){return Hn(g(n.contents,r),function(u){var a=u[0];return Q(g(e.contents,u[1]),function(t){return[[a,t[0]],t[1]]})})}}}function lt(n){var e=function(r){return{contents:function(u){if(cr(u))return[0,u];var a=g(r.contents,u);if(a===void 0)return[0,u];var t=a[0];return Q(g(e(r).contents,a[1]),function(o){return[{hd:t,tl:o[0]},o[1]]})}}};return h(e(n),Me)}function H0(n){return h(an(n,lt(n)),function(e){return nn([e[0]],e[1])})}function de(n,e,r){return{contents:function(u){return Hn(g(an(n,e).contents,u),function(a){var t=a[0],o=t[1],i=t[0];return Q(g(r.contents,a[1]),function(_){return[[i,o,_[0]],_[1]]})})}}}function Le(n,e,r,u){return{contents:function(a){return Hn(g(de(n,e,r).contents,a),function(t){var o=t[0],i=o[2],_=o[1],f=o[0];return Q(g(u.contents,t[1]),function(s){return[[f,_,i,s[0]],s[1]]})})}}}function vt(n,e,r,u,a){return{contents:function(t){return Hn(g(Le(n,e,r,u).contents,t),function(o){var i=o[0],_=i[3],f=i[2],s=i[1],T=i[0];return Q(g(a.contents,o[1]),function(d){return[[T,s,f,_,d[0]],d[1]]})})}}}function va(n,e,r,u,a,t){return{contents:function(o){return Hn(g(vt(n,e,r,u,a).contents,o),function(i){var _=i[0],f=_[4],s=_[3],T=_[2],d=_[1],R=_[0];return Q(g(t.contents,i[1]),function(M){return[[R,d,T,s,f,M[0]],M[1]]})})}}}function Q0(n,e,r,u,a,t,o){return{contents:function(i){return Hn(g(va(n,e,r,u,a,t).contents,i),function(_){var f=_[0],s=f[5],T=f[4],d=f[3],R=f[2],M=f[1],y=f[0];return Q(g(o.contents,_[1]),function(on){return[[y,M,R,d,T,s,on[0]],on[1]]})})}}}function P(n,e){return{contents:function(r){var u=g(n.contents,r);return u!==void 0?[u[0],u[1]]:g(e.contents,r)}}}function Rt(n){return{contents:function(e){return nr(n,function(r){return g(r.contents,e)})}}}function da(n,e,r){return h(an(n,lt(e)),function(u){var a=u[1],t=u[0];return Bn(a,[])?t:pn(a,t,r)})}function dt(n,e,r){return da(n,an(e,n),function(u,a){return io(r,u,a[0],a[1])})}function be(n){return h(de(Dt(function(e){return Bn(e,{TAG:2,_0:0})}),n,Dt(function(e){return Bn(e,{TAG:2,_0:1})})),function(e){return e[1]})}function y0(n,e){var r=function(u,a){var t=g(n.contents,u);if(t===void 0)return[a,u];var o=t[1];return a.push(t[0]),un(g(e.contents,o),[a,o],function(i){return r(i[1],a)})};return{contents:function(u){return r(u,[])}}}function Te(n){return y0(n,Dt(function(e){return Bn(e,{TAG:2,_0:2})}))}function ce(n){return P(h(n,function(e){return j(e)}),{contents:function(e){return[void 0,e]}})}var Ta={contents:function(n){}},dn={contents:function(n){}},We={contents:function(n){}},Ga={contents:function(n){}},_e={contents:function(n){}},I0=Ze(function(n){if(n.TAG===0)return{TAG:0,_0:{TAG:0,_0:n._0}}}),x0=Ze(function(n){if(n.TAG===1)return{TAG:0,_0:{TAG:1,_0:n._0}}}),In=Ze(function(n){if(n.TAG===3)return n._0}),Lt=Ze(function(n){if(n.TAG===4)return n._0}),fr=Ze(function(n){switch(n.TAG|0){case 3:case 4:return n._0;default:return}}),n_=h(an(v({TAG:2,_0:0}),v({TAG:2,_0:1})),function(n){return Se}),e_=P(n_,Ze(function(n){switch(n.TAG|0){case 3:switch(n._0){case"bool":return pe;case"u32":return oe;default:return}case 4:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return}})),ga=P(e_,be(_e)),t_=P(h(de(P(be(Te(_e)),h(ga,function(n){return[n]})),v({TAG:2,_0:5}),_e),function(n){return $n(n[0],n[2])}),ga),r_=P(h(Le(Lt,v({TAG:2,_0:16}),Te(_e),v({TAG:2,_0:18})),function(n){return{TAG:1,_0:n[0],_1:n[2]}}),t_);_e.contents=r_.contents;var u_=h(an(fr,ce(an(v({TAG:2,_0:8}),_e))),function(n){return[n[0],Q(n[1],function(e){return e[1]})]}),a_=h(P(In,fr),function(n){return{TAG:3,_0:n}}),o_=h(an(v({TAG:2,_0:0}),v({TAG:2,_0:1})),function(n){return{TAG:0,_0:0}}),i_=h(be(Le(dn,v({TAG:2,_0:2}),dn,ce(an(v({TAG:2,_0:2}),Te(dn))))),function(n){var e=nn([n[0],n[2]],un(n[3],[],function(r){return r[1]}));return{TAG:13,_0:e}}),ha=Rt([I0,x0,o_,a_,i_,be(dn)]),Ea=P(da(ha,an(v({TAG:2,_0:21}),In),function(n,e){return{TAG:15,_0:n,_1:e[1]}}),ha),wa=P(h(an(Ea,H0(be(Te(dn)))),function(n){return pn(n[1],n[0],function(e,r){return{TAG:7,_0:e,_1:r}})}),Ea),c_=Rt([h(v({TAG:2,_0:11}),function(n){return 2}),h(v({TAG:2,_0:10}),function(n){return 0}),h(v({TAG:2,_0:20}),function(n){return 1})]),__=P(h(v({TAG:2,_0:9}),function(n){return 0}),h(v({TAG:2,_0:10}),function(n){return 1})),f_=Rt([h(v({TAG:2,_0:11}),function(n){return 2}),h(v({TAG:2,_0:12}),function(n){return 3}),h(v({TAG:2,_0:13}),function(n){return 4})]),s_=Rt([h(v({TAG:2,_0:16}),function(n){return 5}),h(v({TAG:2,_0:17}),function(n){return 6}),h(v({TAG:2,_0:18}),function(n){return 7}),h(v({TAG:2,_0:19}),function(n){return 8})]),l_=P(h(v({TAG:2,_0:14}),function(n){return 9}),h(v({TAG:2,_0:15}),function(n){return 10})),v_=P(h(an(c_,wa),function(n){return{TAG:1,_0:n[0],_1:n[1]}}),wa),d_=dt(v_,f_,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),T_=dt(d_,__,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),G_=dt(T_,s_,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),g_=dt(G_,l_,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),h_=P(h(Le(v({TAG:5,_0:3}),dn,We,ce(an(v({TAG:5,_0:4}),We))),function(n){return{TAG:9,_0:n[1],_1:n[2],_2:Q(n[3],function(e){return e[1]})}}),g_),E_=P(h(de(v({TAG:5,_0:6}),dn,We),function(n){return{TAG:10,_0:n[1],_1:n[2]}}),h_),w_=P(h(va(v({TAG:5,_0:0}),In,v({TAG:2,_0:4}),dn,v({TAG:5,_0:2}),dn),function(n){return{TAG:6,_0:n[1],_1:n[3],_2:n[5]}}),E_),m_=P(be(Te(In)),h(In,function(n){return[n]})),p_=P(h(de(m_,v({TAG:2,_0:5}),dn),function(n){return{TAG:5,_0:n[0],_1:n[2]}}),w_),S_=Y0(dn,function(n){switch(n.TAG|0){case 9:case 10:return[!0,{TAG:1,_0:n}];default:return}});We.contents=P(h(vt(ce(v({TAG:5,_0:9})),v({TAG:2,_0:6}),lt(P(h(Ga,function(n){return[!1,n]}),S_)),ce(dn),v({TAG:2,_0:7})),function(n){var e=n[3],r=n[2],u=l(r,function(i){return i[1]}),a=un(n[0],0,function(i){return 1}),t=Ne(r,r.length-1|0);if(t===void 0)return{TAG:8,_0:u,_1:e,_2:a};var o=t[1];return o.TAG===0||!(t[0]&&me(e))?{TAG:8,_0:u,_1:e,_2:a}:{TAG:8,_0:Bt(u,0,r.length-2|0),_1:o._0,_2:a}}),p_).contents;var b_=P(h(Le(Lt,v({TAG:2,_0:6}),Te(de(In,v({TAG:2,_0:8}),dn)),v({TAG:2,_0:7})),function(n){return{TAG:14,_0:n[0],_1:l(n[2],function(e){return[e[0],e[2]]})}}),We),A_=dt(b_,v({TAG:2,_0:4}),function(n,e,r){return{TAG:4,_0:n,_1:r}}),k_=P(h(an(v({TAG:5,_0:7}),ce(dn)),function(n){return{TAG:11,_0:n[1]}}),A_),F_=h(an(k_,ce(an(v({TAG:5,_0:8}),_e))),function(n){var e=n[1],r=n[0];return e!==void 0?{TAG:12,_0:r,_1:e[1]}:r});dn.contents=F_.contents;var N_=h(an(dn,v({TAG:2,_0:3})),function(n){return{TAG:1,_0:n[0]}}),D_=P(h(vt(P(v({TAG:5,_0:0}),v({TAG:5,_0:1})),u_,v({TAG:2,_0:4}),dn,v({TAG:2,_0:3})),function(n){var e=n[1];return{TAG:0,_0:e[0],_1:Bn(n[0],{TAG:5,_0:1}),_2:n[3],_3:e[1]}}),N_);Ga.contents=D_.contents;var R_=h(vt(P(v({TAG:5,_0:0}),v({TAG:5,_0:1})),fr,v({TAG:2,_0:4}),dn,v({TAG:2,_0:3})),function(n){return{TAG:1,_0:n[1],_1:Bn(n[0],{TAG:5,_0:1}),_2:n[3]}}),L_=P(h(vt(v({TAG:5,_0:10}),Lt,v({TAG:2,_0:6}),Te(de(an(ce(v({TAG:5,_0:1})),In),v({TAG:2,_0:8}),_e)),v({TAG:2,_0:7})),function(n){var e=l(n[3],function(r){var u=r[0];return[u[1],r[2],wt(u[0])]});return{TAG:2,_0:n[1],_1:e}}),R_),ma=P(h(Le(v({TAG:5,_0:5}),In,h(be(Te(an(ce(v({TAG:5,_0:1})),In))),function(n){return l(n,function(e){return[e[1],wt(e[0])]})}),We),function(n){return{TAG:0,_0:n[1],_1:n[2],_2:n[3]}}),L_),$_=P(h(Q0(v({TAG:5,_0:12}),v({TAG:5,_0:5}),In,be(h(Te(Le(ce(v({TAG:5,_0:1})),In,v({TAG:2,_0:8}),_e)),function(n){return l(n,function(e){return[e[1],e[3],wt(e[0])]})})),v({TAG:2,_0:5}),_e,v({TAG:2,_0:3})),function(n){return{TAG:4,name:n[2],args:n[3],ret:n[5]}}),ma),C_=P(h(de(v({TAG:5,_0:11}),Lt,h(de(v({TAG:2,_0:6}),lt(ma),v({TAG:2,_0:7})),function(n){return n[1]})),function(n){return{TAG:3,_0:n[1],_1:n[2]}}),$_);Ta.contents=C_.contents;var U_=lt(Ta);function O_(n){var e=n.replace(/(\/\/[^\n]*)/g,""),r=Z0(Fc(e));if(r===void 0)return{TAG:1,_0:"could not tokenize"};var u=g(U_.contents,aa(r[0]));if(u===void 0)return{TAG:1,_0:"could not parse"};var a=u[1];if(cr(a))return{TAG:0,_0:u[0]};var t=w(Bt(Nc(a),0,5)," ",K0);return{TAG:1,_0:"could not parse near "+t}}function M_(n,e){var r=n!==void 0?n:3,u={contents:e.length},a=function(t,o,i){for(;;){var _=i,f=o,s=t;if(s){var T=s.hd,d=0;if(typeof T=="number")switch(T){case 2:var R=s.tl;if(R&&R.hd===3){t={hd:2,tl:R.tl};continue}break;case 9:var M=s.tl;if(M&&M.hd===9){t=M.tl;continue}break;case 10:var y=s.tl;if(y&&y.hd===9){t={hd:14,tl:y.tl};continue}break;case 14:var on=s.tl;if(on&&on.hd===9){t={hd:10,tl:on.tl};continue}break;case 18:var cn=s.tl;if(cn&&cn.hd===9){t={hd:36,tl:cn.tl};continue}break;case 19:var En=s.tl;if(En&&En.hd===9){t={hd:37,tl:En.tl};continue}break;case 24:var wn=s.tl;if(wn&&wn.hd===9){t={hd:30,tl:wn.tl};continue}break;case 25:var bn=s.tl;if(bn&&bn.hd===9){t={hd:31,tl:bn.tl};continue}break;case 30:var Tn=s.tl;if(Tn&&Tn.hd===9){t={hd:24,tl:Tn.tl};continue}break;case 31:var mn=s.tl;if(mn&&mn.hd===9){t={hd:25,tl:mn.tl};continue}break;case 36:var Gn=s.tl;if(Gn&&Gn.hd===9){t={hd:18,tl:Gn.tl};continue}break;case 37:var I=s.tl;if(I&&I.hd===9){t={hd:19,tl:I.tl};continue}break}else switch(T.TAG|0){case 0:var X=T._0,Un=0,An=s.tl;if(An){var gn=An.hd;if(typeof gn=="number"){if(gn===3){t=An.tl;continue}Un=3}else switch(gn.TAG|0){case 0:var H=An.tl;if(H){var On=H.hd;if(typeof On=="number"){var Mn=gn._0;if(On!==43){if(On<15)switch(On){case 4:t={hd:{TAG:0,_0:X+Mn|0},tl:H.tl};continue;case 5:t={hd:{TAG:0,_0:X-Mn|0},tl:H.tl};continue;case 6:t={hd:{TAG:0,_0:Math.imul(X,Mn)},tl:H.tl};continue;case 7:t={hd:{TAG:0,_0:co(X,Mn)},tl:H.tl};continue;case 10:t={hd:{TAG:0,_0:X===Mn?1:0},tl:H.tl};continue;case 0:case 1:case 2:case 3:case 8:case 9:case 11:case 12:case 13:break;case 14:t={hd:{TAG:0,_0:X===Mn?0:1},tl:H.tl};continue}}else{t={hd:{TAG:0,_0:_o(X,Mn)},tl:H.tl};continue}}}break;case 15:t={hd:{TAG:14,_0:X},tl:An.tl};continue;default:Un=3}}if(Un===3&&X===0){var fe=s.tl;if(fe.hd===10){t={hd:9,tl:fe.tl};continue}}break;case 1:case 2:case 3:case 9:case 11:d=2;break;case 12:var qn=s.tl;if(qn){var ge=qn.hd;if(typeof ge!="number"&&ge.TAG===11){var he=T._0;if(he===ge._0){t={hd:{TAG:13,_0:he},tl:qn.tl};continue}}}break;case 13:var Zn=s.tl;if(Zn&&Zn.hd===3){t={hd:{TAG:12,_0:T._0},tl:Zn.tl};continue}break}if(d===2){var ne=s.tl;if(ne&&ne.hd===3){t=ne.tl;continue}}o={hd:T,tl:f},t=s.tl;continue}var Wn=mr(f),Jn=fo(Wn);if(!(_>1&&Jn<u.contents))return Wn;u.contents=Jn,i=_-1|0,o=0,t=Wn}};return r>0?Me(a(rt(e),0,r)):e}function sr(n,e){switch(e.TAG|0){case 0:return n===e._0;case 1:return qt(e._1,function(u){return sr(n,u)});case 2:var r=e._0;return r.TAG===0?!1:qt(Vn.toArray(r._0),function(u){return sr(n,u[1])})}}function pa(n,e,r){if(sr(n,e))return{TAG:1,_0:S({TAG:0,_0:n})+" occurs in "+S(e)};var u=Nr(r,n);return u!==void 0?Bn(u,e)?{TAG:0,_0:r}:{TAG:1,_0:S(e)+" is not unifiable with "+S(u)}:{TAG:0,_0:Ur(r,n,e)}}function Je(n,e){for(;;){var r=n;if(!r)return{TAG:0,_0:e};var u=r.tl,a=r.hd,t=a[1],o=a[0],i=0;switch(o.TAG|0){case 0:var _=o._0,f=0;switch(t.TAG|0){case 0:if(_===t._0){n=u;continue}f=3;break;case 1:case 2:f=3;break}if(f===3)return F(pa(_,t,e),function(I){return function(X){return Je(I,X)}}(u));break;case 1:var s=o._1;switch(t.TAG|0){case 0:i=1;break;case 1:var T=t._1;if(o._0===t._0&&s.length===T.length){var d=pn(De(s,T),u,function(I,X){return{hd:[G(e,X[0]),G(e,X[1])],tl:I}});n=d;continue}i=2;break;case 2:i=2;break}break;case 2:var R=o._0;switch(t.TAG|0){case 0:i=1;break;case 1:i=2;break;case 2:var M=t._0;if(R.TAG===0){var y=R._0;if(M.TAG===0){if(y!==M._0)return{TAG:1,_0:"cannot unify "+S(o)+" with "+S(t)};n=u;continue}var on=yn(y);if(on===void 0)return{TAG:1,_0:'undeclared struct "'+y+'"'};var cn=Je({hd:[{TAG:2,_0:{TAG:1,_0:M._0}},je.toPartialStructType(on,le())],tl:u},e);return cn.TAG===0?{TAG:0,_0:cn._0}:{TAG:1,_0:"struct type "+S(t)+" does not match "+y+": "+cn._0}}var En=R._0;if(M.TAG===0){var wn=M._0,bn=yn(wn);if(bn===void 0)return{TAG:1,_0:'undeclared struct "'+wn+'"'};var Tn=Je({hd:[{TAG:2,_0:{TAG:1,_0:En}},je.toPartialStructType(bn,le())],tl:u},e);return Tn.TAG===0?{TAG:0,_0:Tn._0}:{TAG:1,_0:"struct type "+S(o)+" does not match "+wn+": "+Tn._0}}var mn=Vn.toMap(M._0),Gn=Vn.toArray(En);return F(gc(l(Gn,function(I,X,Un){return function(An){var gn=An[0],H=Vt(Un,gn);return H!==void 0?{TAG:0,_0:[An[1],H]}:{TAG:1,_0:"struct type "+S(X)+' is missing attribute "'+gn+'" from type "'+S(I)+'"'}}}(o,t,mn)),function(I){return I}),function(I,X,Un,An){return function(gn){var H={TAG:2,_0:{TAG:1,_0:Vn.fromArray(Ar(so(Un,l(An,function(On){return On[0]}))),le())}};return Je(lo(rt(gn),{hd:[Vn.tail(X),H],tl:I}),e)}}(u,En,mn,Gn))}break}switch(i){case 1:return F(pa(t._0,o,e),function(I){return function(X){return Je(I,X)}}(u));case 2:return{TAG:1,_0:S(o)+" is not unifiable with "+S(t)}}}}function tn(n,e){return Je({hd:[n,e],tl:0},void 0)}function X_(n){var e;return e=typeof n=="number"?Se:n.TAG===0?oe:pe,_t(e)}function V_(n){return n>=5?n>=9?[[0],$n([{TAG:0,_0:0},{TAG:0,_0:0}],pe)]:_t($n([oe,oe],pe)):_t($n([oe,oe],oe))}function B_(n){switch(n){case 0:return _t($n([oe],oe));case 1:return _t($n([pe],pe));case 2:return[[0],$n([tc({TAG:0,_0:0})],{TAG:0,_0:0})]}}function z_(n,e){return"cannot infer struct type: inferred type "+Vn.show(n,S)+" matches "+w(e,", ",function(r){return r.name})}function lr(n){var e=Go(Or(jn.structs),function(u){return go(tn({TAG:2,_0:{TAG:1,_0:n}},je.toPartialStructType(u,le())),void 0,function(a){return u})});if(e.length!==1)return e.length===0?0:{TAG:1,_0:e};var r=e[0];return{TAG:0,_0:r}}var Sa={ambiguousMatchesError:z_,findMatchingStruct:lr},Ke=Zt();function ba(n,e,r,u){var a=kn.typeOf(r);at(Ke,a);var t=pn(e,n,function(i,_){return Xn.addMono(i,_.contents.name,_.contents.ty)}),o=$n(l(e,function(i){return i.contents.ty}),a);return F(Sn(t,r,a),function(i){var _=G(i,o),f=G(i,u),s=vn(i,n),T=xt(s,_);return K(tn(f,_),function(d){ut(Ke);var R=L(d,i);return[R,G(d,f),Yu(d,T)]})})}function Sn(n,e,r){return F(xn(n,e),function(u){return K(tn(G(u,r),G(u,kn.typeOf(e))),function(a){return L(a,u)})})}function xn(n,e){switch(e.TAG|0){case 0:var r=Ft(X_(e._0));return tn(kn.typeOf(e),r);case 1:var u=e._3,a=e._2,t=e._1,o=e._0;return F(xn(n,t),function(c){var E=vn(c,n);return F(xn(E,u),function(m){var A=L(m,c),$=G(A,$n([kn.typeOf(t),kn.typeOf(u)],o)),C=Ft(V_(a));return K(tn($,C),function(x){return L(x,A)})})});case 2:var i=e._2,_=e._1,f=e._0,s=kn.typeOf(i);return F(xn(n,i),function(c){var E=G(c,$n([s],f)),m=Ft(B_(_));return K(tn(E,m),function(A){return L(A,c)})});case 3:var T=e._0.contents,d=Xn.get(n,T.name);if(d!==void 0)return tn(T.ty,Ft(d));var R=yn(T.name);if(R===void 0)return{TAG:1,_0:'unbound variable: "'+T.name+'"'};var M={TAG:2,_0:{TAG:1,_0:Vn.fromArray(l(R.staticFuncs,function(c){var E=c.name;return[E.contents.name,E.contents.ty]}),le())}};return tn(T.ty,M);case 4:var y=e._1,on=e._0,cn=hn.typeOfExpr(on),En=hn.typeOfExpr(y);return F(xn(n,y),function(c){var E=vn(c,n),m=G(c,cn);return F(Sn(E,on,m),function(A){var $=L(A,c),C=G(A,m),x=G($,En);return K(tn(C,x),function(J){return L(J,$)})})});case 5:return K(ba(n,e._1,e._2,e._0),function(c){return c[0]});case 6:var wn=e._4,bn=e._3,Tn=e._0,mn=e._2.contents,Gn=kn.typeOf(bn);return F(xn(n,bn),function(c){var E=vn(c,n),m=G(c,Gn),A=G(c,Tn),$=xt(Xn.remove(E,mn.name),m),C=Xn.add(E,mn.name,$);return F(Sn(C,wn,A),function(x){var J=L(x,c);return K(tn(G(J,Gn),G(J,mn.ty)),function(Fn){return L(Fn,J)})})});case 7:var I=e._4,X=e._3,Un=e._2,An=e._0,gn=e._1.contents,H=kn.typeOf(X);at(Ke,H);var On=$n(l(Un,function(c){return c.contents.ty}),H),Mn=pn(Un,n,function(c,E){return Xn.addMono(c,E.contents.name,E.contents.ty)}),fe=Xn.addMono(Mn,gn.name,On);return F(Sn(fe,X,H),function(c){var E=vn(c,fe),m=G(c,On),A=G(c,An),$=Xn.add(E,gn.name,xt(E,m));return F(Sn($,I,A),function(C){var x=L(C,c);return K(tn(gn.ty,G(C,m)),function(J){return ut(Ke),L(J,x)})})});case 8:var qn=e._2,ge=l(qn,kn.typeOf),he=$n(ge,e._0);return K(F(Sn(n,e._1,he),function(c){return pn(De(qn,ge),{TAG:0,_0:[c,vn(c,n)]},function(E,m){var A=m[1],$=m[0];return F(E,function(C){var x=C[1],J=C[0],Fn=G(J,A);return K(Sn(x,$,Fn),function(Kn){return[L(Kn,J),vn(Kn,x)]})})})}),function(c){return c[0]});case 9:var Zn=e._2,ne=e._0;return F(pn(e._1,{TAG:0,_0:[void 0,n]},function(c,E){return F(c,function(m){var A=m[1],$=m[0];return K(P_(A,E),function(C){return[L(C,$),vn(C,A)]})})}),function(c){var E=c[0];return Zn!==void 0?F(xn(vn(E,n),Zn),function(m){var A=kn.typeOf(Zn),$=L(m,E);return K(tn(G($,ne),G($,A)),function(C){return L(C,$)})}):K(tn(G(E,ne),Se),function(m){return L(m,E)})});case 10:var Wn=e._3,Jn=e._2,He=e._0;return F(Sn(n,e._1,pe),function(c){var E=vn(c,n),m=G(c,He);return F(Sn(E,Jn,m),function(A){var $=vn(A,E),C=G(A,m),x=L(A,c);return K(Sn($,Wn,C),function(J){return L(J,x)})})});case 11:var Tt=e._1,Qe=kn.typeOf(Tt);return F(xn(n,e._0),function(c){var E=G(c,Qe),m=vn(c,n);return K(Sn(m,Tt,E),function(A){return L(A,c)})});case 12:var ye=Xe(Ke);return ye!==void 0?Sn(n,un(e._0,{TAG:0,_0:0},function(c){return c}),ye):{TAG:1,_0:"'return' used outside of a function"};case 13:return Sn(n,e._0,e._1);case 14:var Gt=pn(e._0,{TAG:0,_0:[Pe,n]},function(c,E){return F(c,function(m){var A=m[1],$=m[0];return F(xn(A,E),function(C){var x=L(C,$),J=vn(C,A);return{TAG:0,_0:[x,J]}})})});return K(Gt,function(c){return c[0]});case 15:var Ie=e._1,Ee=e._0,Ue=yn(Ee);if(Ue===void 0)return{TAG:1,_0:'undeclared struct "'+Ee+'"'};var xe=Ue.attributes,gt=pn(jt(xe,function(c){return me(c.impl)}),{TAG:0,_0:[n,Pe]},function(c,E){var m=E.ty,A=E.name;return F(c,function($){var C=$[1],x=$[0],J=ht(Ie,function(Fn){return Fn[0]===A});return J!==void 0?F(Sn(x,J[1],m),function(Fn){var Kn=vn(Fn,x),Fe=L(Fn,C);return{TAG:0,_0:[Kn,Fe]}}):{TAG:1,_0:'missing attribute "'+A+'" for struct "'+Ee+'"'}})}),nt=nr(Ie,function(c){var E=c[0];if(!qt(xe,function(m){return m.name===E}))return E});return nt!==void 0?{TAG:1,_0:'extraneous attribute: "'+nt+'" for struct "'+Ee+'"'}:K(gt,function(c){return c[1]});case 16:var ke=e._2,et=e._1,q=e._0;return F(xn(n,et),function(c){var E=hn.typeOfExpr(et),m=G(c,E),A=function(U){return Mr(m,G(U,E))?Sn(vn(U,n),e,G(U,q)):{TAG:0,_0:U}};switch(m.TAG|0){case 0:case 1:break;case 2:var $=m._0;if($.TAG===0){var C=$._0,x=yn(C);if(x===void 0)return{TAG:1,_0:'undeclared struct: "'+C+'"'};var J=ht(x.attributes,function(U){return U.name===ke});if(J===void 0)return{TAG:1,_0:'attribute "'+ke+'" does not exist on struct "'+C+'"'};var Fn=un(J.impl,J.ty,function(U){return U[0].contents.ty});return K(tn(G(c,q),G(c,Fn)),function(U){return L(U,c)})}var Kn=$._0,Fe=Vt(Vn.toMap(Kn),ke);if(Fe!==void 0)return K(tn(G(c,q),G(c,Fe)),function(U){return L(U,c)});var tt=Vn.insert(Kn,ke,q),Oe=G(c,{TAG:2,_0:{TAG:1,_0:tt}}),V=lr(tt);if(typeof V!="number")return V.TAG===0?F(tn(m,{TAG:2,_0:{TAG:0,_0:V._0.name}}),function(U){return A(L(U,c))}):F(tn(m,Oe),function(U){return A(L(U,c))});var Nn=0;switch(E.TAG|0){case 0:return{TAG:0,_0:L(Ur(Pe,E._0,Oe),c)};case 1:case 2:Nn=2;break}if(Nn===2)return K(tn(E,Oe),function(U){return L(U,c)});break}var Dn=le(),_n=Vn.insert(Vn.make({TAG:0,_0:Dn}),ke,q),Rn=G(c,{TAG:2,_0:{TAG:1,_0:_n}}),Yn=lr(_n);return typeof Yn=="number"?{TAG:1,_0:"no struct declaration matches type "+S(Rn)}:Yn.TAG===0?F(tn(m,{TAG:2,_0:{TAG:0,_0:Yn._0.name}}),function(U){return A(L(U,c))}):F(tn(m,Rn),function(U){return A(L(U,c))})})}}function P_(n,e){return xn(n,e._0)}function vr(n,e){return n+"_"+e}function Aa(n,e){switch(e.TAG|0){case 0:var r=e._0;return K(ba(n,l(e._1,function(_){return _[0]}),e._2,r.contents.ty),function(_){var f=_[0];return[vn(f,Xn.addMono(n,r.contents.name,r.contents.ty)),f]});case 1:var u=e._0;return K(Sn(n,e._2,u.contents.ty),function(_){return[vn(_,Xn.addMono(n,u.contents.name,u.contents.ty)),_]});case 2:return{TAG:0,_0:[n,Pe]};case 3:var a=e._0,t=yn(a);return t!==void 0?pn(e._1,{TAG:0,_0:[n,Pe]},function(_,f){var s=f[2],T=f[1],d=f[0];return F(_,function(R){var M=R[1],y=R[0];d.contents.newName=vr(a,d.contents.name);var on=un(Ne(T,0),[!1,!1],function(Gn){return Gn[0].contents.name==="self"?[!0,Gn[1]]:[!1,!1]}),cn;if(on[0]){je.addImplementation(t,d,on[1]);var En=Bn(T,[])?[]:To(T,1),wn={TAG:2,_0:{TAG:0,_0:a}},bn=Ne(T,0),Tn;if(bn!==void 0){var mn=bn[0];mn.contents.ty=wn,Tn=Xn.addMono(y,mn.contents.name,wn)}else Tn=y;cn=[Tn,En]}else je.addStaticFunc(t,d),cn=[n,T];return F(Aa(cn[0],{TAG:0,_0:d,_1:cn[1],_2:s}),function(Gn){var I=L(Gn[1],M);yu(I,d);var X=Xn.remove(Gn[0],d.contents.name);return{TAG:0,_0:[X,I]}})})}):{TAG:1,_0:'cannot implement for unknown type "'+a+'"'};case 4:var o=e.name,i=$n(l(e.args,function(_){return _[0].contents.ty}),e.ret);return K(tn(o.contents.ty,i),function(_){return[vn(_,Xn.addMono(n,o.contents.name,o.contents.ty)),_]})}}function j_(n){return vo(Ke),pn(n,{TAG:0,_0:[Xn.empty,Pe]},function(e,r){return F(e,function(u){var a=u[1];return K(Aa(u[0],r),function(t){return[t[0],L(t[1],a)]})})})}var Ye=sn("CompilerExn.InvalidTypeConversion"),dr=sn("CompilerExn.InvalidFunctionSignature"),$t=sn("CompilerExn.VariableNotFound"),ka=sn("CompilerExn.EmptyFunctionStack"),$e=sn("CompilerExn.CannotReassignImmutableValue"),Fa=sn("CompilerExn.FunctionNotFound"),Ae=sn("CompilerExn.Unimplemented"),q_=sn("CompilerExn.UnsupportedGlobalInitializer"),Cn=sn("CompilerExn.InvalidTypeAssertion"),Na=sn("CompilerExn.DerefUsedOutsideOfUnsafeBlock"),Da=sn("CompilerExn.UndeclaredStruct"),Ct=sn("CompilerExn.InvalidAttributeAccess"),Ra=sn("CompilerExn.StructTypeNotMatched"),La=sn("CompilerExn.AmibguousStruct");function $a(n){return n.RE_EXN_ID===Ye?"unsupported type: "+S(n._1):n.RE_EXN_ID===dr?"invalid function signature: "+S(n._1):n.RE_EXN_ID===$t?'variable "'+n._1+'" not found':n.RE_EXN_ID===ka?"Function stack is empty":n.RE_EXN_ID===$e?'cannot mutate "'+n._1+'" as it is behind an immutable binding':n.RE_EXN_ID===Fa?'no function named "'+n._1+'" found':n.RE_EXN_ID===Ae?"unimplemented: "+n._1:n.RE_EXN_ID===q_?"unsupported global initializer: "+kn.show(void 0,n._1):n.RE_EXN_ID===Cn?"invalid type assertion from "+S(n._1)+" to "+S(n._2):n.RE_EXN_ID===Na?"the deref operator can only be used in an unsafe block":n.RE_EXN_ID===ie.UnkownTypeSize?"unknown type size: "+S(n._1):n.RE_EXN_ID===Da?'undeclared struct "'+n._1+'"':n.RE_EXN_ID===Ct?n._1+' does not exist for type "'+S(n._2)+'"':n.RE_EXN_ID===Ra?"No struct declaration matches type "+S(n._1):n.RE_EXN_ID===La?Sa.ambiguousMatchesError(n._1,n._2):n.RE_EXN_ID===hn.UndeclaredIdentifer?'identifier "'+n._1+'" not found':n.RE_EXN_ID===hn.UnexpectedDeclarationInImplBlock?"unexpected declaration in impl block: "+ar.show(void 0,n._1):n.RE_EXN_ID===hn.UnreachableLetStmt?"unreachable: let statement found in Core.fromStmt":"unexpected compiler exception"}function Z_(n,e,r,u){return{name:n,depth:e,ty:r,isMutable:u}}function Tr(n){if(n.TAG===0){var e=n._0,r=yn(e);if(r!==void 0)return r;throw{RE_EXN_ID:Da,_1:e,Error:new Error}}var u=n._0,a=Sa.findMatchingStruct(u);if(typeof a=="number")throw{RE_EXN_ID:Ra,_1:{TAG:2,_0:n},Error:new Error};if(a.TAG===0)return a._0;throw{RE_EXN_ID:La,_1:u,_2:a._0,Error:new Error}}function Ce(n){switch(n.TAG|0){case 0:throw{RE_EXN_ID:Ye,_1:n,Error:new Error};case 1:switch(n._0){case"()":if(n._1.length!==0)throw{RE_EXN_ID:Ye,_1:n,Error:new Error};return[];case"Fun":case"Ptr":return[0];case"Tuple":return fn(l(n._1,Ce));case"bool":case"u32":break;case"u64":if(n._1.length!==0)throw{RE_EXN_ID:Ye,_1:n,Error:new Error};return[1];default:throw{RE_EXN_ID:Ye,_1:n,Error:new Error}}if(n._1.length!==0)throw{RE_EXN_ID:Ye,_1:n,Error:new Error};return[0];case 2:var e=Tr(n._0);return e.size===0?[]:[0]}}function W_(n,e){switch(e.TAG|0){case 1:if(e._0==="Tuple"){var r=fn(l(e._1,Ce)),u=[],a={_0:u,_1:r},t=Pn.getOrAddSignature(n,a);return{TAG:1,_0:t,_1:[[],r]}}break}var o=Ce(e),i=o.length;if(i!==1){if(i===0)return 0;throw{RE_EXN_ID:Ae,_1:"wasmBlockReturnTypeOf for "+S(e),Error:new Error}}var _=o[0];return{TAG:0,_0:_}}function Gr(n){switch(n.TAG|0){case 1:if(n._0==="Fun"){var e=n._1,r=e.slice(0,e.length-1|0),u=Ne(e,e.length-1|0);return Vr(it.Signature.make,fn(l(r,Ce)),un(u,[],Ce))}throw{RE_EXN_ID:dr,_1:n,Error:new Error};case 0:case 2:throw{RE_EXN_ID:dr,_1:n,Error:new Error}}}function gr(n,e,r){return{name:n,locals:[],params:jt(e,function(u){return!ie.isZeroSizedType(u[1])}),ret:r,instructions:[]}}function k(n,e){n.instructions.push(e)}function J_(n,e,r,u,a){return n.locals.push(Z_(e,u,r,a)),(n.params.length+n.locals.length|0)-1|0}function K_(n,e){var r=Xt(n.params,function(t){return t[0]===e});if(r!==void 0){var u=we(n.params,r);return[r,u[2]]}var a=Hu(n.locals,function(t){return t.name===e});if(a!==void 0)return[n.params.length+a|0,we(n.locals,a).isMutable]}function Y_(n){var e=Gr($n(l(n.params,function(a){return a[1]}),n.ret)),r=g(it.Local.fromTypes,fn(l(n.locals,function(a){return l(Ce(a.ty),function(t){return[a.name,t]})}))),u=Vr(it.Body.make,r,M_(void 0,n.instructions));return it.make(n.name,e,u)}function Ca(n,e,r,u,a){return{name:n,mutability:e,ty:r,index:u,init:a}}function H_(n){var e=n.init,r=n.mutability;return Q(n.ty,function(u){return ct.make(r!==2,u,e)})}function b(n){var e=Xe(n.funcStack);if(e!==void 0)return e;throw{RE_EXN_ID:ka,Error:new Error}}function hr(n,e){return Q(Qu(n.funcs,function(r){return r.name===e}),function(r){var u=n.externFuncs.length;return[r[0],u+r[1]|0]})}function Q_(n,e){return Qu(n.externFuncs,function(r){return r.name===e})}function y_(n,e){var r=Xe(n.blockStack);if(r!==void 0&&!(e<=0)){var u=r.shadowStackDelta;return u.contents=u.contents+e|0,k(b(n),{TAG:9,_0:n.stackTop.index}),k(b(n),{TAG:0,_0:e}),k(b(n),5),k(b(n),{TAG:10,_0:n.stackTop.index})}}function I_(n,e){var r=Xe(n.blockStack);if(r!==void 0&&!(e<=0)){var u=r.shadowStackDelta;return u.contents=u.contents-e|0,k(b(n),{TAG:9,_0:n.stackTop.index}),k(b(n),{TAG:0,_0:e}),k(b(n),4),k(b(n),{TAG:10,_0:n.stackTop.index})}}function Ua(n){var e=Xe(n.blockStack);return e!==void 0?e.isUnsafe:!1}function Oa(n,e){return n.scopeDepth=n.scopeDepth+1|0,at(n.blockStack,{isUnsafe:e||Ua(n),shadowStackDelta:{contents:0}})}function x_(n){n.scopeDepth=n.scopeDepth-1|0,I_(n,un(Xe(n.blockStack),0,function(e){return e.shadowStackDelta.contents})),ut(n.blockStack)}function nf(n,e,r,u){var a=b(n),t=J_(a,e,r,n.scopeDepth,u);return k(b(n),{TAG:12,_0:t})}function Ma(n,e,r,u,a){var t=wo(n.globals),o=Ca(e,r,u,t,a);return Pt(n.globals,e,o),t}function Ut(n,e){var r=b(n),u=K_(r,e);return u!==void 0?{TAG:0,_0:u[0],_1:u[1]}:Q(Rr(n.globals,e),function(a){return{TAG:1,_0:a.index,_1:a.mutability===1}})}function ef(n){if(typeof n!="number")return n.TAG===0?{TAG:0,_0:n._0}:{TAG:0,_0:n._0?1:0}}function Xa(n){if(!Ua(n))throw{RE_EXN_ID:Na,Error:new Error}}function Ot(n,e,r){switch(e.TAG|0){case 0:case 1:return{TAG:1,_0:{RE_EXN_ID:Ct,_1:r,_2:e}};case 2:var u=Tr(e._0),a=ht(u.attributes,function(i){return i.name===r});if(a===void 0)return{TAG:1,_0:{RE_EXN_ID:Ct,_1:r,_2:e}};var t=a.impl;if(t===void 0)return{TAG:0,_0:{TAG:0,_0:{offset:a.offset,ty:a.ty,size:a.size,mut:a.mut}}};var o=hr(n,vr(u.name,t[0].contents.name));return o!==void 0?{TAG:0,_0:{TAG:1,_0:[o[0],o[1],t[1]]}}:{TAG:1,_0:{RE_EXN_ID:Ct,_1:r,_2:e}}}}function Va(n){return Qn(void 0,"__lambda"+String(n.funcs.length)+"__")}function Mt(n,e){for(;;){var r=e;switch(r.TAG|0){case 3:var u=r._0,a=Ut(n,u.contents.newName);if(a!==void 0)return a._1?void 0:u.contents.name;throw{RE_EXN_ID:$t,_1:u.contents.name,Error:new Error};case 16:var t=r._2,o=r._1,i=Ot(n,hn.typeOfExpr(o),t);if(i.TAG===0){var _=i._0;if(_.TAG!==0)return;if(!_._0.mut)return t;e=o;continue}throw i._0;default:return}}}function W(n,e){for(;;){var r=e;switch(r.TAG|0){case 0:var u=ef(r._0);return u!==void 0?k(b(n),u):void 0;case 1:var a=r._2,t=r._1;if(ie.isZeroSizedType(hn.typeOfExpr(t))){e={TAG:0,_0:{TAG:1,_0:a===9}};continue}var o;switch(a){case 0:o=4;break;case 1:o=5;break;case 2:o=6;break;case 3:o=7;break;case 4:o=43;break;case 5:o=31;break;case 6:o=19;break;case 7:o=37;break;case 8:o=25;break;case 9:o=10;break;case 10:o=14;break}return W(n,t),W(n,r._3),k(b(n),o);case 2:var i;switch(r._1){case 0:throw{RE_EXN_ID:Ae,_1:"u32 negation is not handled",Error:new Error};case 1:i=9;break;case 2:Xa(n),i={TAG:16,_0:0,_1:0};break}return W(n,r._2),k(b(n),i);case 3:var _=r._0;if(ie.isZeroSizedType(_.contents.ty))return;var f=Ut(n,_.contents.newName);if(f!==void 0)return f.TAG===0?k(b(n),{TAG:11,_0:f._0}):k(b(n),{TAG:9,_0:f._0});throw{RE_EXN_ID:$t,_1:_.contents.name,Error:new Error};case 4:var s=r._1,T=r._0;if(ie.isZeroSizedType(hn.typeOfExpr(s)))return;switch(T.TAG|0){case 2:if(T._1>=2){Xa(n),W(n,T._2),W(n,s);var d=ie.sizeLog2(hn.typeOfExpr(s)),R={TAG:17,_0:d,_1:0};return k(b(n),R)}throw{RE_EXN_ID:Ae,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error};case 3:var M=T._0,y=Ut(n,M.contents.newName);if(y!==void 0){if(y._1){var on;return on=y.TAG===0?{TAG:12,_0:y._0}:{TAG:10,_0:y._0},W(n,s),k(b(n),on)}throw{RE_EXN_ID:$e,_1:M.contents.name,Error:new Error}}throw{RE_EXN_ID:$t,_1:M.contents.name,Error:new Error};case 16:var cn=T._2,En=T._1,wn=Ot(n,hn.typeOfExpr(En),cn);if(wn.TAG===0){var bn=wn._0;if(bn.TAG===0){var Tn=bn._0;if(!Tn.mut)throw{RE_EXN_ID:$e,_1:cn,Error:new Error};var mn=Mt(n,En);if(mn!==void 0)throw{RE_EXN_ID:$e,_1:mn,Error:new Error};return Tn.size>0?(W(n,En),W(n,s),k(b(n),{TAG:17,_0:0,_1:Tn.offset})):void 0}throw{RE_EXN_ID:Ae,_1:"cannot reassign "+cn+" for type "+S(hn.typeOfExpr(En)),Error:new Error}}throw wn._0;default:throw{RE_EXN_ID:Ae,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error}}case 5:var Gn=Va(n),I=Er(n,Gn,l(r._1,function(V){return[V,!1]}),r._2);return k(b(n),{TAG:0,_0:I});case 6:var X=r._3,Un=r._2.contents;ie.isZeroSizedType(hn.typeOfExpr(X))||(W(n,X),nf(n,Un.name,Un.ty,r._1)),e=r._4;continue;case 7:var An=Va(n);r._1.contents.newName=An.contents.name,Er(n,An,l(r._2,function(V){return[V,!1]}),r._3),e=r._4;continue;case 8:var gn=r._2,H=r._1,On=function(V){return function(Dn){return Ln(V,function(_n){return W(n,_n)}),k(b(n),{TAG:14,_0:Dn})}}(gn),Mn=function(V,Nn){return function(_n){Ln(Nn,function(Pa){return W(n,Pa)});var Rn=hn.typeOfExpr(V),Yn=Gr(Rn),U=Pn.getOrAddSignature(n.mod,Yn);return W(n,V),k(b(n),{TAG:15,_0:U,_1:0})}}(H,gn),fe=function(V){return function(Dn,_n){var Rn=_n!==void 0?nn([_n],V):V;return Ln(De(Rn,Dn),function(Yn){var U=Yn[1];if(!!(U[2]&&Qt(U[1])&&wt(Mt(n,Yn[0]))))throw{RE_EXN_ID:$e,_1:U[0],Error:new Error}})}}(gn);switch(H.TAG|0){case 3:var qn=H._0,ge=Ut(n,qn.contents.newName);if(ge!==void 0)return Mn(void 0);var he=hr(n,qn.contents.newName);if(he!==void 0)return fe(he[0].params,void 0),On(he[1]);var Zn=Q_(n,qn.contents.newName);if(Zn!==void 0)return fe(Zn[0].args,void 0),On(Zn[1]);throw{RE_EXN_ID:Fa,_1:qn.contents.name,Error:new Error};case 16:var ne=H._2,Wn=H._1,Jn;if(Wn.TAG===3){var He=Wn._0.contents.name,Tt=yn(He);if(Tt!==void 0){var Qe=hr(n,vr(He,ne));if(Qe!==void 0)Jn=[!1,Qe[0],Qe[1]];else throw{RE_EXN_ID:Ae,_1:'static function "'+ne+'" does not exists on struct '+He,Error:new Error}}else Jn=[!0,void 0,void 0]}else Jn=[!0,void 0,void 0];var ye=Jn[2],Gt=Jn[1],Ie=Jn[0],Ee;if(Gt!==void 0)Ee=Gt;else{var Ue=Ot(n,hn.typeOfExpr(Wn),ne);if(Ue.TAG===0){var xe=Ue._0;Ee=xe.TAG===0?void 0:xe._0[0]}else throw Ue._0}return un(Ee,void 0,function(V,Nn){return function(Dn){var _n=Nn?V:void 0;return fe(Dn.params,_n)}}(Wn,Ie)),Ie&&W(n,Wn),ye!==void 0?On(ye):Mn(void 0);default:return Mn(void 0)}case 9:var gt=r._2;return Oa(n,r._3===1),Ln(r._1,function(V){return tf(n,V)}),gt!==void 0&&W(n,gt),x_(n);case 10:var nt=r._3,ke=W_(n.mod,r._0);return W(n,r._1),k(b(n),{TAG:4,_0:ke}),W(n,r._2),Mr(nt,{TAG:0,_0:0})&&(k(b(n),0),W(n,nt)),k(b(n),1);case 11:return k(b(n),{TAG:7,_0:0}),k(b(n),{TAG:8,_0:0}),W(n,r._0),k(b(n),9),k(b(n),{TAG:5,_0:1}),W(n,r._1),k(b(n),{TAG:6,_0:0}),k(b(n),1),k(b(n),1);case 12:var et=r._0;return et!==void 0&&W(n,et),k(b(n),2);case 13:var q=r._2,c=r._1;if(!Bn(c,q))switch(c.TAG|0){case 1:switch(c._0){case"Ptr":var E=c._1;if(E.length!==1)throw{RE_EXN_ID:Cn,_1:c,_2:q,Error:new Error};var m=E[0];switch(m.TAG|0){case 1:if(m._0==="u32"){if(m._1.length!==0)throw{RE_EXN_ID:Cn,_1:c,_2:q,Error:new Error};switch(q.TAG|0){case 1:if(q._0==="u32"){if(q._1.length!==0)throw{RE_EXN_ID:Cn,_1:c,_2:q,Error:new Error}}else throw{RE_EXN_ID:Cn,_1:c,_2:q,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:Cn,_1:c,_2:q,Error:new Error}}}else throw{RE_EXN_ID:Cn,_1:c,_2:q,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:Cn,_1:c,_2:q,Error:new Error}}break;case"u32":if(c._1.length!==0)throw{RE_EXN_ID:Cn,_1:c,_2:q,Error:new Error};switch(q.TAG|0){case 1:if(q._0==="Ptr"){if(q._1.length!==1)throw{RE_EXN_ID:Cn,_1:c,_2:q,Error:new Error}}else throw{RE_EXN_ID:Cn,_1:c,_2:q,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:Cn,_1:c,_2:q,Error:new Error}}break;default:throw{RE_EXN_ID:Cn,_1:c,_2:q,Error:new Error}}break;case 0:case 2:throw{RE_EXN_ID:Cn,_1:c,_2:q,Error:new Error}}e=r._0;continue;case 14:return Ln(r._0,function(V){return W(n,V)});case 15:var A=r._1,$=Cr(yn(r._0)),C=$.size;y_(n,C),Ln(De($.attributes,A),function(V){var Nn=V[0],Dn=Nn.ty;if(Nn.mut&&Qt(Dn)){var _n=Mt(n,V[1][1]);if(_n!==void 0)throw{RE_EXN_ID:$e,_1:_n,Error:new Error}}if(me(Nn.impl)&&ie.size(Dn)>0)return k(b(n),{TAG:9,_0:n.stackTop.index})}),C>0&&k(b(n),{TAG:9,_0:n.stackTop.index});var x={contents:0};return Ln(A,function(V){return function(Nn){var Dn=Nn[1],_n=function(U){W(n,Dn),k(b(n),{TAG:17,_0:0,_1:V.contents}),V.contents=V.contents+U|0},Rn=kn.typeOf(Dn);switch(Rn.TAG|0){case 0:break;case 1:var Yn=0;switch(Rn._0){case"()":if(Rn._1.length===0)return;break;case"Fun":return _n(4);case"Ptr":if(Rn._1.length===1)return _n(4);break;case"bool":case"u32":Yn=2;break}if(Yn===2&&Rn._1.length===0)return _n(4);break;case 2:return Tr(Rn._0),_n(4)}throw{RE_EXN_ID:Ae,_1:"cannot store "+S(Rn)+" in the shadow stack",Error:new Error}}}(x));case 16:var J=r._1,Fn=Ot(n,hn.typeOfExpr(J),r._2);if(Fn.TAG===0){var Kn=Fn._0;if(Kn.TAG===0){var Fe=Kn._0;return ie.isZeroSizedType(Fe.ty)?void 0:(W(n,J),k(b(n),{TAG:16,_0:0,_1:Fe.offset}))}var tt=Kn._0;if(tt[2]){var Oe=Mt(n,J);if(Oe!==void 0)throw{RE_EXN_ID:$e,_1:Oe,Error:new Error}}return k(b(n),{TAG:0,_0:tt[1]})}throw Fn._0}}}function tf(n,e){var r=e._0;return W(n,r),Ln(Ce(kn.typeOf(r)),function(u){return k(b(n),3)})}function Er(n,e,r,u){var a=l(r,function(i){var _=i[0];return[_.contents.name,_.contents.ty,i[1]||!Qt(_.contents.ty)]}),t=gr(e.contents.newName,a,kn.typeOf(u)),o=n.funcs.push(t)-1|0;return at(n.funcStack,t),W(n,u),k(b(n),1),ut(n.funcStack),o}function rf(n,e){var r=gr("__isolated__",[],hn.typeOfExpr(e));return at(n.funcStack,r),W(n,e),ut(n.funcStack),r}function Ba(n,e){switch(e.TAG|0){case 0:Er(n,e._0,e._1,e._2);return;case 1:var r=e._1,u=e._0;Oa(n,!1);var a=rf(n,e._2),t=a.instructions;if(t.length===1){var o=t[0];if(typeof o!="number"&&o.TAG===0){Ma(n,u.contents.name,r?1:2,0,g(ct.Initializer.fromInstructions,[{TAG:0,_0:o._0}]));return}}Eo(n.globalsInitializer.instructions,"push",[t]);var i=Ma(n,u.contents.name,r?1:0,0,g(ct.Initializer.fromInstructions,[{TAG:0,_0:0}]));n.globalsInitializer.instructions.push({TAG:10,_0:i});return;case 2:return;case 3:return Ln(e._1,function(T){return Ba(n,{TAG:0,_0:T[0],_1:T[1],_2:T[2]})});case 4:var _=e.name,f=Gr(_.contents.ty),s=Pn.getOrAddSignature(n.mod,f);Pn.addImport(n.mod,Uu.make("index",_.contents.name,{_0:s})),n.externFuncs.push({name:_.contents.name,args:l(e.args,function(T){var d=T[0];return[d.contents.name,d.contents.ty,T[1]]}),ret:e.ret});return}}function uf(n){var e={mod:Pn.make(void 0),funcs:[],scopeDepth:0,funcStack:Zt(),globals:Dr(1),globalsInitializer:gr("__initGlobals__",[],Se),stackTop:Ca("__STACK_TOP__",1,0,0,g(ct.Initializer.fromInstructions,[{TAG:0,_0:65535}])),blockStack:Zt(),externFuncs:[]};Pt(e.globals,e.stackTop.name,e.stackTop);try{Ln(n,function(o){return Ba(e,o)}),Pn.addMemory(e.mod,ku.make(Yt.make(6,void 0))),Ln(ho(Or(e.globals),function(o,i){return o.index-i.index|0}),function(o){var i=H_(o);if(i!==void 0)return Pn.addGlobal(e.mod,i)});var r=Gu.fromFuncRefs(0,pr(e.funcs,function(o,i){return o}));Pn.addElement(e.mod,r),Pn.addTable(e.mod,su.make(0,Yt.makeExact(e.funcs.length)));var u=e.funcs.length,a=e.globalsInitializer.instructions.length===0;return a||(e.globalsInitializer.instructions.push(1),e.funcs.push(e.globalsInitializer)),Ln(e.funcs,function(o){o.name==="main"&&!a&&o.instructions.unshift({TAG:14,_0:u});var i=Y_(o);Pn.addExportedFunc(e.mod,o.name,i[1],i[2])}),{TAG:0,_0:e.mod}}catch(o){var t=Xr(o);return{TAG:1,_0:$a(t)}}}function af(n){try{return F(O_(n),function(r){var u=l(r,ar.from);return F(j_(u),function(a){var t=a[1];bc(t);var o=l(u,function(i){return ar.subst(t,i)});return K(uf(o),function(i){var _=Pn.encodeAsUint8Array(i);return[i,_]})})})}catch(r){var e=Xr(r);return{TAG:1,_0:$a(e)}}}var of=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",compile:af});const D={"0":"I32","1":"I64","2":"F32","3":"F64"},wr={"0":"Else","1":"End","2":"Return","3":"Drop","4":"AddI32","5":"SubI32","6":"MulI32","7":"DivI32Unsigned","8":"DivI32Signed","9":"EqzI32","10":"EqI32","11":"EqI64","12":"EqF32","13":"EqF64","14":"NeI32","15":"NeI64","16":"NeF32","17":"NeF64","18":"LeI32Signed","19":"LeI32Unsigned","20":"LeI64Signed","21":"LeI64Unsigned","22":"LeF32","23":"LeF64","24":"GeI32Signed","25":"GeI32Unsigned","26":"GeI64Signed","27":"GeI64Unsigned","28":"GeF32","29":"GeF64","30":"LtI32Signed","31":"LtI32Unsigned","32":"LtI64Signed","33":"LtI64Unsigned","34":"LtF32","35":"LtF64","36":"GtI32Signed","37":"GtI32Unsigned","38":"GtI64Signed","39":"GtI64Unsigned","40":"GtF32","41":"GtF64","42":"RemI32Signed","43":"RemI32Unsigned","44":"And"},cf={"0":"FuncRef","1":"ExternRef"},_f={"0":"Func","1":"Table","2":"Memory","3":"Global"},Ge={"0":"Void"},ff=of,za=function(n){const e=ff.compile(n);return e.TAG===0?{tag:"Ok",value:[{typeSection:e._0[0].typeSection.map(function(u){return[u._0.map(function(t){return D[t]}),u._1.map(function(t){return D[t]})]}),importSection:e._0[0].importSection.map(function(u){return{moduleName:u.moduleName,entityName:u.entityName,desc:{tag:"Func",value:u.desc._0}}}),funcSection:e._0[0].funcSection,tableSection:e._0[0].tableSection.map(function(u){return[cf[u[0]],u[1]]}),memorySection:e._0[0].memorySection,globalSection:e._0[0].globalSection.map(function(u){return[D[u[0]],u[1],u[2].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:{tag:"StoreI32",value:[t._0,t._1]}:wr[t]})]}),exportSection:e._0[0].exportSection.map(function(u){return{name:u.name,kind:_f[u.kind],index:u.index}}),elementSection:e._0[0].elementSection,codeSection:e._0[0].codeSection.map(function(u){return[u[0].map(function(t){return[t[0],D[t[1]]]}),u[1].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:{tag:"StoreI32",value:[t._0,t._1]}:wr[t]})]}),funcs:e._0[0].funcs.map(function(u){return[u[0],[u[1]._0.map(function(t){return D[t]}),u[1]._1.map(function(t){return D[t]})],[u[2][0].map(function(t){return[t[0],D[t[1]]]}),u[2][1].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:D[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return D[i]}),t._0._1[1].map(function(i){return D[i]})]]}:Ge[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:{tag:"StoreI32",value:[t._0,t._1]}:wr[t]})]]})},e._0[1]]}:{tag:"Error",value:e._0}};var sf=`
let SIZEOF_U32 = 4;

struct Array {
  start: Ptr<u32>,
  mut length: u32,
}

impl Array {
  fn read(self, n) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>)
  }

  fn write(self, n, val) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>) = val;
  }

  fn push(mut self, val) {
    self.write(self.length, val);
    self.length = self.length + 1;
  }
}

struct Sieve {
  mut primes: Array,
  mut current: u32
}

impl Sieve {
  fn clear(mut self) {
    self.primes.length = 0;
    // 2 is the first prime
    self.primes.push(2);
    self.current = 1;
  }

  fn isPrime(mut self, n) {
    mut i = 0;
    mut p = self.primes.read(i);

    while p * p <= n {
      if n % p == 0 { return false; }
      i = i + 1;
      p = self.primes.read(i);
    }

    // n is prime
    // add it to the sieve
    self.primes.push(n);

    true
  }

  fn nextPrime(mut self) {
    self.current = self.current + 2;

    while !self.isPrime(self.current) {
      self.current = self.current + 2;
    }

    self.current
  }

  // count the prime numbers <= m
  fn countUpTo(mut self, m) {
    self.clear();

    while self.current <= m {
      self.nextPrime();
    }

    self.primes.length - 1
  }
}

// right after the shadow stack
let PRIMES_START = 64 * 1024;

fn main() {
  mut sieve = Sieve {
    primes: Array {
      start: PRIMES_START as Ptr<u32>,
      length: 0
    },
    current: 0
  };

  sieve.countUpTo(1000000)
}`,lf=`
fn fact(n) {
  let aux = (n, acc) -> if n == 0 { acc } else { aux(n - 1, n * acc) };
  aux(n, 1)
}

fn main() {
  fact(11)
}`,vf=`
fn fib(n) {
  let fib_aux = (n, a, b) -> {
    if n == 0 { return a; }
    if n == 1 { return b; }
    fib_aux(n - 1, b, a + b)
  };

  fib_aux(n, 0, 1)
}

fn main() {
  fib(83)
}`,df=`
let SIZEOF_U32 = 4;

fn read_u32(addr) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>)
}

fn write_u32(addr, val) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>) = val;
}

fn main() {
  let square = n -> n * n;

  mut i = 0;
  while i < 100 {
    write_u32(i, square(i));
    i = i + 1;
  }

  read_u32(42) // 1764
}`,Tf=`
fn isEven(n) {
  n % 2 == 0
}

fn isPrime(n) {
  if n < 2 { return false; }
  if n == 2 { return true; }
  if isEven(n) { return false; }

  mut i = 3;

  while i * i <= n {
    if n % i == 0 { return false; }
    i = i + 2;
  }

  true
}

fn countPrimesLessThan(m) {
  mut i = m;
  mut count = 0;

  while i > 1 {
    if isPrime(i) {
      count = count + 1;
    }

    i = i - 1;
  }

  count
}

fn main() {
  countPrimesLessThan(1000000)
}`,Gf=`
struct MinMax {
  mut min: u32,
  mut max: u32
}

impl MinMax {
  fn reset(mut self) {
    self.min = 0;
    self.max = 0;
  }

  fn resetStatic(mut m) {
    m.reset();
  }
}

fn main() {
  mut m = MinMax {
    min: 17,
    max: 22
  };

  MinMax.resetStatic(m);
  
  m.min + m.max == 0
}`,gf=`
fn main() {
  let twice = (f, x) -> f(f(x));
  
  twice(n -> n * n, 7)
}`,hf=`
struct BumpAllocator {
  mut head: u32
}

impl BumpAllocator {
  fn allocate(mut self, bytes) {
    let addr = self.head as Ptr<u32>;
    self.head = self.head + bytes;
    addr
  }
  
  // do nothing!
  fn free(mut self, addr) { }
}

mut allocator = BumpAllocator { head: 64 * 1024 };

let SIZEOF_U32 = 4;

struct Vec {
  mut start: Ptr<u32>,
  mut length: u32,
  mut capacity: u32 
}

impl Vec {
  fn read(self, index) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>)
  }

  fn write(mut self, index, value) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>) = value;
  }

  fn grow(mut self) unsafe {
    let newCap = if self.capacity == 0 { 8 } else { self.capacity * 2 };
    let newStart = allocator.allocate(newCap * SIZEOF_U32);

    // copy the data from the old array to the new one
    mut i = 0;
    while i < self.length {
      *(((newStart as u32) + (i * SIZEOF_U32)) as Ptr<u32>) = self.read(i);
      i = i + 1;
    }

    allocator.free(self.start);
    self.start = newStart;
    self.capacity = newCap;
  }

  fn push(mut self, val) unsafe {
    if self.length + 1 > self.capacity {
      self.grow();
    }

    self.write(self.length, val);
    self.length = self.length + 1;
  }

  fn pop(mut self) unsafe {
    if self.length > 0 {
      self.length = self.length - 1;
      self.read(self.length)
    } else {
      // until we have Option<T>
      4294967295 // -1
    }
  }
}

fn main() {
  mut vec = Vec {
    start: 0 as Ptr<u32>,
    length: 0,
    capacity: 0
  };

  mut i = 0;
  while i < 1000 {
    vec.push(i);
    i = i + 1;
  }

  (vec.length, vec.capacity, vec.read(723))
}`,Ef=`
fn digitsSquareSum(n) {
  let square = n -> n * n;
  mut sum = 0;

  while n > 0 {
    sum = sum + square(n % 10);
    n = n / 10;
  }

  sum
}

fn reaches89(n) {
  while n != 1 {
    if n == 89 { return true; }
    n = digitsSquareSum(n);
  }

  false
}

fn main() {
  mut i = 1;
  mut count = 0;
  while i < 10000000 {
    if reaches89(i) {
      count = count + 1;
    }

    i = i + 1;
  }

  count
}`,wf=`
// console.log
extern fn log(n: u32) -> u32;

fn main() {
  let loop = n -> if n > 0 { 
    log(n);
    loop(n - 1);
  };

  loop(10);
}`;const mf={"Prime sieve":sf,Factorial:lf,Fibonacci:vf,Pointers:df,Primes:Tf,Structs:Gf,"Lambda (kind of)":gf,Vector:hf,"Project Euler 92":Ef,"External functions":wf},pf=async n=>{const e=await WebAssembly.compile(n),r=await WebAssembly.instantiate(e,{index:{log:console.log}});return"main"in r.exports?r.exports.main():"Error: main function not found, exported functions are: "+Object.keys(r.exports).join(", ")},Sf={Run:async(n,e)=>{e("running...");try{const r=za(n);if(r.tag==="Ok"){const u=await pf(r.value[1]);e(`${u}`)}else e(r.value)}catch(r){e(`${r}`)}},Disassemble:(n,e)=>{try{const r=za(n);if(r.tag==="Ok"){const[u]=r.value;e(Zi(u))}else e(r.value)}catch(r){e(`${r}`)}}},bf=()=>mt.createElement(mo,{actions:Sf,samples:mf,aceMode:"rust"});po.render(mt.createElement(mt.StrictMode,null,mt.createElement(bf,null)),document.getElementById("root"));
