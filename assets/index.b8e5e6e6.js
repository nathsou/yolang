var n=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(e,t,r)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;import{_ as c,s as i,j as _,c as s,r as f,h as l,g as v,a as T,t as d,b as G,d as A,e as m,f as p,i as h,k as g,u as E,m as b,v as w,l as y,n as S,o as k,p as I,q as x,w as D,x as C,y as F,z as N,A as R,B as L,C as X,D as O,E as U,F as M,G as z,H as P,I as j,J as V,K as B,L as q,M as Z,N as W,O as $,P as H,Q as K,R as Y,S as J,T as Q,U as nn,V as en,W as tn,X as rn,Y as un,Z as an,$ as on,a0 as cn,a1 as _n,a2 as sn,a3 as fn,a4 as ln,a5 as vn,a6 as Tn,a7 as dn,a8 as Gn,a9 as An,aa as mn,ab as pn,ac as hn,ad as gn,ae as En,af as bn,ag as wn,ah as yn,ai as Sn,aj as kn,ak as In,al as xn,am as Dn,an as Cn,ao as Fn,ap as Nn,aq as Rn,ar as Ln,as as Xn,at as On,au as Un,av as Mn,aw as zn,ax as Pn}from"./vendor.20756508.js";function jn(n){return[[],n]}var Vn={empty:void 0,add:i,addMono:function(n,e,t){return i(n,e,[[],t])},remove:f,has:l,get:v},Bn={TAG:1,_0:"u32",_1:[]},qn={TAG:1,_0:"bool",_1:[]},Zn={TAG:1,_0:"()",_1:[]};function Wn(n,e){return{TAG:1,_0:"Fun",_1:s(n,[e])}}function $n(n,e,t){if(0===n.TAG)return{TAG:1,_0:[e,t],_1:{TAG:0,_0:n._0}};var r=n._1,u=n._0,a=u[1],o=u[0];return e<o?{TAG:1,_0:[e,t],_1:{TAG:1,_0:[o,a],_1:r}}:{TAG:1,_0:[o,a],_1:$n(r,e,t)}}function Hn(n){return d(function(n,e){for(;;){var t=e,r=n;if(0===r.TAG){var u=r._0;switch(0|u.TAG){case 0:case 1:return t;case 2:var a=u._0;if(0===a.TAG)return t;var o=a._0;if(0===o.TAG)return t;e={hd:o._0,tl:t},n=o._1;continue}}else e={hd:r._0,tl:t},n=r._1}}(n,0))}function Kn(n,e){return"{ "+_(function(n,t){for(;;){var r=t,u=n;if(0===u.TAG)return T(d({hd:"..."+c(e,u._0),tl:r}));var a=u._0;t={hd:a[0]+": "+c(e,a[1]),tl:r},n=u._1}}(n,0),", ",(function(n){return n}))+" }"}var Yn={make:function(n){return{TAG:0,_0:n}},insert:$n,tail:function(n){for(;;){var e=n;if(0===e.TAG)return e._0;n=e._1}},fromArray:function(n,e){return m(n,{TAG:0,_0:{TAG:0,_0:e}},(function(n,e){return $n(n,e[0],e[1])}))},toArray:Hn,toMap:function(n){return p(Hn(n))},map:function n(e,t){if(0!==e.TAG){var r=e._0;return{TAG:1,_0:[r[0],c(t,r[1])],_1:n(e._1,t)}}var u=c(t,e._0);switch(0|u.TAG){case 0:case 1:return{TAG:0,_0:u};case 2:var a=u._0;return 0===a.TAG?{TAG:0,_0:u}:a._0}},show:Kn};function Jn(n){switch(0|n.TAG){case 0:return y(void 0,n._0);case 1:return m(b(n._1,Jn),void 0,E);case 2:var e=n._0;return 0===e.TAG?void 0:m(b(Hn(e._0),(function(n){return c(Jn,c((function(n){return n[1]}),n))})),void 0,E)}}function Qn(n){return g(Jn(n[1]),S(n[0]))}function ne(n,e){return[h(g(Jn(e),function(n){return m(b(w(n),Qn),void 0,E)}(n))),e]}function ee(n){switch(0|n.TAG){case 0:return function(n){var e=String.fromCharCode(97+n%26|0),t=n/26|0;return 0===t?e:e+String(t)}(n._0);case 1:var e=n._1,t=n._0;if(0===e.length)return t;switch(t){case"Fun":var r=G(e,0,e.length-1|0),u=A(e,e.length-1|0);return 1!==r.length?"("+_(r,", ",ee)+") -> "+ee(u):ee(r[0])+" -> "+ee(u);case"Tuple":return"("+_(e,", ",ee)+")";default:return t+"<"+_(e,", ",ee)+">"}case 2:var a=n._0;return 0===a.TAG?a._0:Kn(a._0,ee)}}function te(n){switch(n){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/";case 4:return"%";case 5:return"<";case 6:return"<=";case 7:return">";case 8:return">=";case 9:return"==";case 10:return"!="}}var re={show:te};function ue(n){switch(n){case 0:return"-";case 1:return"!";case 2:return"*"}}var ae={show:ue};function oe(n){return"number"==typeof n?"()":0===n.TAG?String(n._0):n._0?"true":"false"}var ce={show:oe};function ie(n){switch(0|n.TAG){case 0:return oe(n._0);case 1:return ue(n._0)+ie(n._1);case 2:return"("+ie(n._0)+" "+te(n._1)+" "+ie(n._2)+")";case 3:return n._0;case 4:return ie(n._0)+" = "+ie(n._1);case 5:var e=n._1,t=n._0,r=t.length;return 1!==r?0!==r?"("+_(t,", ",(function(n){return n}))+") -> "+ie(e):"() -> "+ie(e):t[0]+" -> "+ie(e);case 6:return"let "+n._0+" = "+ie(n._1)+" in "+ie(n._2);case 7:return"("+ie(n._0)+")("+_(n._1,", ",ie)+")";case 8:return(1===n._2?"unsafe ":"")+"{\n"+_(s(b(n._0,_e),k(n._1,[],(function(n){return[ie(n)]}))),";\n",(function(n){return"  "+n}))+"}\n}";case 9:var u=n._2,a="if "+ie(n._0)+" "+ie(n._1);return void 0!==u?a+" else "+ie(u):a;case 10:return"while "+ie(n._0)+" "+ie(n._1);case 11:return"return "+k(n._0,"",ie);case 12:return ie(n._0)+" as "+ee(n._1);case 13:return"("+_(n._0,", ",ie)+")";case 14:return n._0+" {\n"+_(n._1,", ",(function(n){return n[0]+": "+ie(n[1])}))+"\n}";case 15:return ie(n._0)+"."+n._1}}function _e(n){if(0!==n.TAG)return ie(n._0)+";";var e=n._2,t=n._0;return n._1?"let mut "+t+" = "+ie(e):"let "+t+" = "+ie(e)}var se={showExpr:ie,showDecl:function(n){switch(0|n.TAG){case 0:return"fn "+n._0+"("+_(n._1,", ",(function(n){return n}))+") "+ie(n._2);case 1:return(n._1?"mut":"let")+" "+n._0+" = "+ie(n._2);case 2:return"struct "+n._0+" {\n"+_(n._1,",\n",(function(n){return n[0]+": "+ee(n[1])}))+"\n}"}},showStmt:_e};function fe(n,e){for(;;){var t=e;switch(0|t.TAG){case 0:var r=t._0,u=D(n,r);if(void 0===u)return{TAG:0,_0:r};e=u;continue;case 1:return{TAG:1,_0:t._0,_1:b(t._1,(function(e){return fe(n,e)}))};case 2:var a=t._0;return{TAG:2,_0:0===a.TAG?{TAG:0,_0:a._0}:{TAG:1,_0:Yn.map(a._0,(function(e){return fe(n,e)}))}}}}}function le(n,e){return I(x(e,(function(e){return fe(n,e)})),n,(function(n,e,t){return C(t,e)}))}function ve(n,e){return F(e,(function(e){return function(n,e){var t=e[0];return[t,fe(N(n,t),e[1])]}(n,e)}))}function Te(n,e){for(var t,r=0;R(t)&&r<n.length;){var u=c(e,A(n,r));void 0!==u&&(t=L(X(u))),r=r+1|0}return t}function de(n,e){for(var t,r=n.length-1|0;R(t)&&r>=0;)c(e,A(n,r))?t=r:r=r-1|0;return t}function Ge(n,e){for(var t,r=[],u=0;R(t)&&u<n.length;){var a=A(n,u);0===a.TAG?r.push(c(e,a._0)):t=L(a._0),u=u+1|0}return void 0!==t?{TAG:1,_0:X(t)}:{TAG:0,_0:r}}var Ae={show:function(n){return"struct "+n.name+"{\n"+_(n.attributes,",\n",(function(n){return"  "+n.name+": "+ee(n.ty)}))+"\n}"},toPartialStructType:function(n,e){return{TAG:2,_0:{TAG:1,_0:Yn.fromArray(b(n.attributes,(function(n){return[n.name,n.ty]})),e)}}}},me=Z("Context.Size.UnkownTypeSize");function pe(n){switch(0|n.TAG){case 0:throw{RE_EXN_ID:me,_1:n,Error:new Error};case 1:switch(n._0){case"()":if(0===n._1.length)return 0;throw{RE_EXN_ID:me,_1:n,Error:new Error};case"Fun":case"Ptr":return 4;case"Tuple":return m(b(n._1,pe),0,(function(n,e){return n+e|0}));case"bool":case"u32":break;case"u64":if(0===n._1.length)return 8;throw{RE_EXN_ID:me,_1:n,Error:new Error};default:throw{RE_EXN_ID:me,_1:n,Error:new Error}}if(0===n._1.length)return 4;throw{RE_EXN_ID:me,_1:n,Error:new Error};case 2:return 4}}var he={UnkownTypeSize:me,size:pe,sizeLog2:function(n){return 0|Math.ceil(Math.log2(pe(n)))},isZeroSizedType:function(n){return 0===pe(n)}};var ge={tyVarIndex:0,identifiers:[],renaming:O(10),structs:U(5)};function Ee(n){var e=ge.tyVarIndex;return ge.tyVarIndex=ge.tyVarIndex+1|0,e}function be(n){return{TAG:0,_0:Ee()}}function we(n){var e=n[0],t=b(e,(function(n){return{TAG:0,_0:Ee()}}));return fe(B(q(e,t)),n[1])}function ye(n,e){var t=void 0!==n?X(n):void 0,r=ge.identifiers.length;ge.identifiers.push(e);var u={contents:{name:e,newName:e,index:r,ty:void 0!==t?t:{TAG:0,_0:Ee()}}};return j(ge.renaming,r,u),u}function Se(n){return V(ge.structs,n)}function ke(n){switch(0|n.TAG){case 0:var e=n._0;return"number"==typeof e?Zn:0===e.TAG?Bn:qn;case 3:return n._0.contents.ty;case 4:case 10:return Zn;case 11:return k(n._0,Zn,ke);case 12:return n._2;case 13:return{TAG:1,_0:"Tuple",_1:b(n._0,ke)};case 14:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return n._0}}function Ie(n,e){var t=void 0!==n?X(n):void 0,r=function(n,e){return void 0!==t?"("+e+": "+ee(fe(X(t),n))+")":e};switch(0|e.TAG){case 0:return r(ke(e),ce.show(e._0));case 1:return r(e._0,"("+Ie(L(t),e._1)+" "+re.show(e._2)+" "+Ie(L(t),e._3)+")");case 2:return r(e._0,"("+ae.show(e._1)+Ie(L(t),e._2)+")");case 3:var u=e._0;return r(u.contents.ty,u.contents.name);case 4:var a=e._1;return r(ke(a),Ie(L(t),e._0)+" = "+Ie(L(t),a));case 5:return r(e._0,"("+_(e._2,", ",(function(n){return n.contents.name}))+") -> "+Ie(L(t),e._3));case 6:return r(e._0,"let "+e._1.contents.name+" = "+Ie(L(t),e._2)+" in\n"+Ie(L(t),e._3));case 7:return r(e._0,"("+Ie(L(t),e._1)+")("+_(e._2,", ",(function(n){return Ie(L(t),n)}))+")");case 8:var o=e._2,c=L(t);return r(e._0,(1===e._3?"unsafe ":"")+"{\n"+_(s(b(e._1,(function(n){return xe(c,n)})),k(o,[],(function(n){return[Ie(void 0,n)]}))),";\n",(function(n){return"  "+n}))+(R(o)?"; ":"")+"\n}");case 9:return r(e._0,"if "+Ie(L(t),e._1)+" "+Ie(L(t),e._2)+" else "+Ie(L(t),e._3));case 10:return r(Zn,"while "+Ie(void 0,e._0)+" "+Ie(void 0,e._1));case 11:var i=L(t);return"return "+r(ke(e),k(e._0,"",(function(n){return Ie(i,n)})));case 12:var f=e._0;return r(ke(f),Ie(void 0,f))+" as "+ee(e._2);case 13:var l=L(t);return"("+_(e._0,", ",(function(n){return Ie(l,n)}))+")";case 14:return e._0+" {\n"+_(e._1,",\n",(function(n){return n[0]+": "+Ie(void 0,n[1])}))+"\n}";case 15:return r(e._0,Ie(void 0,e._1)+"."+e._2)}}function xe(n,e){var t=void 0!==n?X(n):void 0;return 0===e.TAG?(e._1?"mut":"let")+" "+e._0.contents.name+" = "+Ie(L(t),e._2):Ie(L(t),e._0)}function De(n,e){var t=void 0!==n?X(n):void 0,r=function(n,e){return void 0!==t?"("+e+": "+ee(fe(X(t),n))+")":e};switch(0|e.TAG){case 0:var u,a=e._1,o=e._0;if(void 0!==t){var c=X(t);u=_(a,", ",(function(n){return n.contents.name+": "+ee(fe(c,n.contents.ty))}))}else u=_(a,", ",(function(n){return n.contents.name}));return r(o.contents.ty,"fn "+o.contents.name+"("+u+") "+Ie(L(t),e._2));case 1:var i=e._0;return r(i.contents.ty,(e._1?"mut":"let")+" "+i.contents.name+" = "+Ie(L(t),e._2));case 2:return se.showDecl({TAG:2,_0:e._0,_1:e._1})}}function Ce(n){var e,t,r={LAZY_DONE:!1,VAL:function(){return be()}};switch(0|n.TAG){case 0:return{TAG:0,_0:n._0};case 1:return{TAG:2,_0:K(r),_1:n._0,_2:Ce(n._1)};case 2:return{TAG:1,_0:K(r),_1:Ce(n._0),_2:n._1,_3:Ce(n._2)};case 3:return{TAG:3,_0:(e=n._0,t=W(de(ge.identifiers,(function(n){return n===e})),(function(n){return $(ge.renaming,n)})),void 0!==t?t:H('unbound identifier "'+e+'"'))};case 4:return{TAG:4,_0:Ce(n._0),_1:Ce(n._1)};case 5:var u=n._1,a=n._0;if(0===a.length)return{TAG:5,_0:K(r),_1:void 0,_2:[ye(void 0,"__x")],_3:Ce(u)};var o=L(void 0);return{TAG:5,_0:K(r),_1:void 0,_2:b(a,(function(n){return ye(o,n)})),_3:Ce(u)};case 6:var c=n._2,i=n._1,_=n._0;if(5!==i.TAG)return{TAG:6,_0:K(r),_1:ye(void 0,_),_2:Ce(i),_3:Ce(c)};var s=ye(void 0,_),f=L(void 0),l={TAG:5,_0:be(),_1:s,_2:b(i._0,(function(n){return ye(f,n)})),_3:Ce(i._1)};return{TAG:6,_0:K(r),_1:s,_2:l,_3:Ce(c)};case 7:return{TAG:7,_0:K(r),_1:Ce(n._0),_2:b(n._1,Ce)};case 8:return{TAG:8,_0:K(r),_1:b(n._0,Fe),_2:Y(n._1,Ce),_3:n._2};case 9:return{TAG:9,_0:K(r),_1:Ce(n._0),_2:Ce(n._1),_3:k(n._2,{TAG:0,_0:0},Ce)};case 10:return{TAG:10,_0:Ce(n._0),_1:Ce(n._1)};case 11:return{TAG:11,_0:Y(n._0,Ce)};case 12:return{TAG:12,_0:Ce(n._0),_1:K(r),_2:n._1};case 13:return{TAG:13,_0:b(n._0,Ce)};case 14:return{TAG:14,_0:n._0,_1:b(n._1,(function(n){return[n[0],Ce(n[1])]}))};case 15:return{TAG:15,_0:be(),_1:Ce(n._0),_2:n._1}}}function Fe(n){if(0!==n.TAG)return{TAG:1,_0:Ce(n._0)};var e=n._3,t=n._2,r=n._1,u=n._0;if(5!==t.TAG)return{TAG:0,_0:ye(L(e),u),_1:r,_2:Ce(t)};var a=ye(L(e),u),o=L(void 0);return{TAG:0,_0:a,_1:r,_2:{TAG:5,_0:be(),_1:a,_2:b(t._0,(function(n){return ye(o,n)})),_3:Ce(t._1)}}}function Ne(n){switch(0|n.TAG){case 0:var e=L(void 0),t=b(n._1,(function(n){return ye(e,n)}));return{TAG:0,_0:ye(void 0,n._0),_1:t,_2:Ce(n._2)};case 1:return{TAG:1,_0:ye(void 0,n._0),_1:n._1,_2:Ce(n._2)};case 2:return{TAG:2,_0:n._0,_1:n._1}}}function Re(n,e){var t=function(e){return Re(n,e)};switch(0|e.TAG){case 0:return{TAG:0,_0:e._0};case 1:return{TAG:1,_0:fe(n,e._0),_1:Re(n,e._1),_2:e._2,_3:Re(n,e._3)};case 2:return{TAG:2,_0:fe(n,e._0),_1:e._1,_2:Re(n,e._2)};case 3:return{TAG:3,_0:e._0};case 4:return{TAG:4,_0:Re(n,e._0),_1:Re(n,e._1)};case 5:return{TAG:5,_0:fe(n,e._0),_1:e._1,_2:e._2,_3:Re(n,e._3)};case 6:return{TAG:6,_0:fe(n,e._0),_1:e._1,_2:Re(n,e._2),_3:Re(n,e._3)};case 7:return{TAG:7,_0:fe(n,e._0),_1:Re(n,e._1),_2:b(e._2,t)};case 8:return{TAG:8,_0:fe(n,e._0),_1:b(e._1,(function(e){return Le(n,e)})),_2:Y(e._2,t),_3:e._3};case 9:return{TAG:9,_0:fe(n,e._0),_1:Re(n,e._1),_2:Re(n,e._2),_3:Re(n,e._3)};case 10:return{TAG:10,_0:Re(n,e._0),_1:Re(n,e._1)};case 11:return{TAG:11,_0:Y(e._0,t)};case 12:return{TAG:12,_0:Re(n,e._0),_1:fe(n,e._1),_2:fe(n,e._2)};case 13:return{TAG:13,_0:b(e._0,t)};case 14:var r=e._1,u=e._0,a=Se(u);if(void 0===a)return H('unreachable: undeclared struct "'+u+"'");var o=function(n,e){for(var t=[],r=!1,u=0;!1===r&&u<n.length;){var a=A(n,u);void 0!==a?t.push(c(e,X(a))):r=!0,u=u+1|0}return r?void 0:t}(b(a.attributes,(function(n){var e=n.name;return J(r,(function(n){return n[0]===e}))})),(function(e){return[e[0],Re(n,e[1])]}));return void 0!==o?{TAG:14,_0:u,_1:o}:H('unreachable: missing attribute for struct "'+u+'"');case 15:return{TAG:15,_0:fe(n,e._0),_1:Re(n,e._1),_2:e._2}}}function Le(n,e){return 0===e.TAG?{TAG:0,_0:e._0,_1:e._1,_2:Re(n,e._2)}:{TAG:1,_0:Re(n,e._0)}}function Xe(n,e){switch(0|e.TAG){case 0:return{TAG:0,_0:e._0,_1:e._1,_2:Re(n,e._2)};case 1:return{TAG:1,_0:e._0,_1:e._1,_2:Re(n,e._2)};case 2:return e}}var Oe={typeOfExpr:ke,typeOfStmt:function(n){return 0===n.TAG?Zn:ke(n._0)},showExpr:Ie,showStmt:xe,showDecl:De,fromExpr:Ce,fromStmt:Fe,fromDecl:Ne,substExpr:Re,substStmt:Le,substDecl:Xe},Ue={show:Ie,from:Ce,subst:Re,typeOf:ke},Me={show:De,from:Ne,subst:Xe};function ze(n){var e=[];return function(n){for(;;){var t=127&n,r=n>>>7;if(0===r)return void e.push(t);e.push(128|t),n=r}}(n),e}function Pe(n){var e=[];return function(n){for(;;){var t=127&n,r=n>>7;if(0===r&&0==(64&t)||-1===r&&0!=(64&t))return void e.push(t);e.push(128|t),n=r}}(0|n),e}function je(n){return s(ze(n.length),n)}function Ve(n){return s(ze(n.length),Q(n))}var Be={encode:je,encodeMany:Ve};function qe(n){var e=new DataView(new ArrayBuffer(4));return e.setFloat32(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3)]}var Ze={encode:qe};function We(n){var e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3),e.getUint8(4),e.getUint8(5),e.getUint8(6),e.getUint8(7)]}var $e={encode:We};function He(n,e){return s([n],je(e))}function Ke(n){var e;switch(n){case 0:e="custom";break;case 1:e="type";break;case 2:e="import";break;case 3:e="function";break;case 4:e="table";break;case 5:e="memory";break;case 6:e="global";break;case 7:e="export";break;case 8:e="start";break;case 9:e="element";break;case 10:e="code";break;case 11:e="data"}return"["+e+"]"}var Ye={id:function(n){return n},encode:He,show:Ke};function Je(n){switch(n){case 0:return 127;case 1:return 126;case 2:return 125;case 3:return 124}}function Qe(n){switch(n){case 0:return"i32";case 1:return"i64";case 2:return"f32";case 3:return"f64"}}var nt={encode:Je,show:Qe};function et(n){return"number"==typeof n?[64]:0===n.TAG?[Je(n._0)]:ze(n._0)}var tt={encode:et,show:function(n){return"number"==typeof n?"void":0===n.TAG?Qe(n._0):"type "+String(n._0)}};function rt(n){if("number"==typeof n)switch(n){case 0:return[5,"else"];case 1:return[11,"end"];case 2:return[15,"return"];case 3:return[26,"drop"];case 4:return[106,"i32.add"];case 5:return[107,"i32.sub"];case 6:return[108,"i32.mul"];case 7:return[110,"i32.div_s"];case 8:return[109,"i32.div_u"];case 9:return[69,"i32.eqz"];case 10:return[70,"i32.eq"];case 11:return[81,"i64.eq"];case 12:return[91,"f32.eq"];case 13:return[97,"f64.eq"];case 14:return[71,"i32.ne"];case 15:return[82,"i64.ne"];case 16:return[92,"f32.ne"];case 17:return[98,"f64.ne"];case 18:return[76,"i32.le_s"];case 19:return[77,"i32.le_u"];case 20:return[87,"i64.le_s"];case 21:return[88,"i64.le_u"];case 22:return[95,"f32.le"];case 23:return[101,"f64.le"];case 24:return[78,"i32.ge_s"];case 25:return[79,"i32.ge_u"];case 26:return[89,"i64.ge_s"];case 27:return[90,"i64.ge_u"];case 28:return[96,"f32.ge"];case 29:return[102,"f64.ge"];case 30:return[72,"i32.lt_s"];case 31:return[73,"i32.lt_u"];case 32:return[83,"i64.lt_s"];case 33:return[84,"i64.lt_u"];case 34:return[93,"f32.lt"];case 35:return[99,"f64.lt"];case 36:return[74,"i32.gt_s"];case 37:return[75,"i32.gt_u"];case 38:return[85,"i64.gt_s"];case 39:return[86,"i64.gt_u"];case 40:return[94,"f32.gt"];case 41:return[100,"f64.gt"];case 42:return[111,"i32.rem_s"];case 43:return[112,"i32.rem_u"];case 44:return[113,"i32.and"]}else switch(0|n.TAG){case 0:return[65,"i32.const "+String(n._0)];case 1:return[66,"i64.const "+String(n._0)];case 2:return[67,"i64.const "+String(n._0)];case 3:return[68,"i64.const "+String(n._0)];case 4:return[4,"if"];case 5:return[13,"br_if "+String(n._0)];case 6:return[12,"br "+String(n._0)];case 7:return[2,"block"];case 8:return[3,"loop"];case 9:return[35,"global.get "+String(n._0)];case 10:return[36,"global.set "+String(n._0)];case 11:return[32,"local.get "+String(n._0)];case 12:return[33,"local.set "+String(n._0)];case 13:return[34,"local.tee "+String(n._0)];case 14:return[16,"call "+String(n._0)];case 15:return[17,"call_indirect [typeIndex="+String(n._0)+", tableIndex="+String(n._1)+"]"];case 16:return[40,"i32.load (alignment="+String(n._0)+", offset="+String(n._1)+")"];case 17:return[54,"i32.store (alignment="+String(n._0)+", offset="+String(n._1)+")"]}}function ut(n){return rt(n)[0]}function at(n){if("number"==typeof n)switch(n){case 0:case 1:return-1;default:return 0}else switch(0|n.TAG){case 4:case 7:case 8:return 1;default:return 0}}function ot(n,e,t,r){var u,a=void 0!==n?n:{contents:0},o=rt(e),c=at(e),i=_(nn(0,a.contents+(c<0?c:0)|0),"  ",(function(n){return""}));a.contents=a.contents+c|0,0===e&&(a.contents=a.contents+1|0);var s=0;if("number"==typeof e)u="";else switch(0|e.TAG){case 11:case 12:case 13:s=1;break;case 14:u="<"+k(en(t,e._0),"??",(function(n){return n}))+">";break;default:u=""}return 1===s&&(u="<"+k(en(r,e._0),"??",(function(n){return n}))+">"),i+o[1]+" "+u}function ct(n){var e=0;if("number"==typeof n)return[ut(n)];switch(0|n.TAG){case 0:case 1:e=1;break;case 2:return s([ut(n)],qe(n._0));case 3:return s([ut(n)],We(n._0));case 5:case 6:e=3;break;case 4:case 7:case 8:e=2;break;case 9:case 10:case 11:case 12:case 13:e=4;break;case 14:return s([ut(n)],ze(n._0));case 15:return Q([[ut(n)],ze(n._0),ze(n._1)]);case 16:case 17:e=5}switch(e){case 1:return s([ut(n)],Pe(n._0));case 2:return s([ut(n)],et(n._0));case 3:case 4:return s([ut(n)],ze(n._0));case 5:return Q([[ut(n)],ze(n._0),ze(n._1)])}}var it={info:rt,opcode:ut,identationDelta:at,show:ot,encode:ct};function _t(n){return Q([[96],je(b(n._0,Je)),je(b(n._1,Je))])}function st(n){var e=n._1,t=n._0,r=_(t,", ",Qe),u=_(e,", ",Qe);if(1===t.length){var a=e.length;if(1===a)return r+" -> "+u;if(0===a)return r+" -> ()"}return 0!==e.length?"("+r+") -> ("+u+")":"("+r+") -> ()"}function ft(n){return s(ze(n[0].length),[Je(n[1])])}function lt(n){return"local ["+_(n[0],", ",(function(n){return n}))+"] "+Qe(n[1])}function vt(n){var e=Ve(b(n[0],ft)),t=Q(b(n[1],ct));return Q([[e.length+t.length|0],e,t])}function Tt(n,e,t){var r=n[0],u={contents:1},a=on(t._0,(function(n,e){return"param["+String(n)+"]"})),o=s(a,Q(b(r,(function(n){return n[0]})))),c=_(r,"\n",lt),i=_(n[1],"\n",(function(n){return ot(u,n,e,o)}));return 0===r.length?i:c+"\n"+i}var dt={Signature:{funcTypeCode:96,make:function(n,e){return{_0:n,_1:e}},empty:{_0:[],_1:[]},encode:_t,show:st},Local:{fromTypes:function(n){var e=rn(function(n,e){for(;;){var t=e,r=n;if(!r)return t;var u=r.tl,a=r.hd,o=a[1],c=a[0];if(t){var i=t.tl,_=t.hd,s=_[1],f=_[0];if(cn(o,s)){e={hd:[{hd:c,tl:f},s],tl:i},n=u;continue}e={hd:[{hd:c,tl:0},o],tl:{hd:[f,s],tl:i}},n=u}else e={hd:[{hd:c,tl:0},o],tl:0},n=u}}(un(n),0));return d(an(e,(function(n){return[T(d(n[0])),n[1]]})))},encode:ft,show:lt},Body:{make:function(n,e){return[n,e]},encode:vt,show:Tt},make:function(n,e,t){return[n,e,t]}};function Gt(n,e){var t=tn(n,(function(n){return cn(n,e)}));return void 0!==t?t:(n.push(e),n.length-1|0)}function At(n){return He(1,Ve(b(n,_t)))}function mt(n){return Ke(1)+"\n"+_(n,"\n",st)}var pt={make:function(n){return[]},getOrAdd:Gt,encode:At,show:mt};function ht(n,e){return n.push(e),n.length-1|0}function gt(n){return He(3,Ve(b(n,ze)))}function Et(n,e){return Ke(3)+"\n"+_(q(n,e),"\n",(function(n){return n[1]+": "+String(n[0])}))}var bt={make:function(n){return[]},addSignature:ht,encode:gt,show:Et};function wt(n,e){return n.push(e),n.length-1|0}function yt(n){return He(10,Ve(b(n,vt)))}function St(n,e){var t=b(e,(function(n){return n[0]}));return Ke(10)+"\n"+_(q(n,e),"\n\n",(function(n){var e=n[1];return e[0]+"\n"+Tt(n[0],t,e[1])}))}var kt={make:function(n){return[]},addFunc:wt,encode:yt,show:St};function It(n){return je(b(n.split(""),(function(n){return 0|n.charCodeAt(0)})))}var xt={encode:It};function Dt(n){switch(n){case 0:return"func";case 1:return"table";case 2:return"memory";case 3:return"global"}}function Ct(n){return Q([It(n.name),[n.kind],ze(n.index)])}function Ft(n){return"export "+Dt(n.kind)+" "+n.name+" (index: "+String(n.index)+")"}var Nt={ExternalKind:{encode:function(n){return[n]},show:Dt},make:function(n,e,t){return{name:n,kind:e,index:t}},encode:Ct,show:Ft};function Rt(n){return He(7,Ve(b(n,Ct)))}function Lt(n){return Ke(7)+"\n"+_(n,"\n",Ft)}var Xt={make:function(n){return[]},add:function(n,e){n.push(e)},encode:Rt,show:Lt};var Ot={show:function(n){return n?"externref":"funcref"},encode:function(n){return n?111:112}};function Ut(n){return"{ min: "+String(n[0])+", max: "+k(n[1],"?",(function(n){return String(n)}))+" }"}function Mt(n){var e=n[1],t=n[0];return void 0!==e?Q([[1],ze(t),ze(e)]):s([0],ze(t))}var zt={show:Ut,make:function(n,e){return[n,e]},makeExact:function(n){return[n,n]},encode:Mt};function Pt(n){return s([n[0]?111:112],Mt(n[1]))}function jt(n){return"table "+(n[0]?"externref":"funcref")+" "+Ut(n[1])}var Vt={make:function(n,e){return[n,e]},encode:Pt,show:jt};function Bt(n){return Ke(4)+"\n"+_(n,"\n",jt)}function qt(n){return He(4,Ve(b(n,Pt)))}var Zt={make:function(n){return[]},add:function(n,e){n.push(e)},show:Bt,encode:qt};function Wt(n){return"elem funcref ("+_(n.funcIndices," ",(function(n){return String(n)}))+") (offset="+String(n.offset)+")"}function $t(n){return Q([[0],ct({TAG:0,_0:n.offset}),ct(1),Ve(b(n.funcIndices,ze))])}var Ht={fromFuncRefs:function(n,e){return{offset:void 0!==n?n:0,funcIndices:e}},show:Wt,encode:$t};function Kt(n){return Ke(9)+"\n"+_(n,"\n",Wt)}function Yt(n){return He(9,Ve(b(n,$t)))}var Jt={make:function(n){return[]},add:function(n,e){n.push(e)},show:Kt,encode:Yt};function Qt(n){var e;return e=0===n.TAG?{TAG:0,_0:n._0}:{TAG:9,_0:n._0},s(ct(e),ct(1))}function nr(n){return 0===n.TAG?String(n._0):"global.get "+String(n._0)}function er(n){return"global "+(n[1]?"mutable":"immutable")+" "+Qe(n[0])+" = "+nr(n[2])}function tr(n){return s([Je(n[0]),n[1]?1:0],Qt(n[2]))}var rr={Initializer:{encode:Qt,show:nr},make:function(n,e,t){return[e,n,t]},show:er,encode:tr};function ur(n){return Ke(6)+"\n"+_(n,"\n",er)}function ar(n){return He(6,Ve(b(n,tr)))}var or={make:function(n){return[]},add:function(n,e){n.push(e)},show:ur,encode:ar};function cr(n){return"memory "+Ut(n)}var ir={make:function(n){return n},show:cr,encode:Mt};function _r(n,e){return n.push(e)-1|0}function sr(n){return Ke(5)+"\n"+_(n,"\n",cr)}function fr(n){return He(5,Ve(b(n,Mt)))}var lr={make:function(n){return[]},add:_r,show:sr,encode:fr};function vr(n,e,t,r){var u=Gt(n.typeSection,t);return ht(n.funcSection,u),n.funcs.push([e,t,r]),wt(n.codeSection,r)+n.importsCount|0}function Tr(n){return Q([[0,97,115,109,1,0,0,0],At(n.typeSection),gt(n.funcSection),qt(n.tableSection),fr(n.memorySection),ar(n.globalSection),Rt(n.exportSection),Yt(n.elementSection),yt(n.codeSection)])}var dr={make:function(n){return{typeSection:[],funcSection:[],tableSection:[],memorySection:[],globalSection:[],exportSection:[],elementSection:[],codeSection:[],funcs:[],importsCount:0}},getOrAddSignature:function(n,e){return Gt(n.typeSection,e)},addFunc:vr,addExportedFunc:function(n,e,t,r){var u=vr(n,e,t,r),a={name:e,kind:0,index:u};return n.exportSection.push(a),u},addTable:function(n,e){n.tableSection.push(e)},addElement:function(n,e){n.elementSection.push(e)},addGlobal:function(n,e){n.globalSection.push(e)},addMemory:function(n,e){return _r(n.memorySection,e)},encode:Tr,encodeAsUint8Array:function(n){return e=Tr(n),Uint8Array.from(e);var e},show:function(n){return _([mt(n.typeSection),Et(n.funcSection,b(n.funcs,(function(n){return n[0]}))),Bt(n.tableSection),sr(n.memorySection),ur(n.globalSection),Lt(n.exportSection),Kt(n.elementSection),St(n.codeSection,n.funcs)],"\n\n",(function(n){return n}))}},Gr=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uleb128:ze,sleb128:Pe,Vec:Be,F32:Ze,F64:$e,Section:Ye,ValueType:nt,BlockReturnType:tt,Inst:it,Func:dt,TypeSection:pt,FuncSection:bt,CodeSection:kt,Str:xt,ExportEntry:Nt,ExportSection:Xt,ReferenceType:Ot,Limits:zt,Table:Vt,TableSection:Zt,Elem:Ht,ElementSection:Jt,Global:rr,GlobalSection:or,Memory:ir,MemorySection:lr,Module:dr});function Ar(n){return[n,0,n.length]}function mr(n,e){var t=e[2],r=void 0!==n?n:1;return[e[0],Math.min(e[1]+r|0,t),t]}function pr(n){return en(n[0],n[1])}function hr(n){return mr(1,n)}function gr(n){return n[1]===n[2]}function Er(n,e){var t=pr(e);if(void 0!==t&&c(n,t))return[t,mr(void 0,e)]}function br(n){return function(e){return Er((function(e){return e===n}),e)}}function wr(n){return n>=97&&n<=122}function yr(n){return n>=48&&n<=57}function Sr(n){return!!function(n){return!!wr(n)||function(n){return n>=65&&n<=90}(n)}(n)||yr(n)}function kr(n){return Er(wr,n)}function Ir(n){return Er(Sr,n)}function xr(n){return n>13||n<9?32===n:!(12===n||11===n)}function Dr(n){return Er(xr,n)}function Cr(n,e,t){return Y(c(n,t),(function(n){return[c(e,n[0]),n[1]]}))}function Fr(n,e,t){for(;;){var r=t,u=void 0!==n?n:[];if(gr(r))return[u,r];var a=c(e,r);if(void 0===a)return[u,r];u.push(a[0]),t=a[1],n=u}}function Nr(n){return Fr(void 0,Dr,n)}function Rr(n,e,t){return W(c(n,t),(function(n){var t=n[0];return Y(c(e,n[1]),(function(n){return[[t,n[0]],n[1]]}))}))}function Lr(n){return function(e){return Cr((function(e){return Rr(n,(function(e){return Fr(void 0,n,e)}),e)}),(function(n){return s([n[0]],n[1])}),e)}}function Xr(n){if(!n)return function(n){return[0,n]};var e=n.hd,t=Xr(n.tl),r=function(n){return Rr(e,t,n)};return function(n){return Cr(r,(function(n){return{hd:n[0],tl:n[1]}}),n)}}function Or(n,e,t){var r=c(n,t);return void 0!==r?[r[0],r[1]]:c(e,t)}function Ur(n,e){return Te(n,(function(n){return c(n,e)}))}function Mr(n){var e=Array.from(n,(function(n){var e=_n(n,0);return function(n){return Er((function(n){return n===e}),n)}})),t=Xr(un(e));return function(e){return Cr(t,(function(e){return n}),e)}}var zr=Lr((function(n){return Er(yr,n)}));var Pr=Mr("false");function jr(n){return Cr(Pr,(function(n){return{TAG:1,_0:!1}}),n)}var Vr=Mr("true");function Br(n){return Cr(Vr,(function(n){return{TAG:1,_0:!0}}),n)}var qr=[Ir,br(95),br(39)];function Zr(n){return Ur(qr,n)}function Wr(n){return Fr(void 0,Zr,n)}var $r=br(95);function Hr(n){return Or(kr,$r,n)}function Kr(n){return Rr(Hr,Wr,n)}var Yr=[Ir,br(95)],Jr=Lr((function(n){return Ur(Yr,n)}));var Qr=Mr("let"),nu=Mr("mut"),eu=Mr("in"),tu=Mr("if"),ru=Mr("else"),uu=Mr("fn"),au=Mr("while"),ou=Mr("return"),cu=Mr("as"),iu=Mr("unsafe"),_u=Mr("struct"),su=[function(n){return Cr(Qr,(function(n){return{TAG:5,_0:0}}),n)},function(n){return Cr(nu,(function(n){return{TAG:5,_0:1}}),n)},function(n){return Cr(eu,(function(n){return{TAG:5,_0:2}}),n)},function(n){return Cr(tu,(function(n){return{TAG:5,_0:3}}),n)},function(n){return Cr(ru,(function(n){return{TAG:5,_0:4}}),n)},function(n){return Cr(uu,(function(n){return{TAG:5,_0:5}}),n)},function(n){return Cr(au,(function(n){return{TAG:5,_0:6}}),n)},function(n){return Cr(ou,(function(n){return{TAG:5,_0:7}}),n)},function(n){return Cr(cu,(function(n){return{TAG:5,_0:8}}),n)},function(n){return Cr(iu,(function(n){return{TAG:5,_0:9}}),n)},function(n){return Cr(_u,(function(n){return{TAG:5,_0:10}}),n)}];function fu(n){return Ur(su,n)}function lu(n){return Rr(fu,(function(n){return void 0!==c(Ir,e=n)?void 0:[void 0,hr(e)];var e}),n)}var vu=Mr("->"),Tu=Mr("=="),du=Mr("!="),Gu=br(43),Au=br(45),mu=br(42),pu=br(47),hu=br(37),gu=Mr("<="),Eu=Mr(">="),bu=br(60),wu=br(62),yu=br(40),Su=br(41),ku=br(44),Iu=br(59),xu=br(61),Du=br(123),Cu=br(125),Fu=br(58),Nu=br(33),Ru=br(46),Lu=[function(n){return Cr(vu,(function(n){return{TAG:2,_0:5}}),n)},function(n){return Cr(Tu,(function(n){return{TAG:2,_0:14}}),n)},function(n){return Cr(du,(function(n){return{TAG:2,_0:15}}),n)},function(n){return Cr(Gu,(function(n){return{TAG:2,_0:9}}),n)},function(n){return Cr(Au,(function(n){return{TAG:2,_0:10}}),n)},function(n){return Cr(mu,(function(n){return{TAG:2,_0:11}}),n)},function(n){return Cr(pu,(function(n){return{TAG:2,_0:12}}),n)},function(n){return Cr(hu,(function(n){return{TAG:2,_0:13}}),n)},function(n){return Cr(gu,(function(n){return{TAG:2,_0:17}}),n)},function(n){return Cr(Eu,(function(n){return{TAG:2,_0:19}}),n)},function(n){return Cr(bu,(function(n){return{TAG:2,_0:16}}),n)},function(n){return Cr(wu,(function(n){return{TAG:2,_0:18}}),n)},function(n){return Cr(yu,(function(n){return{TAG:2,_0:0}}),n)},function(n){return Cr(Su,(function(n){return{TAG:2,_0:1}}),n)},function(n){return Cr(ku,(function(n){return{TAG:2,_0:2}}),n)},function(n){return Cr(Iu,(function(n){return{TAG:2,_0:3}}),n)},function(n){return Cr(xu,(function(n){return{TAG:2,_0:4}}),n)},function(n){return Cr(Du,(function(n){return{TAG:2,_0:6}}),n)},function(n){return Cr(Cu,(function(n){return{TAG:2,_0:7}}),n)},function(n){return Cr(Fu,(function(n){return{TAG:2,_0:8}}),n)},function(n){return Cr(Nu,(function(n){return{TAG:2,_0:20}}),n)},function(n){return Cr(Ru,(function(n){return{TAG:2,_0:21}}),n)}];var Xu=[function(n){return Cr(zr,(function(n){return{TAG:0,_0:sn(fn(_(n,"",(function(n){return ln(1,n)}))))}}),n)},function(n){return Or(Br,jr,n)},function(n){return Cr(lu,(function(n){return n[0]}),n)},function(n){return Ur(Lu,n)},function(n){return Cr(Kr,(function(n){return{TAG:3,_0:ln(1,n[0])+_(n[1],"",(function(n){return ln(1,n)}))}}),n)},function(n){return Cr(Jr,(function(n){return{TAG:4,_0:_(n,"",(function(n){return ln(1,n)}))}}),n)}];function Ou(n){return Ur(Xu,n)}function Uu(n){return Fr(void 0,(function(n){return Cr((function(n){return e=Nr,W(Rr(Nr,Ou,n),(function(n){var t=n[0],r=t[1],u=t[0];return Y(c(e,n[1]),(function(n){return[[u,r,n[0]],n[1]]}))}));var e}),(function(n){return n[1]}),n)}),n)}function Mu(n){switch(0|n.TAG){case 0:return String(n._0);case 1:return n._0?"true":"false";case 2:return function(n){switch(n){case 0:return"(";case 1:return")";case 2:return",";case 3:return";";case 4:return"=";case 5:return"->";case 6:return"{";case 7:return"}";case 8:return":";case 9:return"+";case 10:return"-";case 11:return"*";case 12:return"/";case 13:return"%";case 14:return"==";case 15:return"!=";case 16:return"<";case 17:return"<=";case 18:return">";case 19:return">=";case 20:return"!";case 21:return"."}}(n._0);case 3:case 4:return n._0;case 5:return function(n){switch(n){case 0:return"let";case 1:return"mut";case 2:return"in";case 3:return"if";case 4:return"else";case 5:return"fn";case 6:return"while";case 7:return"return";case 8:return"as";case 9:return"unsafe";case 10:return"struct"}}(n._0)}}function zu(n){return{contents:function(e){return W(pr(e),(function(t){if(c(n,t))return[t,hr(e)]}))}}}function Pu(n){return{contents:function(e){return W(pr(e),(function(t){return Y(c(n,t),(function(n){return[n,hr(e)]}))}))}}}function ju(n){return zu((function(e){return cn(e,n)}))}function Vu(n,e){return{contents:function(t){return Y(c(n.contents,t),(function(n){return[c(e,n[0]),n[1]]}))}}}function Bu(n,e){return{contents:function(t){return W(c(n.contents,t),(function(n){var t=n[0];return Y(c(e.contents,n[1]),(function(n){return[[t,n[0]],n[1]]}))}))}}}function qu(n){var e=function(n){return{contents:function(t){if(gr(t))return[0,t];var r=c(n.contents,t);if(void 0===r)return[0,t];var u=r[0];return Y(c(e(n).contents,r[1]),(function(n){return[{hd:u,tl:n[0]},n[1]]}))}}};return Vu(e(n),d)}function Zu(n,e,t){return{contents:function(r){return W(c(Bu(n,e).contents,r),(function(n){var e=n[0],r=e[1],u=e[0];return Y(c(t.contents,n[1]),(function(n){return[[u,r,n[0]],n[1]]}))}))}}}function Wu(n,e,t,r){return{contents:function(u){return W(c(Zu(n,e,t).contents,u),(function(n){var e=n[0],t=e[2],u=e[1],a=e[0];return Y(c(r.contents,n[1]),(function(n){return[[a,u,t,n[0]],n[1]]}))}))}}}function $u(n,e,t,r,u){return{contents:function(a){return W(c(Wu(n,e,t,r).contents,a),(function(n){var e=n[0],t=e[3],r=e[2],a=e[1],o=e[0];return Y(c(u.contents,n[1]),(function(n){return[[o,a,r,t,n[0]],n[1]]}))}))}}}function Hu(n,e){return{contents:function(t){var r=c(n.contents,t);return void 0!==r?[r[0],r[1]]:c(e.contents,t)}}}function Ku(n){return{contents:function(e){return Te(n,(function(n){return c(n.contents,e)}))}}}function Yu(n,e,t){return Vu(Bu(n,qu(e)),(function(n){var e=n[1],r=n[0];return cn(e,[])?r:m(e,r,t)}))}function Ju(n,e,t){return Yu(n,Bu(e,n),(function(n,e){return vn(t,n,e[0],e[1])}))}function Qu(n){return Vu(Zu(zu((function(n){return cn(n,{TAG:2,_0:0})})),n,zu((function(n){return cn(n,{TAG:2,_0:1})}))),(function(n){return n[1]}))}function na(n){return function(n,e){var t=function(r,u){var a=c(n.contents,r);if(void 0===a)return[u,r];var o=a[1];return u.push(a[0]),k(c(e.contents,o),[u,o],(function(n){return t(n[1],u)}))};return{contents:function(n){return t(n,[])}}}(n,zu((function(n){return cn(n,{TAG:2,_0:2})})))}function ea(n){return Hu(Vu(n,(function(n){return L(n)})),{contents:function(n){return[void 0,n]}})}var ta={contents:function(n){}},ra={contents:function(n){}},ua={contents:function(n){}},aa={contents:function(n){}},oa={contents:function(n){}},ca=Pu((function(n){if(0===n.TAG)return{TAG:0,_0:{TAG:0,_0:n._0}}})),ia=Pu((function(n){if(1===n.TAG)return{TAG:0,_0:{TAG:1,_0:n._0}}})),_a=Pu((function(n){if(3===n.TAG)return n._0})),sa=Pu((function(n){if(4===n.TAG)return n._0})),fa=Pu((function(n){switch(0|n.TAG){case 3:case 4:return n._0;default:return}})),la=Hu(Vu(Bu(ju({TAG:2,_0:0}),ju({TAG:2,_0:1})),(function(n){return Zn})),Pu((function(n){switch(0|n.TAG){case 3:switch(n._0){case"bool":return qn;case"u32":return Bn;default:return}case 4:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return}}))),va=Hu(la,Qu(oa)),Ta=Hu(Vu(Zu(Hu(Qu(na(oa)),Vu(va,(function(n){return[n]}))),ju({TAG:2,_0:5}),oa),(function(n){return Wn(n[0],n[2])})),va),da=Hu(Vu(Wu(sa,ju({TAG:2,_0:16}),na(oa),ju({TAG:2,_0:18})),(function(n){return{TAG:1,_0:n[0],_1:n[2]}})),Ta);oa.contents=da.contents;var Ga,Aa,ma,pa,ha,ga,Ea,ba=Vu(Bu(fa,ea(Bu(ju({TAG:2,_0:8}),oa))),(function(n){return[n[0],Y(n[1],(function(n){return n[1]}))]})),wa=Vu(Hu(_a,fa),(function(n){return{TAG:3,_0:n}})),ya=Ku([ca,ia,Vu(Bu(ju({TAG:2,_0:0}),ju({TAG:2,_0:1})),(function(n){return{TAG:0,_0:0}})),wa,Vu(Qu(Wu(ra,ju({TAG:2,_0:2}),ra,ea(Bu(ju({TAG:2,_0:2}),na(ra))))),(function(n){return{TAG:13,_0:s([n[0],n[2]],k(n[3],[],(function(n){return n[1]})))}})),Qu(ra)]),Sa=Hu(Vu(Bu(ya,Vu(Bu(Ga=Qu(na(ra)),qu(Ga)),(function(n){return s([n[0]],n[1])}))),(function(n){return m(n[1],n[0],(function(n,e){return{TAG:7,_0:n,_1:e}}))})),ya),ka=Hu(Yu(Sa,Bu(ju({TAG:2,_0:21}),_a),(function(n,e){return{TAG:15,_0:n,_1:e[1]}})),Sa),Ia=Ku([Vu(ju({TAG:2,_0:11}),(function(n){return 2})),Vu(ju({TAG:2,_0:10}),(function(n){return 0})),Vu(ju({TAG:2,_0:20}),(function(n){return 1}))]),xa=Hu(Vu(ju({TAG:2,_0:9}),(function(n){return 0})),Vu(ju({TAG:2,_0:10}),(function(n){return 1}))),Da=Ku([Vu(ju({TAG:2,_0:11}),(function(n){return 2})),Vu(ju({TAG:2,_0:12}),(function(n){return 3})),Vu(ju({TAG:2,_0:13}),(function(n){return 4}))]),Ca=Ku([Vu(ju({TAG:2,_0:16}),(function(n){return 5})),Vu(ju({TAG:2,_0:17}),(function(n){return 6})),Vu(ju({TAG:2,_0:18}),(function(n){return 7})),Vu(ju({TAG:2,_0:19}),(function(n){return 8}))]),Fa=Hu(Vu(ju({TAG:2,_0:14}),(function(n){return 9})),Vu(ju({TAG:2,_0:15}),(function(n){return 10}))),Na=Ju(Hu(Vu(Bu(Ia,ka),(function(n){return{TAG:1,_0:n[0],_1:n[1]}})),ka),Da,(function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}})),Ra=Ju(Na,xa,(function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}})),La=Ju(Ra,Ca,(function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}})),Xa=Ju(La,Fa,(function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}})),Oa=Hu(Vu(Wu(ju({TAG:5,_0:3}),ra,ua,ea(Bu(ju({TAG:5,_0:4}),ua))),(function(n){return{TAG:9,_0:n[1],_1:n[2],_2:Y(n[3],(function(n){return n[1]}))}})),Xa),Ua=Hu(Vu(Zu(ju({TAG:5,_0:6}),ra,ua),(function(n){return{TAG:10,_0:n[1],_1:n[2]}})),Oa),Ma=Hu(Vu((Aa=ju({TAG:5,_0:0}),ma=_a,pa=ju({TAG:2,_0:4}),ha=ra,ga=ju({TAG:5,_0:2}),Ea=ra,{contents:function(n){return W(c($u(Aa,ma,pa,ha,ga).contents,n),(function(n){var e=n[0],t=e[4],r=e[3],u=e[2],a=e[1],o=e[0];return Y(c(Ea.contents,n[1]),(function(n){return[[o,a,u,r,t,n[0]],n[1]]}))}))}}),(function(n){return{TAG:6,_0:n[1],_1:n[3],_2:n[5]}})),Ua),za=Hu(Qu(na(_a)),Vu(_a,(function(n){return[n]}))),Pa=Ju(Hu(Vu(Zu(za,ju({TAG:2,_0:5}),ra),(function(n){return{TAG:5,_0:n[0],_1:n[2]}})),Ma),ju({TAG:2,_0:4}),(function(n,e,t){return{TAG:4,_0:n,_1:t}})),ja=function(n,e){return{contents:function(t){var r=c(n.contents,t);if(void 0!==r){var u=r[1];return Y(c(e,r[0]),(function(n){return[n,u]}))}}}}(ra,(function(n){switch(0|n.TAG){case 9:case 10:return[!0,{TAG:1,_0:n}];default:return}}));ua.contents=Hu(Vu($u(ea(ju({TAG:5,_0:9})),ju({TAG:2,_0:6}),qu(Hu(Vu(aa,(function(n){return[!1,n]})),ja)),ea(ra),ju({TAG:2,_0:7})),(function(n){var e=n[3],t=n[2],r=b(t,(function(n){return n[1]})),u=k(n[0],0,(function(n){return 1})),a=en(t,t.length-1|0);if(void 0===a)return{TAG:8,_0:r,_1:e,_2:u};var o=a[1];return 0!==o.TAG&&a[0]&&R(e)?{TAG:8,_0:G(r,0,t.length-2|0),_1:o._0,_2:u}:{TAG:8,_0:r,_1:e,_2:u}})),Pa).contents;var Va=Hu(Vu(Wu(sa,ju({TAG:2,_0:6}),na(Zu(_a,ju({TAG:2,_0:8}),ra)),ju({TAG:2,_0:7})),(function(n){return{TAG:14,_0:n[0],_1:b(n[2],(function(n){return[n[0],n[2]]}))}})),ua),Ba=Hu(Vu(Bu(ju({TAG:5,_0:7}),ea(ra)),(function(n){return{TAG:11,_0:n[1]}})),Va),qa=Vu(Bu(Ba,ea(Bu(ju({TAG:5,_0:8}),oa))),(function(n){var e=n[1],t=n[0];return void 0!==e?{TAG:12,_0:t,_1:e[1]}:t}));ra.contents=qa.contents;var Za=Vu(Bu(ra,ju({TAG:2,_0:3})),(function(n){return{TAG:1,_0:n[0]}})),Wa=Hu(Vu($u(Hu(ju({TAG:5,_0:0}),ju({TAG:5,_0:1})),ba,ju({TAG:2,_0:4}),ra,ju({TAG:2,_0:3})),(function(n){var e=n[1];return{TAG:0,_0:e[0],_1:cn(n[0],{TAG:5,_0:1}),_2:n[3],_3:e[1]}})),Za);aa.contents=Wa.contents;var $a=Vu($u(Hu(ju({TAG:5,_0:0}),ju({TAG:5,_0:1})),fa,ju({TAG:2,_0:4}),ra,ju({TAG:2,_0:3})),(function(n){return{TAG:1,_0:n[1],_1:cn(n[0],{TAG:5,_0:1}),_2:n[3]}})),Ha=Hu(Vu($u(ju({TAG:5,_0:10}),sa,ju({TAG:2,_0:6}),na(Zu(_a,ju({TAG:2,_0:8}),oa)),ju({TAG:2,_0:7})),(function(n){var e=b(n[3],(function(n){return[n[0],n[2]]}));return{TAG:2,_0:n[1],_1:e}})),$a),Ka=Hu(Vu(Wu(ju({TAG:5,_0:5}),_a,Qu(na(_a)),ua),(function(n){return{TAG:0,_0:n[1],_1:n[2],_2:n[3]}})),Ha);ta.contents=Ka.contents;var Ya=qu(ta);function Ja(n){var e,t=n.replace(/(\/\/[^\n]*)/g,""),r=Uu((e=t,Ar(Array.from(e,(function(n){return _n(n,0)})))));if(void 0===r)return{TAG:1,_0:"could not tokenize"};var u=c(Ya.contents,Ar(r[0]));if(void 0===u)return{TAG:1,_0:"could not parse"};var a,o=u[1];return gr(o)?{TAG:0,_0:u[0]}:{TAG:1,_0:"could not parse near "+_(G((a=o)[0].slice(a[1],a[2]),0,5)," ",Mu)}}function Qa(n,e){switch(0|e.TAG){case 0:return n===e._0;case 1:return gn(e._1,(function(e){return Qa(n,e)}));case 2:var t=e._0;return 0!==t.TAG&&gn(Yn.toArray(t._0),(function(e){return Qa(n,e[1])}))}}function no(n,e,t){if(Qa(n,e))return{TAG:1,_0:ee({TAG:0,_0:n})+" occurs in "+ee(e)};var r=D(t,n);return void 0!==r?cn(r,e)?{TAG:0,_0:t}:{TAG:1,_0:ee(e)+" is not unifiable with "+ee(r)}:{TAG:0,_0:hn(t,n,e)}}function eo(n,e){for(;;){var t=n;if(!t)return{TAG:0,_0:e};var r=t.tl,u=t.hd,a=u[1],o=u[0],c=0;switch(0|o.TAG){case 0:var i=o._0,_=0;switch(0|a.TAG){case 0:if(i===a._0){n=r;continue}_=3;break;case 1:case 2:_=3}if(3===_)return Gn(no(i,a,e),function(n){return function(e){return eo(n,e)}}(r));break;case 1:var s=o._1;switch(0|a.TAG){case 0:c=1;break;case 1:var f=a._1;if(o._0===a._0&&s.length===f.length){n=m(q(s,f),r,(function(n,t){return{hd:[fe(e,t[0]),fe(e,t[1])],tl:n}}));continue}c=2;break;case 2:c=2}break;case 2:var l=o._0;switch(0|a.TAG){case 0:c=1;break;case 1:c=2;break;case 2:var T=a._0;if(0===l.TAG){var d=l._0;if(0===T.TAG){if(d!==T._0)return{TAG:1,_0:"cannot unify "+ee(o)+" with "+ee(a)};n=r;continue}var G=Se(d);if(void 0===G)return{TAG:1,_0:'undeclared struct "'+d+'"'};var A=eo({hd:[{TAG:2,_0:{TAG:1,_0:T._0}},Ae.toPartialStructType(G,Ee())],tl:r},e);return 0===A.TAG?{TAG:0,_0:A._0}:{TAG:1,_0:"struct type "+ee(a)+" does not match "+d+": "+A._0}}var p=l._0;if(0===T.TAG){var h=T._0,g=Se(h);if(void 0===g)return{TAG:1,_0:'undeclared struct "'+h+'"'};var E=eo({hd:[{TAG:2,_0:{TAG:1,_0:p}},Ae.toPartialStructType(g,Ee())],tl:r},e);return 0===E.TAG?{TAG:0,_0:E._0}:{TAG:1,_0:"struct type "+ee(o)+" does not match "+h+": "+E._0}}var w=Yn.toMap(T._0),y=Yn.toArray(p);return Gn(Ge(b(y,function(n,e,t){return function(r){var u=r[0],a=v(t,u);return void 0!==a?{TAG:0,_0:[r[1],a]}:{TAG:1,_0:"struct type "+ee(e)+' is missing attribute "'+u+'" from type "'+ee(n)+'"'}}}(o,a,w)),(function(n){return n})),function(n,t,r,u){return function(a){var o={TAG:2,_0:{TAG:1,_0:Yn.fromArray(An(mn(r,b(u,(function(n){return n[0]})))),Ee())}};return eo(pn(un(a),{hd:[Yn.tail(t),o],tl:n}),e)}}(r,p,w,y))}}switch(c){case 1:return Gn(no(a._0,o,e),function(n){return function(e){return eo(n,e)}}(r));case 2:return{TAG:1,_0:ee(o)+" is not unifiable with "+ee(a)}}}}function to(n,e){return eo({hd:[n,e],tl:0},void 0)}function ro(n){if(8!==n.TAG)return n;var e=n._3,t=n._2,r=n._0,u=function(n){if(!n)return Y(t,ro);var a=n.hd;return 0===a.TAG?{TAG:6,_0:r,_1:a._0,_2:ro(a._2),_3:k(u(n.tl),{TAG:0,_0:0},(function(n){return n}))}:{TAG:8,_0:r,_1:[uo(a)],_2:u(n.tl),_3:e}};return{TAG:8,_0:r,_1:[],_2:u(un(n._1)),_3:e}}function uo(n){return 0===n.TAG?{TAG:0,_0:n._0,_1:n._1,_2:ro(n._2)}:{TAG:1,_0:ro(n._0)}}function ao(n){switch(0|n.TAG){case 0:return{TAG:0,_0:n._0,_1:n._1,_2:ro(n._2)};case 1:return{TAG:1,_0:n._0,_1:n._1,_2:ro(n._2)};case 2:return n}}function oo(n){var e=In(xn(ge.structs),(function(e){return Cn(to({TAG:2,_0:{TAG:1,_0:n}},Ae.toPartialStructType(e,Ee())),void 0,(function(n){return e}))}));return 1!==e.length?0===e.length?0:{TAG:1,_0:e}:{TAG:0,_0:e[0]}}var co={ambiguousMatchesError:function(n,e){return"cannot infer struct type: inferred type "+Yn.show(n,ee)+" matches "+_(e,", ",(function(n){return n.name}))},findMatchingStruct:oo},io=wn();function _o(n,e,t){return Gn(so(n,e),(function(n){return bn(to(fe(n,t),fe(n,Ue.typeOf(e))),(function(e){return le(e,n)}))}))}function so(n,e){switch(0|e.TAG){case 0:var t=we(function(n){return jn("number"==typeof n?Zn:0===n.TAG?Bn:qn)}(e._0));return to(Ue.typeOf(e),t);case 1:var r=e._3,u=e._2,a=e._1,o=e._0;return Gn(so(n,a),(function(e){var t=ve(e,n);return Gn(so(t,r),(function(n){var t=le(n,e),c=fe(t,Wn([Ue.typeOf(a),Ue.typeOf(r)],o)),i=we(function(n){return n>=5?n>=9?[[0],Wn([{TAG:0,_0:0},{TAG:0,_0:0}],qn)]:jn(Wn([Bn,Bn],qn)):jn(Wn([Bn,Bn],Bn))}(u));return bn(to(c,i),(function(n){return le(n,t)}))}))}));case 2:var c=e._2,i=e._1,_=e._0,s=Ue.typeOf(c);return Gn(so(n,c),(function(n){var e=fe(n,Wn([s],_)),t=we(function(n){switch(n){case 0:return jn(Wn([Bn],Bn));case 1:return jn(Wn([qn],qn));case 2:return[[0],Wn([(e={TAG:0,_0:0},{TAG:1,_0:"Ptr",_1:[e]})],{TAG:0,_0:0})]}var e}(i));return bn(to(e,t),(function(e){return le(e,n)}))}));case 3:var f=e._0.contents,l=Vn.get(n,f.name);return void 0!==l?to(f.ty,we(l)):{TAG:1,_0:'unbound variable: "'+f.name+'"'};case 4:var T=e._1,d=e._0,G=Oe.typeOfExpr(d),A=Oe.typeOfExpr(T);return Gn(so(n,T),(function(e){var t=ve(e,n),r=fe(e,G);return Gn(_o(t,d,r),(function(n){var t=le(n,e),u=fe(n,r),a=fe(t,A);return bn(to(u,a),(function(n){return le(n,t)}))}))}));case 5:var p=e._3,h=e._2,g=e._0,E=Ue.typeOf(p);Sn(io,E);var w=m(h,n,(function(n,e){return Vn.addMono(n,e.contents.name,e.contents.ty)})),y=Wn(b(h,(function(n){return n.contents.ty})),E),S=k(e._1,w,(function(n){return Vn.add(w,n.contents.name,jn(y))}));return Gn(_o(S,p,E),(function(n){var e=fe(n,y),t=fe(n,g);return Gn(to(t,e),(function(e){var t=le(e,n);return kn(io),{TAG:0,_0:t}}))}));case 6:var I=e._3,x=e._2,D=e._0,C=e._1.contents,F=Ue.typeOf(x);return Gn(so(n,x),(function(e){var t=ve(e,n),r=fe(e,F),u=fe(e,D),a=ne(Vn.remove(t,C.name),r),o=Vn.add(t,C.name,a);return Gn(_o(o,I,u),(function(n){var t=le(n,e);return bn(to(fe(t,F),fe(t,C.ty)),(function(n){return le(n,t)}))}))}));case 7:var N=e._2,R=b(N,Ue.typeOf),L=Wn(R,e._0);return bn(Gn(_o(n,e._1,L),(function(e){return m(q(N,R),{TAG:0,_0:[e,ve(e,n)]},(function(n,e){var t=e[1],r=e[0];return Gn(n,(function(n){var e=n[1],u=n[0],a=fe(u,t);return bn(_o(e,r,a),(function(n){return[le(n,u),ve(n,e)]}))}))}))})),(function(n){return n[0]}));case 8:var X=e._2,O=e._0;return Gn(m(e._1,{TAG:0,_0:[void 0,n]},(function(n,e){return Gn(n,(function(n){var t=n[1],r=n[0];return bn(function(n,e){return 0===e.TAG?{TAG:1,_0:"CoreLetStmt should have been rewritten to CoreLetIn in the inferencer"}:so(n,e._0)}(t,e),(function(n){return[le(n,r),ve(n,t)]}))}))})),(function(e){var t=e[0];return void 0!==X?Gn(so(ve(t,n),X),(function(n){var e=Ue.typeOf(X),r=le(n,t);return bn(to(fe(r,O),fe(r,e)),(function(n){return le(n,r)}))})):bn(to(fe(t,O),Zn),(function(n){return le(n,t)}))}));case 9:var U=e._3,M=e._2,z=e._0;return Gn(_o(n,e._1,qn),(function(e){var t=ve(e,n),r=fe(e,z);return Gn(_o(t,M,r),(function(n){var u=ve(n,t),a=fe(n,r),o=le(n,e);return bn(_o(u,U,a),(function(n){return le(n,o)}))}))}));case 10:var P=e._1,j=Ue.typeOf(P);return Gn(so(n,e._0),(function(e){var t=fe(e,j),r=ve(e,n);return bn(_o(r,P,t),(function(n){return le(n,e)}))}));case 11:var V=yn(io);return void 0!==V?_o(n,k(e._0,{TAG:0,_0:0},(function(n){return n})),V):{TAG:1,_0:"'return' used outside of a function"};case 12:return _o(n,e._0,e._1);case 13:var B=m(e._0,{TAG:0,_0:[undefined,n]},(function(n,e){return Gn(n,(function(n){var t=n[1],r=n[0];return Gn(so(t,e),(function(n){return{TAG:0,_0:[le(n,r),ve(n,t)]}}))}))}));return bn(B,(function(n){return n[0]}));case 14:var Z=e._1,W=e._0,$=Se(W);if(void 0===$)return{TAG:1,_0:'undeclared struct "'+W+'"'};var H=m($.attributes,{TAG:0,_0:[n,undefined]},(function(n,e){var t=e.ty,r=e.name;return Gn(n,(function(n){var e=n[1],u=n[0],a=J(Z,(function(n){return n[0]===r}));return void 0!==a?Gn(_o(u,a[1],t),(function(n){return{TAG:0,_0:[ve(n,u),le(n,e)]}})):{TAG:1,_0:'missing field "'+r+'" for struct "'+W+'"'}}))}));return bn(H,(function(n){return n[1]}));case 15:var K=e._2,Y=e._1,Q=e._0;return Gn(so(n,Y),(function(t){var r=Oe.typeOfExpr(Y),u=fe(t,r),a=function(t){return Dn(u,fe(t,r))?_o(ve(t,n),e,fe(t,Q)):{TAG:0,_0:t}};switch(0|u.TAG){case 0:case 1:break;case 2:var o=u._0;if(0===o.TAG){var c=o._0,i=Se(c);if(void 0===i)return{TAG:1,_0:'undeclared struct: "'+c+'"'};var _=J(i.attributes,(function(n){return n.name===K}));return void 0!==_?bn(to(fe(t,Q),fe(t,_.ty)),(function(n){return le(n,t)})):{TAG:1,_0:'attribute "'+K+'" does not exist on struct "'+c+'"'}}var s=o._0,f=v(Yn.toMap(s),K);if(void 0!==f)return bn(to(fe(t,Q),fe(t,f)),(function(n){return le(n,t)}));var l=Yn.insert(s,K,Q),T=fe(t,{TAG:2,_0:{TAG:1,_0:l}}),d=oo(l);if("number"!=typeof d)return 0===d.TAG?Gn(to(u,{TAG:2,_0:{TAG:0,_0:d._0.name}}),(function(n){return a(le(n,t))})):Gn(to(u,T),(function(n){return a(le(n,t))}));var G=0;switch(0|r.TAG){case 0:return{TAG:0,_0:le(hn(undefined,r._0,T),t)};case 1:case 2:G=2}if(2===G)return bn(to(r,T),(function(n){return le(n,t)}))}var A=Ee(),m=Yn.insert(Yn.make({TAG:0,_0:A}),K,Q),p=fe(t,{TAG:2,_0:{TAG:1,_0:m}}),h=oo(m);return"number"==typeof h?{TAG:1,_0:"no struct declaration matches type "+ee(p)}:0===h.TAG?Gn(to(u,{TAG:2,_0:{TAG:0,_0:h._0.name}}),(function(n){return a(le(n,t))})):Gn(to(u,p),(function(n){return a(le(n,t))}))}))}}function fo(n,e){switch(0|e.TAG){case 0:var t=e._0;return bn(so(n,{TAG:5,_0:t.contents.ty,_1:t,_2:e._1,_3:e._2}),(function(e){return[ve(e,Vn.addMono(n,t.contents.name,t.contents.ty)),e]}));case 1:var r=e._0;return bn(_o(n,e._2,r.contents.ty),(function(e){return[ve(e,Vn.addMono(n,r.contents.name,r.contents.ty)),e]}));case 2:return a=e._0,o=e._1,c={contents:0},i=[],M(o,(function(n){var e=n[1],t=pe(e);i.push({name:n[0],offset:c.contents,ty:e,size:t}),c.contents=c.contents+t|0})),u={name:a,attributes:i,size:c.contents},P(ge.structs,u.name,u),{TAG:0,_0:[n,undefined]}}var u,a,o,c,i}var lo=Z("Compiler.CompilerExn.InvalidTypeConversion"),vo=Z("Compiler.CompilerExn.InvalidFunctionSignature"),To=Z("Compiler.CompilerExn.VariableNotFound"),Go=Z("Compiler.CompilerExn.EmptyFunctionStack"),Ao=Z("Compiler.CompilerExn.CannotReassignImmutableValue"),mo=Z("Compiler.CompilerExn.FunctionNotFound"),po=Z("Compiler.CompilerExn.Unimplemented"),ho=Z("Compiler.CompilerExn.UnsupportedGlobalInitializer"),go=Z("Compiler.CompilerExn.InvalidTypeAssertion"),Eo=Z("Compiler.CompilerExn.DerefUsedOutsideOfUnsafeBlock"),bo=Z("Compiler.CompilerExn.UndeclaredStruct"),wo=Z("Compiler.CompilerExn.InvalidAttributeAccess"),yo=Z("Compiler.CompilerExn.StructTypeNotMatched"),So=Z("Compiler.CompilerExn.AmibguousStruct");function ko(n){return n.RE_EXN_ID===lo?"unsupported type: "+ee(n._1):n.RE_EXN_ID===vo?"invalid function signature: "+ee(n._1):n.RE_EXN_ID===To?'variable "'+n._1+'" not found':n.RE_EXN_ID===Go?"Function stack is empty":n.RE_EXN_ID===Ao?'cannot reassign "'+n._1+'" as it is immutable':n.RE_EXN_ID===mo?'no function named "'+n._1+'" found':n.RE_EXN_ID===po?"unimplemented: "+n._1:n.RE_EXN_ID===ho?"unsupported global initializer: "+Ue.show(void 0,n._1):n.RE_EXN_ID===go?"invalid type assertion from "+ee(n._1)+" to "+ee(n._2):n.RE_EXN_ID===Eo?"the deref operator can only be used in an unsafe block":n.RE_EXN_ID===he.UnkownTypeSize?"unknown type size: "+ee(n._1):n.RE_EXN_ID===bo?'undeclared struct "'+n._1+'"':n.RE_EXN_ID===wo?n._1+' does not exist for type "'+ee(n._2)+'"':n.RE_EXN_ID===yo?"No struct declaration matches type "+ee(n._1):n.RE_EXN_ID===So?co.ambiguousMatchesError(n._1,n._2):"unexpected compiler exception"}function Io(n){if(0===n.TAG){var e=n._0,t=Se(e);if(void 0!==t)return t;throw{RE_EXN_ID:bo,_1:e,Error:new Error}}var r=n._0,u=co.findMatchingStruct(r);if("number"==typeof u)throw{RE_EXN_ID:yo,_1:{TAG:2,_0:n},Error:new Error};if(0===u.TAG)return u._0;throw{RE_EXN_ID:So,_1:r,_2:u._0,Error:new Error}}function xo(n){switch(0|n.TAG){case 0:throw{RE_EXN_ID:lo,_1:n,Error:new Error};case 1:switch(n._0){case"()":if(0!==n._1.length)throw{RE_EXN_ID:lo,_1:n,Error:new Error};return[];case"Fun":case"Ptr":return[0];case"Tuple":return Q(b(n._1,xo));case"bool":case"u32":break;case"u64":if(0!==n._1.length)throw{RE_EXN_ID:lo,_1:n,Error:new Error};return[1];default:throw{RE_EXN_ID:lo,_1:n,Error:new Error}}if(0!==n._1.length)throw{RE_EXN_ID:lo,_1:n,Error:new Error};return[0];case 2:return 0===Io(n._0).size?[]:[0]}}function Do(n,e){switch(0|e.TAG){case 1:if("Tuple"===e._0){var t=Q(b(e._1,xo)),r={_0:[],_1:t};return{TAG:1,_0:dr.getOrAddSignature(n,r),_1:[[],t]}}}var u=xo(e),a=u.length;if(1!==a){if(0===a)return 0;throw{RE_EXN_ID:po,_1:"wasmBlockReturnTypeOf for "+ee(e),Error:new Error}}return{TAG:0,_0:u[0]}}function Co(n){switch(0|n.TAG){case 1:if("Fun"===n._0){var e=n._1,t=e.slice(0,e.length-1|0),r=en(e,e.length-1|0);return Rn(dt.Signature.make,Q(b(t,xo)),k(r,[],xo))}throw{RE_EXN_ID:vo,_1:n,Error:new Error};case 0:case 2:throw{RE_EXN_ID:vo,_1:n,Error:new Error}}}function Fo(n,e){n.instructions.push(e)}function No(n){var e=Co(Wn(b(n.params,(function(n){return n[1]})),n.ret)),t=c(dt.Local.fromTypes,Q(b(n.locals,(function(n){return b(xo(n.ty),(function(e){return[n.name,e]}))})))),r=Rn(dt.Body.make,t,function(n){for(var e=un(n),t=0;;){var r=t,u=e;if(!u)return T(d(r));var a=u.hd,o=0;if("number"==typeof a)switch(a){case 9:var c=u.tl;if(c&&9===c.hd){e=c.tl;continue}break;case 10:var i=u.tl;if(i&&9===i.hd){e={hd:14,tl:i.tl};continue}break;case 14:var _=u.tl;if(_&&9===_.hd){e={hd:10,tl:_.tl};continue}break;case 18:var s=u.tl;if(s&&9===s.hd){e={hd:36,tl:s.tl};continue}break;case 19:var f=u.tl;if(f&&9===f.hd){e={hd:37,tl:f.tl};continue}break;case 24:var l=u.tl;if(l&&9===l.hd){e={hd:30,tl:l.tl};continue}break;case 25:var v=u.tl;if(v&&9===v.hd){e={hd:31,tl:v.tl};continue}break;case 30:var G=u.tl;if(G&&9===G.hd){e={hd:24,tl:G.tl};continue}break;case 31:var A=u.tl;if(A&&9===A.hd){e={hd:25,tl:A.tl};continue}break;case 36:var m=u.tl;if(m&&9===m.hd){e={hd:18,tl:m.tl};continue}break;case 37:var p=u.tl;if(p&&9===p.hd){e={hd:19,tl:p.tl};continue}}else switch(0|a.TAG){case 0:var h=a._0,g=0,E=u.tl;if(E){var b=E.hd;if("number"==typeof b){if(3===b){e=E.tl;continue}g=3}else if(0===b.TAG){var w=E.tl;if(w){var y=w.hd;if("number"==typeof y){var S=b._0;if(43===y){e={hd:{TAG:0,_0:dn(h,S)},tl:w.tl};continue}if(y<15)switch(y){case 4:e={hd:{TAG:0,_0:h+S|0},tl:w.tl};continue;case 5:e={hd:{TAG:0,_0:h-S|0},tl:w.tl};continue;case 6:e={hd:{TAG:0,_0:Math.imul(h,S)},tl:w.tl};continue;case 7:e={hd:{TAG:0,_0:Tn(h,S)},tl:w.tl};continue;case 10:e={hd:{TAG:0,_0:h===S?1:0},tl:w.tl};continue;case 0:case 1:case 2:case 3:case 8:case 9:case 11:case 12:case 13:break;case 14:e={hd:{TAG:0,_0:h===S?0:1},tl:w.tl};continue}}}}else g=3}if(3===g&&0===h){var k=u.tl;if(10===k.hd){e={hd:9,tl:k.tl};continue}}break;case 1:case 2:case 3:case 11:o=2;break;case 12:var I=u.tl;if(I){var x=I.hd;if("number"!=typeof x&&11===x.TAG){var D=a._0;if(D===x._0){e={hd:{TAG:13,_0:D},tl:I.tl};continue}}}}if(2===o){var C=u.tl;if(C&&3===C.hd){e=C.tl;continue}}t={hd:a,tl:r},e=u.tl}}(n.instructions));return dt.make(n.name,e,r)}function Ro(n,e,t,r,u){return{name:n,isMutable:e,ty:t,index:r,init:u}}function Lo(n){var e=yn(n.funcStack);if(void 0!==e)return e;throw{RE_EXN_ID:Go,Error:new Error}}function Xo(n,e){return tn(n.funcs,(function(n){return n.name===e}))}function Oo(n,e){var t=yn(n.blockStack);if(void 0!==t&&!(e<=0)){var r=t.shadowStackDelta;return r.contents=r.contents+e|0,Fo(Lo(n),{TAG:9,_0:n.stackTop.index}),Fo(Lo(n),{TAG:0,_0:e}),Fo(Lo(n),5),Fo(Lo(n),{TAG:10,_0:n.stackTop.index})}}function Uo(n){var e=yn(n.blockStack);return void 0!==e&&e.isUnsafe}function Mo(n,e){return n.scopeDepth=n.scopeDepth+1|0,Sn(n.blockStack,{isUnsafe:e||Uo(n),shadowStackDelta:{contents:0}})}function zo(n){n.scopeDepth=n.scopeDepth-1|0,function(n,e){var t=yn(n.blockStack);if(void 0!==t&&!(e<=0)){var r=t.shadowStackDelta;r.contents=r.contents-e|0,Fo(Lo(n),{TAG:9,_0:n.stackTop.index}),Fo(Lo(n),{TAG:0,_0:e}),Fo(Lo(n),4),Fo(Lo(n),{TAG:10,_0:n.stackTop.index})}}(n,k(yn(n.blockStack),0,(function(n){return n.shadowStackDelta.contents}))),kn(n.blockStack)}function Po(n,e,t,r){var u=function(n,e,t,r,u){return n.locals.push(function(n,e,t,r){return{name:n,depth:e,ty:t,isMutable:r}}(e,r,t,u)),(n.params.length+n.locals.length|0)-1|0}(Lo(n),e,t,n.scopeDepth,r);return Fo(Lo(n),{TAG:12,_0:u})}function jo(n,e){var t=function(n,e){var t=tn(n.params,(function(n){return n[0]===e}));if(void 0!==t)return[t,!0];var r=de(n.locals,(function(n){return n.name===e}));return void 0!==r?[n.params.length+r|0,A(n.locals,r).isMutable]:void 0}(Lo(n),e);return void 0!==t?{TAG:0,_0:t[0],_1:t[1]}:Y(V(n.globals,e),(function(n){return{TAG:1,_0:n.index,_1:n.isMutable}}))}function Vo(n){return"number"==typeof n?void 0:0===n.TAG?{TAG:0,_0:n._0}:{TAG:0,_0:n._0?1:0}}function Bo(n){if(!Uo(n))throw{RE_EXN_ID:Eo,Error:new Error}}function qo(n,e){switch(0|n.TAG){case 0:case 1:return{TAG:1,_0:{RE_EXN_ID:wo,_1:e,_2:n}};case 2:var t=Io(n._0),r=J(t.attributes,(function(n){return n.name===e}));return void 0!==r?{TAG:0,_0:{offset:r.offset,ty:r.ty,size:r.size}}:{TAG:1,_0:{RE_EXN_ID:wo,_1:e,_2:n}}}}function Zo(n,e){for(;;){var t=e;switch(0|t.TAG){case 0:var r=Vo(t._0);return void 0!==r?Fo(Lo(n),r):void 0;case 1:var u,a=t._2,o=t._1;if(he.isZeroSizedType(Oe.typeOfExpr(o))){e={TAG:0,_0:{TAG:1,_0:9===a}};continue}switch(a){case 0:u=4;break;case 1:u=5;break;case 2:u=6;break;case 3:u=7;break;case 4:u=43;break;case 5:u=31;break;case 6:u=19;break;case 7:u=37;break;case 8:u=25;break;case 9:u=10;break;case 10:u=14}return Zo(n,o),Zo(n,t._3),Fo(Lo(n),u);case 2:var c;switch(t._1){case 0:throw{RE_EXN_ID:po,_1:"u32 negation is not handled",Error:new Error};case 1:c=9;break;case 2:Bo(n),c={TAG:16,_0:0,_1:0}}return Zo(n,t._2),Fo(Lo(n),c);case 3:var i=t._0;if(he.isZeroSizedType(i.contents.ty))return;var _=jo(n,i.contents.newName);if(void 0!==_)return 0===_.TAG?Fo(Lo(n),{TAG:11,_0:_._0}):Fo(Lo(n),{TAG:9,_0:_._0});throw{RE_EXN_ID:To,_1:i.contents.name,Error:new Error};case 4:var s=t._1,f=t._0;if(he.isZeroSizedType(Oe.typeOfExpr(s)))return;switch(0|f.TAG){case 2:if(f._1>=2){Bo(n),Zo(n,f._2),Zo(n,s);var l={TAG:17,_0:he.sizeLog2(Oe.typeOfExpr(s)),_1:0};return Fo(Lo(n),l)}throw{RE_EXN_ID:po,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error};case 3:var v=f._0,T=jo(n,v.contents.newName);if(void 0!==T){var d;if(T._1)return d=0===T.TAG?{TAG:12,_0:T._0}:{TAG:10,_0:T._0},Zo(n,s),Fo(Lo(n),d);throw{RE_EXN_ID:Ao,_1:v.contents.name,Error:new Error}}throw{RE_EXN_ID:To,_1:v.contents.name,Error:new Error};case 15:var G=f._1,A=qo(Oe.typeOfExpr(G),f._2);if(0===A.TAG){var m=A._0;return m.size>0?(Zo(n,G),Zo(n,s),Fo(Lo(n),{TAG:17,_0:0,_1:m.offset})):void 0}throw A._0;default:throw{RE_EXN_ID:po,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error}}case 5:var p=t._1,h=ye(void 0,"__lambda"+String(n.funcs.length)+"__");void 0!==p&&(p.contents.newName=h.contents.name);var g=Wo(n,h,t._2,t._3);return Fo(Lo(n),{TAG:0,_0:g});case 6:var E=t._2,b=t._1.contents;he.isZeroSizedType(Oe.typeOfExpr(E))||(Zo(n,E),Po(n,b.name,b.ty,!1)),e=t._3;continue;case 7:var w=t._2,y=t._1,S=function(e,t){return function(r){M(t,(function(e){return Zo(n,e)}));var u=Co(Oe.typeOfExpr(e)),a=dr.getOrAddSignature(n.mod,u);return Zo(n,e),Fo(Lo(n),{TAG:15,_0:a,_1:0})}}(y,w);if(3!==y.TAG)return S(void 0);var k=y._0;if(void 0!==jo(n,k.contents.newName))return S(void 0);var I=Xo(n,k.contents.newName);if(void 0!==I)return M(w,(function(e){return Zo(n,e)})),Fo(Lo(n),{TAG:14,_0:I});throw{RE_EXN_ID:mo,_1:k.contents.name,Error:new Error};case 8:var x=t._2;return Mo(n,1===t._3),M(t._1,(function(e){return $o(n,e)})),void 0!==x&&Zo(n,x),zo(n);case 9:var D=t._3,C=Do(n.mod,t._0);return Zo(n,t._1),Fo(Lo(n),{TAG:4,_0:C}),Zo(n,t._2),Dn(D,{TAG:0,_0:0})&&(Fo(Lo(n),0),Zo(n,D)),Fo(Lo(n),1);case 10:return Fo(Lo(n),{TAG:7,_0:0}),Fo(Lo(n),{TAG:8,_0:0}),Zo(n,t._0),Fo(Lo(n),9),Fo(Lo(n),{TAG:5,_0:1}),Zo(n,t._1),Fo(Lo(n),{TAG:6,_0:0}),Fo(Lo(n),1),Fo(Lo(n),1);case 11:var F=t._0;return void 0!==F&&Zo(n,F),Fo(Lo(n),2);case 12:var N=t._2,R=t._1;if(!cn(R,N))switch(0|R.TAG){case 1:switch(R._0){case"Ptr":var L=R._1;if(1!==L.length)throw{RE_EXN_ID:go,_1:R,_2:N,Error:new Error};var X=L[0];switch(0|X.TAG){case 1:if("u32"!==X._0)throw{RE_EXN_ID:go,_1:R,_2:N,Error:new Error};if(0!==X._1.length)throw{RE_EXN_ID:go,_1:R,_2:N,Error:new Error};switch(0|N.TAG){case 1:if("u32"!==N._0)throw{RE_EXN_ID:go,_1:R,_2:N,Error:new Error};if(0!==N._1.length)throw{RE_EXN_ID:go,_1:R,_2:N,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:go,_1:R,_2:N,Error:new Error}}break;case 0:case 2:throw{RE_EXN_ID:go,_1:R,_2:N,Error:new Error}}break;case"u32":if(0!==R._1.length)throw{RE_EXN_ID:go,_1:R,_2:N,Error:new Error};switch(0|N.TAG){case 1:if("Ptr"!==N._0)throw{RE_EXN_ID:go,_1:R,_2:N,Error:new Error};if(1!==N._1.length)throw{RE_EXN_ID:go,_1:R,_2:N,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:go,_1:R,_2:N,Error:new Error}}break;default:throw{RE_EXN_ID:go,_1:R,_2:N,Error:new Error}}break;case 0:case 2:throw{RE_EXN_ID:go,_1:R,_2:N,Error:new Error}}e=t._0;continue;case 13:return M(t._0,(function(e){return Zo(n,e)}));case 14:var O=sn(Se(t._0)),U=O.size;Oo(n,U),M(O.attributes,(function(e){if(he.size(e.ty)>0)return Fo(Lo(n),{TAG:9,_0:n.stackTop.index})})),U>0&&Fo(Lo(n),{TAG:9,_0:n.stackTop.index});return M(t._1,function(e){return function(t){var r=t[1],u=function(t){Zo(n,r),Fo(Lo(n),{TAG:17,_0:0,_1:e.contents}),e.contents=e.contents+t|0},a=Ue.typeOf(r);switch(0|a.TAG){case 0:break;case 1:var o=0;switch(a._0){case"()":if(0===a._1.length)return;break;case"Fun":return u(4);case"Ptr":if(1===a._1.length)return u(4);break;case"bool":case"u32":o=2}if(2===o&&0===a._1.length)return u(4);break;case 2:return Io(a._0),u(4)}throw{RE_EXN_ID:po,_1:"cannot store "+ee(a)+" in the shadow stack",Error:new Error}}}({contents:0}));case 15:var z=t._1,P=qo(Oe.typeOfExpr(z),t._2);if(0===P.TAG){var j=P._0;return he.isZeroSizedType(j.ty)?void 0:(Zo(n,z),Fo(Lo(n),{TAG:16,_0:0,_1:j.offset}))}throw P._0}}}function Wo(n,e,t,r){var u,a,o,c=b(t,(function(n){return[n.contents.name,n.contents.ty]})),i=(u=e.contents.newName,a=c,o=Ue.typeOf(r),{name:u,locals:[],params:Xn(a,(function(n){return!he.isZeroSizedType(n[1])})),ret:o,instructions:[]}),_=n.funcs.push(i)-1|0;return Sn(n.funcStack,i),Zo(n,r),Fo(Lo(n),1),kn(n.funcStack),_}function $o(n,e){if(0===e.TAG){var t=e._2,r=e._0;return Zo(n,t),he.isZeroSizedType(Oe.typeOfExpr(t))?void 0:Po(n,r.contents.name,r.contents.ty,e._1)}var u=e._0;return Zo(n,u),M(xo(Ue.typeOf(u)),(function(e){return Fo(Lo(n),3)}))}function Ho(n,e){switch(0|e.TAG){case 0:return void Wo(n,e._0,e._1,e._2);case 1:var t,r=e._2;if(0!==r.TAG)throw{RE_EXN_ID:ho,_1:r,Error:new Error};var u=Vo(r._0);if(void 0===u)throw{RE_EXN_ID:ho,_1:r,Error:new Error};if("number"==typeof u)throw{RE_EXN_ID:ho,_1:r,Error:new Error};if(0!==u.TAG)throw{RE_EXN_ID:ho,_1:r,Error:new Error};return t={TAG:0,_0:u._0},void function(n,e,t,r,u){var a=Ln(n.globals),o=Ro(e,t,r,a,u);P(n.globals,e,o)}(n,e._0.contents.name,e._1,0,t);case 2:return}}function Ko(n){var e={mod:dr.make(void 0),funcs:[],scopeDepth:0,funcStack:wn(),globals:U(1),stackTop:Ro("__STACK_TOP__",!0,0,0,{TAG:0,_0:65535}),blockStack:wn()};P(e.globals,e.stackTop.name,e.stackTop);try{M(n,(function(n){return Ho(e,n)})),dr.addMemory(e.mod,ir.make(zt.make(6,void 0))),M(Fn(xn(e.globals),(function(n,e){return n.index-e.index|0})),(function(n){var t,r,u,a=(r=(t=n).init,u=t.isMutable,Y(t.ty,(function(n){return rr.make(u,n,r)})));if(void 0!==a)return dr.addGlobal(e.mod,a)}));var t=Ht.fromFuncRefs(0,on(e.funcs,(function(n,e){return n})));return dr.addElement(e.mod,t),dr.addTable(e.mod,Vt.make(0,zt.makeExact(e.funcs.length))),M(e.funcs,(function(n){var t=No(n);dr.addExportedFunc(e.mod,n.name,t[1],t[2])})),{TAG:0,_0:e.mod}}catch(r){return{TAG:1,_0:ko(Nn(r))}}}var Yo=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",compile:function(n){return Gn(Ja(n),(function(n){var e=b(n,Me.from);return Gn(function(n){return En(io),m(b(n,ao),{TAG:0,_0:[Vn.empty,void 0]},(function(n,e){return Gn(n,(function(n){var t=n[1];return bn(fo(n[0],e),(function(n){return[n[0],le(n[1],t)]}))}))}))}(e),(function(n){var t,r=n[1];t=r,M(z(ge.renaming),(function(n){n.contents.ty=fe(t,n.contents.ty)}));var u=b(e,(function(n){return Me.subst(r,n)}));return bn(Ko(u),(function(n){return[n,dr.encodeAsUint8Array(n)]}))}))}))}});const Jo={0:"I32",1:"I64",2:"F32",3:"F64"},Qo={0:"Else",1:"End",2:"Return",3:"Drop",4:"AddI32",5:"SubI32",6:"MulI32",7:"DivI32Unsigned",8:"DivI32Signed",9:"EqzI32",10:"EqI32",11:"EqI64",12:"EqF32",13:"EqF64",14:"NeI32",15:"NeI64",16:"NeF32",17:"NeF64",18:"LeI32Signed",19:"LeI32Unsigned",20:"LeI64Signed",21:"LeI64Unsigned",22:"LeF32",23:"LeF64",24:"GeI32Signed",25:"GeI32Unsigned",26:"GeI64Signed",27:"GeI64Unsigned",28:"GeF32",29:"GeF64",30:"LtI32Signed",31:"LtI32Unsigned",32:"LtI64Signed",33:"LtI64Unsigned",34:"LtF32",35:"LtF64",36:"GtI32Signed",37:"GtI32Unsigned",38:"GtI64Signed",39:"GtI64Unsigned",40:"GtF32",41:"GtF64",42:"RemI32Signed",43:"RemI32Unsigned",44:"And"},nc={0:"FuncRef",1:"ExternRef"},ec={0:"Func",1:"Table",2:"Memory",3:"Global"},tc={0:"Void"},rc=Yo,uc=function(n){const e=rc.compile(n);return 0===e.TAG?{tag:"Ok",value:[{typeSection:e._0[0].typeSection.map((function(n){return[n._0.map((function(n){return Jo[n]})),n._1.map((function(n){return Jo[n]}))]})),funcSection:e._0[0].funcSection,tableSection:e._0[0].tableSection.map((function(n){return[nc[n[0]],n[1]]})),memorySection:e._0[0].memorySection,globalSection:e._0[0].globalSection.map((function(n){return[Jo[n[0]],n[1],0===n[2].TAG?{tag:"InitConstI32",value:n[2]._0}:{tag:"InitGetGlobal",value:n[2]._0}]})),exportSection:e._0[0].exportSection.map((function(n){return{name:n.name,kind:ec[n.kind],index:n.index}})),elementSection:e._0[0].elementSection,codeSection:e._0[0].codeSection.map((function(n){return[n[0].map((function(n){return[n[0],Jo[n[1]]]})),n[1].map((function(n){return"object"==typeof n?0===n.TAG?{tag:"ConstI32",value:n._0}:1===n.TAG?{tag:"ConstI64",value:n._0}:2===n.TAG?{tag:"ConstF32",value:n._0}:3===n.TAG?{tag:"ConstF64",value:n._0}:4===n.TAG?{tag:"If",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Jo[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Jo[n]})),n._0._1[1].map((function(n){return Jo[n]}))]]}:tc[n._0]}:5===n.TAG?{tag:"BranchIf",value:n._0}:6===n.TAG?{tag:"Branch",value:n._0}:7===n.TAG?{tag:"Block",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Jo[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Jo[n]})),n._0._1[1].map((function(n){return Jo[n]}))]]}:tc[n._0]}:8===n.TAG?{tag:"Loop",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Jo[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Jo[n]})),n._0._1[1].map((function(n){return Jo[n]}))]]}:tc[n._0]}:9===n.TAG?{tag:"GetGlobal",value:n._0}:10===n.TAG?{tag:"SetGlobal",value:n._0}:11===n.TAG?{tag:"GetLocal",value:n._0}:12===n.TAG?{tag:"SetLocal",value:n._0}:13===n.TAG?{tag:"TeeLocal",value:n._0}:14===n.TAG?{tag:"Call",value:n._0}:15===n.TAG?{tag:"CallIndirect",value:[n._0,n._1]}:16===n.TAG?{tag:"LoadI32",value:[n._0,n._1]}:{tag:"StoreI32",value:[n._0,n._1]}:Qo[n]}))]})),funcs:e._0[0].funcs.map((function(n){return[n[0],[n[1]._0.map((function(n){return Jo[n]})),n[1]._1.map((function(n){return Jo[n]}))],[n[2][0].map((function(n){return[n[0],Jo[n[1]]]})),n[2][1].map((function(n){return"object"==typeof n?0===n.TAG?{tag:"ConstI32",value:n._0}:1===n.TAG?{tag:"ConstI64",value:n._0}:2===n.TAG?{tag:"ConstF32",value:n._0}:3===n.TAG?{tag:"ConstF64",value:n._0}:4===n.TAG?{tag:"If",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Jo[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Jo[n]})),n._0._1[1].map((function(n){return Jo[n]}))]]}:tc[n._0]}:5===n.TAG?{tag:"BranchIf",value:n._0}:6===n.TAG?{tag:"Branch",value:n._0}:7===n.TAG?{tag:"Block",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Jo[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Jo[n]})),n._0._1[1].map((function(n){return Jo[n]}))]]}:tc[n._0]}:8===n.TAG?{tag:"Loop",value:"object"==typeof n._0?0===n._0.TAG?{tag:"TypeValue",value:Jo[n._0._0]}:{tag:"TypeIndex",value:[n._0._0,[n._0._1[0].map((function(n){return Jo[n]})),n._0._1[1].map((function(n){return Jo[n]}))]]}:tc[n._0]}:9===n.TAG?{tag:"GetGlobal",value:n._0}:10===n.TAG?{tag:"SetGlobal",value:n._0}:11===n.TAG?{tag:"GetLocal",value:n._0}:12===n.TAG?{tag:"SetLocal",value:n._0}:13===n.TAG?{tag:"TeeLocal",value:n._0}:14===n.TAG?{tag:"Call",value:n._0}:15===n.TAG?{tag:"CallIndirect",value:[n._0,n._1]}:16===n.TAG?{tag:"LoadI32",value:[n._0,n._1]}:{tag:"StoreI32",value:[n._0,n._1]}:Qo[n]}))]]})),importsCount:e._0[0].importsCount},e._0[1]]}:{tag:"Error",value:e._0}},ac={0:"I32",1:"I64",2:"F32",3:"F64"},oc={I32:0,I64:1,F32:2,F64:3},cc={Else:0,End:1,Return:2,Drop:3,AddI32:4,SubI32:5,MulI32:6,DivI32Unsigned:7,DivI32Signed:8,EqzI32:9,EqI32:10,EqI64:11,EqF32:12,EqF64:13,NeI32:14,NeI64:15,NeF32:16,NeF64:17,LeI32Signed:18,LeI32Unsigned:19,LeI64Signed:20,LeI64Unsigned:21,LeF32:22,LeF64:23,GeI32Signed:24,GeI32Unsigned:25,GeI64Signed:26,GeI64Unsigned:27,GeF32:28,GeF64:29,LtI32Signed:30,LtI32Unsigned:31,LtI64Signed:32,LtI64Unsigned:33,LtF32:34,LtF64:35,GtI32Signed:36,GtI32Unsigned:37,GtI64Signed:38,GtI64Unsigned:39,GtF32:40,GtF64:41,RemI32Signed:42,RemI32Unsigned:43,And:44},ic={FuncRef:0,ExternRef:1},_c={Func:0,Table:1,Memory:2,Global:3},sc={Void:0},fc=Gr;fc.uleb128,fc.sleb128,fc.Vec.encode,fc.Vec.encodeMany,fc.F32.encode,fc.F64.encode,fc.Func.Signature.funcTypeCode,fc.Func.Signature.empty._0.map((function(n){return ac[n]})),fc.Func.Signature.empty._1.map((function(n){return ac[n]})),fc.FuncSection.make,fc.FuncSection.encode,fc.Str.encode,fc.Limits.makeExact,fc.Elem.show,fc.Elem.encode,fc.ElementSection.make,fc.ElementSection.show,fc.ElementSection.encode,fc.MemorySection.make;fc.F32,fc.F64,fc.Vec,fc.Str;const lc=({theme:n,code:e,onChange:t})=>On.createElement(Un,{mode:"rust",width:"100vw",height:"calc(100vh - 39px)",value:e,theme:n,enableLiveAutocompletion:!0,onChange:t,fontSize:16,editorProps:{$blockScrolling:!0}}),vc=({theme:n,text:e})=>On.createElement(Un,{mode:"text",width:"100vw",height:"calc(100vh - 39px)",value:e,theme:n,enableLiveAutocompletion:!0,onChange:()=>null,fontSize:16,editorProps:{$blockScrolling:!0},setOptions:{showLineNumbers:!1}}),Tc={dark:{backgroundColor:"#1c1c1c",color:"white",borderColor:"#3b3b3b"},light:{backgroundColor:"white",color:"black",borderColor:"black"}},dc=n=>((n,r)=>e(n,t(r)))(((n,e)=>{for(var t in e||(e={}))u.call(e,t)&&o(n,t,e[t]);if(r)for(var t of r(e))a.call(e,t)&&o(n,t,e[t]);return n})({},n?Tc.dark:Tc.light),{borderWidth:"2px",borderStyle:"solid",fontSize:"20px",margin:"4px",borderRadius:"4px"}),Gc=({children:n,onClick:e,isDark:t})=>On.createElement("button",{onClick:e,style:dc(t)},n);const Ac={"Prime sieve":"\nlet SIZEOF_U32 = 4;\n\nstruct Array {\n  start: Ptr<u32>,\n  length: u32,\n  capacity: u32,\n}\n\nfn read(array, n) unsafe {\n  *(((array.start as u32) + n * SIZEOF_U32) as Ptr<u32>)\n}\n\nfn write(array, n, val) unsafe {\n  *(((array.start as u32) + n * SIZEOF_U32) as Ptr<u32>) = val;\n}\n\nfn push(array, val) unsafe {\n  write(array, array.length, val);\n  array.length = array.length + 1;\n}\n\nfn checkPrimeSieve(primes, n) {\n  mut i = 0;\n  mut p = read(primes, i);\n\n  while p * p <= n {\n    if n % p == 0 { return; }\n    i = i + 1;\n    p = read(primes, i);\n  }\n\n  // add this prime to the sieve\n  push(primes, n);\n}\n\nfn countPrimesLessThan(m) {\n  mut primes = Array {\n    // right after the shadow stack\n    start: 65536 as Ptr<u32>,\n    length: 0,\n    capacity: 100000\n  };\n\n  // 2 is the first prime\n  push(primes, 2);\n\n  mut i = 3;\n  while i <= m {\n    checkPrimeSieve(primes, i);\n    i = i + 2;\n  }\n\n  primes.length\n}\n\nfn main() {\n  countPrimesLessThan(1000000)\n}",Factorial:"\nfn fact(n) {\n  let aux = (n, acc) -> if n == 0 { acc } else { aux(n - 1, n * acc) } in\n  aux(n, 1)\n}\n\nfn main() {\n  fact(11)\n}",Fibonacci:"\nfn fib(n) {\n  let fib_aux = (n, a, b) -> {\n    if n == 0 { return a; }\n    if n == 1 { return b; }\n    fib_aux(n - 1, b, a + b)\n  };\n\n  fib_aux(n, 0, 1)\n}\n\nfn main() {\n  fib(83)\n}",Pointers:"\nlet SIZEOF_U32 = 4;\n\nfn read_u32(addr) unsafe {\n  *((addr * SIZEOF_U32) as Ptr<u32>)\n}\n\nfn write_u32(addr, val) unsafe {\n  *((addr * SIZEOF_U32) as Ptr<u32>) = val;\n}\n\nfn main() {\n  let square = n -> n * n;\n\n  mut i = 0;\n  while i < 100 {\n    write_u32(i, square(i));\n    i = i + 1;\n  }\n\n  read_u32(42) // 1764\n}",Primes:"\nfn isEven(n) {\n  n % 2 == 0\n}\n\nfn isPrime(n) {\n  if n < 2 { return false; }\n  if n == 2 { return true; }\n  if isEven(n) { return false; }\n\n  mut i = 3;\n\n  while i * i <= n {\n    if n % i == 0 { return false; }\n    i = i + 2;\n  }\n\n  true\n}\n\nfn countPrimesLessThan(m) {\n  mut i = m;\n  mut count = 0;\n\n  while i > 1 {\n    if isPrime(i) {\n      count = count + 1;\n    }\n\n    i = i - 1;\n  }\n\n  count\n}\n\nfn main() {\n  countPrimesLessThan(1000000)\n}",Structs:"\nstruct MinMax {\n  min: u32,\n  max: u32\n}\n\nstruct MinMax2 {\n  min: u32,\n  maxx: u32\n}\n\nfn reset(m) {\n  m.min = 0;\n  m.max = 0;\n}\n\nfn main() {\n  let m = MinMax {\n    min: 1789,\n    max: 1998\n  };\n\n  reset(m);\n\n  m.min + m.max == 0\n}","Lambda (kind of)":"\nfn main() {\n  let twice = (f, x) -> f(f(x));\n  \n  twice(n -> n * n, 7)\n}"},mc=({onSelect:n,isDark:e,defaultSample:t})=>{const[r,u]=Mn.exports.useState(t);return Mn.exports.useEffect((()=>{n(Ac[r])}),[]),On.createElement("select",{value:r,style:dc(e),onChange:e=>{const t=e.target.value;u(t),n(Ac[t])}},Object.entries(Ac).map((([n,e])=>On.createElement("option",{key:n},n))))},pc=({onRun:n,onDisassemble:e,isDark:t,toggleDarkMode:r,onSelectSample:u})=>On.createElement("div",{style:{display:"flex",flexDirection:"row",backgroundColor:t?"black":"white",borderBottom:"2px solid silver"}},On.createElement(Gc,{isDark:t,onClick:n},"Run"),On.createElement(Gc,{isDark:t,onClick:e},"Disassemble"),On.createElement(mc,{isDark:t,onSelect:u,defaultSample:"Prime sieve"}),On.createElement(Gc,{isDark:t,onClick:r},(t?"Light":"Dark")+" Mode")),hc=({children:n})=>On.createElement("div",{style:{background:"silver",cursor:"col-resize",width:"100%",height:"100%",outline:"none",overflow:"hidden"}},n);function gc(){const[n,e]=Mn.exports.useState(""),[t,r]=Mn.exports.useState(""),[u,a]=Mn.exports.useState((new Date).getHours()>=20||(new Date).getHours()<=9),o=u?"terminal":"github",c=Mn.exports.useCallback((async()=>{try{const e=uc(n);if("Ok"===e.tag){r("running...");const n=await(async n=>{const e=await WebAssembly.compile(n),t=await WebAssembly.instantiate(e);if("main"in t.exports)return t.exports.main();throw new Error("main function not found, exported functions are: "+Object.keys(t.exports).join(", "))})(e.value[1]);r(String(n))}else r(e.value)}catch(e){r(`${e}`)}}),[n,r]),i=Mn.exports.useCallback((()=>{const e=uc(n);if("Ok"===e.tag){const[n]=e.value;r((t=n,fc.Module.show({typeSection:t.typeSection.map((function(n){return{TAG:0,_0:n[0].map((function(n){return oc[n]})),_1:n[1].map((function(n){return oc[n]}))}})),funcSection:t.funcSection,tableSection:t.tableSection.map((function(n){return[ic[n[0]],[n[1][0],null==n[1][1]?void 0:n[1][1]]]})),memorySection:t.memorySection.map((function(n){return[n[0],null==n[1]?void 0:n[1]]})),globalSection:t.globalSection.map((function(n){return[oc[n[0]],n[1],"InitConstI32"===n[2].tag?{TAG:0,_0:n[2].value}:{TAG:1,_0:n[2].value}]})),exportSection:t.exportSection.map((function(n){return{name:n.name,kind:_c[n.kind],index:n.index}})),elementSection:t.elementSection,codeSection:t.codeSection.map((function(n){return[n[0].map((function(n){return[n[0],oc[n[1]]]})),n[1].map((function(n){return"object"==typeof n?"ConstI32"===n.tag?{TAG:0,_0:n.value}:"ConstI64"===n.tag?{TAG:1,_0:n.value}:"ConstF32"===n.tag?{TAG:2,_0:n.value}:"ConstF64"===n.tag?{TAG:3,_0:n.value}:"If"===n.tag?{TAG:4,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:oc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return oc[n]})),n.value.value[1][1].map((function(n){return oc[n]}))]}:sc[n.value]}:"BranchIf"===n.tag?{TAG:5,_0:n.value}:"Branch"===n.tag?{TAG:6,_0:n.value}:"Block"===n.tag?{TAG:7,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:oc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return oc[n]})),n.value.value[1][1].map((function(n){return oc[n]}))]}:sc[n.value]}:"Loop"===n.tag?{TAG:8,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:oc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return oc[n]})),n.value.value[1][1].map((function(n){return oc[n]}))]}:sc[n.value]}:"GetGlobal"===n.tag?{TAG:9,_0:n.value}:"SetGlobal"===n.tag?{TAG:10,_0:n.value}:"GetLocal"===n.tag?{TAG:11,_0:n.value}:"SetLocal"===n.tag?{TAG:12,_0:n.value}:"TeeLocal"===n.tag?{TAG:13,_0:n.value}:"Call"===n.tag?{TAG:14,_0:n.value}:"CallIndirect"===n.tag?{TAG:15,_0:n.value[0],_1:n.value[1]}:"LoadI32"===n.tag?{TAG:16,_0:n.value[0],_1:n.value[1]}:{TAG:17,_0:n.value[0],_1:n.value[1]}:cc[n]}))]})),funcs:t.funcs.map((function(n){return[n[0],{TAG:0,_0:n[1][0].map((function(n){return oc[n]})),_1:n[1][1].map((function(n){return oc[n]}))},[n[2][0].map((function(n){return[n[0],oc[n[1]]]})),n[2][1].map((function(n){return"object"==typeof n?"ConstI32"===n.tag?{TAG:0,_0:n.value}:"ConstI64"===n.tag?{TAG:1,_0:n.value}:"ConstF32"===n.tag?{TAG:2,_0:n.value}:"ConstF64"===n.tag?{TAG:3,_0:n.value}:"If"===n.tag?{TAG:4,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:oc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return oc[n]})),n.value.value[1][1].map((function(n){return oc[n]}))]}:sc[n.value]}:"BranchIf"===n.tag?{TAG:5,_0:n.value}:"Branch"===n.tag?{TAG:6,_0:n.value}:"Block"===n.tag?{TAG:7,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:oc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return oc[n]})),n.value.value[1][1].map((function(n){return oc[n]}))]}:sc[n.value]}:"Loop"===n.tag?{TAG:8,_0:"object"==typeof n.value?"TypeValue"===n.value.tag?{TAG:0,_0:oc[n.value.value]}:{TAG:1,_0:n.value.value[0],_1:[n.value.value[1][0].map((function(n){return oc[n]})),n.value.value[1][1].map((function(n){return oc[n]}))]}:sc[n.value]}:"GetGlobal"===n.tag?{TAG:9,_0:n.value}:"SetGlobal"===n.tag?{TAG:10,_0:n.value}:"GetLocal"===n.tag?{TAG:11,_0:n.value}:"SetLocal"===n.tag?{TAG:12,_0:n.value}:"TeeLocal"===n.tag?{TAG:13,_0:n.value}:"Call"===n.tag?{TAG:14,_0:n.value}:"CallIndirect"===n.tag?{TAG:15,_0:n.value[0],_1:n.value[1]}:"LoadI32"===n.tag?{TAG:16,_0:n.value[0],_1:n.value[1]}:{TAG:17,_0:n.value[0],_1:n.value[1]}:cc[n]}))]]})),importsCount:t.importsCount})))}else r(e.value);var t}),[n,r]);return On.createElement("div",{style:{display:"flex",flexDirection:"column"}},On.createElement(pc,{onRun:c,onDisassemble:i,toggleDarkMode:()=>a(!u),isDark:u,onSelectSample:n=>e(n)}),On.createElement(zn.exports.Split,{splitterSize:"10px",renderSplitter:()=>On.createElement(hc,null)},On.createElement(lc,{theme:o,code:n,onChange:e}),On.createElement(vc,{theme:o,text:t})))}Pn.render(On.createElement(On.StrictMode,null,On.createElement(gc,null)),document.getElementById("root"));
