import{c as I,a as wn,j as w,r as La,m as an,g as De,b as Ot,d as s,z as Ne,e as Er,f as ut,t as Me,h as Ca,i as wr,k as Pn,l as pr,_ as G,s as Sr,n as Ua,o as $a,p as Mt,q as mr,u as br,v as Xt,w as Ee,x as fn,y as pn,A as Oa,B as Ma,C as Ar,D as Vt,E as Xa,F as Va,G as Ba,H as za,I as Pa,J as ja,K as qa,L as kr,M as we,N as q,O as yn,P as nn,Q as Za,R as Fr,S as An,T as Wa,U as Bt,V as Dr,W as Ja,X as In,Y as Ka,Z as Ya,$ as xn,a0 as Nr,a1 as gt,a2 as zt,a3 as Rr,a4 as Lr,a5 as Ha,a6 as ht,a7 as Qa,a8 as Pt,a9 as ya,aa as Ia,ab as xa,ac as F,ad as no,ae as eo,af as Cr,ag as jt,ah as to,ai as Y,aj as ro,ak as at,al as uo,am as Ur,an as qt,ao as ot,ap as Xe,aq as ao,ar as $r,as as oo,at as Or,au as Mr,av as io,aw as co,ax as Et,ay as _o,az as fo}from"./vendor.eee862fd.js";const so=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))u(a);new MutationObserver(a=>{for(const t of a)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const t={};return a.integrity&&(t.integrity=a.integrity),a.referrerpolicy&&(t.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?t.credentials="include":a.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function u(a){if(a.ep)return;a.ep=!0;const t=r(a);fetch(a.href,t)}};so();function dn(n){var e=[],r=function(u){for(;;){var a=u,t=a&127,o=a>>>7;if(o!==0){e.push(t|128),u=o;continue}e.push(t);return}};return r(n),e}function Xr(n){var e=[],r=function(u){for(;;){var a=u,t=a&127,o=a>>7;if(o===0&&(t&64)==0||o===-1&&(t&64)!=0){e.push(t);return}e.push(t|128),u=o}};return r(n|0),e}function it(n){return I(dn(n.length),n)}function Zn(n){return I(dn(n.length),wn(n))}var lo={encode:it,encodeMany:Zn};function Vr(n){var e=new DataView(new ArrayBuffer(4));return e.setFloat32(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3)]}var vo={encode:Vr};function Br(n){var e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3),e.getUint8(4),e.getUint8(5),e.getUint8(6),e.getUint8(7)]}var To={encode:Br};function Go(n){return n}function oe(n,e){return I([n],it(e))}function ie(n){var e;switch(n){case 0:e="custom";break;case 1:e="type";break;case 2:e="import";break;case 3:e="function";break;case 4:e="table";break;case 5:e="memory";break;case 6:e="global";break;case 7:e="export";break;case 8:e="start";break;case 9:e="element";break;case 10:e="code";break;case 11:e="data";break}return"["+e+"]"}var go={id:Go,encode:oe,show:ie};function Ve(n){switch(n){case 0:return 127;case 1:return 126;case 2:return 125;case 3:return 124}}function Be(n){switch(n){case 0:return"i32";case 1:return"i64";case 2:return"f32";case 3:return"f64"}}var ho={encode:Ve,show:Be};function zr(n){return typeof n=="number"?[64]:n.TAG===0?[Ve(n._0)]:dn(n._0)}function Eo(n){return typeof n=="number"?"void":n.TAG===0?Be(n._0):"type "+String(n._0)}var wo={encode:zr,show:Eo};function Zt(n){if(typeof n=="number")switch(n){case 0:return[5,"else"];case 1:return[11,"end"];case 2:return[15,"return"];case 3:return[26,"drop"];case 4:return[106,"i32.add"];case 5:return[107,"i32.sub"];case 6:return[108,"i32.mul"];case 7:return[110,"i32.div_s"];case 8:return[109,"i32.div_u"];case 9:return[69,"i32.eqz"];case 10:return[70,"i32.eq"];case 11:return[81,"i64.eq"];case 12:return[91,"f32.eq"];case 13:return[97,"f64.eq"];case 14:return[71,"i32.ne"];case 15:return[82,"i64.ne"];case 16:return[92,"f32.ne"];case 17:return[98,"f64.ne"];case 18:return[76,"i32.le_s"];case 19:return[77,"i32.le_u"];case 20:return[87,"i64.le_s"];case 21:return[88,"i64.le_u"];case 22:return[95,"f32.le"];case 23:return[101,"f64.le"];case 24:return[78,"i32.ge_s"];case 25:return[79,"i32.ge_u"];case 26:return[89,"i64.ge_s"];case 27:return[90,"i64.ge_u"];case 28:return[96,"f32.ge"];case 29:return[102,"f64.ge"];case 30:return[72,"i32.lt_s"];case 31:return[73,"i32.lt_u"];case 32:return[83,"i64.lt_s"];case 33:return[84,"i64.lt_u"];case 34:return[93,"f32.lt"];case 35:return[99,"f64.lt"];case 36:return[74,"i32.gt_s"];case 37:return[75,"i32.gt_u"];case 38:return[85,"i64.gt_s"];case 39:return[86,"i64.gt_u"];case 40:return[94,"f32.gt"];case 41:return[100,"f64.gt"];case 42:return[111,"i32.rem_s"];case 43:return[112,"i32.rem_u"];case 44:return[113,"i32.and"]}else switch(n.TAG|0){case 0:return[65,"i32.const "+String(n._0)];case 1:return[66,"i64.const "+String(n._0)];case 2:return[67,"i64.const "+String(n._0)];case 3:return[68,"i64.const "+String(n._0)];case 4:return[4,"if"];case 5:return[13,"br_if "+String(n._0)];case 6:return[12,"br "+String(n._0)];case 7:return[2,"block"];case 8:return[3,"loop"];case 9:return[35,"global.get "+String(n._0)];case 10:return[36,"global.set "+String(n._0)];case 11:return[32,"local.get "+String(n._0)];case 12:return[33,"local.set "+String(n._0)];case 13:return[34,"local.tee "+String(n._0)];case 14:return[16,"call "+String(n._0)];case 15:return[17,"call_indirect [typeIndex="+String(n._0)+", tableIndex="+String(n._1)+"]"];case 16:return[40,"i32.load (alignment="+String(n._0)+", offset="+String(n._1)+")"];case 17:return[54,"i32.store (alignment="+String(n._0)+", offset="+String(n._1)+")"]}}function ne(n){return Zt(n)[0]}function Pr(n){if(typeof n=="number")switch(n){case 0:case 1:return-1;default:return 0}else switch(n.TAG|0){case 4:case 7:case 8:return 1;default:return 0}}function wt(n,e,r,u){var a=n!==void 0?n:{contents:0},t=Zt(e),o=Pr(e),i=w(La(0,a.contents+(o<0?o:0)|0),"  ",function(f){return""});a.contents=a.contents+o|0,e===0&&(a.contents=a.contents+1|0);var _,v=0;if(typeof e=="number")_="";else switch(e.TAG|0){case 11:case 12:case 13:v=1;break;case 14:_="<"+an(De(r,e._0),"??",function(f){return f})+">";break;default:_=""}return v===1&&(_="<"+an(De(u,e._0),"??",function(f){return f})+">"),i+t[1]+" "+_}function ze(n){var e=0;if(typeof n=="number")return[ne(n)];switch(n.TAG|0){case 0:case 1:e=1;break;case 2:return I([ne(n)],Vr(n._0));case 3:return I([ne(n)],Br(n._0));case 5:case 6:e=3;break;case 4:case 7:case 8:e=2;break;case 9:case 10:case 11:case 12:case 13:e=4;break;case 14:return I([ne(n)],dn(n._0));case 15:return wn([[ne(n)],dn(n._0),dn(n._1)]);case 16:case 17:e=5;break}switch(e){case 1:return I([ne(n)],Xr(n._0));case 2:return I([ne(n)],zr(n._0));case 3:case 4:return I([ne(n)],dn(n._0));case 5:return wn([[ne(n)],dn(n._0),dn(n._1)])}}var po={info:Zt,opcode:ne,identationDelta:Pr,show:wt,encode:ze};function So(n,e){return{_0:n,_1:e}}var mo=[],bo=[],Ao={_0:mo,_1:bo};function jr(n){return wn([[96],it(s(n._0,Ve)),it(s(n._1,Ve))])}function qr(n){var e=n._1,r=n._0,u=w(r,", ",Be),a=w(e,", ",Be);if(r.length===1){var t=e.length;if(t===1)return u+" -> "+a;if(t===0)return u+" -> ()"}var o=e.length;return o!==1?o!==0?"("+u+") -> ("+a+")":"("+u+") -> ()":"("+u+") -> "+a}var ko={funcTypeCode:96,make:So,empty:Ao,encode:jr,show:qr};function Fo(n){var e=function(u,a){for(;;){var t=a,o=u;if(!o)return t;var i=o.tl,_=o.hd,v=_[1],f=_[0];if(t){var h=t.tl,T=t.hd,C=T[1],V=T[0];if(Pn(v,C)){a={hd:[{hd:f,tl:V},C],tl:h},u=i;continue}a={hd:[{hd:f,tl:0},v],tl:{hd:[V,C],tl:h}},u=i;continue}a={hd:[{hd:f,tl:0},v],tl:0},u=i}},r=Er(e(ut(n),0));return Me(Ca(r,function(u){return[pr(Me(u[0])),u[1]]}))}function Zr(n){return I(dn(n[0].length),[Ve(n[1])])}function Wr(n){return"local ["+w(n[0],", ",function(e){return e})+"] "+Be(n[1])}var Do={fromTypes:Fo,encode:Zr,show:Wr};function No(n,e){return[n,e]}function Jr(n){var e=Zn(s(n[0],Zr)),r=wn(s(n[1],ze));return wn([[e.length+r.length|0],e,r])}function Kr(n,e,r){var u=n[0],a={contents:1},t=wr(r._0,function(v,f){return"param["+String(v)+"]"}),o=I(t,wn(s(u,function(v){return v[0]}))),i=w(u,`
`,Wr),_=w(n[1],`
`,function(v){return wt(a,v,e,o)});return u.length===0?_:i+`
`+_}var Ro={make:No,encode:Jr,show:Kr};function Lo(n,e,r){return[n,e,r]}var ct={Signature:ko,Local:Do,Body:Ro,make:Lo};function Co(n){return[]}function Wt(n,e){var r=Ot(n,function(u){return Pn(u,e)});return r!==void 0?r:(n.push(e),n.length-1|0)}function Yr(n){return oe(1,Zn(s(n,jr)))}function Hr(n){return ie(1)+`
`+w(n,`
`,qr)}var Uo={make:Co,getOrAdd:Wt,encode:Yr,show:Hr};function $o(n){return[]}function Qr(n,e){return n.push(e),n.length-1|0}function yr(n){return oe(3,Zn(s(n,dn)))}function Ir(n,e){return ie(3)+`
`+w(Ne(n,e),`
`,function(r){return r[1]+": "+String(r[0])})}var Oo={make:$o,addSignature:Qr,encode:yr,show:Ir};function Mo(n){return[]}function xr(n,e){return n.push(e),n.length-1|0}function nu(n){return oe(10,Zn(s(n,Jr)))}function eu(n,e){var r=s(e,function(u){return u[0]});return ie(10)+`
`+w(Ne(n,e),`

`,function(u){var a=u[1];return a[0]+`
`+Kr(u[0],r,a[1])})}var Xo={make:Mo,addFunc:xr,encode:nu,show:eu};function tu(n){return it(s(n.split(""),function(e){return e.charCodeAt(0)|0}))}var Vo={encode:tu};function Bo(n){return[n]}function ru(n){switch(n){case 0:return"func";case 1:return"table";case 2:return"memory";case 3:return"global"}}var zo={encode:Bo,show:ru};function Po(n,e,r){return{name:n,kind:e,index:r}}function uu(n){return wn([tu(n.name),[n.kind],dn(n.index)])}function au(n){return"export "+ru(n.kind)+" "+n.name+" (index: "+String(n.index)+")"}var jo={ExternalKind:zo,make:Po,encode:uu,show:au};function qo(n){return[]}function Zo(n,e){n.push(e)}function ou(n){return oe(7,Zn(s(n,uu)))}function iu(n){return ie(7)+`
`+w(n,`
`,au)}var Wo={make:qo,add:Zo,encode:ou,show:iu};function Jo(n){return n?"externref":"funcref"}function Ko(n){return n?111:112}var Yo={show:Jo,encode:Ko};function Jt(n){return"{ min: "+String(n[0])+", max: "+an(n[1],"?",function(e){return String(e)})+" }"}function Ho(n,e){return[n,e]}function Qo(n){return[n,n]}function pt(n){var e=n[1],r=n[0];return e!==void 0?wn([[1],dn(r),dn(e)]):I([0],dn(r))}var Kt={show:Jt,make:Ho,makeExact:Qo,encode:pt};function yo(n,e){return[n,e]}function cu(n){return I([n[0]?111:112],pt(n[1]))}function _u(n){return"table "+(n[0]?"externref":"funcref")+" "+Jt(n[1])}var fu={make:yo,encode:cu,show:_u};function Io(n){return[]}function xo(n,e){n.push(e)}function su(n){return ie(4)+`
`+w(n,`
`,_u)}function lu(n){return oe(4,Zn(s(n,cu)))}var ni={make:Io,add:xo,show:su,encode:lu};function ei(n,e){var r=n!==void 0?n:0;return{offset:r,funcIndices:e}}function vu(n){return"elem funcref ("+w(n.funcIndices," ",function(e){return String(e)})+") (offset="+String(n.offset)+")"}function du(n){return wn([[0],ze({TAG:0,_0:n.offset}),ze(1),Zn(s(n.funcIndices,dn))])}var Tu={fromFuncRefs:ei,show:vu,encode:du};function ti(n){return[]}function ri(n,e){n.push(e)}function Gu(n){return ie(9)+`
`+w(n,`
`,vu)}function gu(n){return oe(9,Zn(s(n,du)))}var ui={make:ti,add:ri,show:Gu,encode:gu};function ai(n){return n}function hu(n){return I(wn(s(n,ze)),ze(1))}function Eu(n){if(n.length!==1)return`
`+w(n,`
`,function(r){return"  "+wt(void 0,r,[],[])})+`
end`;var e=n[0];return wt(void 0,e,[],[])}var oi={fromInstructions:ai,encode:hu,show:Eu};function ii(n,e,r){return[e,n,r]}function wu(n){return"global "+(n[1]?"mutable":"immutable")+" "+Be(n[0])+" = "+Eu(n[2])}function pu(n){return I([Ve(n[0]),n[1]?1:0],hu(n[2]))}var _t={Initializer:oi,make:ii,show:wu,encode:pu};function ci(n){return[]}function _i(n,e){n.push(e)}function Su(n){return ie(6)+`
`+w(n,`
`,wu)}function mu(n){return oe(6,Zn(s(n,pu)))}var fi={make:ci,add:_i,show:Su,encode:mu};function si(n){return n}function bu(n){return"memory "+Jt(n)}var Au={make:si,show:bu,encode:pt};function li(n){return[]}function ku(n,e){return n.push(e)-1|0}function Fu(n){return ie(5)+`
`+w(n,`
`,bu)}function Du(n){return oe(5,Zn(s(n,pt)))}var vi={make:li,add:ku,show:Fu,encode:Du};function di(n){return{typeSection:[],funcSection:[],tableSection:[],memorySection:[],globalSection:[],exportSection:[],elementSection:[],codeSection:[],funcs:[],importsCount:0}}function Ti(n,e){return Wt(n.typeSection,e)}function Nu(n,e,r,u){var a=Wt(n.typeSection,r);return Qr(n.funcSection,a),n.funcs.push([e,r,u]),xr(n.codeSection,u)+n.importsCount|0}function Gi(n,e,r,u){var a=Nu(n,e,r,u),t={name:e,kind:0,index:a};return n.exportSection.push(t),a}function gi(n,e){n.tableSection.push(e)}function hi(n,e){n.elementSection.push(e)}function Ei(n,e){n.globalSection.push(e)}function wi(n,e){return ku(n.memorySection,e)}function Ru(n){return wn([[0,97,115,109,1,0,0,0],Yr(n.typeSection),yr(n.funcSection),lu(n.tableSection),Du(n.memorySection),mu(n.globalSection),ou(n.exportSection),gu(n.elementSection),nu(n.codeSection)])}function pi(n){return(e=>Uint8Array.from(e))(Ru(n))}function Si(n){return w([Hr(n.typeSection),Ir(n.funcSection,s(n.funcs,function(e){return e[0]})),su(n.tableSection),Fu(n.memorySection),Su(n.globalSection),iu(n.exportSection),Gu(n.elementSection),eu(n.codeSection,n.funcs)],`

`,function(e){return e})}var ee={make:di,getOrAddSignature:Ti,addFunc:Nu,addExportedFunc:Gi,addTable:gi,addElement:hi,addGlobal:Ei,addMemory:wi,encode:Ru,encodeAsUint8Array:pi,show:Si},mi=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uleb128:dn,sleb128:Xr,Vec:lo,F32:vo,F64:To,Section:go,ValueType:ho,BlockReturnType:wo,Inst:po,Func:ct,TypeSection:Uo,FuncSection:Oo,CodeSection:Xo,Str:Vo,ExportEntry:jo,ExportSection:Wo,ReferenceType:Yo,Limits:Kt,Table:fu,TableSection:ni,Elem:Tu,ElementSection:ui,Global:_t,GlobalSection:fi,Memory:Au,MemorySection:vi,Module:ee});const Lu={"0":"I32","1":"I64","2":"F32","3":"F64"},D={I32:0,I64:1,F32:2,F64:3},Yt={Else:0,End:1,Return:2,Drop:3,AddI32:4,SubI32:5,MulI32:6,DivI32Unsigned:7,DivI32Signed:8,EqzI32:9,EqI32:10,EqI64:11,EqF32:12,EqF64:13,NeI32:14,NeI64:15,NeF32:16,NeF64:17,LeI32Signed:18,LeI32Unsigned:19,LeI64Signed:20,LeI64Unsigned:21,LeF32:22,LeF64:23,GeI32Signed:24,GeI32Unsigned:25,GeI64Signed:26,GeI64Unsigned:27,GeF32:28,GeF64:29,LtI32Signed:30,LtI32Unsigned:31,LtI64Signed:32,LtI64Unsigned:33,LtF32:34,LtF64:35,GtI32Signed:36,GtI32Unsigned:37,GtI64Signed:38,GtI64Unsigned:39,GtF32:40,GtF64:41,RemI32Signed:42,RemI32Unsigned:43,And:44},bi={FuncRef:0,ExternRef:1},Ai={Func:0,Table:1,Memory:2,Global:3},ce={Void:0},H=mi;H.uleb128;H.sleb128;H.Vec.encode;H.Vec.encodeMany;H.F32.encode;H.F64.encode;H.Func.Signature.funcTypeCode;H.Func.Signature.empty._0.map(function(e){return Lu[e]}),H.Func.Signature.empty._1.map(function(e){return Lu[e]});H.FuncSection.make;H.FuncSection.encode;H.Str.encode;H.Limits.makeExact;H.Elem.show;H.Elem.encode;H.ElementSection.make;H.ElementSection.show;H.ElementSection.encode;H.MemorySection.make;const ki=function(n){return H.Module.show({typeSection:n.typeSection.map(function(u){return{TAG:0,_0:u[0].map(function(t){return D[t]}),_1:u[1].map(function(t){return D[t]})}}),funcSection:n.funcSection,tableSection:n.tableSection.map(function(u){return[bi[u[0]],[u[1][0],u[1][1]==null?void 0:u[1][1]]]}),memorySection:n.memorySection.map(function(u){return[u[0],u[1]==null?void 0:u[1]]}),globalSection:n.globalSection.map(function(u){return[D[u[0]],u[1],u[2].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:D[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return D[i]}),t.value.value[1][1].map(function(i){return D[i]})]}:ce[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:D[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return D[i]}),t.value.value[1][1].map(function(i){return D[i]})]}:ce[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:D[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return D[i]}),t.value.value[1][1].map(function(i){return D[i]})]}:ce[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:{TAG:17,_0:t.value[0],_1:t.value[1]}:Yt[t]})]}),exportSection:n.exportSection.map(function(u){return{name:u.name,kind:Ai[u.kind],index:u.index}}),elementSection:n.elementSection,codeSection:n.codeSection.map(function(u){return[u[0].map(function(t){return[t[0],D[t[1]]]}),u[1].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:D[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return D[i]}),t.value.value[1][1].map(function(i){return D[i]})]}:ce[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:D[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return D[i]}),t.value.value[1][1].map(function(i){return D[i]})]}:ce[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:D[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return D[i]}),t.value.value[1][1].map(function(i){return D[i]})]}:ce[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:{TAG:17,_0:t.value[0],_1:t.value[1]}:Yt[t]})]}),funcs:n.funcs.map(function(u){return[u[0],{TAG:0,_0:u[1][0].map(function(t){return D[t]}),_1:u[1][1].map(function(t){return D[t]})},[u[2][0].map(function(t){return[t[0],D[t[1]]]}),u[2][1].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:D[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return D[i]}),t.value.value[1][1].map(function(i){return D[i]})]}:ce[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:D[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return D[i]}),t.value.value[1][1].map(function(i){return D[i]})]}:ce[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:D[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return D[i]}),t.value.value[1][1].map(function(i){return D[i]})]}:ce[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:{TAG:17,_0:t.value[0],_1:t.value[1]}:Yt[t]})]]}),importsCount:n.importsCount})};H.F32;H.F64;H.Vec;H.Str;function Fi(n,e,r){return G(e,G(n,r))}function ft(n){return[[],n]}var Di=Sr;function Ni(n,e,r){return Sr(n,e,[[],r])}var Ri=Ua,Li=$a,Ci=Mt;function Ui(n,e){var r=w(mr(br(n,e)),`
`,function(u){return"  "+u[0]+": "+u[1]});return`{
`+r+`
}`}var jn={empty:void 0,add:Di,addMono:Ni,remove:Ri,has:Li,get:Ci,show:Ui},$i=[],te={TAG:1,_0:"u32",_1:$i},Oi=[],pe={TAG:1,_0:"bool",_1:Oi},Mi=[],Se={TAG:1,_0:"()",_1:Mi};function Vn(n,e){return{TAG:1,_0:"Fun",_1:I(n,[e])}}function Xi(n){return{TAG:1,_0:"Tuple",_1:n}}function Vi(n){return{TAG:1,_0:"Ptr",_1:[n]}}function Ht(n){switch(n.TAG|0){case 0:case 1:return!1;case 2:return!0}}var Re=fn("Types.Size.UnkownTypeSize");function St(n){for(;;){var e=n;switch(e.TAG|0){case 0:throw{RE_EXN_ID:Re,_1:e,Error:new Error};case 1:switch(e._0){case"()":if(e._1.length===0)return 0;throw{RE_EXN_ID:Re,_1:e,Error:new Error};case"Mut":var r=e._1;if(r.length!==1)throw{RE_EXN_ID:Re,_1:e,Error:new Error};n=r[0];continue;case"Fun":case"Ptr":return 4;case"Tuple":return pn(s(e._1,St),0,function(u,a){return u+a|0});case"bool":case"u32":break;case"u64":if(e._1.length===0)return 8;throw{RE_EXN_ID:Re,_1:e,Error:new Error};default:throw{RE_EXN_ID:Re,_1:e,Error:new Error}}if(e._1.length===0)return 4;throw{RE_EXN_ID:Re,_1:e,Error:new Error};case 2:return 4}}}function Bi(n){return Math.ceil(Math.log2(St(n)))|0}function zi(n){return St(n)===0}var re={UnkownTypeSize:Re,size:St,sizeLog2:Bi,isZeroSizedType:zi};function Pi(n){return{TAG:0,_0:n}}function Qt(n,e,r){if(n.TAG===0)return{TAG:1,_0:[e,r],_1:{TAG:0,_0:n._0}};var u=n._1,a=n._0,t=a[1],o=a[0];return e<o?{TAG:1,_0:[e,r],_1:{TAG:1,_0:[o,t],_1:u}}:{TAG:1,_0:[o,t],_1:Qt(u,e,r)}}function ji(n){for(;;){var e=n;if(e.TAG===0)return e._0;n=e._1}}function qi(n,e){return pn(n,{TAG:0,_0:{TAG:0,_0:e}},function(r,u){return Qt(r,u[0],u[1])})}function yt(n){var e=function(r,u){for(;;){var a=u,t=r;if(t.TAG===0){var o=t._0;switch(o.TAG|0){case 0:case 1:return a;case 2:var i=o._0;if(i.TAG===0)return a;var _=i._0;if(_.TAG===0)return a;u={hd:_._0,tl:a},r=_._1;continue}}else{u={hd:t._0,tl:a},r=t._1;continue}}};return Me(e(n,0))}function Zi(n){return Oa(yt(n))}function Cu(n,e){if(n.TAG===0){var r=G(e,n._0);switch(r.TAG|0){case 0:case 1:return{TAG:0,_0:r};case 2:var u=r._0;return u.TAG===0?{TAG:0,_0:r}:u._0}}else{var a=n._0;return{TAG:1,_0:[a[0],G(e,a[1])],_1:Cu(n._1,e)}}}function Uu(n,e){var r=function(u,a){for(;;){var t=a,o=u;if(o.TAG===0)return pr(Me({hd:"..."+G(e,o._0),tl:t}));var i=o._0;a={hd:i[0]+": "+G(e,i[1]),tl:t},u=o._1}};return"{ "+w(r(n,0),", ",function(u){return u})+" }"}var Bn={make:Pi,insert:Qt,tail:ji,fromArray:qi,toArray:yt,toMap:Zi,map:Cu,show:Uu};function mt(n){switch(n.TAG|0){case 0:return Va(void 0,n._0);case 1:return pn(s(n._1,mt),void 0,Vt);case 2:var e=n._0;return e.TAG===0?void 0:pn(s(yt(e._0),function(r){return Fi(function(u){return u[1]},mt,r)}),void 0,Vt)}}function Wi(n){return Ar(mt(n[1]),Ba(n[0]))}function Ji(n){return pn(s(Xa(n),Wi),void 0,Vt)}function It(n,e){var r=Ma(Ar(mt(e),Ji(n)));return[r,e]}function Ki(n){var e=String.fromCharCode(97+n%26|0),r=n/26|0;return r===0?e:e+String(r)}function k(n){switch(n.TAG|0){case 0:return Ki(n._0);case 1:var e=n._1,r=n._0;if(e.length===0)return r;switch(r){case"Fun":var u=Xt(e,0,e.length-1|0),a=Ee(e,e.length-1|0);if(u.length!==1)return"("+w(u,", ",k)+") -> "+k(a);var t=u[0];return k(t)+" -> "+k(a);case"Tuple":return"("+w(e,", ",k)+")";default:return r+"<"+w(e,", ",k)+">"}case 2:var o=n._0;return o.TAG===0?o._0:Uu(o._0,k)}}function $u(n){switch(n){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/";case 4:return"%";case 5:return"<";case 6:return"<=";case 7:return">";case 8:return">=";case 9:return"==";case 10:return"!="}}var Yi={show:$u};function Ou(n){switch(n){case 0:return"-";case 1:return"!";case 2:return"*"}}var Hi={show:Ou};function Mu(n){return typeof n=="number"?"()":n.TAG===0?String(n._0):n._0?"true":"false"}var Qi={show:Mu};function O(n){switch(n.TAG|0){case 0:return Mu(n._0);case 1:return Ou(n._0)+O(n._1);case 2:return"("+O(n._0)+" "+$u(n._1)+" "+O(n._2)+")";case 3:return n._0;case 4:return O(n._0)+" = "+O(n._1);case 5:var e=n._1,r=n._0,u=r.length;if(u!==1)return u!==0?"("+w(r,", ",function(i){return i})+") -> "+O(e):"() -> "+O(e);var a=r[0];return a+" -> "+O(e);case 6:return"let "+n._0+" = "+O(n._1)+" in "+O(n._2);case 7:return"("+O(n._0)+")("+w(n._1,", ",O)+")";case 8:return(n._2===1?"unsafe ":"")+`{
`+w(I(s(n._0,Vu),an(n._1,[],function(i){return[O(i)]})),`;
`,function(i){return"  "+i})+`}
}`;case 9:var t=n._2,o="if "+O(n._0)+" "+O(n._1);return t!==void 0?o+" else "+O(t):o;case 10:return"while "+O(n._0)+" "+O(n._1);case 11:return"return "+an(n._0,"",O);case 12:return O(n._0)+" as "+k(n._1);case 13:return"("+w(n._0,", ",O)+")";case 14:return n._0+` {
`+w(n._1,", ",function(i){return i[0]+": "+O(i[1])})+`
}`;case 15:return O(n._0)+"."+n._1}}function Xu(n){switch(n.TAG|0){case 0:return"fn "+n._0+"("+w(n._1,", ",function(e){return(e[1]?"mut ":"")+e[0]})+") "+O(n._2);case 1:return(n._1?"mut":"let")+" "+n._0+" = "+O(n._2);case 2:return"struct "+n._0+` {
`+w(n._1,`,
`,function(e){return(e[2]?"mut ":"")+e[0]+": "+k(e[1])})+`
}`;case 3:return n._0+` {
`+w(n._1,`

`,Xu)+`
}`}}function Vu(n){if(n.TAG!==0)return O(n._0)+";";var e=n._2,r=n._0;return n._1?"let mut "+r+" = "+O(e):"let "+r+" = "+O(e)}var yi={showExpr:O,showDecl:Xu,showStmt:Vu};function d(n,e){for(;;){var r=e;switch(r.TAG|0){case 0:var u=r._0,a=kr(n,u);if(a===void 0)return{TAG:0,_0:u};e=a;continue;case 1:return{TAG:1,_0:r._0,_1:s(r._1,function(i){return d(n,i)})};case 2:var t=r._0,o;return o=t.TAG===0?{TAG:0,_0:t._0}:{TAG:1,_0:Bn.map(t._0,function(i){return d(n,i)})},{TAG:2,_0:o}}}}function Bu(n,e){var r=e[0];return[r,d(qa(n,r),e[1])]}function L(n,e){return za(Pa(e,function(r){return d(n,r)}),n,function(r,u,a){return ja(a,u)})}function Tn(n,e){return br(e,function(r){return Bu(n,r)})}var Pe;function xt(n,e){for(var r,u=0;we(r)&&u<n.length;){var a=G(e,Ee(n,u));a!==void 0&&(r=q(yn(a))),u=u+1|0}return r}function zu(n,e){for(var r,u=n.length-1|0;we(r)&&u>=0;)G(e,Ee(n,u))?r=u:u=u-1|0;return r}function Ii(n,e){for(var r=[],u=!1,a=0;u===!1&&a<n.length;){var t=Ee(n,a);t!==void 0?r.push(G(e,yn(t))):u=!0,a=a+1|0}if(!u)return r}function xi(n,e){for(var r=[],u,a=0;we(u)&&a<n.length;){var t=Ee(n,a);t.TAG===0?r.push(G(e,t._0)):u=q(t._0),a=a+1|0}var o=u;return o!==void 0?{TAG:1,_0:yn(o)}:{TAG:0,_0:r}}function nc(n,e){return nn(Ot(n,e),function(r){return[Ee(n,r),r]})}function ec(n){return"struct "+n.name+`{
`+w(n.attributes,`,
`,function(e){return"  "+e.name+": "+k(e.ty)})+`
}`}function tc(n,e){return{TAG:2,_0:{TAG:1,_0:Bn.fromArray(s(n.attributes,function(r){return[r.name,r.ty]}),e)}}}function rc(n,e){var r={contents:0},u=[];return An(e,function(a){var t=a[1],o=re.size(t);u.push({name:a[0],mut:a[2],offset:r.contents,ty:t,size:o,impl:void 0}),r.contents=r.contents+o|0}),{name:n,attributes:u,size:r.contents,staticFuncs:[]}}function uc(n,e,r){n.attributes.push({name:e.contents.name,mut:!1,offset:0,ty:e.contents.ty,size:0,impl:[e,r]})}function ac(n,e){n.staticFuncs.push({name:e})}var je={show:ec,toPartialStructType:tc,make:rc,addImplementation:uc,addStaticFunc:ac},qn={tyVarIndex:0,identifiers:[],renaming:Za(10),structs:Fr(5)};function _e(n){var e=qn.tyVarIndex;return qn.tyVarIndex=qn.tyVarIndex+1|0,e}function nr(n){return{TAG:0,_0:_e()}}function bt(n){var e=n[0],r=s(e,function(u){return{TAG:0,_0:_e()}});return d(Ya(Ne(e,r)),n[1])}function fe(n,e){var r=n!==void 0?yn(n):void 0,u=qn.identifiers.length;qn.identifiers.push(e);var a={contents:{name:e,newName:e,index:u,ty:r!==void 0?r:{TAG:0,_0:_e()}}};return Ja(qn.renaming,u,a),a}function oc(n){return In(zu(qn.identifiers,function(e){return e===n}),function(e){return Ka(qn.renaming,e)})}function Pu(n,e){e.contents.ty=d(n,e.contents.ty)}function ic(n){return An(Wa(qn.renaming),function(e){return Pu(n,e)})}function cc(n){return Bt(qn.structs,n.name,n)}function Wn(n){return Dr(qn.structs,n)}function se(n){switch(n.TAG|0){case 0:var e=n._0;return typeof e=="number"?Se:e.TAG===0?te:pe;case 3:return n._0.contents.ty;case 4:case 11:return Se;case 12:return an(n._0,Se,se);case 13:return n._2;case 14:return Xi(s(n._0,se));case 15:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return n._0}}function _c(n){return se(n._0)}function M(n,e){var r=n!==void 0?yn(n):void 0,u=function(T,C){return r!==void 0?"("+C+": "+k(d(yn(r),T))+")":C},a=function(T){return M(q(r),T)};switch(e.TAG|0){case 0:return u(se(e),Qi.show(e._0));case 1:return u(e._0,"("+M(q(r),e._1)+" "+Yi.show(e._2)+" "+M(q(r),e._3)+")");case 2:return u(e._0,"("+Hi.show(e._1)+M(q(r),e._2)+")");case 3:var t=e._0;return u(t.contents.ty,t.contents.name);case 4:var o=e._1;return u(se(o),M(q(r),e._0)+" = "+M(q(r),o));case 5:return u(e._0,"("+w(e._1,", ",function(T){return T.contents.name})+") -> "+M(q(r),e._2));case 6:return u(e._0,"let "+(e._1?"mut":"")+" "+e._2.contents.name+" = "+M(q(r),e._3)+` in
`+M(q(r),e._4));case 7:return u(e._0,"let rec "+e._1.contents.name+" ("+w(e._2,", ",function(T){return T.contents.name})+") = "+M(q(r),e._3)+` in
`+M(q(r),e._4));case 8:return u(e._0,"("+M(q(r),e._1)+")("+w(e._2,", ",a)+")");case 9:var i=e._2,_=q(r);return u(e._0,(e._3===1?"unsafe ":"")+`{
`+w(I(s(e._1,function(T){return ju(_,T)}),an(i,[],function(T){return[M(void 0,T)]})),`;
`,function(T){return"  "+T})+(we(i)?"; ":"")+`
}`);case 10:return u(e._0,"if "+M(q(r),e._1)+" "+M(q(r),e._2)+" else "+M(q(r),e._3));case 11:return u(Se,"while "+M(void 0,e._0)+" "+M(void 0,e._1));case 12:var v=q(r);return"return "+u(se(e),an(e._0,"",function(T){return M(v,T)}));case 13:var f=e._0;return u(se(f),M(void 0,f))+" as "+k(e._2);case 14:var h=q(r);return"("+w(e._0,", ",function(T){return M(h,T)})+")";case 15:return e._0+` {
`+w(e._1,`,
`,function(T){return T[0]+": "+M(void 0,T[1])})+`
}`;case 16:return u(e._0,M(void 0,e._1)+"."+e._2)}}function ju(n,e){var r=n!==void 0?yn(n):void 0;return M(q(r),e._0)}function er(n,e){var r=n!==void 0?yn(n):void 0,u=function(v,f){return r!==void 0?"("+f+": "+k(d(yn(r),v))+")":f};switch(e.TAG|0){case 0:var a=e._1,t=e._0,o;if(r!==void 0){var i=yn(r);o=w(a,", ",function(v){var f=v[0];return(v[1]?"mut ":"")+(f.contents.name+": "+k(d(i,f.contents.ty)))})}else o=w(a,", ",function(v){return(v[1]?"mut ":"")+v[0].contents.name});return u(t.contents.ty,"fn "+t.contents.name+"("+o+") "+M(q(r),e._2));case 1:var _=e._0;return u(_.contents.ty,(e._1?"mut":"let")+" "+_.contents.name+" = "+M(q(r),e._2));case 2:return yi.showDecl({TAG:2,_0:e._0,_1:e._1});case 3:return"impl "+e._0+` {
`+w(e._1,`

`,function(v){return er(void 0,{TAG:0,_0:v[0],_1:v[1],_2:v[2]})})+`
}`}}var qu=fn("Core.CoreAst.UnexpectedDeclarationInImplBlock"),Zu=fn("Core.CoreAst.UndeclaredIdentifer"),Wu=fn("Core.CoreAst.UnreachableLetStmt");function tr(n,e,r,u,a){return r.TAG===5?{TAG:7,_0:r._0,_1:n,_2:r._1,_3:r._2,_4:u}:{TAG:6,_0:a,_1:e,_2:n,_3:r,_4:u}}function X(n){var e={LAZY_DONE:!1,VAL:function(){return nr()}};switch(n.TAG|0){case 0:return{TAG:0,_0:n._0};case 1:return{TAG:2,_0:xn(e),_1:n._0,_2:X(n._1)};case 2:return{TAG:1,_0:xn(e),_1:X(n._0),_2:n._1,_3:X(n._2)};case 3:var r=n._0,u=oc(r);if(u!==void 0)return{TAG:3,_0:u};var a=Wn(r);if(a!==void 0)return{TAG:3,_0:fe(void 0,r)};throw{RE_EXN_ID:Zu,_1:r,Error:new Error};case 4:return{TAG:4,_0:X(n._0),_1:X(n._1)};case 5:var t=n._1,o=n._0;if(o.length===0)return{TAG:5,_0:xn(e),_1:[fe(void 0,"__x")],_2:X(t)};var i=q(void 0);return{TAG:5,_0:xn(e),_1:s(o,function(h){return fe(i,h)}),_2:X(t)};case 6:return tr(fe(void 0,n._0),!1,X(n._1),X(n._2),xn(e));case 7:return{TAG:8,_0:xn(e),_1:X(n._0),_2:s(n._1,X)};case 8:var _=n._2,v=n._1,f=function(h){if(!h)return nn(v,X);var T=h.hd;if(T.TAG!==0)return{TAG:9,_0:xn(e),_1:[Ju(T)],_2:f(h.tl),_3:_};var C=T._3;return tr(fe(void 0,T._0),T._1,X(T._2),an(f(h.tl),{TAG:0,_0:0},function(V){return V}),C!==void 0?C:nr())};return{TAG:9,_0:xn(e),_1:[],_2:f(ut(n._0)),_3:_};case 9:return{TAG:10,_0:xn(e),_1:X(n._0),_2:X(n._1),_3:an(n._2,{TAG:0,_0:0},X)};case 10:return{TAG:11,_0:X(n._0),_1:X(n._1)};case 11:return{TAG:12,_0:nn(n._0,X)};case 12:return{TAG:13,_0:X(n._0),_1:xn(e),_2:n._1};case 13:return{TAG:14,_0:s(n._0,X)};case 14:return{TAG:15,_0:n._0,_1:s(n._1,function(h){return[h[0],X(h[1])]})};case 15:return{TAG:16,_0:nr(),_1:X(n._0),_2:n._1}}}function Ju(n){if(n.TAG!==0)return{_0:X(n._0)};throw{RE_EXN_ID:Wu,Error:new Error}}function rr(n){switch(n.TAG|0){case 0:var e=s(n._1,function(t){return[fe(q(void 0),t[0]),t[1]]});return{TAG:0,_0:fe(void 0,n._0),_1:e,_2:X(n._2)};case 1:return{TAG:1,_0:fe(void 0,n._0),_1:n._1,_2:X(n._2)};case 2:var r=n._1,u=n._0;return cc(je.make(u,r)),{TAG:2,_0:u,_1:r};case 3:var a=s(s(n._1,rr),function(t){if(t.TAG===0)return[t._0,t._1,t._2];throw{RE_EXN_ID:qu,_1:t,Error:new Error}});return{TAG:3,_0:n._0,_1:a}}}function Z(n,e){var r=function(i){return Z(n,i)};switch(e.TAG|0){case 0:return{TAG:0,_0:e._0};case 1:return{TAG:1,_0:d(n,e._0),_1:Z(n,e._1),_2:e._2,_3:Z(n,e._3)};case 2:return{TAG:2,_0:d(n,e._0),_1:e._1,_2:Z(n,e._2)};case 3:return{TAG:3,_0:e._0};case 4:return{TAG:4,_0:Z(n,e._0),_1:Z(n,e._1)};case 5:return{TAG:5,_0:d(n,e._0),_1:e._1,_2:Z(n,e._2)};case 6:return{TAG:6,_0:d(n,e._0),_1:e._1,_2:e._2,_3:Z(n,e._3),_4:Z(n,e._4)};case 7:return{TAG:7,_0:d(n,e._0),_1:e._1,_2:e._2,_3:Z(n,e._3),_4:Z(n,e._4)};case 8:return{TAG:8,_0:d(n,e._0),_1:Z(n,e._1),_2:s(e._2,r)};case 9:return{TAG:9,_0:d(n,e._0),_1:s(e._1,function(i){return Ku(n,i)}),_2:nn(e._2,r),_3:e._3};case 10:return{TAG:10,_0:d(n,e._0),_1:Z(n,e._1),_2:Z(n,e._2),_3:Z(n,e._3)};case 11:return{TAG:11,_0:Z(n,e._0),_1:Z(n,e._1)};case 12:return{TAG:12,_0:nn(e._0,r)};case 13:return{TAG:13,_0:Z(n,e._0),_1:d(n,e._1),_2:d(n,e._2)};case 14:return{TAG:14,_0:s(e._0,r)};case 15:var u=e._1,a=e._0,t=Wn(a);if(t===void 0)return Nr('unreachable: undeclared struct "'+a+"'");var o=Ii(s(zt(t.attributes,function(i){return we(i.impl)}),function(i){var _=i.name;return gt(u,function(v){return v[0]===_})}),function(i){return[i[0],Z(n,i[1])]});return o!==void 0?{TAG:15,_0:a,_1:o}:Nr('unreachable: missing attribute for struct "'+a+'"');case 16:return{TAG:16,_0:d(n,e._0),_1:Z(n,e._1),_2:e._2}}}function Ku(n,e){return{_0:Z(n,e._0)}}function Yu(n,e){switch(e.TAG|0){case 0:return{TAG:0,_0:e._0,_1:e._1,_2:Z(n,e._2)};case 1:return{TAG:1,_0:e._0,_1:e._1,_2:Z(n,e._2)};case 2:return e;case 3:return{TAG:3,_0:e._0,_1:s(e._1,function(r){return[r[0],r[1],Z(n,r[2])]})}}}var Gn={typeOfExpr:se,typeOfStmt:_c,showExpr:M,showStmt:ju,showDecl:er,UnexpectedDeclarationInImplBlock:qu,UndeclaredIdentifer:Zu,UnreachableLetStmt:Wu,rewriteLetIn:tr,fromExpr:X,fromStmt:Ju,fromDecl:rr,substExpr:Z,substStmt:Ku,substDecl:Yu},kn={show:M,from:X,subst:Z,typeOf:se},ur={show:er,from:rr,subst:Yu};function Hu(n){return[n,0,n.length]}function fc(n){return Hu(Array.from(n,function(e){return Rr(e,0)}))}function Qu(n,e){var r=e[2],u=n!==void 0?n:1;return[e[0],Math.min(e[1]+u|0,r),r]}function ar(n){return De(n[0],n[1])}function or(n){return Qu(1,n)}function ir(n){return n[1]===n[2]}function sc(n){return n[0].slice(n[1],n[2])}function qe(n,e){var r=ar(e);if(r!==void 0&&G(n,r))return[r,Qu(void 0,e)]}function en(n){return function(e){return qe(function(r){return r===n},e)}}function yu(n){return n>=97?n<=122:!1}function lc(n){return n>=65?n<=90:!1}function vc(n){return yu(n)?!0:lc(n)}function Iu(n){return n>=48?n<=57:!1}function dc(n){return vc(n)?!0:Iu(n)}function Tc(n){return qe(yu,n)}function Gc(n){return qe(Iu,n)}function cr(n){return qe(dc,n)}function gc(n){return n>13||n<9?n===32:!(n===12||n===11)}function hc(n){return qe(gc,n)}function S(n,e,r){return nn(G(n,r),function(u){return[G(e,u[0]),u[1]]})}function At(n,e,r){for(;;){var u=n,a=r,t=u!==void 0?u:[];if(ir(a))return[t,a];var o=G(e,a);if(o===void 0)return[t,a];t.push(o[0]),r=o[1],n=t}}function xu(n){return At(void 0,hc,n)}function st(n,e,r){return In(G(n,r),function(u){var a=u[0];return nn(G(e,u[1]),function(t){return[[a,t[0]],t[1]]})})}function na(n){return function(e){return S(function(r){return st(n,function(u){return At(void 0,n,u)},r)},function(r){return I([r[0]],r[1])},e)}}function Ec(n,e,r,u){return In(st(n,e,u),function(a){var t=a[0],o=t[1],i=t[0];return nn(G(r,a[1]),function(_){return[[i,o,_[0]],_[1]]})})}function ea(n){if(!n)return function(a){return[0,a]};var e=n.hd,r=ea(n.tl),u=function(a){return st(e,r,a)};return function(a){return S(u,function(t){return{hd:t[0],tl:t[1]}},a)}}function ta(n,e,r){var u=G(n,r);return u!==void 0?[u[0],u[1]]:G(e,r)}function lt(n,e){return xt(n,function(r){return G(r,e)})}function on(n){var e=Array.from(n,function(u){var a=Rr(u,0);return function(t){return qe(function(o){return o===a},t)}}),r=ea(ut(e));return function(u){return S(r,function(a){return n},u)}}function wc(n,e){var r=G(n,e);if(r===void 0)return[void 0,or(e)]}var pc=na(Gc);function Sc(n){return S(pc,function(e){return{TAG:0,_0:Lr(Ha(w(e,"",function(r){return ht(1,r)})))}},n)}var mc=on("false");function bc(n){return S(mc,function(e){return{TAG:1,_0:!1}},n)}var Ac=on("true");function kc(n){return S(Ac,function(e){return{TAG:1,_0:!0}},n)}function Fc(n){return ta(kc,bc,n)}var Dc=[cr,en(95),en(39)];function Nc(n){return lt(Dc,n)}function Rc(n){return At(void 0,Nc,n)}var Lc=en(95);function Cc(n){return ta(Tc,Lc,n)}function Uc(n){return st(Cc,Rc,n)}function $c(n){return S(Uc,function(e){return{TAG:3,_0:ht(1,e[0])+w(e[1],"",function(r){return ht(1,r)})}},n)}var Oc=[cr,en(95)],Mc=na(function(n){return lt(Oc,n)});function Xc(n){return S(Mc,function(e){return{TAG:4,_0:w(e,"",function(r){return ht(1,r)})}},n)}var Vc=on("let"),Bc=on("mut"),zc=on("in"),Pc=on("if"),jc=on("else"),qc=on("fn"),Zc=on("while"),Wc=on("return"),Jc=on("as"),Kc=on("unsafe"),Yc=on("struct"),Hc=on("impl"),Qc=[function(n){return S(Vc,function(e){return{TAG:5,_0:0}},n)},function(n){return S(Bc,function(e){return{TAG:5,_0:1}},n)},function(n){return S(zc,function(e){return{TAG:5,_0:2}},n)},function(n){return S(Pc,function(e){return{TAG:5,_0:3}},n)},function(n){return S(jc,function(e){return{TAG:5,_0:4}},n)},function(n){return S(qc,function(e){return{TAG:5,_0:5}},n)},function(n){return S(Zc,function(e){return{TAG:5,_0:6}},n)},function(n){return S(Wc,function(e){return{TAG:5,_0:7}},n)},function(n){return S(Jc,function(e){return{TAG:5,_0:8}},n)},function(n){return S(Kc,function(e){return{TAG:5,_0:9}},n)},function(n){return S(Yc,function(e){return{TAG:5,_0:10}},n)},function(n){return S(Hc,function(e){return{TAG:5,_0:11}},n)}];function yc(n){return lt(Qc,n)}function Ic(n){return st(yc,function(e){return wc(cr,e)},n)}function xc(n){return S(Ic,function(e){return e[0]},n)}var n_=on("->"),e_=on("=="),t_=on("!="),r_=en(43),u_=en(45),a_=en(42),o_=en(47),i_=en(37),c_=on("<="),__=on(">="),f_=en(60),s_=en(62),l_=en(40),v_=en(41),d_=en(44),T_=en(59),G_=en(61),g_=en(123),h_=en(125),E_=en(58),w_=en(33),p_=en(46),S_=[function(n){return S(n_,function(e){return{TAG:2,_0:5}},n)},function(n){return S(e_,function(e){return{TAG:2,_0:14}},n)},function(n){return S(t_,function(e){return{TAG:2,_0:15}},n)},function(n){return S(r_,function(e){return{TAG:2,_0:9}},n)},function(n){return S(u_,function(e){return{TAG:2,_0:10}},n)},function(n){return S(a_,function(e){return{TAG:2,_0:11}},n)},function(n){return S(o_,function(e){return{TAG:2,_0:12}},n)},function(n){return S(i_,function(e){return{TAG:2,_0:13}},n)},function(n){return S(c_,function(e){return{TAG:2,_0:17}},n)},function(n){return S(__,function(e){return{TAG:2,_0:19}},n)},function(n){return S(f_,function(e){return{TAG:2,_0:16}},n)},function(n){return S(s_,function(e){return{TAG:2,_0:18}},n)},function(n){return S(l_,function(e){return{TAG:2,_0:0}},n)},function(n){return S(v_,function(e){return{TAG:2,_0:1}},n)},function(n){return S(d_,function(e){return{TAG:2,_0:2}},n)},function(n){return S(T_,function(e){return{TAG:2,_0:3}},n)},function(n){return S(G_,function(e){return{TAG:2,_0:4}},n)},function(n){return S(g_,function(e){return{TAG:2,_0:6}},n)},function(n){return S(h_,function(e){return{TAG:2,_0:7}},n)},function(n){return S(E_,function(e){return{TAG:2,_0:8}},n)},function(n){return S(w_,function(e){return{TAG:2,_0:20}},n)},function(n){return S(p_,function(e){return{TAG:2,_0:21}},n)}];function m_(n){return lt(S_,n)}var b_=[Sc,Fc,xc,m_,$c,Xc];function A_(n){return lt(b_,n)}function k_(n){return At(void 0,function(e){return S(function(r){return Ec(xu,A_,xu,r)},function(r){return r[1]},e)},n)}function F_(n){switch(n){case 0:return"(";case 1:return")";case 2:return",";case 3:return";";case 4:return"=";case 5:return"->";case 6:return"{";case 7:return"}";case 8:return":";case 9:return"+";case 10:return"-";case 11:return"*";case 12:return"/";case 13:return"%";case 14:return"==";case 15:return"!=";case 16:return"<";case 17:return"<=";case 18:return">";case 19:return">=";case 20:return"!";case 21:return"."}}function D_(n){switch(n){case 0:return"let";case 1:return"mut";case 2:return"in";case 3:return"if";case 4:return"else";case 5:return"fn";case 6:return"while";case 7:return"return";case 8:return"as";case 9:return"unsafe";case 10:return"struct";case 11:return"impl"}}function N_(n){switch(n.TAG|0){case 0:return String(n._0);case 1:return n._0?"true":"false";case 2:return F_(n._0);case 3:case 4:return n._0;case 5:return D_(n._0)}}function kt(n){return{contents:function(e){return In(ar(e),function(r){if(G(n,r))return[r,or(e)]})}}}function Ze(n){return{contents:function(e){return In(ar(e),function(r){return nn(G(n,r),function(u){return[u,or(e)]})})}}}function R_(n,e){return{contents:function(r){var u=G(n.contents,r);if(u!==void 0){var a=u[1];return nn(G(e,u[0]),function(t){return[t,a]})}}}}function l(n){return kt(function(e){return Pn(e,n)})}function E(n,e){return{contents:function(r){return nn(G(n.contents,r),function(u){return[G(e,u[0]),u[1]]})}}}function cn(n,e){return{contents:function(r){return In(G(n.contents,r),function(u){var a=u[0];return nn(G(e.contents,u[1]),function(t){return[[a,t[0]],t[1]]})})}}}function vt(n){var e=function(r){return{contents:function(u){if(ir(u))return[0,u];var a=G(r.contents,u);if(a===void 0)return[0,u];var t=a[0];return nn(G(e(r).contents,a[1]),function(o){return[{hd:t,tl:o[0]},o[1]]})}}};return E(e(n),Me)}function L_(n){return E(cn(n,vt(n)),function(e){return I([e[0]],e[1])})}function le(n,e,r){return{contents:function(u){return In(G(cn(n,e).contents,u),function(a){var t=a[0],o=t[1],i=t[0];return nn(G(r.contents,a[1]),function(_){return[[i,o,_[0]],_[1]]})})}}}function We(n,e,r,u){return{contents:function(a){return In(G(le(n,e,r).contents,a),function(t){var o=t[0],i=o[2],_=o[1],v=o[0];return nn(G(u.contents,t[1]),function(f){return[[v,_,i,f[0]],f[1]]})})}}}function dt(n,e,r,u,a){return{contents:function(t){return In(G(We(n,e,r,u).contents,t),function(o){var i=o[0],_=i[3],v=i[2],f=i[1],h=i[0];return nn(G(a.contents,o[1]),function(T){return[[h,f,v,_,T[0]],T[1]]})})}}}function C_(n,e,r,u,a,t){return{contents:function(o){return In(G(dt(n,e,r,u,a).contents,o),function(i){var _=i[0],v=_[4],f=_[3],h=_[2],T=_[1],C=_[0];return nn(G(t.contents,i[1]),function(V){return[[C,T,h,f,v,V[0]],V[1]]})})}}}function B(n,e){return{contents:function(r){var u=G(n.contents,r);return u!==void 0?[u[0],u[1]]:G(e.contents,r)}}}function Ft(n){return{contents:function(e){return xt(n,function(r){return G(r.contents,e)})}}}function ra(n,e,r){return E(cn(n,vt(e)),function(u){var a=u[1],t=u[0];return Pn(a,[])?t:pn(a,t,r)})}function Tt(n,e,r){return ra(n,cn(e,n),function(u,a){return Qa(r,u,a[0],a[1])})}function Le(n){return E(le(kt(function(e){return Pn(e,{TAG:2,_0:0})}),n,kt(function(e){return Pn(e,{TAG:2,_0:1})})),function(e){return e[1]})}function U_(n,e){var r=function(u,a){var t=G(n.contents,u);if(t===void 0)return[a,u];var o=t[1];return a.push(t[0]),an(G(e.contents,o),[a,o],function(i){return r(i[1],a)})};return{contents:function(u){return r(u,[])}}}function me(n){return U_(n,kt(function(e){return Pn(e,{TAG:2,_0:2})}))}function ve(n){return B(E(n,function(e){return q(e)}),{contents:function(e){return[void 0,e]}})}var ua={contents:function(n){}},sn={contents:function(n){}},Je={contents:function(n){}},aa={contents:function(n){}},be={contents:function(n){}},$_=Ze(function(n){if(n.TAG===0)return{TAG:0,_0:{TAG:0,_0:n._0}}}),O_=Ze(function(n){if(n.TAG===1)return{TAG:0,_0:{TAG:1,_0:n._0}}}),de=Ze(function(n){if(n.TAG===3)return n._0}),Dt=Ze(function(n){if(n.TAG===4)return n._0}),_r=Ze(function(n){switch(n.TAG|0){case 3:case 4:return n._0;default:return}}),M_=E(cn(l({TAG:2,_0:0}),l({TAG:2,_0:1})),function(n){return Se}),X_=B(M_,Ze(function(n){switch(n.TAG|0){case 3:switch(n._0){case"bool":return pe;case"u32":return te;default:return}case 4:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return}})),oa=B(X_,Le(be)),V_=B(E(le(B(Le(me(be)),E(oa,function(n){return[n]})),l({TAG:2,_0:5}),be),function(n){return Vn(n[0],n[2])}),oa),B_=B(E(We(Dt,l({TAG:2,_0:16}),me(be),l({TAG:2,_0:18})),function(n){return{TAG:1,_0:n[0],_1:n[2]}}),V_);be.contents=B_.contents;var z_=E(cn(_r,ve(cn(l({TAG:2,_0:8}),be))),function(n){return[n[0],nn(n[1],function(e){return e[1]})]}),P_=E(B(de,_r),function(n){return{TAG:3,_0:n}}),j_=E(cn(l({TAG:2,_0:0}),l({TAG:2,_0:1})),function(n){return{TAG:0,_0:0}}),q_=E(Le(We(sn,l({TAG:2,_0:2}),sn,ve(cn(l({TAG:2,_0:2}),me(sn))))),function(n){var e=I([n[0],n[2]],an(n[3],[],function(r){return r[1]}));return{TAG:13,_0:e}}),ia=Ft([$_,O_,j_,P_,q_,Le(sn)]),ca=B(ra(ia,cn(l({TAG:2,_0:21}),de),function(n,e){return{TAG:15,_0:n,_1:e[1]}}),ia),_a=B(E(cn(ca,L_(Le(me(sn)))),function(n){return pn(n[1],n[0],function(e,r){return{TAG:7,_0:e,_1:r}})}),ca),Z_=Ft([E(l({TAG:2,_0:11}),function(n){return 2}),E(l({TAG:2,_0:10}),function(n){return 0}),E(l({TAG:2,_0:20}),function(n){return 1})]),W_=B(E(l({TAG:2,_0:9}),function(n){return 0}),E(l({TAG:2,_0:10}),function(n){return 1})),J_=Ft([E(l({TAG:2,_0:11}),function(n){return 2}),E(l({TAG:2,_0:12}),function(n){return 3}),E(l({TAG:2,_0:13}),function(n){return 4})]),K_=Ft([E(l({TAG:2,_0:16}),function(n){return 5}),E(l({TAG:2,_0:17}),function(n){return 6}),E(l({TAG:2,_0:18}),function(n){return 7}),E(l({TAG:2,_0:19}),function(n){return 8})]),Y_=B(E(l({TAG:2,_0:14}),function(n){return 9}),E(l({TAG:2,_0:15}),function(n){return 10})),H_=B(E(cn(Z_,_a),function(n){return{TAG:1,_0:n[0],_1:n[1]}}),_a),Q_=Tt(H_,J_,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),y_=Tt(Q_,W_,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),I_=Tt(y_,K_,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),x_=Tt(I_,Y_,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),n0=B(E(We(l({TAG:5,_0:3}),sn,Je,ve(cn(l({TAG:5,_0:4}),Je))),function(n){return{TAG:9,_0:n[1],_1:n[2],_2:nn(n[3],function(e){return e[1]})}}),x_),e0=B(E(le(l({TAG:5,_0:6}),sn,Je),function(n){return{TAG:10,_0:n[1],_1:n[2]}}),n0),t0=B(E(C_(l({TAG:5,_0:0}),de,l({TAG:2,_0:4}),sn,l({TAG:5,_0:2}),sn),function(n){return{TAG:6,_0:n[1],_1:n[3],_2:n[5]}}),e0),r0=B(Le(me(de)),E(de,function(n){return[n]})),u0=B(E(le(r0,l({TAG:2,_0:5}),sn),function(n){return{TAG:5,_0:n[0],_1:n[2]}}),t0),a0=R_(sn,function(n){switch(n.TAG|0){case 9:case 10:return[!0,{TAG:1,_0:n}];default:return}});Je.contents=B(E(dt(ve(l({TAG:5,_0:9})),l({TAG:2,_0:6}),vt(B(E(aa,function(n){return[!1,n]}),a0)),ve(sn),l({TAG:2,_0:7})),function(n){var e=n[3],r=n[2],u=s(r,function(i){return i[1]}),a=an(n[0],0,function(i){return 1}),t=De(r,r.length-1|0);if(t===void 0)return{TAG:8,_0:u,_1:e,_2:a};var o=t[1];return o.TAG===0||!(t[0]&&we(e))?{TAG:8,_0:u,_1:e,_2:a}:{TAG:8,_0:Xt(u,0,r.length-2|0),_1:o._0,_2:a}}),u0).contents;var o0=B(E(We(Dt,l({TAG:2,_0:6}),me(le(de,l({TAG:2,_0:8}),sn)),l({TAG:2,_0:7})),function(n){return{TAG:14,_0:n[0],_1:s(n[2],function(e){return[e[0],e[2]]})}}),Je),i0=Tt(o0,l({TAG:2,_0:4}),function(n,e,r){return{TAG:4,_0:n,_1:r}}),c0=B(E(cn(l({TAG:5,_0:7}),ve(sn)),function(n){return{TAG:11,_0:n[1]}}),i0),_0=E(cn(c0,ve(cn(l({TAG:5,_0:8}),be))),function(n){var e=n[1],r=n[0];return e!==void 0?{TAG:12,_0:r,_1:e[1]}:r});sn.contents=_0.contents;var f0=E(cn(sn,l({TAG:2,_0:3})),function(n){return{TAG:1,_0:n[0]}}),s0=B(E(dt(B(l({TAG:5,_0:0}),l({TAG:5,_0:1})),z_,l({TAG:2,_0:4}),sn,l({TAG:2,_0:3})),function(n){var e=n[1];return{TAG:0,_0:e[0],_1:Pn(n[0],{TAG:5,_0:1}),_2:n[3],_3:e[1]}}),f0);aa.contents=s0.contents;var l0=E(dt(B(l({TAG:5,_0:0}),l({TAG:5,_0:1})),_r,l({TAG:2,_0:4}),sn,l({TAG:2,_0:3})),function(n){return{TAG:1,_0:n[1],_1:Pn(n[0],{TAG:5,_0:1}),_2:n[3]}}),v0=B(E(dt(l({TAG:5,_0:10}),Dt,l({TAG:2,_0:6}),me(le(cn(ve(l({TAG:5,_0:1})),de),l({TAG:2,_0:8}),be)),l({TAG:2,_0:7})),function(n){var e=s(n[3],function(r){var u=r[0];return[u[1],r[2],Pt(u[0])]});return{TAG:2,_0:n[1],_1:e}}),l0),fa=B(E(We(l({TAG:5,_0:5}),de,E(Le(me(cn(ve(l({TAG:5,_0:1})),de))),function(n){return s(n,function(e){return[e[1],Pt(e[0])]})}),Je),function(n){return{TAG:0,_0:n[1],_1:n[2],_2:n[3]}}),v0),d0=B(E(le(l({TAG:5,_0:11}),Dt,E(le(l({TAG:2,_0:6}),vt(fa),l({TAG:2,_0:7})),function(n){return n[1]})),function(n){return{TAG:3,_0:n[1],_1:n[2]}}),fa);ua.contents=d0.contents;var T0=vt(ua);function G0(n){var e=n.replace(/(\/\/[^\n]*)/g,""),r=k_(fc(e));if(r===void 0)return{TAG:1,_0:"could not tokenize"};var u=G(T0.contents,Hu(r[0]));if(u===void 0)return{TAG:1,_0:"could not parse"};var a=u[1];if(ir(a))return{TAG:0,_0:u[0]};var t=w(Xt(sc(a),0,5)," ",N_);return{TAG:1,_0:"could not parse near "+t}}function g0(n,e){var r=n!==void 0?n:3,u={contents:e.length},a=function(t,o,i){for(;;){var _=i,v=o,f=t;if(f){var h=f.hd,T=0;if(typeof h=="number")switch(h){case 2:var C=f.tl;if(C&&C.hd===3){t={hd:2,tl:C.tl};continue}break;case 9:var V=f.tl;if(V&&V.hd===9){t=V.tl;continue}break;case 10:var Q=f.tl;if(Q&&Q.hd===9){t={hd:14,tl:Q.tl};continue}break;case 14:var Fn=f.tl;if(Fn&&Fn.hd===9){t={hd:10,tl:Fn.tl};continue}break;case 18:var gn=f.tl;if(gn&&gn.hd===9){t={hd:36,tl:gn.tl};continue}break;case 19:var ln=f.tl;if(ln&&ln.hd===9){t={hd:37,tl:ln.tl};continue}break;case 24:var vn=f.tl;if(vn&&vn.hd===9){t={hd:30,tl:vn.tl};continue}break;case 25:var mn=f.tl;if(mn&&mn.hd===9){t={hd:31,tl:mn.tl};continue}break;case 30:var rn=f.tl;if(rn&&rn.hd===9){t={hd:24,tl:rn.tl};continue}break;case 31:var hn=f.tl;if(hn&&hn.hd===9){t={hd:25,tl:hn.tl};continue}break;case 36:var Ln=f.tl;if(Ln&&Ln.hd===9){t={hd:18,tl:Ln.tl};continue}break;case 37:var un=f.tl;if(un&&un.hd===9){t={hd:19,tl:un.tl};continue}break}else switch(h.TAG|0){case 0:var P=h._0,Cn=0,bn=f.tl;if(bn){var _n=bn.hd;if(typeof _n=="number"){if(_n===3){t=bn.tl;continue}Cn=3}else switch(_n.TAG|0){case 0:var J=bn.tl;if(J){var Un=J.hd;if(typeof Un=="number"){var zn=_n._0;if(Un!==43){if(Un<15)switch(Un){case 4:t={hd:{TAG:0,_0:P+zn|0},tl:J.tl};continue;case 5:t={hd:{TAG:0,_0:P-zn|0},tl:J.tl};continue;case 6:t={hd:{TAG:0,_0:Math.imul(P,zn)},tl:J.tl};continue;case 7:t={hd:{TAG:0,_0:ya(P,zn)},tl:J.tl};continue;case 10:t={hd:{TAG:0,_0:P===zn?1:0},tl:J.tl};continue;case 0:case 1:case 2:case 3:case 8:case 9:case 11:case 12:case 13:break;case 14:t={hd:{TAG:0,_0:P===zn?0:1},tl:J.tl};continue}}else{t={hd:{TAG:0,_0:Ia(P,zn)},tl:J.tl};continue}}}break;case 15:t={hd:{TAG:14,_0:P},tl:bn.tl};continue;default:Cn=3}}if(Cn===3&&P===0){var ue=f.tl;if(ue.hd===10){t={hd:9,tl:ue.tl};continue}}break;case 1:case 2:case 3:case 9:case 11:T=2;break;case 12:var Ge=f.tl;if(Ge){var Kn=Ge.hd;if(typeof Kn!="number"&&Kn.TAG===11){var ge=h._0;if(ge===Kn._0){t={hd:{TAG:13,_0:ge},tl:Ge.tl};continue}}}break;case 13:var $n=f.tl;if($n&&$n.hd===3){t={hd:{TAG:12,_0:h._0},tl:$n.tl};continue}break}if(T===2){var On=f.tl;if(On&&On.hd===3){t=On.tl;continue}}o={hd:h,tl:v},t=f.tl;continue}var ae=Er(v),$e=xa(ae);if(!(_>1&&$e<u.contents))return ae;u.contents=$e,i=_-1|0,o=0,t=ae}};return r>0?Me(a(ut(e),0,r)):e}function fr(n,e){switch(e.TAG|0){case 0:return n===e._0;case 1:return jt(e._1,function(u){return fr(n,u)});case 2:var r=e._0;return r.TAG===0?!1:jt(Bn.toArray(r._0),function(u){return fr(n,u[1])})}}function sa(n,e,r){if(fr(n,e))return{TAG:1,_0:k({TAG:0,_0:n})+" occurs in "+k(e)};var u=kr(r,n);return u!==void 0?Pn(u,e)?{TAG:0,_0:r}:{TAG:1,_0:k(e)+" is not unifiable with "+k(u)}:{TAG:0,_0:Cr(r,n,e)}}function Ke(n,e){for(;;){var r=n;if(!r)return{TAG:0,_0:e};var u=r.tl,a=r.hd,t=a[1],o=a[0],i=0;switch(o.TAG|0){case 0:var _=o._0,v=0;switch(t.TAG|0){case 0:if(_===t._0){n=u;continue}v=3;break;case 1:case 2:v=3;break}if(v===3)return F(sa(_,t,e),function(un){return function(P){return Ke(un,P)}}(u));break;case 1:var f=o._1;switch(t.TAG|0){case 0:i=1;break;case 1:var h=t._1;if(o._0===t._0&&f.length===h.length){var T=pn(Ne(f,h),u,function(un,P){return{hd:[d(e,P[0]),d(e,P[1])],tl:un}});n=T;continue}i=2;break;case 2:i=2;break}break;case 2:var C=o._0;switch(t.TAG|0){case 0:i=1;break;case 1:i=2;break;case 2:var V=t._0;if(C.TAG===0){var Q=C._0;if(V.TAG===0){if(Q!==V._0)return{TAG:1,_0:"cannot unify "+k(o)+" with "+k(t)};n=u;continue}var Fn=Wn(Q);if(Fn===void 0)return{TAG:1,_0:'undeclared struct "'+Q+'"'};var gn=Ke({hd:[{TAG:2,_0:{TAG:1,_0:V._0}},je.toPartialStructType(Fn,_e())],tl:u},e);return gn.TAG===0?{TAG:0,_0:gn._0}:{TAG:1,_0:"struct type "+k(t)+" does not match "+Q+": "+gn._0}}var ln=C._0;if(V.TAG===0){var vn=V._0,mn=Wn(vn);if(mn===void 0)return{TAG:1,_0:'undeclared struct "'+vn+'"'};var rn=Ke({hd:[{TAG:2,_0:{TAG:1,_0:ln}},je.toPartialStructType(mn,_e())],tl:u},e);return rn.TAG===0?{TAG:0,_0:rn._0}:{TAG:1,_0:"struct type "+k(o)+" does not match "+vn+": "+rn._0}}var hn=Bn.toMap(V._0),Ln=Bn.toArray(ln);return F(xi(s(Ln,function(un,P,Cn){return function(bn){var _n=bn[0],J=Mt(Cn,_n);return J!==void 0?{TAG:0,_0:[bn[1],J]}:{TAG:1,_0:"struct type "+k(P)+' is missing attribute "'+_n+'" from type "'+k(un)+'"'}}}(o,t,hn)),function(un){return un}),function(un,P,Cn,bn){return function(_n){var J={TAG:2,_0:{TAG:1,_0:Bn.fromArray(mr(no(Cn,s(bn,function(Un){return Un[0]}))),_e())}};return Ke(eo(ut(_n),{hd:[Bn.tail(P),J],tl:un}),e)}}(u,ln,hn,Ln))}break}switch(i){case 1:return F(sa(t._0,o,e),function(un){return function(P){return Ke(un,P)}}(u));case 2:return{TAG:1,_0:k(o)+" is not unifiable with "+k(t)}}}}function tn(n,e){return Ke({hd:[n,e],tl:0},void 0)}function h0(n){var e;return e=typeof n=="number"?Se:n.TAG===0?te:pe,ft(e)}function E0(n){return n>=5?n>=9?[[0],Vn([{TAG:0,_0:0},{TAG:0,_0:0}],pe)]:ft(Vn([te,te],pe)):ft(Vn([te,te],te))}function w0(n){switch(n){case 0:return ft(Vn([te],te));case 1:return ft(Vn([pe],pe));case 2:return[[0],Vn([Vi({TAG:0,_0:0})],{TAG:0,_0:0})]}}function p0(n,e){return"cannot infer struct type: inferred type "+Bn.show(n,k)+" matches "+w(e,", ",function(r){return r.name})}function sr(n){var e=uo(Ur(qn.structs),function(u){return ao(tn({TAG:2,_0:{TAG:1,_0:n}},je.toPartialStructType(u,_e())),void 0,function(a){return u})});if(e.length!==1)return e.length===0?0:{TAG:1,_0:e};var r=e[0];return{TAG:0,_0:r}}var la={ambiguousMatchesError:p0,findMatchingStruct:sr},Ye=qt();function va(n,e,r,u){var a=kn.typeOf(r);ot(Ye,a);var t=pn(e,n,function(i,_){return jn.addMono(i,_.contents.name,_.contents.ty)}),o=Vn(s(e,function(i){return i.contents.ty}),a);return F(Sn(t,r,a),function(i){var _=d(i,o),v=d(i,u),f=Tn(i,n),h=It(f,_);return Y(tn(v,_),function(T){at(Ye);var C=L(T,i);return[C,d(T,v),Bu(T,h)]})})}function Sn(n,e,r){return F(Jn(n,e),function(u){return Y(tn(d(u,r),d(u,kn.typeOf(e))),function(a){return L(a,u)})})}function Jn(n,e){switch(e.TAG|0){case 0:var r=bt(h0(e._0));return tn(kn.typeOf(e),r);case 1:var u=e._3,a=e._2,t=e._1,o=e._0;return F(Jn(n,t),function(c){var g=Tn(c,n);return F(Jn(g,u),function(p){var A=L(p,c),U=d(A,Vn([kn.typeOf(t),kn.typeOf(u)],o)),R=bt(E0(a));return Y(tn(U,R),function(K){return L(K,A)})})});case 2:var i=e._2,_=e._1,v=e._0,f=kn.typeOf(i);return F(Jn(n,i),function(c){var g=d(c,Vn([f],v)),p=bt(w0(_));return Y(tn(g,p),function(A){return L(A,c)})});case 3:var h=e._0.contents,T=jn.get(n,h.name);if(T!==void 0)return tn(h.ty,bt(T));var C=Wn(h.name);if(C===void 0)return{TAG:1,_0:'unbound variable: "'+h.name+'"'};var V={TAG:2,_0:{TAG:1,_0:Bn.fromArray(s(C.staticFuncs,function(c){var g=c.name;return[g.contents.name,g.contents.ty]}),_e())}};return tn(h.ty,V);case 4:var Q=e._1,Fn=e._0,gn=Gn.typeOfExpr(Fn),ln=Gn.typeOfExpr(Q);return F(Jn(n,Q),function(c){var g=Tn(c,n),p=d(c,gn);return F(Sn(g,Fn,p),function(A){var U=L(A,c),R=d(A,p),K=d(U,ln);return Y(tn(R,K),function(W){return L(W,U)})})});case 5:return Y(va(n,e._1,e._2,e._0),function(c){return c[0]});case 6:var vn=e._4,mn=e._3,rn=e._0,hn=e._2.contents,Ln=kn.typeOf(mn);return F(Jn(n,mn),function(c){var g=Tn(c,n),p=d(c,Ln),A=d(c,rn),U=It(jn.remove(g,hn.name),p),R=jn.add(g,hn.name,U);return F(Sn(R,vn,A),function(K){var W=L(K,c);return Y(tn(d(W,Ln),d(W,hn.ty)),function(Mn){return L(Mn,W)})})});case 7:var un=e._4,P=e._3,Cn=e._2,bn=e._0,_n=e._1.contents,J=kn.typeOf(P);ot(Ye,J);var Un=Vn(s(Cn,function(c){return c.contents.ty}),J),zn=pn(Cn,n,function(c,g){return jn.addMono(c,g.contents.name,g.contents.ty)}),ue=jn.addMono(zn,_n.name,Un);return F(Sn(ue,P,J),function(c){var g=Tn(c,ue),p=d(c,Un),A=d(c,bn),U=jn.add(g,_n.name,It(g,p));return F(Sn(U,un,A),function(R){var K=L(R,c);return Y(tn(_n.ty,d(R,p)),function(W){return at(Ye),L(W,K)})})});case 8:var Ge=e._2,Kn=s(Ge,kn.typeOf),ge=Vn(Kn,e._0);return Y(F(Sn(n,e._1,ge),function(c){return pn(Ne(Ge,Kn),{TAG:0,_0:[c,Tn(c,n)]},function(g,p){var A=p[1],U=p[0];return F(g,function(R){var K=R[1],W=R[0],Mn=d(W,A);return Y(Sn(K,U,Mn),function(Yn){return[L(Yn,W),Tn(Yn,K)]})})})}),function(c){return c[0]});case 9:var $n=e._2,On=e._0;return F(pn(e._1,{TAG:0,_0:[void 0,n]},function(c,g){return F(c,function(p){var A=p[1],U=p[0];return Y(S0(A,g),function(R){return[L(R,U),Tn(R,A)]})})}),function(c){var g=c[0];return $n!==void 0?F(Jn(Tn(g,n),$n),function(p){var A=kn.typeOf($n),U=L(p,g);return Y(tn(d(U,On),d(U,A)),function(R){return L(R,U)})}):Y(tn(d(g,On),Se),function(p){return L(p,g)})});case 10:var ae=e._3,$e=e._2,Qe=e._0;return F(Sn(n,e._1,pe),function(c){var g=Tn(c,n),p=d(c,Qe);return F(Sn(g,$e,p),function(A){var U=Tn(A,g),R=d(A,p),K=L(A,c);return Y(Sn(U,ae,R),function(W){return L(W,K)})})});case 11:var ye=e._1,Gt=kn.typeOf(ye);return F(Jn(n,e._0),function(c){var g=d(c,Gt),p=Tn(c,n);return Y(Sn(p,ye,g),function(A){return L(A,c)})});case 12:var Ie=Xe(Ye);return Ie!==void 0?Sn(n,an(e._0,{TAG:0,_0:0},function(c){return c}),Ie):{TAG:1,_0:"'return' used outside of a function"};case 13:return Sn(n,e._0,e._1);case 14:var xe=pn(e._0,{TAG:0,_0:[Pe,n]},function(c,g){return F(c,function(p){var A=p[1],U=p[0];return F(Jn(A,g),function(R){var K=L(R,U),W=Tn(R,A);return{TAG:0,_0:[K,W]}})})});return Y(xe,function(c){return c[0]});case 15:var Oe=e._1,ke=e._0,nt=Wn(ke);if(nt===void 0)return{TAG:1,_0:'undeclared struct "'+ke+'"'};var et=nt.attributes,$t=pn(zt(et,function(c){return we(c.impl)}),{TAG:0,_0:[n,Pe]},function(c,g){var p=g.ty,A=g.name;return F(c,function(U){var R=U[1],K=U[0],W=gt(Oe,function(Mn){return Mn[0]===A});return W!==void 0?F(Sn(K,W[1],p),function(Mn){var Yn=Tn(Mn,K),Fe=L(Mn,R);return{TAG:0,_0:[Yn,Fe]}}):{TAG:1,_0:'missing attribute "'+A+'" for struct "'+ke+'"'}})}),tt=xt(Oe,function(c){var g=c[0];if(!jt(et,function(p){return p.name===g}))return g});return tt!==void 0?{TAG:1,_0:'extraneous attribute: "'+tt+'" for struct "'+ke+'"'}:Y($t,function(c){return c[1]});case 16:var j=e._2,x=e._1,he=e._0;return F(Jn(n,x),function(c){var g=Gn.typeOfExpr(x),p=d(c,g),A=function(y){return $r(p,d(y,g))?Sn(Tn(y,n),e,d(y,he)):{TAG:0,_0:y}};switch(p.TAG|0){case 0:case 1:break;case 2:var U=p._0;if(U.TAG===0){var R=U._0,K=Wn(R);if(K===void 0)return{TAG:1,_0:'undeclared struct: "'+R+'"'};var W=gt(K.attributes,function(y){return y.name===j});if(W===void 0)return{TAG:1,_0:'attribute "'+j+'" does not exist on struct "'+R+'"'};var Mn=an(W.impl,W.ty,function(y){return y[0].contents.ty});return Y(tn(d(c,he),d(c,Mn)),function(y){return L(y,c)})}var Yn=U._0,Fe=Mt(Bn.toMap(Yn),j);if(Fe!==void 0)return Y(tn(d(c,he),d(c,Fe)),function(y){return L(y,c)});var $=Bn.insert(Yn,j,he),Dn=d(c,{TAG:2,_0:{TAG:1,_0:$}}),Nn=sr($);if(typeof Nn!="number")return Nn.TAG===0?F(tn(p,{TAG:2,_0:{TAG:0,_0:Nn._0.name}}),function(y){return A(L(y,c))}):F(tn(p,Dn),function(y){return A(L(y,c))});var En=0;switch(g.TAG|0){case 0:return{TAG:0,_0:L(Cr(Pe,g._0,Dn),c)};case 1:case 2:En=2;break}if(En===2)return Y(tn(g,Dn),function(y){return L(y,c)});break}var Xn=_e(),Hn=Bn.insert(Bn.make({TAG:0,_0:Xn}),j,he),Qn=d(c,{TAG:2,_0:{TAG:1,_0:Hn}}),rt=sr(Hn);return typeof rt=="number"?{TAG:1,_0:"no struct declaration matches type "+k(Qn)}:rt.TAG===0?F(tn(p,{TAG:2,_0:{TAG:0,_0:rt._0.name}}),function(y){return A(L(y,c))}):F(tn(p,Qn),function(y){return A(L(y,c))})})}}function S0(n,e){return Jn(n,e._0)}function lr(n,e){return n+"_"+e}function da(n,e){switch(e.TAG|0){case 0:var r=e._0;return Y(va(n,s(e._1,function(o){return o[0]}),e._2,r.contents.ty),function(o){var i=o[0];return[Tn(i,jn.addMono(n,r.contents.name,r.contents.ty)),i]});case 1:var u=e._0;return Y(Sn(n,e._2,u.contents.ty),function(o){return[Tn(o,jn.addMono(n,u.contents.name,u.contents.ty)),o]});case 2:return{TAG:0,_0:[n,Pe]};case 3:var a=e._0,t=Wn(a);return t!==void 0?pn(e._1,{TAG:0,_0:[n,Pe]},function(o,i){var _=i[2],v=i[1],f=i[0];return F(o,function(h){var T=h[1],C=h[0];f.contents.newName=lr(a,f.contents.name);var V=an(De(v,0),[!1,!1],function(rn){return rn[0].contents.name==="self"?[!0,rn[1]]:[!1,!1]}),Q;if(V[0]){je.addImplementation(t,f,V[1]);var Fn=Pn(v,[])?[]:ro(v,1),gn={TAG:2,_0:{TAG:0,_0:a}},ln=De(v,0),vn;if(ln!==void 0){var mn=ln[0];mn.contents.ty=gn,vn=jn.addMono(C,mn.contents.name,gn)}else vn=C;Q=[vn,Fn]}else je.addStaticFunc(t,f),Q=[n,v];return F(da(Q[0],{TAG:0,_0:f,_1:Q[1],_2:_}),function(rn){var hn=L(rn[1],T);Pu(hn,f);var Ln=jn.remove(rn[0],f.contents.name);return{TAG:0,_0:[Ln,hn]}})})}):{TAG:1,_0:'cannot implement for unknown type "'+a+'"'}}}function m0(n){return to(Ye),pn(n,{TAG:0,_0:[jn.empty,Pe]},function(e,r){return F(e,function(u){var a=u[1];return Y(da(u[0],r),function(t){return[t[0],L(t[1],a)]})})})}var He=fn("CompilerExn.InvalidTypeConversion"),vr=fn("CompilerExn.InvalidFunctionSignature"),Nt=fn("CompilerExn.VariableNotFound"),Ta=fn("CompilerExn.EmptyFunctionStack"),Ce=fn("CompilerExn.CannotReassignImmutableValue"),Ga=fn("CompilerExn.FunctionNotFound"),Ae=fn("CompilerExn.Unimplemented"),b0=fn("CompilerExn.UnsupportedGlobalInitializer"),Rn=fn("CompilerExn.InvalidTypeAssertion"),ga=fn("CompilerExn.DerefUsedOutsideOfUnsafeBlock"),ha=fn("CompilerExn.UndeclaredStruct"),Rt=fn("CompilerExn.InvalidAttributeAccess"),Ea=fn("CompilerExn.StructTypeNotMatched"),wa=fn("CompilerExn.AmibguousStruct");function pa(n){return n.RE_EXN_ID===He?"unsupported type: "+k(n._1):n.RE_EXN_ID===vr?"invalid function signature: "+k(n._1):n.RE_EXN_ID===Nt?'variable "'+n._1+'" not found':n.RE_EXN_ID===Ta?"Function stack is empty":n.RE_EXN_ID===Ce?'cannot mutate "'+n._1+'" as it is behind an immutable binding':n.RE_EXN_ID===Ga?'no function named "'+n._1+'" found':n.RE_EXN_ID===Ae?"unimplemented: "+n._1:n.RE_EXN_ID===b0?"unsupported global initializer: "+kn.show(void 0,n._1):n.RE_EXN_ID===Rn?"invalid type assertion from "+k(n._1)+" to "+k(n._2):n.RE_EXN_ID===ga?"the deref operator can only be used in an unsafe block":n.RE_EXN_ID===re.UnkownTypeSize?"unknown type size: "+k(n._1):n.RE_EXN_ID===ha?'undeclared struct "'+n._1+'"':n.RE_EXN_ID===Rt?n._1+' does not exist for type "'+k(n._2)+'"':n.RE_EXN_ID===Ea?"No struct declaration matches type "+k(n._1):n.RE_EXN_ID===wa?la.ambiguousMatchesError(n._1,n._2):n.RE_EXN_ID===Gn.UndeclaredIdentifer?'identifier "'+n._1+'" not found':n.RE_EXN_ID===Gn.UnexpectedDeclarationInImplBlock?"unexpected declaration in impl block: "+ur.show(void 0,n._1):n.RE_EXN_ID===Gn.UnreachableLetStmt?"unreachable: let statement found in Core.fromStmt":"unexpected compiler exception"}function A0(n,e,r,u){return{name:n,depth:e,ty:r,isMutable:u}}function dr(n){if(n.TAG===0){var e=n._0,r=Wn(e);if(r!==void 0)return r;throw{RE_EXN_ID:ha,_1:e,Error:new Error}}var u=n._0,a=la.findMatchingStruct(u);if(typeof a=="number")throw{RE_EXN_ID:Ea,_1:{TAG:2,_0:n},Error:new Error};if(a.TAG===0)return a._0;throw{RE_EXN_ID:wa,_1:u,_2:a._0,Error:new Error}}function Ue(n){switch(n.TAG|0){case 0:throw{RE_EXN_ID:He,_1:n,Error:new Error};case 1:switch(n._0){case"()":if(n._1.length!==0)throw{RE_EXN_ID:He,_1:n,Error:new Error};return[];case"Fun":case"Ptr":return[0];case"Tuple":return wn(s(n._1,Ue));case"bool":case"u32":break;case"u64":if(n._1.length!==0)throw{RE_EXN_ID:He,_1:n,Error:new Error};return[1];default:throw{RE_EXN_ID:He,_1:n,Error:new Error}}if(n._1.length!==0)throw{RE_EXN_ID:He,_1:n,Error:new Error};return[0];case 2:var e=dr(n._0);return e.size===0?[]:[0]}}function k0(n,e){switch(e.TAG|0){case 1:if(e._0==="Tuple"){var r=wn(s(e._1,Ue)),u=[],a={_0:u,_1:r},t=ee.getOrAddSignature(n,a);return{TAG:1,_0:t,_1:[[],r]}}break}var o=Ue(e),i=o.length;if(i!==1){if(i===0)return 0;throw{RE_EXN_ID:Ae,_1:"wasmBlockReturnTypeOf for "+k(e),Error:new Error}}var _=o[0];return{TAG:0,_0:_}}function Sa(n){switch(n.TAG|0){case 1:if(n._0==="Fun"){var e=n._1,r=e.slice(0,e.length-1|0),u=De(e,e.length-1|0);return Mr(ct.Signature.make,wn(s(r,Ue)),an(u,[],Ue))}throw{RE_EXN_ID:vr,_1:n,Error:new Error};case 0:case 2:throw{RE_EXN_ID:vr,_1:n,Error:new Error}}}function Tr(n,e,r){return{name:n,locals:[],params:zt(e,function(u){return!re.isZeroSizedType(u[1])}),ret:r,instructions:[]}}function b(n,e){n.instructions.push(e)}function F0(n,e,r,u,a){return n.locals.push(A0(e,u,r,a)),(n.params.length+n.locals.length|0)-1|0}function D0(n,e){var r=Ot(n.params,function(t){return t[0]===e});if(r!==void 0){var u=Ee(n.params,r);return[r,u[2]]}var a=zu(n.locals,function(t){return t.name===e});if(a!==void 0)return[n.params.length+a|0,Ee(n.locals,a).isMutable]}function N0(n){var e=Sa(Vn(s(n.params,function(a){return a[1]}),n.ret)),r=G(ct.Local.fromTypes,wn(s(n.locals,function(a){return s(Ue(a.ty),function(t){return[a.name,t]})}))),u=Mr(ct.Body.make,r,g0(void 0,n.instructions));return ct.make(n.name,e,u)}function ma(n,e,r,u,a){return{name:n,mutability:e,ty:r,index:u,init:a}}function R0(n){var e=n.init,r=n.mutability;return nn(n.ty,function(u){return _t.make(r!==2,u,e)})}function m(n){var e=Xe(n.funcStack);if(e!==void 0)return e;throw{RE_EXN_ID:Ta,Error:new Error}}function Gr(n,e){return nc(n.funcs,function(r){return r.name===e})}function L0(n,e){var r=Xe(n.blockStack);if(r!==void 0&&!(e<=0)){var u=r.shadowStackDelta;return u.contents=u.contents+e|0,b(m(n),{TAG:9,_0:n.stackTop.index}),b(m(n),{TAG:0,_0:e}),b(m(n),5),b(m(n),{TAG:10,_0:n.stackTop.index})}}function C0(n,e){var r=Xe(n.blockStack);if(r!==void 0&&!(e<=0)){var u=r.shadowStackDelta;return u.contents=u.contents-e|0,b(m(n),{TAG:9,_0:n.stackTop.index}),b(m(n),{TAG:0,_0:e}),b(m(n),4),b(m(n),{TAG:10,_0:n.stackTop.index})}}function ba(n){var e=Xe(n.blockStack);return e!==void 0?e.isUnsafe:!1}function Aa(n,e){return n.scopeDepth=n.scopeDepth+1|0,ot(n.blockStack,{isUnsafe:e||ba(n),shadowStackDelta:{contents:0}})}function U0(n){n.scopeDepth=n.scopeDepth-1|0,C0(n,an(Xe(n.blockStack),0,function(e){return e.shadowStackDelta.contents})),at(n.blockStack)}function $0(n,e,r,u){var a=m(n),t=F0(a,e,r,n.scopeDepth,u);return b(m(n),{TAG:12,_0:t})}function ka(n,e,r,u,a){var t=co(n.globals),o=ma(e,r,u,t,a);return Bt(n.globals,e,o),t}function Lt(n,e){var r=m(n),u=D0(r,e);return u!==void 0?{TAG:0,_0:u[0],_1:u[1]}:nn(Dr(n.globals,e),function(a){return{TAG:1,_0:a.index,_1:a.mutability===1}})}function O0(n){if(typeof n!="number")return n.TAG===0?{TAG:0,_0:n._0}:{TAG:0,_0:n._0?1:0}}function Fa(n){if(!ba(n))throw{RE_EXN_ID:ga,Error:new Error}}function Ct(n,e,r){switch(e.TAG|0){case 0:case 1:return{TAG:1,_0:{RE_EXN_ID:Rt,_1:r,_2:e}};case 2:var u=dr(e._0),a=gt(u.attributes,function(i){return i.name===r});if(a===void 0)return{TAG:1,_0:{RE_EXN_ID:Rt,_1:r,_2:e}};var t=a.impl;if(t===void 0)return{TAG:0,_0:{TAG:0,_0:{offset:a.offset,ty:a.ty,size:a.size,mut:a.mut}}};var o=Gr(n,lr(u.name,t[0].contents.name));return o!==void 0?{TAG:0,_0:{TAG:1,_0:[o[0],o[1],t[1]]}}:{TAG:1,_0:{RE_EXN_ID:Rt,_1:r,_2:e}}}}function Da(n){return fe(void 0,"__lambda"+String(n.funcs.length)+"__")}function Ut(n,e){for(;;){var r=e;switch(r.TAG|0){case 3:var u=r._0,a=Lt(n,u.contents.newName);if(a!==void 0)return a._1?void 0:u.contents.name;throw{RE_EXN_ID:Nt,_1:u.contents.name,Error:new Error};case 16:var t=r._2,o=r._1,i=Ct(n,Gn.typeOfExpr(o),t);if(i.TAG===0){var _=i._0;if(_.TAG!==0)return;if(!_._0.mut)return t;e=o;continue}throw i._0;default:return}}}function z(n,e){for(;;){var r=e;switch(r.TAG|0){case 0:var u=O0(r._0);return u!==void 0?b(m(n),u):void 0;case 1:var a=r._2,t=r._1;if(re.isZeroSizedType(Gn.typeOfExpr(t))){e={TAG:0,_0:{TAG:1,_0:a===9}};continue}var o;switch(a){case 0:o=4;break;case 1:o=5;break;case 2:o=6;break;case 3:o=7;break;case 4:o=43;break;case 5:o=31;break;case 6:o=19;break;case 7:o=37;break;case 8:o=25;break;case 9:o=10;break;case 10:o=14;break}return z(n,t),z(n,r._3),b(m(n),o);case 2:var i;switch(r._1){case 0:throw{RE_EXN_ID:Ae,_1:"u32 negation is not handled",Error:new Error};case 1:i=9;break;case 2:Fa(n),i={TAG:16,_0:0,_1:0};break}return z(n,r._2),b(m(n),i);case 3:var _=r._0;if(re.isZeroSizedType(_.contents.ty))return;var v=Lt(n,_.contents.newName);if(v!==void 0)return v.TAG===0?b(m(n),{TAG:11,_0:v._0}):b(m(n),{TAG:9,_0:v._0});throw{RE_EXN_ID:Nt,_1:_.contents.name,Error:new Error};case 4:var f=r._1,h=r._0;if(re.isZeroSizedType(Gn.typeOfExpr(f)))return;switch(h.TAG|0){case 2:if(h._1>=2){Fa(n),z(n,h._2),z(n,f);var T=re.sizeLog2(Gn.typeOfExpr(f)),C={TAG:17,_0:T,_1:0};return b(m(n),C)}throw{RE_EXN_ID:Ae,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error};case 3:var V=h._0,Q=Lt(n,V.contents.newName);if(Q!==void 0){if(Q._1){var Fn;return Fn=Q.TAG===0?{TAG:12,_0:Q._0}:{TAG:10,_0:Q._0},z(n,f),b(m(n),Fn)}throw{RE_EXN_ID:Ce,_1:V.contents.name,Error:new Error}}throw{RE_EXN_ID:Nt,_1:V.contents.name,Error:new Error};case 16:var gn=h._2,ln=h._1,vn=Ct(n,Gn.typeOfExpr(ln),gn);if(vn.TAG===0){var mn=vn._0;if(mn.TAG===0){var rn=mn._0;if(!rn.mut)throw{RE_EXN_ID:Ce,_1:gn,Error:new Error};var hn=Ut(n,ln);if(hn!==void 0)throw{RE_EXN_ID:Ce,_1:hn,Error:new Error};return rn.size>0?(z(n,ln),z(n,f),b(m(n),{TAG:17,_0:0,_1:rn.offset})):void 0}throw{RE_EXN_ID:Ae,_1:"cannot reassign "+gn+" for type "+k(Gn.typeOfExpr(ln)),Error:new Error}}throw vn._0;default:throw{RE_EXN_ID:Ae,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error}}case 5:var Ln=Da(n),un=gr(n,Ln,s(r._1,function($){return[$,!1]}),r._2);return b(m(n),{TAG:0,_0:un});case 6:var P=r._3,Cn=r._2.contents;re.isZeroSizedType(Gn.typeOfExpr(P))||(z(n,P),$0(n,Cn.name,Cn.ty,r._1)),e=r._4;continue;case 7:var bn=Da(n);r._1.contents.newName=bn.contents.name,gr(n,bn,s(r._2,function($){return[$,!1]}),r._3),e=r._4;continue;case 8:var _n=r._2,J=r._1,Un=function($,Dn){return function(En){An(Dn,function(rt){return z(n,rt)});var Xn=Gn.typeOfExpr($),Hn=Sa(Xn),Qn=ee.getOrAddSignature(n.mod,Hn);return z(n,$),b(m(n),{TAG:15,_0:Qn,_1:0})}}(J,_n),zn=function($){return function(Nn,En){var Xn=En!==void 0?I([En],$):$;return An(Ne(Xn,Nn.params),function(Hn){var Qn=Hn[1];if(!!(Qn[2]&&Ht(Qn[1])&&Pt(Ut(n,Hn[0]))))throw{RE_EXN_ID:Ce,_1:Qn[0],Error:new Error}})}}(_n);switch(J.TAG|0){case 3:var ue=J._0,Ge=Lt(n,ue.contents.newName);if(Ge!==void 0)return Un(void 0);var Kn=Gr(n,ue.contents.newName);if(Kn!==void 0)return zn(Kn[0],void 0),An(_n,function($){return z(n,$)}),b(m(n),{TAG:14,_0:Kn[1]});throw{RE_EXN_ID:Ga,_1:ue.contents.name,Error:new Error};case 16:var ge=J._2,$n=J._1,On;if($n.TAG===3){var ae=$n._0.contents.name,$e=Wn(ae);if($e!==void 0){var Qe=Gr(n,lr(ae,ge));if(Qe!==void 0)On=[!1,Qe[0],Qe[1]];else throw{RE_EXN_ID:Ae,_1:'static function "'+ge+'" does not exists on struct '+ae,Error:new Error}}else On=[!0,void 0,void 0]}else On=[!0,void 0,void 0];var ye=On[2],Gt=On[1],Ie=On[0],xe;if(Gt!==void 0)xe=Gt;else{var Oe=Ct(n,Gn.typeOfExpr($n),ge);if(Oe.TAG===0){var ke=Oe._0;xe=ke.TAG===0?void 0:ke._0[0]}else throw Oe._0}return an(xe,void 0,function($,Dn){return function(Nn){var En=Dn?$:void 0;return zn(Nn,En)}}($n,Ie)),Ie&&z(n,$n),ye!==void 0?(An(_n,function($){return z(n,$)}),b(m(n),{TAG:14,_0:ye})):Un(void 0);default:return Un(void 0)}case 9:var nt=r._2;return Aa(n,r._3===1),An(r._1,function($){return M0(n,$)}),nt!==void 0&&z(n,nt),U0(n);case 10:var et=r._3,$t=k0(n.mod,r._0);return z(n,r._1),b(m(n),{TAG:4,_0:$t}),z(n,r._2),$r(et,{TAG:0,_0:0})&&(b(m(n),0),z(n,et)),b(m(n),1);case 11:return b(m(n),{TAG:7,_0:0}),b(m(n),{TAG:8,_0:0}),z(n,r._0),b(m(n),9),b(m(n),{TAG:5,_0:1}),z(n,r._1),b(m(n),{TAG:6,_0:0}),b(m(n),1),b(m(n),1);case 12:var tt=r._0;return tt!==void 0&&z(n,tt),b(m(n),2);case 13:var j=r._2,x=r._1;if(!Pn(x,j))switch(x.TAG|0){case 1:switch(x._0){case"Ptr":var he=x._1;if(he.length!==1)throw{RE_EXN_ID:Rn,_1:x,_2:j,Error:new Error};var c=he[0];switch(c.TAG|0){case 1:if(c._0==="u32"){if(c._1.length!==0)throw{RE_EXN_ID:Rn,_1:x,_2:j,Error:new Error};switch(j.TAG|0){case 1:if(j._0==="u32"){if(j._1.length!==0)throw{RE_EXN_ID:Rn,_1:x,_2:j,Error:new Error}}else throw{RE_EXN_ID:Rn,_1:x,_2:j,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:Rn,_1:x,_2:j,Error:new Error}}}else throw{RE_EXN_ID:Rn,_1:x,_2:j,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:Rn,_1:x,_2:j,Error:new Error}}break;case"u32":if(x._1.length!==0)throw{RE_EXN_ID:Rn,_1:x,_2:j,Error:new Error};switch(j.TAG|0){case 1:if(j._0==="Ptr"){if(j._1.length!==1)throw{RE_EXN_ID:Rn,_1:x,_2:j,Error:new Error}}else throw{RE_EXN_ID:Rn,_1:x,_2:j,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:Rn,_1:x,_2:j,Error:new Error}}break;default:throw{RE_EXN_ID:Rn,_1:x,_2:j,Error:new Error}}break;case 0:case 2:throw{RE_EXN_ID:Rn,_1:x,_2:j,Error:new Error}}e=r._0;continue;case 14:return An(r._0,function($){return z(n,$)});case 15:var g=r._1,p=Lr(Wn(r._0)),A=p.size;L0(n,A),An(Ne(p.attributes,g),function($){var Dn=$[0],Nn=Dn.ty;if(Dn.mut&&Ht(Nn)){var En=Ut(n,$[1][1]);if(En!==void 0)throw{RE_EXN_ID:Ce,_1:En,Error:new Error}}if(we(Dn.impl)&&re.size(Nn)>0)return b(m(n),{TAG:9,_0:n.stackTop.index})}),A>0&&b(m(n),{TAG:9,_0:n.stackTop.index});var U={contents:0};return An(g,function($){return function(Dn){var Nn=Dn[1],En=function(Qn){z(n,Nn),b(m(n),{TAG:17,_0:0,_1:$.contents}),$.contents=$.contents+Qn|0},Xn=kn.typeOf(Nn);switch(Xn.TAG|0){case 0:break;case 1:var Hn=0;switch(Xn._0){case"()":if(Xn._1.length===0)return;break;case"Fun":return En(4);case"Ptr":if(Xn._1.length===1)return En(4);break;case"bool":case"u32":Hn=2;break}if(Hn===2&&Xn._1.length===0)return En(4);break;case 2:return dr(Xn._0),En(4)}throw{RE_EXN_ID:Ae,_1:"cannot store "+k(Xn)+" in the shadow stack",Error:new Error}}}(U));case 16:var R=r._1,K=Ct(n,Gn.typeOfExpr(R),r._2);if(K.TAG===0){var W=K._0;if(W.TAG===0){var Mn=W._0;return re.isZeroSizedType(Mn.ty)?void 0:(z(n,R),b(m(n),{TAG:16,_0:0,_1:Mn.offset}))}var Yn=W._0;if(Yn[2]){var Fe=Ut(n,R);if(Fe!==void 0)throw{RE_EXN_ID:Ce,_1:Fe,Error:new Error}}return b(m(n),{TAG:0,_0:Yn[1]})}throw K._0}}}function M0(n,e){var r=e._0;return z(n,r),An(Ue(kn.typeOf(r)),function(u){return b(m(n),3)})}function gr(n,e,r,u){var a=s(r,function(i){var _=i[0];return[_.contents.name,_.contents.ty,i[1]||!Ht(_.contents.ty)]}),t=Tr(e.contents.newName,a,kn.typeOf(u)),o=n.funcs.push(t)-1|0;return ot(n.funcStack,t),z(n,u),b(m(n),1),at(n.funcStack),o}function X0(n,e){var r=Tr("__isolated__",[],Gn.typeOfExpr(e));return ot(n.funcStack,r),z(n,e),at(n.funcStack),r}function Na(n,e){switch(e.TAG|0){case 0:gr(n,e._0,e._1,e._2);return;case 1:var r=e._1,u=e._0;Aa(n,!1);var a=X0(n,e._2),t=a.instructions;if(t.length===1){var o=t[0];if(typeof o!="number"&&o.TAG===0){ka(n,u.contents.name,r?1:2,0,G(_t.Initializer.fromInstructions,[{TAG:0,_0:o._0}]));return}}io(n.globalsInitializer.instructions,"push",[t]);var i=ka(n,u.contents.name,r?1:0,0,G(_t.Initializer.fromInstructions,[{TAG:0,_0:0}]));n.globalsInitializer.instructions.push({TAG:10,_0:i});return;case 2:return;case 3:return An(e._1,function(_){return Na(n,{TAG:0,_0:_[0],_1:_[1],_2:_[2]})})}}function V0(n){var e={mod:ee.make(void 0),funcs:[],scopeDepth:0,funcStack:qt(),globals:Fr(1),globalsInitializer:Tr("__initGlobals__",[],Se),stackTop:ma("__STACK_TOP__",1,0,0,G(_t.Initializer.fromInstructions,[{TAG:0,_0:65535}])),blockStack:qt()};Bt(e.globals,e.stackTop.name,e.stackTop);try{An(n,function(o){return Na(e,o)}),ee.addMemory(e.mod,Au.make(Kt.make(6,void 0))),An(oo(Ur(e.globals),function(o,i){return o.index-i.index|0}),function(o){var i=R0(o);if(i!==void 0)return ee.addGlobal(e.mod,i)});var r=Tu.fromFuncRefs(0,wr(e.funcs,function(o,i){return o}));ee.addElement(e.mod,r),ee.addTable(e.mod,fu.make(0,Kt.makeExact(e.funcs.length)));var u=e.funcs.length,a=e.globalsInitializer.instructions.length===0;return a||(e.globalsInitializer.instructions.push(1),e.funcs.push(e.globalsInitializer)),An(e.funcs,function(o){o.name==="main"&&!a&&o.instructions.unshift({TAG:14,_0:u});var i=N0(o);ee.addExportedFunc(e.mod,o.name,i[1],i[2])}),{TAG:0,_0:e.mod}}catch(o){var t=Or(o);return{TAG:1,_0:pa(t)}}}function B0(n){try{return F(G0(n),function(r){var u=s(r,ur.from);return F(m0(u),function(a){var t=a[1];ic(t);var o=s(u,function(i){return ur.subst(t,i)});return Y(V0(o),function(i){var _=ee.encodeAsUint8Array(i);return[i,_]})})})}catch(r){var e=Or(r);return{TAG:1,_0:pa(e)}}}var z0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",compile:B0});const N={"0":"I32","1":"I64","2":"F32","3":"F64"},hr={"0":"Else","1":"End","2":"Return","3":"Drop","4":"AddI32","5":"SubI32","6":"MulI32","7":"DivI32Unsigned","8":"DivI32Signed","9":"EqzI32","10":"EqI32","11":"EqI64","12":"EqF32","13":"EqF64","14":"NeI32","15":"NeI64","16":"NeF32","17":"NeF64","18":"LeI32Signed","19":"LeI32Unsigned","20":"LeI64Signed","21":"LeI64Unsigned","22":"LeF32","23":"LeF64","24":"GeI32Signed","25":"GeI32Unsigned","26":"GeI64Signed","27":"GeI64Unsigned","28":"GeF32","29":"GeF64","30":"LtI32Signed","31":"LtI32Unsigned","32":"LtI64Signed","33":"LtI64Unsigned","34":"LtF32","35":"LtF64","36":"GtI32Signed","37":"GtI32Unsigned","38":"GtI64Signed","39":"GtI64Unsigned","40":"GtF32","41":"GtF64","42":"RemI32Signed","43":"RemI32Unsigned","44":"And"},P0={"0":"FuncRef","1":"ExternRef"},j0={"0":"Func","1":"Table","2":"Memory","3":"Global"},Te={"0":"Void"},q0=z0,Ra=function(n){const e=q0.compile(n);return e.TAG===0?{tag:"Ok",value:[{typeSection:e._0[0].typeSection.map(function(u){return[u._0.map(function(t){return N[t]}),u._1.map(function(t){return N[t]})]}),funcSection:e._0[0].funcSection,tableSection:e._0[0].tableSection.map(function(u){return[P0[u[0]],u[1]]}),memorySection:e._0[0].memorySection,globalSection:e._0[0].globalSection.map(function(u){return[N[u[0]],u[1],u[2].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:N[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return N[i]}),t._0._1[1].map(function(i){return N[i]})]]}:Te[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:N[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return N[i]}),t._0._1[1].map(function(i){return N[i]})]]}:Te[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:N[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return N[i]}),t._0._1[1].map(function(i){return N[i]})]]}:Te[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:{tag:"StoreI32",value:[t._0,t._1]}:hr[t]})]}),exportSection:e._0[0].exportSection.map(function(u){return{name:u.name,kind:j0[u.kind],index:u.index}}),elementSection:e._0[0].elementSection,codeSection:e._0[0].codeSection.map(function(u){return[u[0].map(function(t){return[t[0],N[t[1]]]}),u[1].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:N[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return N[i]}),t._0._1[1].map(function(i){return N[i]})]]}:Te[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:N[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return N[i]}),t._0._1[1].map(function(i){return N[i]})]]}:Te[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:N[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return N[i]}),t._0._1[1].map(function(i){return N[i]})]]}:Te[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:{tag:"StoreI32",value:[t._0,t._1]}:hr[t]})]}),funcs:e._0[0].funcs.map(function(u){return[u[0],[u[1]._0.map(function(t){return N[t]}),u[1]._1.map(function(t){return N[t]})],[u[2][0].map(function(t){return[t[0],N[t[1]]]}),u[2][1].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:N[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return N[i]}),t._0._1[1].map(function(i){return N[i]})]]}:Te[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:N[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return N[i]}),t._0._1[1].map(function(i){return N[i]})]]}:Te[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:N[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return N[i]}),t._0._1[1].map(function(i){return N[i]})]]}:Te[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:{tag:"StoreI32",value:[t._0,t._1]}:hr[t]})]]}),importsCount:e._0[0].importsCount},e._0[1]]}:{tag:"Error",value:e._0}};var Z0=`
let SIZEOF_U32 = 4;

struct Array {
  start: Ptr<u32>,
  mut length: u32,
}

impl Array {
  fn read(self, n) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>)
  }

  fn write(self, n, val) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>) = val;
  }

  fn push(mut self, val) {
    self.write(self.length, val);
    self.length = self.length + 1;
  }
}

struct Sieve {
  mut primes: Array,
  mut current: u32
}

impl Sieve {
  fn clear(mut self) {
    self.primes.length = 0;
    // 2 is the first prime
    self.primes.push(2);
    self.current = 1;
  }

  fn isPrime(mut self, n) {
    mut i = 0;
    mut p = self.primes.read(i);

    while p * p <= n {
      if n % p == 0 { return false; }
      i = i + 1;
      p = self.primes.read(i);
    }

    // n is prime
    // add it to the sieve
    self.primes.push(n);

    true
  }

  fn nextPrime(mut self) {
    self.current = self.current + 2;

    while !self.isPrime(self.current) {
      self.current = self.current + 2;
    }

    self.current
  }

  // count the prime numbers <= m
  fn countUpTo(mut self, m) {
    self.clear();

    while self.current <= m {
      self.nextPrime();
    }

    self.primes.length - 1
  }
}

// right after the shadow stack
let PRIMES_START = 64 * 1024;

fn main() {
  mut sieve = Sieve {
    primes: Array {
      start: PRIMES_START as Ptr<u32>,
      length: 0
    },
    current: 0
  };

  sieve.countUpTo(1000000)
}`,W0=`
fn fact(n) {
  let aux = (n, acc) -> if n == 0 { acc } else { aux(n - 1, n * acc) };
  aux(n, 1)
}

fn main() {
  fact(11)
}`,J0=`
fn fib(n) {
  let fib_aux = (n, a, b) -> {
    if n == 0 { return a; }
    if n == 1 { return b; }
    fib_aux(n - 1, b, a + b)
  };

  fib_aux(n, 0, 1)
}

fn main() {
  fib(83)
}`,K0=`
let SIZEOF_U32 = 4;

fn read_u32(addr) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>)
}

fn write_u32(addr, val) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>) = val;
}

fn main() {
  let square = n -> n * n;

  mut i = 0;
  while i < 100 {
    write_u32(i, square(i));
    i = i + 1;
  }

  read_u32(42) // 1764
}`,Y0=`
fn isEven(n) {
  n % 2 == 0
}

fn isPrime(n) {
  if n < 2 { return false; }
  if n == 2 { return true; }
  if isEven(n) { return false; }

  mut i = 3;

  while i * i <= n {
    if n % i == 0 { return false; }
    i = i + 2;
  }

  true
}

fn countPrimesLessThan(m) {
  mut i = m;
  mut count = 0;

  while i > 1 {
    if isPrime(i) {
      count = count + 1;
    }

    i = i - 1;
  }

  count
}

fn main() {
  countPrimesLessThan(1000000)
}`,H0=`
struct MinMax {
  mut min: u32,
  mut max: u32
}

impl MinMax {
  fn reset(mut self) {
    self.min = 0;
    self.max = 0;
  }

  fn resetStatic(mut m) {
    m.reset();
  }
}

fn main() {
  mut m = MinMax {
    min: 17,
    max: 22
  };

  MinMax.resetStatic(m);
  
  m.min + m.max == 0
}`,Q0=`
fn main() {
  let twice = (f, x) -> f(f(x));
  
  twice(n -> n * n, 7)
}`,y0=`
struct BumpAllocator {
  mut head: u32
}

impl BumpAllocator {
  fn allocate(mut self, bytes) {
    let addr = self.head as Ptr<u32>;
    self.head = self.head + bytes;
    addr
  }
  
  // do nothing!
  fn free(mut self, addr) { }
}

mut allocator = BumpAllocator { head: 64 * 1024 };

let SIZEOF_U32 = 4;

struct Vec {
  mut start: Ptr<u32>,
  mut length: u32,
  mut capacity: u32 
}

impl Vec {
  fn read(self, index) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>)
  }

  fn write(mut self, index, value) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>) = value;
  }

  fn grow(mut self) unsafe {
    let newCap = if self.capacity == 0 { 8 } else { self.capacity * 2 };
    let newStart = allocator.allocate(newCap * SIZEOF_U32);

    // copy the data from the old array to the new one
    mut i = 0;
    while i < self.length {
      *(((newStart as u32) + (i * SIZEOF_U32)) as Ptr<u32>) = self.read(i);
      i = i + 1;
    }

    allocator.free(self.start);
    self.start = newStart;
    self.capacity = newCap;
  }

  fn push(mut self, val) unsafe {
    if self.length + 1 > self.capacity {
      self.grow();
    }

    self.write(self.length, val);
    self.length = self.length + 1;
  }

  fn pop(mut self) unsafe {
    if self.length > 0 {
      self.length = self.length - 1;
      self.read(self.length)
    } else {
      // until we have Option<T>
      4294967295 // -1
    }
  }
}

fn main() {
  mut vec = Vec {
    start: 0 as Ptr<u32>,
    length: 0,
    capacity: 0
  };

  mut i = 0;
  while i < 1000 {
    vec.push(i);
    i = i + 1;
  }

  (vec.length, vec.capacity, vec.read(723))
}`,I0=`
fn digitsSquareSum(n) {
  let square = n -> n * n;
  mut sum = 0;

  while n > 0 {
    sum = sum + square(n % 10);
    n = n / 10;
  }

  sum
}

fn reaches89(n) {
  while n != 1 {
    if n == 89 { return true; }
    n = digitsSquareSum(n);
  }

  false
}

fn main() {
  mut i = 1;
  mut count = 0;
  while i < 10000000 {
    if reaches89(i) {
      count = count + 1;
    }

    i = i + 1;
  }

  count
}`;const x0={"Prime sieve":Z0,Factorial:W0,Fibonacci:J0,Pointers:K0,Primes:Y0,Structs:H0,"Lambda (kind of)":Q0,Vector:y0,"Project Euler 92":I0},nf=async n=>{const e=await WebAssembly.compile(n),r=await WebAssembly.instantiate(e);return"main"in r.exports?r.exports.main():"Error: main function not found, exported functions are: "+Object.keys(r.exports).join(", ")},ef={Run:async(n,e)=>{e("running...");try{const r=Ra(n);if(r.tag==="Ok"){const u=await nf(r.value[1]);e(`${u}`)}else e(r.value)}catch(r){e(`${r}`)}},Disassemble:(n,e)=>{try{const r=Ra(n);if(r.tag==="Ok"){const[u]=r.value;e(ki(u))}else e(r.value)}catch(r){e(`${r}`)}}},tf=()=>Et.createElement(_o,{actions:ef,samples:x0,aceMode:"rust"});fo.render(Et.createElement(Et.StrictMode,null,Et.createElement(tf,null)),document.getElementById("root"));
