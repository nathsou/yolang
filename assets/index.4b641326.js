import{c as tn,a as cn,j as w,r as Oo,m as Tn,g as je,b as ot,d as l,z as Ze,k as Or,e as au,f as wr,t as ir,h as zo,i as ou,l as Mn,n as iu,o as he,_ as T,p as Ee,s as N,v as On,q as K,u as cu,w as Vo,x as Bo,y as it,A as _u,B as fu,C as wn,D as ct,E as Gn,F as Po,G as qo,H as su,I as _t,J as jo,K as Zo,L as Wo,M as We,N as Jo,O as Ko,P as Yo,Q as Ho,R as lu,S as kn,T as Qo,U as vu,V as Io,W as ft,X as du,Y as yo,Z as In,$ as xo,a0 as ni,a1 as se,a2 as Tu,a3 as zr,a4 as Gu,a5 as st,a6 as gu,a7 as ei,a8 as Vr,a9 as ri,aa as ti,ab as ui,ac as F,ad as ai,ae as oi,af as hu,ag as ii,ah as lt,ai as ci,aj as Eu,ak as _i,al as fi,am as Q,an as si,ao as mr,ap as Br,aq as Re,ar as Fe,as as Au,at as li,au as Sr,av as vt,aw as vi,ax as di,ay as Ti,az as Pr,aA as Gi,aB as gi}from"./vendor.708cc860.js";const hi=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))u(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function u(a){if(a.ep)return;a.ep=!0;const r=t(a);fetch(a.href,r)}};hi();function fn(n){var e=[],t=function(u){for(;;){var a=u,r=a&127,o=a>>>7;if(o!==0){e.push(r|128),u=o;continue}e.push(r);return}};return t(n),e}function qr(n){var e=[],t=function(u){for(;;){var a=u,r=a&127,o=a>>7;if(o===0&&(r&64)==0||o===-1&&(r&64)!=0){e.push(r);return}e.push(r|128),u=o}};return t(n|0),e}function $e(n){return tn(fn(n.length),n)}function jn(n){return tn(fn(n.length),cn(n))}var Ei={encode:$e,encodeMany:jn},Ai=qr,wi={encode:Ai},mi=qr,Si={encode:mi};function wu(n){var e=new DataView(new ArrayBuffer(4));return e.setFloat32(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3)]}var pi={encode:wu};function mu(n){var e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3),e.getUint8(4),e.getUint8(5),e.getUint8(6),e.getUint8(7)]}var bi={encode:mu};function ki(n){return n}function yn(n,e){return tn([n],$e(e))}function xn(n){var e;switch(n){case 0:e="custom";break;case 1:e="type";break;case 2:e="import";break;case 3:e="function";break;case 4:e="table";break;case 5:e="memory";break;case 6:e="global";break;case 7:e="export";break;case 8:e="start";break;case 9:e="element";break;case 10:e="code";break;case 11:e="data";break}return"["+e+"]"}var Di={id:ki,encode:yn,show:xn};function cr(n){switch(n){case 0:return 127;case 1:return 126;case 2:return 125;case 3:return 124}}function _r(n){switch(n){case 0:return"i32";case 1:return"i64";case 2:return"f32";case 3:return"f64"}}var Ni={encode:cr,show:_r};function Su(n){return typeof n=="number"?[64]:n.TAG===0?[cr(n._0)]:fn(n._0)}function Ri(n){return typeof n=="number"?"void":n.TAG===0?_r(n._0):"type "+String(n._0)}var Fi={encode:Su,show:Ri};function dt(n){if(typeof n=="number")switch(n){case 0:return[[5],"else"];case 1:return[[11],"end"];case 2:return[[15],"return"];case 3:return[[26],"drop"];case 4:return[[106],"i32.add"];case 5:return[[107],"i32.sub"];case 6:return[[108],"i32.mul"];case 7:return[[110],"i32.div_s"];case 8:return[[109],"i32.div_u"];case 9:return[[69],"i32.eqz"];case 10:return[[70],"i32.eq"];case 11:return[[81],"i64.eq"];case 12:return[[91],"f32.eq"];case 13:return[[97],"f64.eq"];case 14:return[[71],"i32.ne"];case 15:return[[82],"i64.ne"];case 16:return[[92],"f32.ne"];case 17:return[[98],"f64.ne"];case 18:return[[76],"i32.le_s"];case 19:return[[77],"i32.le_u"];case 20:return[[87],"i64.le_s"];case 21:return[[88],"i64.le_u"];case 22:return[[95],"f32.le"];case 23:return[[101],"f64.le"];case 24:return[[78],"i32.ge_s"];case 25:return[[79],"i32.ge_u"];case 26:return[[89],"i64.ge_s"];case 27:return[[90],"i64.ge_u"];case 28:return[[96],"f32.ge"];case 29:return[[102],"f64.ge"];case 30:return[[72],"i32.lt_s"];case 31:return[[73],"i32.lt_u"];case 32:return[[83],"i64.lt_s"];case 33:return[[84],"i64.lt_u"];case 34:return[[93],"f32.lt"];case 35:return[[99],"f64.lt"];case 36:return[[74],"i32.gt_s"];case 37:return[[75],"i32.gt_u"];case 38:return[[85],"i64.gt_s"];case 39:return[[86],"i64.gt_u"];case 40:return[[94],"f32.gt"];case 41:return[[100],"f64.gt"];case 42:return[[111],"i32.rem_s"];case 43:return[[112],"i32.rem_u"];case 44:return[[113],"i32.and"];case 45:return[[114],"i32.or"];case 46:return[[116],"i32.shl"];case 47:return[[117],"i32.shr_s"];case 48:return[[118],"i32.shr_u"]}else switch(n.TAG|0){case 0:return[[65],"i32.const "+String(n._0)];case 1:return[[66],"i64.const "+String(n._0)];case 2:return[[67],"i64.const "+String(n._0)];case 3:return[[68],"i64.const "+String(n._0)];case 4:return[[4],"if"];case 5:return[[13],"br_if "+String(n._0)];case 6:return[[12],"br "+String(n._0)];case 7:return[[2],"block"];case 8:return[[3],"loop"];case 9:return[[35],"global.get "+String(n._0)];case 10:return[[36],"global.set "+String(n._0)];case 11:return[[32],"local.get "+String(n._0)];case 12:return[[33],"local.set "+String(n._0)];case 13:return[[34],"local.tee "+String(n._0)];case 14:return[[16],"call "+String(n._0)];case 15:return[[17],"call_indirect [typeIndex="+String(n._0)+", tableIndex="+String(n._1)+"]"];case 16:return[[40],"i32.load (alignment="+String(n._0)+", offset="+String(n._1)+")"];case 17:return[[54],"i32.store (alignment="+String(n._0)+", offset="+String(n._1)+")"];case 18:return[[252,8],"memory.init "+String(n._0)];case 19:return[[252,9],"data.drop "+String(n._0)]}}function ne(n){return dt(n)[0]}function pu(n){if(typeof n=="number")switch(n){case 0:case 1:return-1;default:return 0}else switch(n.TAG|0){case 4:case 7:case 8:return 1;default:return 0}}function jr(n,e,t,u){var a=n!==void 0?n:{contents:0},r=dt(e),o=pu(e),i=w(Oo(0,a.contents+(o<0?o:0)|0),"  ",function(f){return""});a.contents=a.contents+o|0,e===0&&(a.contents=a.contents+1|0);var c,_=0;if(typeof e=="number")c="";else switch(e.TAG|0){case 11:case 12:case 13:_=1;break;case 14:c="<"+Tn(je(t,e._0),"??",function(f){return f})+">";break;default:c=""}return _===1&&(c="<"+Tn(je(u,e._0),"??",function(f){return f})+">"),i+r[1]+" "+c}function le(n){var e=0;if(typeof n=="number")return ne(n);switch(n.TAG|0){case 0:case 1:return tn(ne(n),qr(n._0));case 2:return tn(ne(n),wu(n._0));case 3:return tn(ne(n),mu(n._0));case 4:case 7:case 8:e=1;break;case 9:case 10:case 11:case 12:case 13:e=2;break;case 15:return cn([ne(n),fn(n._0),fn(n._1)]);case 16:case 17:e=3;break;case 18:return cn([ne(n),fn(n._0),[0]]);case 5:case 6:case 14:case 19:return tn(ne(n),fn(n._0))}switch(e){case 1:return tn(ne(n),Su(n._0));case 2:return tn(ne(n),fn(n._0));case 3:return cn([ne(n),fn(n._0),fn(n._1)])}}var $i={info:dt,opcode:ne,identationDelta:pu,show:jr,encode:le};function Xi(n,e){return{_0:n,_1:e}}var Li=[],Ci=[],Ui={_0:Li,_1:Ci};function bu(n){return cn([[96],$e(l(n._0,cr)),$e(l(n._1,cr))])}function ku(n){var e=n._1,t=n._0,u=w(t,", ",_r),a=w(e,", ",_r);if(t.length===1){var r=e.length;if(r===1)return u+" -> "+a;if(r===0)return u+" -> ()"}var o=e.length;return o!==1?o!==0?"("+u+") -> ("+a+")":"("+u+") -> ()":"("+u+") -> "+a}var Mi={funcTypeCode:96,make:Xi,empty:Ui,encode:bu,show:ku};function Oi(n){var e=function(u,a){for(;;){var r=a,o=u;if(!o)return r;var i=o.tl,c=o.hd,_=c[1],f=c[0];if(r){var d=r.tl,R=r.hd,B=R[1],b=R[0];if(Mn(_,B)){a={hd:[{hd:f,tl:b},B],tl:d},u=i;continue}a={hd:[{hd:f,tl:0},_],tl:{hd:[b,B],tl:d}},u=i;continue}a={hd:[{hd:f,tl:0},_],tl:0},u=i}},t=au(e(wr(n),0));return ir(zo(t,function(u){return[iu(ir(u[0])),u[1]]}))}function Du(n){return tn(fn(n[0].length),[cr(n[1])])}function Nu(n){return"local ["+w(n[0],", ",function(e){return e})+"] "+_r(n[1])}var zi={fromTypes:Oi,encode:Du,show:Nu};function Vi(n,e){return[n,e]}function Ru(n){var e=jn(l(n[0],Du)),t=cn(l(n[1],le));return cn([[e.length+t.length|0],e,t])}function Fu(n,e,t){var u=n[0],a={contents:1},r=ou(t._0,function(_,f){return"param["+String(_)+"]"}),o=tn(r,cn(l(u,function(_){return _[0]}))),i=w(u,`
`,Nu),c=w(n[1],`
`,function(_){return jr(a,_,e,o)});return u.length===0?c:i+`
`+c}var Bi={make:Vi,encode:Ru,show:Fu};function Pi(n,e,t){return[n,e,t]}var pr={Signature:Mi,Local:zi,Body:Bi,make:Pi};function qi(n){return[]}function Tt(n,e){var t=ot(n,function(u){return Mn(u,e)});return t!==void 0?t:(n.push(e),n.length-1|0)}function $u(n){return yn(1,jn(l(n,bu)))}function Xu(n){return xn(1)+`
`+w(n,`
`,ku)}var ji={make:qi,getOrAdd:Tt,encode:$u,show:Xu};function Zi(n){return[]}function Lu(n,e){return n.push(e),n.length-1|0}function Cu(n){return yn(3,jn(l(n,fn)))}function Uu(n,e){return xn(3)+`
`+w(Ze(n,e),`
`,function(t){return t[1]+": "+String(t[0])})}var Wi={make:Zi,addSignature:Lu,encode:Cu,show:Uu};function Zr(n){return $e(l(n.split(""),function(e){return e.charCodeAt(0)|0}))}var Ji={encode:Zr};function Ki(n){return[n]}function Mu(n){switch(n){case 0:return"func";case 1:return"table";case 2:return"memory";case 3:return"global"}}var Yi={encode:Ki,show:Mu};function Hi(n,e,t){return{name:n,kind:e,index:t}}function Ou(n){return cn([Zr(n.name),[n.kind],fn(n.index)])}function zu(n){return"export "+Mu(n.kind)+" "+n.name+" (index: "+String(n.index)+")"}var Vu={ExternalKind:Yi,make:Hi,encode:Ou,show:zu};function Qi(n){return[]}function Ii(n,e){n.push(e)}function Bu(n){return yn(7,jn(l(n,Ou)))}function Pu(n){return xn(7)+`
`+w(n,`
`,zu)}var yi={make:Qi,add:Ii,encode:Bu,show:Pu};function xi(n){return n?"externref":"funcref"}function nc(n){return n?111:112}var ec={show:xi,encode:nc};function Gt(n){return"{ min: "+String(n[0])+", max: "+Tn(n[1],"?",function(e){return String(e)})+" }"}function rc(n,e){return[n,e]}function tc(n){return[n,n]}function Wr(n){var e=n[1],t=n[0];return e!==void 0?cn([[1],fn(t),fn(e)]):tn([0],fn(t))}var gt={show:Gt,make:rc,makeExact:tc,encode:Wr};function uc(n,e){return[n,e]}function qu(n){return tn([n[0]?111:112],Wr(n[1]))}function ju(n){return"table "+(n[0]?"externref":"funcref")+" "+Gt(n[1])}var Zu={make:uc,encode:qu,show:ju};function ac(n){return[]}function oc(n,e){n.push(e)}function Wu(n){return xn(4)+`
`+w(n,`
`,ju)}function Ju(n){return yn(4,jn(l(n,qu)))}var ic={make:ac,add:oc,show:Wu,encode:Ju};function cc(n,e){var t=n!==void 0?n:0;return{offset:t,funcIndices:e}}function Ku(n){return"elem funcref ("+w(n.funcIndices," ",function(e){return String(e)})+") (offset="+String(n.offset)+")"}function Yu(n){return cn([[0],le({TAG:0,_0:n.offset}),le(1),jn(l(n.funcIndices,fn))])}var Hu={fromFuncRefs:cc,show:Ku,encode:Yu};function _c(n){return[]}function fc(n,e){n.push(e)}function Qu(n){return xn(9)+`
`+w(n,`
`,Ku)}function Iu(n){return yn(9,jn(l(n,Yu)))}var sc={make:_c,add:fc,show:Qu,encode:Iu};function lc(n){return n}function yu(n){return tn(cn(l(n,le)),le(1))}function xu(n){if(n.length!==1)return`
`+w(n,`
`,function(t){return"  "+jr(void 0,t,[],[])})+`
end`;var e=n[0];return jr(void 0,e,[],[])}var vc={fromInstructions:lc,encode:yu,show:xu};function dc(n,e,t){return[e,n,t]}function na(n){return"global "+(n[1]?"mutable":"immutable")+" "+_r(n[0])+" = "+xu(n[2])}function ea(n){return tn([cr(n[0]),n[1]?1:0],yu(n[2]))}var br={Initializer:vc,make:dc,show:na,encode:ea};function Tc(n){return[]}function Gc(n,e){n.push(e)}function ra(n){return xn(6)+`
`+w(n,`
`,na)}function ta(n){return yn(6,jn(l(n,ea)))}var gc={make:Tc,add:Gc,show:ra,encode:ta};function hc(n){return n}function ua(n){return"memory "+Gt(n)}var aa={make:hc,show:ua,encode:Wr};function Ec(n){return[]}function oa(n,e){return n.push(e)-1|0}function ia(n){return xn(5)+`
`+w(n,`
`,ua)}function ca(n){return yn(5,jn(l(n,Wr)))}var Ac={make:Ec,add:oa,show:ia,encode:ca},wc={};function _a(n){return cn([[0],fn(n._0)])}function fa(n){return"func (index: "+String(n._0)+")"}var mc={make:void 0,encode:_a,show:fa};function sa(n){return cn([Zr(n.moduleName),Zr(n.entityName),_a(n.desc)])}function Sc(n,e,t){return{moduleName:n,entityName:e,desc:t}}function la(n){return"import "+fa(n.desc)+" "+n.moduleName+"."+n.entityName}var va={ImportDesc:mc,encode:sa,make:Sc,show:la};function pc(n){return[]}function da(n,e){return n.push(e)-1|0}function Ta(n){return yn(2,jn(l(n,sa)))}function Ga(n){return xn(2)+`
`+w(n,`
`,la)}function bc(n){return n.length}var kc={make:pc,add:da,encode:Ta,show:Ga,count:bc};function Dc(n){return[]}function ga(n,e){return n.push(e),n.length-1|0}function ha(n){return yn(10,jn(l(n,Ru)))}function Ea(n,e,t){var u=l(Or(e,function(r){return!0}),function(r){return r.entityName}),a=tn(u,l(t,function(r){return r[0]}));return xn(10)+`
`+w(Ze(n,t),`

`,function(r){var o=r[1];return o[0]+`
`+Fu(r[0],a,o[1])})}var Nc={make:Dc,addFunc:ga,encode:ha,show:Ea};function Aa(n){return n?"active memIndex: "+String(n._0)+" offset: "+String(n._1):"passive"}var Rc={show:Aa};function Fc(n,e){return{init:n,mode:e}}function wa(n){return"segment len: "+String(n.init.length)+" mode: "+Aa(n.mode)}function ma(n){var e=n.mode,t=n.init;if(!e)return tn([1],$e(t));var u=e._0;return u!==0?cn([[2],fn(u),le({TAG:0,_0:e._1}),le(1),$e(t)]):cn([[0],le({TAG:0,_0:e._1}),le(1),$e(t)])}var $c={make:Fc,show:wa,encode:ma};function Xc(n){return[]}function Sa(n,e){return n.push(e)-1|0}function pa(n){return xn(11)+`
`+w(n,`

`,wa)}function ba(n){return yn(11,jn(l(n,ma)))}var Lc={make:Xc,add:Sa,show:pa,encode:ba},ka={Mode:Rc,Segment:$c,Section:Lc};function Cc(n){return{typeSection:[],importSection:[],funcSection:[],tableSection:[],memorySection:[],globalSection:[],exportSection:[],elementSection:[],codeSection:[],dataSection:[],funcs:[]}}function Uc(n,e){return Tt(n.typeSection,e)}function Da(n,e,t,u){var a=Tt(n.typeSection,t);return Lu(n.funcSection,a),n.funcs.push([e,t,u]),ga(n.codeSection,u)+n.importSection.length|0}function Mc(n,e,t,u){var a=Da(n,e,t,u),r={name:e,kind:0,index:a};return n.exportSection.push(r),a}function Oc(n,e){n.exportSection.push(e)}function zc(n,e){n.tableSection.push(e)}function Vc(n,e){n.elementSection.push(e)}function Bc(n,e){n.globalSection.push(e)}function Pc(n,e){return oa(n.memorySection,e)}function qc(n,e){return da(n.importSection,e)}function jc(n,e){return Sa(n.dataSection,e)}function Na(n){return cn([[0,97,115,109,1,0,0,0],$u(n.typeSection),Ta(n.importSection),Cu(n.funcSection),Ju(n.tableSection),ca(n.memorySection),ta(n.globalSection),Bu(n.exportSection),Iu(n.elementSection),ha(n.codeSection),ba(n.dataSection)])}function Zc(n){return(e=>Uint8Array.from(e))(Na(n))}function Wc(n){return w([Xu(n.typeSection),Ga(n.importSection),Uu(n.funcSection,l(n.funcs,function(e){return e[0]})),Wu(n.tableSection),ia(n.memorySection),ra(n.globalSection),Pu(n.exportSection),Qu(n.elementSection),Ea(n.codeSection,n.importSection,n.funcs),pa(n.dataSection)],`

`,function(e){return e})}var zn={make:Cc,getOrAddSignature:Uc,addFunc:Da,addExportedFunc:Mc,addExport:Oc,addTable:zc,addElement:Vc,addGlobal:Bc,addMemory:Pc,addImport:qc,addData:jc,encode:Na,encodeAsUint8Array:Zc,show:Wc},Jc=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uleb128:fn,sleb128:qr,Vec:Ei,I32:wi,I64:Si,F32:pi,F64:bi,Section:Di,ValueType:Ni,BlockReturnType:Fi,Inst:$i,Func:pr,TypeSection:ji,FuncSection:Wi,Str:Ji,ExportEntry:Vu,ExportSection:yi,ReferenceType:ec,Limits:gt,Table:Zu,TableSection:ic,Elem:Hu,ElementSection:sc,Global:br,GlobalSection:gc,Memory:aa,MemorySection:Ac,Import:wc,ImportEntry:va,ImportSection:kc,CodeSection:Nc,Data:ka,Module:zn});const ht={Else:0,End:1,Return:2,Drop:3,AddI32:4,SubI32:5,MulI32:6,DivI32Unsigned:7,DivI32Signed:8,EqzI32:9,EqI32:10,EqI64:11,EqF32:12,EqF64:13,NeI32:14,NeI64:15,NeF32:16,NeF64:17,LeI32Signed:18,LeI32Unsigned:19,LeI64Signed:20,LeI64Unsigned:21,LeF32:22,LeF64:23,GeI32Signed:24,GeI32Unsigned:25,GeI64Signed:26,GeI64Unsigned:27,GeF32:28,GeF64:29,LtI32Signed:30,LtI32Unsigned:31,LtI64Signed:32,LtI64Unsigned:33,LtF32:34,LtF64:35,GtI32Signed:36,GtI32Unsigned:37,GtI64Signed:38,GtI64Unsigned:39,GtF32:40,GtF64:41,RemI32Signed:42,RemI32Unsigned:43,AndI32:44,OrI32:45,ShlI32:46,ShrI32Signed:47,ShrI32Unsigned:48},Ra={"0":"I32","1":"I64","2":"F32","3":"F64"},C={I32:0,I64:1,F32:2,F64:3},Kc={FuncRef:0,ExternRef:1},Yc={Func:0,Table:1,Memory:2,Global:3},Ae={Void:0},Hc={Passive:0},Z=Jc;Z.uleb128;Z.sleb128;Z.Vec.encode;Z.Vec.encodeMany;Z.I32.encode;Z.I64.encode;Z.F32.encode;Z.F64.encode;Z.Func.Signature.funcTypeCode;Z.Func.Signature.empty._0.map(function(e){return Ra[e]}),Z.Func.Signature.empty._1.map(function(e){return Ra[e]});Z.FuncSection.make;Z.FuncSection.encode;Z.Str.encode;Z.Limits.makeExact;Z.Elem.show;Z.Elem.encode;Z.ElementSection.make;Z.ElementSection.show;Z.ElementSection.encode;Z.MemorySection.make;Z.ImportEntry.ImportDesc.make;const Qc=function(n){return Z.Module.show({typeSection:n.typeSection.map(function(u){return{TAG:0,_0:u[0].map(function(r){return C[r]}),_1:u[1].map(function(r){return C[r]})}}),importSection:n.importSection.map(function(u){return{moduleName:u.moduleName,entityName:u.entityName,desc:{TAG:0,_0:u.desc.value}}}),funcSection:n.funcSection,tableSection:n.tableSection.map(function(u){return[Kc[u[0]],[u[1][0],u[1][1]==null?void 0:u[1][1]]]}),memorySection:n.memorySection.map(function(u){return[u[0],u[1]==null?void 0:u[1]]}),globalSection:n.globalSection.map(function(u){return[C[u[0]],u[1],u[2].map(function(r){return typeof r=="object"?r.tag==="ConstI32"?{TAG:0,_0:r.value}:r.tag==="ConstI64"?{TAG:1,_0:r.value}:r.tag==="ConstF32"?{TAG:2,_0:r.value}:r.tag==="ConstF64"?{TAG:3,_0:r.value}:r.tag==="If"?{TAG:4,_0:typeof r.value=="object"?r.value.tag==="TypeValue"?{TAG:0,_0:C[r.value.value]}:{TAG:1,_0:r.value.value[0],_1:[r.value.value[1][0].map(function(i){return C[i]}),r.value.value[1][1].map(function(i){return C[i]})]}:Ae[r.value]}:r.tag==="BranchIf"?{TAG:5,_0:r.value}:r.tag==="Branch"?{TAG:6,_0:r.value}:r.tag==="Block"?{TAG:7,_0:typeof r.value=="object"?r.value.tag==="TypeValue"?{TAG:0,_0:C[r.value.value]}:{TAG:1,_0:r.value.value[0],_1:[r.value.value[1][0].map(function(i){return C[i]}),r.value.value[1][1].map(function(i){return C[i]})]}:Ae[r.value]}:r.tag==="Loop"?{TAG:8,_0:typeof r.value=="object"?r.value.tag==="TypeValue"?{TAG:0,_0:C[r.value.value]}:{TAG:1,_0:r.value.value[0],_1:[r.value.value[1][0].map(function(i){return C[i]}),r.value.value[1][1].map(function(i){return C[i]})]}:Ae[r.value]}:r.tag==="GetGlobal"?{TAG:9,_0:r.value}:r.tag==="SetGlobal"?{TAG:10,_0:r.value}:r.tag==="GetLocal"?{TAG:11,_0:r.value}:r.tag==="SetLocal"?{TAG:12,_0:r.value}:r.tag==="TeeLocal"?{TAG:13,_0:r.value}:r.tag==="Call"?{TAG:14,_0:r.value}:r.tag==="CallIndirect"?{TAG:15,_0:r.value[0],_1:r.value[1]}:r.tag==="LoadI32"?{TAG:16,_0:r.value[0],_1:r.value[1]}:r.tag==="StoreI32"?{TAG:17,_0:r.value[0],_1:r.value[1]}:r.tag==="InitMemory"?{TAG:18,_0:r.value}:{TAG:19,_0:r.value}:ht[r]})]}),exportSection:n.exportSection.map(function(u){return{name:u.name,kind:Yc[u.kind],index:u.index}}),elementSection:n.elementSection,codeSection:n.codeSection.map(function(u){return[u[0].map(function(r){return[r[0],C[r[1]]]}),u[1].map(function(r){return typeof r=="object"?r.tag==="ConstI32"?{TAG:0,_0:r.value}:r.tag==="ConstI64"?{TAG:1,_0:r.value}:r.tag==="ConstF32"?{TAG:2,_0:r.value}:r.tag==="ConstF64"?{TAG:3,_0:r.value}:r.tag==="If"?{TAG:4,_0:typeof r.value=="object"?r.value.tag==="TypeValue"?{TAG:0,_0:C[r.value.value]}:{TAG:1,_0:r.value.value[0],_1:[r.value.value[1][0].map(function(i){return C[i]}),r.value.value[1][1].map(function(i){return C[i]})]}:Ae[r.value]}:r.tag==="BranchIf"?{TAG:5,_0:r.value}:r.tag==="Branch"?{TAG:6,_0:r.value}:r.tag==="Block"?{TAG:7,_0:typeof r.value=="object"?r.value.tag==="TypeValue"?{TAG:0,_0:C[r.value.value]}:{TAG:1,_0:r.value.value[0],_1:[r.value.value[1][0].map(function(i){return C[i]}),r.value.value[1][1].map(function(i){return C[i]})]}:Ae[r.value]}:r.tag==="Loop"?{TAG:8,_0:typeof r.value=="object"?r.value.tag==="TypeValue"?{TAG:0,_0:C[r.value.value]}:{TAG:1,_0:r.value.value[0],_1:[r.value.value[1][0].map(function(i){return C[i]}),r.value.value[1][1].map(function(i){return C[i]})]}:Ae[r.value]}:r.tag==="GetGlobal"?{TAG:9,_0:r.value}:r.tag==="SetGlobal"?{TAG:10,_0:r.value}:r.tag==="GetLocal"?{TAG:11,_0:r.value}:r.tag==="SetLocal"?{TAG:12,_0:r.value}:r.tag==="TeeLocal"?{TAG:13,_0:r.value}:r.tag==="Call"?{TAG:14,_0:r.value}:r.tag==="CallIndirect"?{TAG:15,_0:r.value[0],_1:r.value[1]}:r.tag==="LoadI32"?{TAG:16,_0:r.value[0],_1:r.value[1]}:r.tag==="StoreI32"?{TAG:17,_0:r.value[0],_1:r.value[1]}:r.tag==="InitMemory"?{TAG:18,_0:r.value}:{TAG:19,_0:r.value}:ht[r]})]}),dataSection:n.dataSection.map(function(u){return{init:u.init,mode:typeof u.mode=="object"?{TAG:0,_0:u.mode[0],_1:u.mode[1]}:Hc[u.mode]}}),funcs:n.funcs.map(function(u){return[u[0],{TAG:0,_0:u[1][0].map(function(r){return C[r]}),_1:u[1][1].map(function(r){return C[r]})},[u[2][0].map(function(r){return[r[0],C[r[1]]]}),u[2][1].map(function(r){return typeof r=="object"?r.tag==="ConstI32"?{TAG:0,_0:r.value}:r.tag==="ConstI64"?{TAG:1,_0:r.value}:r.tag==="ConstF32"?{TAG:2,_0:r.value}:r.tag==="ConstF64"?{TAG:3,_0:r.value}:r.tag==="If"?{TAG:4,_0:typeof r.value=="object"?r.value.tag==="TypeValue"?{TAG:0,_0:C[r.value.value]}:{TAG:1,_0:r.value.value[0],_1:[r.value.value[1][0].map(function(i){return C[i]}),r.value.value[1][1].map(function(i){return C[i]})]}:Ae[r.value]}:r.tag==="BranchIf"?{TAG:5,_0:r.value}:r.tag==="Branch"?{TAG:6,_0:r.value}:r.tag==="Block"?{TAG:7,_0:typeof r.value=="object"?r.value.tag==="TypeValue"?{TAG:0,_0:C[r.value.value]}:{TAG:1,_0:r.value.value[0],_1:[r.value.value[1][0].map(function(i){return C[i]}),r.value.value[1][1].map(function(i){return C[i]})]}:Ae[r.value]}:r.tag==="Loop"?{TAG:8,_0:typeof r.value=="object"?r.value.tag==="TypeValue"?{TAG:0,_0:C[r.value.value]}:{TAG:1,_0:r.value.value[0],_1:[r.value.value[1][0].map(function(i){return C[i]}),r.value.value[1][1].map(function(i){return C[i]})]}:Ae[r.value]}:r.tag==="GetGlobal"?{TAG:9,_0:r.value}:r.tag==="SetGlobal"?{TAG:10,_0:r.value}:r.tag==="GetLocal"?{TAG:11,_0:r.value}:r.tag==="SetLocal"?{TAG:12,_0:r.value}:r.tag==="TeeLocal"?{TAG:13,_0:r.value}:r.tag==="Call"?{TAG:14,_0:r.value}:r.tag==="CallIndirect"?{TAG:15,_0:r.value[0],_1:r.value[1]}:r.tag==="LoadI32"?{TAG:16,_0:r.value[0],_1:r.value[1]}:r.tag==="StoreI32"?{TAG:17,_0:r.value[0],_1:r.value[1]}:r.tag==="InitMemory"?{TAG:18,_0:r.value}:{TAG:19,_0:r.value}:ht[r]})]]})})};Z.F32;Z.F64;Z.I32;Z.I64;Z.Vec;Z.Str;function Ic(n,e,t){return T(e,T(n,t))}var yc={compose:Ic};function xc(n){var e=Math.log2(n);return e===Math.floor(e)}var Fa={isPowerOf2:xc};function n_(n,e){for(var t,u=0;he(t)&&u<n.length;){var a=T(e,Ee(n,u));a!==void 0&&(t=N(On(a))),u=u+1|0}return t}function e_(n,e){for(var t,u=n.length-1|0;he(t)&&u>=0;)T(e,Ee(n,u))?t=u:u=u-1|0;return t}function r_(n,e){for(var t,u=n.length-1|0;he(t)&&u>=0;){var a=Ee(n,u);T(e,a)?t=N(a):u=u-1|0}return t}function t_(n,e){for(var t=[],u=!1,a=0;u===!1&&a<n.length;){var r=Ee(n,a);r!==void 0?t.push(T(e,On(r))):u=!0,a=a+1|0}if(!u)return t}function u_(n,e){for(var t=[],u,a=0;he(u)&&a<n.length;){var r=Ee(n,a);r.TAG===0?t.push(T(e,r._0)):u=N(r._0),a=a+1|0}var o=u;return o!==void 0?{TAG:1,_0:On(o)}:{TAG:0,_0:t}}function a_(n,e){return K(ot(n,e),function(t){return[Ee(n,t),t]})}var we={firstSomeBy:n_,getReverseIndexBy:e_,getReverseBy:r_,mapOption:t_,mapResult:u_,getValueAndIndexBy:a_};function fr(n){return[[],n]}var o_=cu;function i_(n,e,t){return cu(n,e,[[],t])}var c_=Vo,__=Bo,f_=it;function s_(n,e){var t=w(_u(fu(n,e)),`
`,function(u){return"  "+u[0]+": "+u[1]});return`{
`+t+`
}`}var Vn={empty:void 0,add:o_,addMono:i_,remove:c_,has:__,get:f_,show:s_},l_=[],Et={TAG:1,_0:"u8",_1:l_},v_=[],Jn={TAG:1,_0:"u32",_1:v_},d_=[],At={TAG:1,_0:"char",_1:d_},T_=[],wt={TAG:1,_0:"str",_1:T_},G_=[],Zn={TAG:1,_0:"bool",_1:G_},g_=[],Xe={TAG:1,_0:"()",_1:g_};function $n(n,e){return{TAG:1,_0:"Fun",_1:tn(n,[e])}}function h_(n){return{TAG:1,_0:"Tuple",_1:n}}function $a(n,e){return{TAG:1,_0:"Array",_1:[n,{TAG:1,_0:String(e),_1:[]}]}}function E_(n){return{TAG:1,_0:"Ptr",_1:[n]}}function mt(n){switch(n.TAG|0){case 0:return!1;case 1:return n._0==="Array";case 2:return!0}}var ee=Gn("Types.Size.UnkownTypeSize");function Jr(n){for(;;){var e=n;switch(e.TAG|0){case 0:throw{RE_EXN_ID:ee,_1:e,Error:new Error};case 1:var t=0;switch(e._0){case"()":if(e._1.length===0)return 0;throw{RE_EXN_ID:ee,_1:e,Error:new Error};case"Array":var u=e._1;if(u.length!==2)throw{RE_EXN_ID:ee,_1:e,Error:new Error};var a=u[1];switch(a.TAG|0){case 1:if(a._1.length===0)return 4;throw{RE_EXN_ID:ee,_1:e,Error:new Error};case 0:case 2:throw{RE_EXN_ID:ee,_1:e,Error:new Error}}case"Mut":var r=e._1;if(r.length!==1)throw{RE_EXN_ID:ee,_1:e,Error:new Error};n=r[0];continue;case"Fun":case"Ptr":return 4;case"Tuple":return wn(l(e._1,Jr),0,function(o,i){return o+i|0});case"bool":case"u32":t=1;break;case"u64":if(e._1.length===0)return 8;throw{RE_EXN_ID:ee,_1:e,Error:new Error};case"char":case"u8":t=2;break;default:throw{RE_EXN_ID:ee,_1:e,Error:new Error}}switch(t){case 1:if(e._1.length===0)return 4;throw{RE_EXN_ID:ee,_1:e,Error:new Error};case 2:if(e._1.length===0)return 1;throw{RE_EXN_ID:ee,_1:e,Error:new Error}}break;case 2:return 4}}}function A_(n){return Math.ceil(Math.log2(Jr(n)))|0}function w_(n){return Jr(n)===0}var re={UnkownTypeSize:ee,size:Jr,sizeLog2:A_,isZeroSizedType:w_};function m_(n){return{TAG:0,_0:n}}function St(n,e,t){if(n.TAG===0)return{TAG:1,_0:[e,t],_1:{TAG:0,_0:n._0}};var u=n._1,a=n._0,r=a[1],o=a[0];return e<o?{TAG:1,_0:[e,t],_1:{TAG:1,_0:[o,r],_1:u}}:{TAG:1,_0:[o,r],_1:St(u,e,t)}}function S_(n){for(;;){var e=n;if(e.TAG===0)return e._0;n=e._1}}function p_(n,e){return wn(n,{TAG:0,_0:{TAG:0,_0:e}},function(t,u){return St(t,u[0],u[1])})}function pt(n){var e=function(t,u){for(;;){var a=u,r=t;if(r.TAG===0){var o=r._0;switch(o.TAG|0){case 0:case 1:return a;case 2:var i=o._0;if(i.TAG===0)return a;var c=i._0;if(c.TAG===0)return a;u={hd:c._0,tl:a},t=c._1;continue}}else{u={hd:r._0,tl:a},t=r._1;continue}}};return ir(e(n,0))}function b_(n){return Po(pt(n))}function Xa(n,e){if(n.TAG===0){var t=T(e,n._0);switch(t.TAG|0){case 0:case 1:return{TAG:0,_0:t};case 2:var u=t._0;return u.TAG===0?{TAG:0,_0:t}:u._0}}else{var a=n._0;return{TAG:1,_0:[a[0],T(e,a[1])],_1:Xa(n._1,e)}}}function La(n,e){var t=function(u,a){for(;;){var r=a,o=u;if(o.TAG===0)return iu(ir({hd:"..."+T(e,o._0),tl:r}));var i=o._0;a={hd:i[0]+": "+T(e,i[1]),tl:r},u=o._1}};return"{ "+w(t(n,0),", ",function(u){return u})+" }"}var Wn={make:m_,insert:St,tail:S_,fromArray:p_,toArray:pt,toMap:b_,map:Xa,show:La};function Kr(n){switch(n.TAG|0){case 0:return Zo(void 0,n._0);case 1:return wn(l(n._1,Kr),void 0,_t);case 2:var e=n._0;return e.TAG===0?void 0:wn(l(pt(e._0),function(t){return yc.compose(function(u){return u[1]},Kr,t)}),void 0,_t)}}function k_(n){return su(Kr(n[1]),Wo(n[0]))}function D_(n){return wn(l(jo(n),k_),void 0,_t)}function bt(n,e){var t=qo(su(Kr(e),D_(n)));return[t,e]}function N_(n){var e=String.fromCharCode(97+n%26|0),t=n/26|0;return t===0?e:e+String(t)}function k(n){switch(n.TAG|0){case 0:return N_(n._0);case 1:var e=n._0;if(n._1.length===0)return e;switch(e){case"Array":var t=n._1;if(t.length===2){var u=t[0],a=t[1];switch(a.TAG|0){case 1:if(a._1.length===0)return"["+k(u)+"; "+a._0+"]";break}}break;case"Fun":var r=n._1,o=ct(r,0,r.length-1|0),i=Ee(r,r.length-1|0);if(o.length!==1)return"("+w(o,", ",k)+") -> "+k(i);var c=o[0];return k(c)+" -> "+k(i);case"Tuple":return"("+w(n._1,", ",k)+")"}return e+"<"+w(n._1,", ",k)+">";case 2:var _=n._0;return _.TAG===0?_._0:La(_._0,k)}}function Ca(n){switch(n){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/";case 4:return"%";case 5:return"<";case 6:return"<=";case 7:return">";case 8:return">=";case 9:return"==";case 10:return"!=";case 11:return"&&";case 12:return"||";case 13:return"&";case 14:return"|";case 15:return"<<";case 16:return">>"}}var R_={show:Ca};function Ua(n){switch(n){case 0:return"-";case 1:return"!";case 2:return"*"}}var F_={show:Ua};function Ma(n){if(typeof n=="number")return"()";switch(n.TAG|0){case 0:case 1:return String(n._0);case 2:return n._0?"true":"false";case 3:return"'"+We(1,n._0)+"'";case 4:return'"'+n._0+'"'}}var $_={show:Ma};function q(n){switch(n.TAG|0){case 0:return Ma(n._0);case 1:return Ua(n._0)+q(n._1);case 2:return"("+q(n._0)+" "+Ca(n._1)+" "+q(n._2)+")";case 3:return n._0;case 4:return q(n._0)+" = "+q(n._1);case 5:var e=n._1,t=n._0,u=t.length;if(u!==1)return u!==0?"("+w(t,", ",function(c){return c})+") -> "+q(e):"() -> "+q(e);var a=t[0];return a+" -> "+q(e);case 6:return"let "+n._0+" = "+q(n._1)+" in "+q(n._2);case 7:return"("+q(n._0)+")("+w(n._1,", ",q)+")";case 8:return(n._2===1?"unsafe ":"")+`{
`+w(tn(l(n._0,Oa),Tn(n._1,[],function(c){return[q(c)]})),`;
`,function(c){return"  "+c})+`
}`;case 9:var r=n._2,o="if "+q(n._0)+" "+q(n._1);return r!==void 0?o+" else "+q(r):o;case 10:return"while "+q(n._0)+" "+q(n._1);case 11:return"return "+Tn(n._0,"",q);case 12:return q(n._0)+" as "+k(n._1);case 13:return"("+w(n._0,", ",q)+")";case 14:return n._0+` {
`+w(n._1,", ",function(c){return c[0]+": "+q(c[1])})+`
}`;case 15:var i=n._0;return i.TAG===0?"["+q(i._0)+"; "+String(i._1)+"]":"["+w(i._0,", ",q)+"]";case 16:return q(n._0)+"."+n._1}}function kt(n){switch(n.TAG|0){case 0:return"fn "+n._0+"("+w(n._1,", ",function(e){return(e[1]?"mut ":"")+e[0]})+") "+q(n._2);case 1:return(n._1?"mut":"let")+" "+n._0+" = "+q(n._2);case 2:return"struct "+n._0+` {
`+w(n._1,`,
`,function(e){return(e[2]?"mut ":"")+e[0]+": "+k(e[1])})+`
}`;case 3:return"impl "+n._0+` {
`+w(n._1,`

`,kt)+`
}`;case 4:return"extern fn "+n.name+"("+w(n.args,", ",function(e){return(e[2]?"mut ":"")+e[0]+": "+k(e[1])})+") -> "+k(n.ret)}}function Oa(n){return n.TAG===0?(n._1?"mut":"let")+" "+n._0+" = "+q(n._2):q(n._0)}var X_={showExpr:q,showDecl:kt,showStmt:Oa},L_={show:kt};function A(n,e){for(;;){var t=e;switch(t.TAG|0){case 0:var u=t._0,a=lu(n,u);if(a===void 0)return{TAG:0,_0:u};e=a;continue;case 1:return{TAG:1,_0:t._0,_1:l(t._1,function(i){return A(n,i)})};case 2:var r=t._0,o;return o=r.TAG===0?{TAG:0,_0:r._0}:{TAG:1,_0:Wn.map(r._0,function(i){return A(n,i)})},{TAG:2,_0:o}}}}function za(n,e){var t=e[0];return[t,A(Ho(n,t),e[1])]}function M(n,e){return Jo(Ko(e,function(t){return A(n,t)}),n,function(t,u,a){return Yo(a,u)})}function gn(n,e){return fu(e,function(t){return za(n,t)})}var Je;function Dt(n,e){return{TAG:2,_0:{TAG:1,_0:Wn.fromArray(l(n.attributes,function(t){return[t.name,t.ty]}),e)}}}function C_(n,e){var t={contents:0},u=[];return kn(e,function(a){var r=a[1],o=re.size(r);u.push({name:a[0],mut:a[2],offset:t.contents,ty:r,size:o,impl:void 0}),t.contents=t.contents+o|0}),{name:n,attributes:u,size:t.contents,staticFuncs:[]}}function U_(n,e,t){n.attributes.push({name:e.contents.name,mut:!1,offset:0,ty:e.contents.ty,size:0,impl:[e,t]})}function M_(n,e){n.staticFuncs.push({name:e})}var Nt=Gn("Struct.UndeclaredStruct"),Rt=Gn("Struct.StructTypeNotMatched"),Va=Gn("Struct.AmibguousStruct"),Kn={tyVarIndex:0,identifiers:[],renaming:Qo(10),structs:vu(5)};function me(n){var e=Kn.tyVarIndex;return Kn.tyVarIndex=Kn.tyVarIndex+1|0,e}function kr(n){return{TAG:0,_0:me()}}function Yr(n){var e=n[0],t=l(e,function(u){return{TAG:0,_0:me()}});return A(ni(Ze(e,t)),n[1])}function te(n,e){var t=n!==void 0?On(n):void 0,u=Kn.identifiers.length;Kn.identifiers.push(e);var a={contents:{name:e,newName:e,index:u,ty:t!==void 0?t:{TAG:0,_0:me()}}};return yo(Kn.renaming,u,a),a}function O_(n){return In(we.getReverseIndexBy(Kn.identifiers,function(e){return e===n}),function(e){return xo(Kn.renaming,e)})}function Ba(n,e){e.contents.ty=A(n,e.contents.ty)}function Pa(n){return kn(Io(Kn.renaming),function(e){return Ba(n,e)})}function z_(n){return ft(Kn.structs,n.name,n)}function Yn(n){return du(Kn.structs,n)}function Le(n){switch(n.TAG|0){case 0:var e=n._0;if(typeof e=="number")return Xe;switch(e.TAG|0){case 0:return Et;case 1:return Jn;case 2:return Zn;case 3:return At;case 4:return wt}case 3:return n._0.contents.ty;case 4:case 11:return Xe;case 12:return Tn(n._0,Xe,Le);case 13:return n._2;case 14:return h_(l(n._0,Le));case 15:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return n._0}}function V_(n){return n.TAG===0?n._1:n._0.length}var B_={len:V_};function P_(n){return Le(n._0)}function Y(n,e){var t=n!==void 0?On(n):void 0,u=function(d,R){return t!==void 0?"("+R+": "+k(A(On(t),d))+")":R},a=function(d){return Y(N(t),d)};switch(e.TAG|0){case 0:return u(Le(e),$_.show(e._0));case 1:return u(e._0,"("+Y(N(t),e._1)+" "+R_.show(e._2)+" "+Y(N(t),e._3)+")");case 2:return u(e._0,"("+F_.show(e._1)+Y(N(t),e._2)+")");case 3:var r=e._0;return u(r.contents.ty,r.contents.name);case 4:var o=e._1;return u(Le(o),Y(N(t),e._0)+" = "+Y(N(t),o));case 5:return u(e._0,"("+w(e._1,", ",function(d){return d.contents.name})+") -> "+Y(N(t),e._2));case 6:return u(e._0,(e._1?"mut":"let")+" "+e._2.contents.name+" = "+Y(N(t),e._3)+` in
`+Y(N(t),e._4));case 7:return u(e._0,"let rec "+e._1.contents.name+" ("+w(e._2,", ",function(d){return d.contents.name})+") = "+Y(N(t),e._3)+` in
`+Y(N(t),e._4));case 8:return u(e._0,"("+Y(N(t),e._1)+")("+w(e._2,", ",a)+")");case 9:var i=e._2,c=N(t);return u(e._0,(e._3===1?"unsafe ":"")+`{
`+w(tn(l(e._1,function(d){return qa(c,d)}),Tn(i,[],function(d){return[Y(N(t),d)]})),`;
`,function(d){return"  "+d})+(he(i)?"; ":"")+`
}`);case 10:return u(e._0,"if "+Y(N(t),e._1)+" "+Y(N(t),e._2)+" else "+Y(N(t),e._3));case 11:return u(Xe,"while "+Y(N(t),e._0)+" "+Y(N(t),e._1));case 12:return"return "+u(Le(e),Tn(e._0,"",a));case 13:return Y(N(t),e._0)+" as "+k(e._2);case 14:return"("+w(e._0,", ",a)+")";case 15:return e._0+` {
`+w(e._1,`,
`,function(d){return d[0]+": "+Y(N(t),d[1])})+`
}`;case 16:var _=e._1,f;return f=_.TAG===0?"["+Y(N(t),_._0)+"; "+String(_._1)+"]":"["+w(_._0,", ",function(d){return Y(N(t),d)})+"]",u(e._0,f);case 17:return u(e._0,Y(N(t),e._1)+"."+e._2)}}function qa(n,e){var t=n!==void 0?On(n):void 0;return Y(N(t),e._0)}function Ft(n,e){var t=n!==void 0?On(n):void 0,u=function(_,f){return t!==void 0?"("+f+": "+k(A(On(t),_))+")":f};switch(e.TAG|0){case 0:var a=e._1,r=e._0,o;if(t!==void 0){var i=On(t);o=w(a,", ",function(_){var f=_[0];return(_[1]?"mut ":"")+(f.contents.name+": "+k(A(i,f.contents.ty)))})}else o=w(a,", ",function(_){return(_[1]?"mut ":"")+_[0].contents.name});return u(r.contents.ty,"fn "+r.contents.name+"("+o+") "+Y(N(t),e._2));case 1:var c=e._0;return u(c.contents.ty,(e._1?"mut":"let")+" "+c.contents.name+" = "+Y(N(t),e._2));case 2:return X_.showDecl({TAG:2,_0:e._0,_1:e._1});case 3:return"impl "+e._0+` {
`+w(e._1,`

`,function(_){return Ft(void 0,{TAG:0,_0:_[0],_1:_[1],_2:_[2]})})+`
}`;case 4:return"extern fn "+e.name.contents.name+"("+w(e.args,", ",function(_){var f=_[0];return(_[1]?"mut ":"")+f.contents.name+": "+k(f.contents.ty)})+") -> "+k(e.ret)}}var ja=Gn("Core.CoreAst.UnexpectedDeclarationInImplBlock"),Za=Gn("Core.CoreAst.UndeclaredIdentifer"),Wa=Gn("Core.CoreAst.UnreachableLetStmt");function $t(n,e,t,u,a){return t.TAG===5?{TAG:7,_0:t._0,_1:n,_2:t._1,_3:t._2,_4:u}:{TAG:6,_0:a,_1:e,_2:n,_3:t,_4:u}}function j(n){var e={LAZY_DONE:!1,VAL:function(){return kr()}};switch(n.TAG|0){case 0:return{TAG:0,_0:n._0};case 1:return{TAG:2,_0:se(e),_1:n._0,_2:j(n._1)};case 2:return{TAG:1,_0:se(e),_1:j(n._0),_2:n._1,_3:j(n._2)};case 3:var t=n._0,u=O_(t);if(u!==void 0)return{TAG:3,_0:u};var a=Yn(t);if(a!==void 0)return{TAG:3,_0:te(void 0,t)};throw{RE_EXN_ID:Za,_1:t,Error:new Error};case 4:return{TAG:4,_0:j(n._0),_1:j(n._1)};case 5:var r=n._1,o=n._0;if(o.length===0)return{TAG:5,_0:se(e),_1:[te(void 0,"__x")],_2:j(r)};var i=N(void 0);return{TAG:5,_0:se(e),_1:l(o,function(b){return te(i,b)}),_2:j(r)};case 6:return $t(te(void 0,n._0),!1,j(n._1),j(n._2),se(e));case 7:return{TAG:8,_0:se(e),_1:j(n._0),_2:l(n._1,j)};case 8:var c=n._2,_=n._1,f=function(b){if(!b)return K(_,j);var z=b.hd;if(z.TAG!==0)return{TAG:9,_0:se(e),_1:[Ja(z)],_2:f(b.tl),_3:c};var _n=z._3;return $t(te(void 0,z._0),z._1,j(z._2),Tn(f(b.tl),{TAG:0,_0:0},function(hn){return hn}),_n!==void 0?_n:kr())};return{TAG:9,_0:se(e),_1:[],_2:f(wr(n._0)),_3:c};case 9:return{TAG:10,_0:se(e),_1:j(n._0),_2:j(n._1),_3:Tn(n._2,{TAG:0,_0:0},j)};case 10:return{TAG:11,_0:j(n._0),_1:j(n._1)};case 11:return{TAG:12,_0:K(n._0,j)};case 12:return{TAG:13,_0:j(n._0),_1:se(e),_2:n._1};case 13:return{TAG:14,_0:l(n._0,j)};case 14:return{TAG:15,_0:n._0,_1:l(n._1,function(b){return[b[0],j(b[1])]})};case 15:var d=n._0,R=kr(),B;return B=d.TAG===0?{TAG:0,_0:j(d._0),_1:d._1}:{TAG:1,_0:l(d._0,j)},{TAG:16,_0:R,_1:B};case 16:return{TAG:17,_0:kr(),_1:j(n._0),_2:n._1}}}function Ja(n){if(n.TAG!==0)return{_0:j(n._0)};throw{RE_EXN_ID:Wa,Error:new Error}}function Xt(n){switch(n.TAG|0){case 0:var e=l(n._1,function(o){return[te(N(void 0),o[0]),o[1]]});return{TAG:0,_0:te(void 0,n._0),_1:e,_2:j(n._2)};case 1:return{TAG:1,_0:te(void 0,n._0),_1:n._1,_2:j(n._2)};case 2:var t=n._1,u=n._0;return z_(C_(u,t)),{TAG:2,_0:u,_1:t};case 3:var a=l(l(n._1,Xt),function(o){if(o.TAG===0)return[o._0,o._1,o._2];throw{RE_EXN_ID:ja,_1:o,Error:new Error}});return{TAG:3,_0:n._0,_1:a};case 4:var r=l(n.args,function(o){return[te(N(o[1]),o[0]),o[2]]});return{TAG:4,name:te(void 0,n.name),args:r,ret:n.ret}}}function I(n,e){var t=function(_){return I(n,_)};switch(e.TAG|0){case 0:return{TAG:0,_0:e._0};case 1:return{TAG:1,_0:A(n,e._0),_1:I(n,e._1),_2:e._2,_3:I(n,e._3)};case 2:return{TAG:2,_0:A(n,e._0),_1:e._1,_2:I(n,e._2)};case 3:return{TAG:3,_0:e._0};case 4:return{TAG:4,_0:I(n,e._0),_1:I(n,e._1)};case 5:return{TAG:5,_0:A(n,e._0),_1:e._1,_2:I(n,e._2)};case 6:return{TAG:6,_0:A(n,e._0),_1:e._1,_2:e._2,_3:I(n,e._3),_4:I(n,e._4)};case 7:return{TAG:7,_0:A(n,e._0),_1:e._1,_2:e._2,_3:I(n,e._3),_4:I(n,e._4)};case 8:return{TAG:8,_0:A(n,e._0),_1:I(n,e._1),_2:l(e._2,t)};case 9:return{TAG:9,_0:A(n,e._0),_1:l(e._1,function(_){return Ka(n,_)}),_2:K(e._2,t),_3:e._3};case 10:return{TAG:10,_0:A(n,e._0),_1:I(n,e._1),_2:I(n,e._2),_3:I(n,e._3)};case 11:return{TAG:11,_0:I(n,e._0),_1:I(n,e._1)};case 12:return{TAG:12,_0:K(e._0,t)};case 13:return{TAG:13,_0:I(n,e._0),_1:A(n,e._1),_2:A(n,e._2)};case 14:return{TAG:14,_0:l(e._0,t)};case 15:var u=e._1,a=e._0,r=Yn(a);if(r===void 0)return Tu('unreachable: undeclared struct "'+a+"'");var o=we.mapOption(l(Or(r.attributes,function(_){return he(_.impl)}),function(_){var f=_.name;return zr(u,function(d){return d[0]===f})}),function(_){return[_[0],I(n,_[1])]});return o!==void 0?{TAG:15,_0:a,_1:o}:Tu('unreachable: missing attribute for struct "'+a+'"');case 16:var i=e._1,c;return c=i.TAG===0?{TAG:0,_0:I(n,i._0),_1:i._1}:{TAG:1,_0:l(i._0,t)},{TAG:16,_0:A(n,e._0),_1:c};case 17:return{TAG:17,_0:A(n,e._0),_1:I(n,e._1),_2:e._2}}}function Ka(n,e){return{_0:I(n,e._0)}}function Ya(n,e){switch(e.TAG|0){case 0:return{TAG:0,_0:e._0,_1:e._1,_2:I(n,e._2)};case 1:return{TAG:1,_0:e._0,_1:e._1,_2:I(n,e._2)};case 3:return{TAG:3,_0:e._0,_1:l(e._1,function(t){return[t[0],t[1],I(n,t[2])]})};case 2:case 4:return e}}function en(n,e){var t=function(r){return en(n,r)};switch(e.TAG|0){case 1:return T(n,{TAG:1,_0:e._0,_1:en(n,e._1),_2:e._2,_3:en(n,e._3)});case 2:return T(n,{TAG:2,_0:e._0,_1:e._1,_2:en(n,e._2)});case 0:case 3:return T(n,e);case 4:return T(n,{TAG:4,_0:en(n,e._0),_1:en(n,e._1)});case 5:return T(n,{TAG:5,_0:e._0,_1:e._1,_2:en(n,e._2)});case 6:return T(n,{TAG:6,_0:e._0,_1:e._1,_2:e._2,_3:en(n,e._3),_4:en(n,e._4)});case 7:return T(n,{TAG:7,_0:e._0,_1:e._1,_2:e._2,_3:en(n,e._3),_4:en(n,e._4)});case 8:return T(n,{TAG:8,_0:e._0,_1:en(n,e._1),_2:l(e._2,t)});case 9:return T(n,{TAG:9,_0:e._0,_1:l(e._1,function(r){return{_0:en(n,r._0)}}),_2:K(e._2,t),_3:e._3});case 10:return T(n,{TAG:10,_0:e._0,_1:en(n,e._1),_2:en(n,e._2),_3:en(n,e._3)});case 11:return T(n,{TAG:11,_0:en(n,e._0),_1:en(n,e._1)});case 12:return T(n,{TAG:12,_0:K(e._0,t)});case 13:return T(n,{TAG:13,_0:en(n,e._0),_1:e._1,_2:e._2});case 14:return T(n,{TAG:14,_0:l(e._0,t)});case 15:return T(n,{TAG:15,_0:e._0,_1:l(e._1,function(r){return[r[0],en(n,r[1])]})});case 16:var u=e._1,a;return a=u.TAG===0?{TAG:0,_0:en(n,u._0),_1:u._1}:{TAG:1,_0:l(u._0,t)},T(n,{TAG:16,_0:e._0,_1:a});case 17:return T(n,{TAG:17,_0:e._0,_1:en(n,e._1),_2:e._2})}}function Ha(n,e){switch(e.TAG|0){case 0:return{TAG:0,_0:e._0,_1:e._1,_2:en(n,e._2)};case 1:return{TAG:1,_0:e._0,_1:e._1,_2:en(n,e._2)};case 3:return{TAG:3,_0:e._0,_1:l(e._1,function(t){return[t[0],t[1],en(n,t[2])]})};case 2:case 4:return e}}function Qa(n,e,t,u){var a=n!==void 0?On(n):void 0,r=e!==void 0?On(e):void 0;Ha(function(o){return o.TAG===9?(K(a,function(i){return T(i,o)}),T(t,o),K(r,function(i){return T(i,o)})):T(t,o),o},u)}function q_(n,e,t,u){var a=n!==void 0?On(n):void 0,r=e!==void 0?On(e):void 0,o=N(r),i=N(a);return kn(u,function(c){return Qa(i,o,t,c)})}var sn={typeOfExpr:Le,ArrayInit:B_,typeOfStmt:P_,showExpr:Y,showStmt:qa,showDecl:Ft,UnexpectedDeclarationInImplBlock:ja,UndeclaredIdentifer:Za,UnreachableLetStmt:Wa,rewriteLetIn:$t,fromExpr:j,fromStmt:Ja,fromDecl:Xt,substExpr:I,substStmt:Ka,substDecl:Ya,rewriteExpr:en,rewriteDecl:Ha,visitDecl:Qa,visitProg:q_},Xn={show:Y,from:j,subst:I,typeOf:Le},Ce={show:Ft,from:Xt,subst:Ya},Ia=Gn("ParserExn.InvalidCharacter");function j_(n,e){return n.RE_EXN_ID===Ia?"invalid character: '"+We(1,n._1)+"'":T(e,n)}function ya(n){return[n,0,n.length]}function Z_(n){return ya(Array.from(n,function(e){return Gu(e,0)}))}function xa(n,e){var t=e[2],u=n!==void 0?n:1;return[e[0],Math.min(e[1]+u|0,t),t]}function Hr(n){return je(n[0],n[1])}function Lt(n){return xa(1,n)}function Ct(n){return n[1]===n[2]}function W_(n){return n[0].slice(n[1],n[2])}function sr(n,e){var t=Hr(e);if(t!==void 0&&T(n,t))return[t,xa(void 0,e)]}function O(n){return function(e){return sr(function(t){return t===n},e)}}function no(n){return n>=97?n<=122:!1}function J_(n){return n>=65?n<=90:!1}function K_(n){return no(n)?!0:J_(n)}function eo(n){return n>=48?n<=57:!1}function Y_(n){return K_(n)?!0:eo(n)}function H_(n){return sr(no,n)}function Q_(n){return sr(eo,n)}function Ut(n){return sr(Y_,n)}function I_(n){return n>13||n<9?n===32:!(n===12||n===11)}function y_(n){return sr(I_,n)}function g(n,e,t){return K(T(n,t),function(u){return[T(e,u[0]),u[1]]})}function Dr(n,e,t){for(;;){var u=n,a=t,r=u!==void 0?u:[];if(Ct(a))return[r,a];var o=T(e,a);if(o===void 0)return[r,a];r.push(o[0]),t=o[1],n=r}}function ro(n){return Dr(void 0,y_,n)}function Ke(n,e,t){return In(T(n,t),function(u){var a=u[0];return K(T(e,u[1]),function(r){return[[a,r[0]],r[1]]})})}function to(n){return function(e){return g(function(t){return Ke(n,function(u){return Dr(void 0,n,u)},t)},function(t){return tn([t[0]],t[1])},e)}}function Mt(n,e,t,u){return In(Ke(n,e,u),function(a){var r=a[0],o=r[1],i=r[0];return K(T(t,a[1]),function(c){return[[i,o,c[0]],c[1]]})})}function uo(n){if(!n)return function(a){return[0,a]};var e=n.hd,t=uo(n.tl),u=function(a){return Ke(e,t,a)};return function(a){return g(u,function(r){return{hd:r[0],tl:r[1]}},a)}}function Ot(n,e,t){var u=T(n,t);return u!==void 0?[u[0],u[1]]:T(e,t)}function lr(n,e){return we.firstSomeBy(n,function(t){return T(t,e)})}function W(n){var e=Array.from(n,function(u){var a=Gu(u,0);return function(r){return sr(function(o){return o===a},r)}}),t=uo(wr(e));return function(u){return g(t,function(a){return n},u)}}function zt(n,e){var t=T(n,e);if(t===void 0)return[st(Hr(e)),Lt(e)]}var x_=to(Q_);function Vt(n){return g(x_,function(e){return st(gu(w(e,"",function(t){return We(1,t)})))},n)}var n0=W("u8");function e0(n){return Ke(Vt,n0,n)}function r0(n){return g(e0,function(e){return{TAG:0,_0:e[0],_1:8}},n)}var t0=W("u32");function u0(n){return Ke(Vt,t0,n)}function a0(n){return g(u0,function(e){return{TAG:0,_0:e[0],_1:32}},n)}function o0(n){return Ot(a0,function(e){return g(Vt,function(t){return{TAG:0,_0:t,_1:32}},e)},n)}var i0=[r0,o0];function c0(n){return lr(i0,n)}var _0=W("false");function f0(n){return g(_0,function(e){return{TAG:1,_0:!1}},n)}var s0=W("true");function l0(n){return g(s0,function(e){return{TAG:1,_0:!0}},n)}function v0(n){return Ot(l0,f0,n)}var d0=[Ut,O(95),O(39)];function T0(n){return lr(d0,n)}function G0(n){return Dr(void 0,T0,n)}var g0=O(95);function h0(n){return Ot(H_,g0,n)}function E0(n){return Ke(h0,G0,n)}function A0(n){return g(E0,function(e){return{TAG:5,_0:We(1,e[0])+w(e[1],"",function(t){return We(1,t)})}},n)}function ao(n){return w(n,"",function(e){return We(1,e)})}var w0=[Ut,O(95)],m0=to(function(n){return lr(w0,n)});function S0(n){return g(m0,function(e){return{TAG:6,_0:ao(e)}},n)}var p0=O(39),b0=O(39);function k0(n){return zt(b0,n)}var D0=O(39);function N0(n){return Mt(D0,k0,p0,n)}function R0(n){return g(N0,function(e){var t=e[1];if(t>127)throw{RE_EXN_ID:Ia,_1:t,Error:new Error};return{TAG:2,_0:t}},n)}var F0=O(34),$0=O(34);function X0(n){return zt($0,n)}function L0(n){return Dr(void 0,X0,n)}var C0=O(34);function U0(n){return Mt(C0,L0,F0,n)}function M0(n){return g(U0,function(e){return{TAG:3,_0:ao(e[1])}},n)}var O0=W("let"),z0=W("mut"),V0=W("in"),B0=W("if"),P0=W("else"),q0=W("fn"),j0=W("while"),Z0=W("return"),W0=W("as"),J0=W("unsafe"),K0=W("struct"),Y0=W("impl"),H0=W("extern"),Q0=[function(n){return g(O0,function(e){return{TAG:7,_0:0}},n)},function(n){return g(z0,function(e){return{TAG:7,_0:1}},n)},function(n){return g(V0,function(e){return{TAG:7,_0:2}},n)},function(n){return g(B0,function(e){return{TAG:7,_0:3}},n)},function(n){return g(P0,function(e){return{TAG:7,_0:4}},n)},function(n){return g(q0,function(e){return{TAG:7,_0:5}},n)},function(n){return g(j0,function(e){return{TAG:7,_0:6}},n)},function(n){return g(Z0,function(e){return{TAG:7,_0:7}},n)},function(n){return g(W0,function(e){return{TAG:7,_0:8}},n)},function(n){return g(J0,function(e){return{TAG:7,_0:9}},n)},function(n){return g(K0,function(e){return{TAG:7,_0:10}},n)},function(n){return g(Y0,function(e){return{TAG:7,_0:11}},n)},function(n){return g(H0,function(e){return{TAG:7,_0:12}},n)}];function I0(n){return lr(Q0,n)}function y0(n){return Ke(I0,function(e){return zt(Ut,e)},n)}function x0(n){return g(y0,function(e){return e[0]},n)}var nf=W("->"),ef=W("=="),rf=W("!="),tf=W("&&"),uf=W("||"),af=W("+="),of=W("-="),cf=W("*="),_f=W("/="),ff=W("%="),sf=O(43),lf=O(45),vf=O(42),df=O(47),Tf=O(37),Gf=W("<="),gf=W(">="),hf=O(60),Ef=O(62),Af=O(40),wf=O(41),mf=O(44),Sf=O(59),pf=O(61),bf=O(123),kf=O(125),Df=O(91),Nf=O(93),Rf=O(58),Ff=O(33),$f=O(46),Xf=O(38),Lf=O(124),Cf=O(39),Uf=O(34),Mf=[function(n){return g(nf,function(e){return{TAG:4,_0:5}},n)},function(n){return g(ef,function(e){return{TAG:4,_0:16}},n)},function(n){return g(rf,function(e){return{TAG:4,_0:17}},n)},function(n){return g(tf,function(e){return{TAG:4,_0:25}},n)},function(n){return g(uf,function(e){return{TAG:4,_0:27}},n)},function(n){return g(af,function(e){return{TAG:4,_0:28}},n)},function(n){return g(of,function(e){return{TAG:4,_0:29}},n)},function(n){return g(cf,function(e){return{TAG:4,_0:30}},n)},function(n){return g(_f,function(e){return{TAG:4,_0:31}},n)},function(n){return g(ff,function(e){return{TAG:4,_0:32}},n)},function(n){return g(sf,function(e){return{TAG:4,_0:11}},n)},function(n){return g(lf,function(e){return{TAG:4,_0:12}},n)},function(n){return g(vf,function(e){return{TAG:4,_0:13}},n)},function(n){return g(df,function(e){return{TAG:4,_0:14}},n)},function(n){return g(Tf,function(e){return{TAG:4,_0:15}},n)},function(n){return g(Gf,function(e){return{TAG:4,_0:19}},n)},function(n){return g(gf,function(e){return{TAG:4,_0:21}},n)},function(n){return g(hf,function(e){return{TAG:4,_0:18}},n)},function(n){return g(Ef,function(e){return{TAG:4,_0:20}},n)},function(n){return g(Af,function(e){return{TAG:4,_0:0}},n)},function(n){return g(wf,function(e){return{TAG:4,_0:1}},n)},function(n){return g(mf,function(e){return{TAG:4,_0:2}},n)},function(n){return g(Sf,function(e){return{TAG:4,_0:3}},n)},function(n){return g(pf,function(e){return{TAG:4,_0:4}},n)},function(n){return g(bf,function(e){return{TAG:4,_0:6}},n)},function(n){return g(kf,function(e){return{TAG:4,_0:7}},n)},function(n){return g(Df,function(e){return{TAG:4,_0:8}},n)},function(n){return g(Nf,function(e){return{TAG:4,_0:9}},n)},function(n){return g(Rf,function(e){return{TAG:4,_0:10}},n)},function(n){return g(Ff,function(e){return{TAG:4,_0:22}},n)},function(n){return g($f,function(e){return{TAG:4,_0:23}},n)},function(n){return g(Xf,function(e){return{TAG:4,_0:24}},n)},function(n){return g(Lf,function(e){return{TAG:4,_0:26}},n)},function(n){return g(Cf,function(e){return{TAG:4,_0:33}},n)},function(n){return g(Uf,function(e){return{TAG:4,_0:34}},n)}];function Of(n){return lr(Mf,n)}var zf=[c0,v0,R0,M0,x0,Of,A0,S0];function Vf(n){return lr(zf,n)}function Bf(n){return Dr(void 0,function(e){return g(function(t){return Mt(ro,Vf,ro,t)},function(t){return t[1]},e)},n)}function Pf(n){switch(n){case 0:return"(";case 1:return")";case 2:return",";case 3:return";";case 4:return"=";case 5:return"->";case 6:return"{";case 7:return"}";case 8:return"[";case 9:return"]";case 10:return":";case 11:return"+";case 12:return"-";case 13:return"*";case 14:return"/";case 15:return"%";case 16:return"==";case 17:return"!=";case 18:return"<";case 19:return"<=";case 20:return">";case 21:return">=";case 22:return"!";case 23:return".";case 24:return"&";case 25:return"&&";case 26:return"|";case 27:return"||";case 28:return"+=";case 29:return"-=";case 30:return"*=";case 31:return"/=";case 32:return"%=";case 33:return"'";case 34:return'"'}}function qf(n){switch(n){case 0:return"let";case 1:return"mut";case 2:return"in";case 3:return"if";case 4:return"else";case 5:return"fn";case 6:return"while";case 7:return"return";case 8:return"as";case 9:return"unsafe";case 10:return"struct";case 11:return"impl";case 12:return"extern"}}function jf(n){switch(n.TAG|0){case 0:return String(n._0);case 1:return n._0?"true":"false";case 2:return"'"+We(1,n._0)+"'";case 3:return'"'+n._0+'"';case 4:return Pf(n._0);case 5:case 6:return n._0;case 7:return qf(n._0)}}function vr(n){return{contents:function(e){return In(Hr(e),function(t){if(T(n,t))return[t,Lt(e)]})}}}function Ue(n){return{contents:function(e){return In(Hr(e),function(t){return K(T(n,t),function(u){return[u,Lt(e)]})})}}}function Zf(n,e){return{contents:function(t){var u=T(n.contents,t);if(u!==void 0){var a=u[1];return K(T(e,u[0]),function(r){return[r,a]})}}}}function v(n){return vr(function(e){return Mn(e,n)})}function G(n,e){return{contents:function(t){return K(T(n.contents,t),function(u){return[T(e,u[0]),u[1]]})}}}function ln(n,e){return{contents:function(t){return In(T(n.contents,t),function(u){var a=u[0];return K(T(e.contents,u[1]),function(r){return[[a,r[0]],r[1]]})})}}}function Nr(n){var e=function(t){return{contents:function(u){if(Ct(u))return[0,u];var a=T(t.contents,u);if(a===void 0)return[0,u];var r=a[0];return K(T(e(t).contents,a[1]),function(o){return[{hd:r,tl:o[0]},o[1]]})}}};return G(e(n),ir)}function Wf(n){return G(ln(n,Nr(n)),function(e){return tn([e[0]],e[1])})}function Hn(n,e,t){return{contents:function(u){return In(T(ln(n,e).contents,u),function(a){var r=a[0],o=r[1],i=r[0];return K(T(t.contents,a[1]),function(c){return[[i,o,c[0]],c[1]]})})}}}function Ye(n,e,t,u){return{contents:function(a){return In(T(Hn(n,e,t).contents,a),function(r){var o=r[0],i=o[2],c=o[1],_=o[0];return K(T(u.contents,r[1]),function(f){return[[_,c,i,f[0]],f[1]]})})}}}function Rr(n,e,t,u,a){return{contents:function(r){return In(T(Ye(n,e,t,u).contents,r),function(o){var i=o[0],c=i[3],_=i[2],f=i[1],d=i[0];return K(T(a.contents,o[1]),function(R){return[[d,f,_,c,R[0]],R[1]]})})}}}function oo(n,e,t,u,a,r){return{contents:function(o){return In(T(Rr(n,e,t,u,a).contents,o),function(i){var c=i[0],_=c[4],f=c[3],d=c[2],R=c[1],B=c[0];return K(T(r.contents,i[1]),function(b){return[[B,R,d,f,_,b[0]],b[1]]})})}}}function Jf(n,e,t,u,a,r,o){return{contents:function(i){return In(T(oo(n,e,t,u,a,r).contents,i),function(c){var _=c[0],f=_[5],d=_[4],R=_[3],B=_[2],b=_[1],z=_[0];return K(T(o.contents,c[1]),function(_n){return[[z,b,B,R,d,f,_n[0]],_n[1]]})})}}}function P(n,e){return{contents:function(t){var u=T(n.contents,t);return u!==void 0?[u[0],u[1]]:T(e.contents,t)}}}function He(n){return{contents:function(e){return we.firstSomeBy(n,function(t){return T(t.contents,e)})}}}function io(n,e,t){return G(ln(n,Nr(e)),function(u){var a=u[1],r=u[0];return Mn(a,[])?r:wn(a,r,t)})}function Qe(n,e,t){return io(n,ln(e,n),function(u,a){return ei(t,u,a[0],a[1])})}function Me(n){return G(Hn(vr(function(e){return Mn(e,{TAG:4,_0:0})}),n,vr(function(e){return Mn(e,{TAG:4,_0:1})})),function(e){return e[1]})}function Bt(n){return G(Hn(vr(function(e){return Mn(e,{TAG:4,_0:8})}),n,vr(function(e){return Mn(e,{TAG:4,_0:9})})),function(e){return e[1]})}function Kf(n,e){var t=function(u,a){var r=T(n.contents,u);if(r===void 0)return[a,u];var o=r[1];return a.push(r[0]),Tn(T(e.contents,o),[a,o],function(i){return t(i[1],a)})};return{contents:function(u){return t(u,[])}}}function ve(n){return Kf(n,vr(function(e){return Mn(e,{TAG:4,_0:2})}))}function de(n){return P(G(n,function(e){return N(e)}),{contents:function(e){return[void 0,e]}})}var co=ln,_o={contents:function(n){}},vn={contents:function(n){}},dr={contents:function(n){}},fo={contents:function(n){}},ue={contents:function(n){}},Pt=Ue(function(n){if(n.TAG===0){var e=n._0;return n._1===32?{TAG:0,_0:{TAG:1,_0:e}}:{TAG:0,_0:{TAG:0,_0:e}}}}),Yf=Ue(function(n){if(n.TAG===1)return{TAG:0,_0:{TAG:2,_0:n._0}}}),ae=Ue(function(n){if(n.TAG===5)return n._0}),Qr=Ue(function(n){if(n.TAG===6)return n._0}),qt=Ue(function(n){switch(n.TAG|0){case 5:case 6:return n._0;default:return}}),Hf=Ue(function(n){if(n.TAG===2)return{TAG:0,_0:{TAG:3,_0:n._0}}}),Qf=Ue(function(n){if(n.TAG===3)return{TAG:0,_0:{TAG:4,_0:n._0}}}),If=G(ln(v({TAG:4,_0:0}),v({TAG:4,_0:1})),function(n){return Xe}),yf=P(If,Ue(function(n){switch(n.TAG|0){case 5:switch(n._0){case"bool":return Zn;case"char":return At;case"str":return wt;case"u32":return Jn;case"u8":return Et;default:return}case 6:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return}})),so=P(yf,Me(ue));function lo(n){if(n.TAG!==0)return-1;var e=n._0;return typeof e=="number"||e.TAG!==1?-1:e._0}var xf=P(G(Bt(Hn(ue,v({TAG:4,_0:3}),Pt)),function(n){return $a(n[0],lo(n[2]))}),so),ns=P(G(Hn(P(Me(ve(ue)),G(so,function(n){return[n]})),v({TAG:4,_0:5}),ue),function(n){return $n(n[0],n[2])}),xf),es=P(G(Ye(Qr,v({TAG:4,_0:18}),ve(ue),v({TAG:4,_0:20})),function(n){return{TAG:1,_0:n[0],_1:n[2]}}),ns);ue.contents=es.contents;var rs=G(ln(qt,de(ln(v({TAG:4,_0:10}),ue))),function(n){return[n[0],K(n[1],function(e){return e[1]})]}),ts=G(P(ae,qt),function(n){return{TAG:3,_0:n}}),us=G(ln(v({TAG:4,_0:0}),v({TAG:4,_0:1})),function(n){return{TAG:0,_0:0}}),as=G(Me(Ye(vn,v({TAG:4,_0:2}),vn,de(ln(v({TAG:4,_0:2}),ve(vn))))),function(n){var e=tn([n[0],n[2]],Tn(n[3],[],function(t){return t[1]}));return{TAG:13,_0:e}}),vo=He([Pt,Yf,Hf,Qf,us,ts,as,Me(vn)]),To=P(io(vo,ln(v({TAG:4,_0:23}),ae),function(n,e){return{TAG:16,_0:n,_1:e[1]}}),vo),Go=P(G(ln(To,Wf(Me(ve(vn)))),function(n){return wn(n[1],n[0],function(e,t){return{TAG:7,_0:e,_1:t}})}),To),os=He([G(v({TAG:4,_0:13}),function(n){return 2}),G(v({TAG:4,_0:12}),function(n){return 0}),G(v({TAG:4,_0:22}),function(n){return 1})]),is=P(G(v({TAG:4,_0:11}),function(n){return 0}),G(v({TAG:4,_0:12}),function(n){return 1})),cs=He([G(v({TAG:4,_0:13}),function(n){return 2}),G(v({TAG:4,_0:14}),function(n){return 3}),G(v({TAG:4,_0:15}),function(n){return 4})]),_s=He([G(v({TAG:4,_0:25}),function(n){return 11}),G(v({TAG:4,_0:27}),function(n){return 12})]),fs=He([G(v({TAG:4,_0:24}),function(n){return 13}),G(v({TAG:4,_0:26}),function(n){return 14}),G(co(v({TAG:4,_0:18}),v({TAG:4,_0:18})),function(n){return 15}),G(co(v({TAG:4,_0:20}),v({TAG:4,_0:20})),function(n){return 16})]),ss=He([G(v({TAG:4,_0:18}),function(n){return 5}),G(v({TAG:4,_0:19}),function(n){return 6}),G(v({TAG:4,_0:20}),function(n){return 7}),G(v({TAG:4,_0:21}),function(n){return 8})]),ls=P(G(v({TAG:4,_0:16}),function(n){return 9}),G(v({TAG:4,_0:17}),function(n){return 10})),vs=P(G(ln(os,Go),function(n){return{TAG:1,_0:n[0],_1:n[1]}}),Go),ds=Qe(vs,cs,function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}}),Ts=Qe(ds,is,function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}}),Gs=Qe(Ts,_s,function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}}),gs=Qe(Gs,fs,function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}}),hs=Qe(gs,ss,function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}}),Es=Qe(hs,ls,function(n,e,t){return{TAG:2,_0:n,_1:e,_2:t}}),As=P(G(Ye(v({TAG:7,_0:3}),vn,dr,de(ln(v({TAG:7,_0:4}),dr))),function(n){return{TAG:9,_0:n[1],_1:n[2],_2:K(n[3],function(e){return e[1]})}}),Es),ws=P(G(Hn(v({TAG:7,_0:6}),vn,dr),function(n){return{TAG:10,_0:n[1],_1:n[2]}}),As),ms=P(G(oo(v({TAG:7,_0:0}),ae,v({TAG:4,_0:4}),vn,v({TAG:7,_0:2}),vn),function(n){return{TAG:6,_0:n[1],_1:n[3],_2:n[5]}}),ws),Ss=P(Me(ve(ae)),G(ae,function(n){return[n]})),ps=P(G(Hn(Ss,v({TAG:4,_0:5}),vn),function(n){return{TAG:5,_0:n[0],_1:n[2]}}),ms),bs=Zf(vn,function(n){switch(n.TAG|0){case 9:case 10:return[!0,{TAG:1,_0:n}];default:return}});dr.contents=P(G(Rr(de(v({TAG:7,_0:9})),v({TAG:4,_0:6}),Nr(P(G(fo,function(n){return[!1,n]}),bs)),de(vn),v({TAG:4,_0:7})),function(n){var e=n[3],t=n[2],u=l(t,function(i){return i[1]}),a=Tn(n[0],0,function(i){return 1}),r=je(t,t.length-1|0);if(r===void 0)return{TAG:8,_0:u,_1:e,_2:a};var o=r[1];return o.TAG===0||!(r[0]&&he(e))?{TAG:8,_0:u,_1:e,_2:a}:{TAG:8,_0:ct(u,0,t.length-1|0),_1:o._0,_2:a}}),ps).contents;var ks=G(Bt(Hn(vn,v({TAG:4,_0:3}),Pt)),function(n){return{TAG:15,_0:{TAG:0,_0:n[0],_1:lo(n[2])}}}),Ds=G(Bt(ve(vn)),function(n){return{TAG:15,_0:{TAG:1,_0:n}}}),Ns=P(P(ks,Ds),dr),Rs=P(G(Ye(Qr,v({TAG:4,_0:6}),ve(Hn(ae,v({TAG:4,_0:10}),vn)),v({TAG:4,_0:7})),function(n){return{TAG:14,_0:n[0],_1:l(n[2],function(e){return[e[0],e[2]]})}}),Ns),Fs=He([G(v({TAG:4,_0:4}),function(n){return"eq"}),G(v({TAG:4,_0:28}),function(n){return"plusEq"}),G(v({TAG:4,_0:29}),function(n){return"minusEq"}),G(v({TAG:4,_0:30}),function(n){return"starEq"}),G(v({TAG:4,_0:31}),function(n){return"divEq"}),G(v({TAG:4,_0:32}),function(n){return"modEq"})]),$s=Qe(Rs,Fs,function(n,e,t){return e==="minusEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:1,_2:t}}:e==="divEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:3,_2:t}}:e==="eq"?{TAG:4,_0:n,_1:t}:e==="starEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:2,_2:t}}:e==="modEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:4,_2:t}}:{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:0,_2:t}}}),Xs=P(G(ln(v({TAG:7,_0:7}),de(vn)),function(n){return{TAG:11,_0:n[1]}}),$s),Ls=G(ln(Xs,de(ln(v({TAG:7,_0:8}),ue))),function(n){var e=n[1],t=n[0];return e!==void 0?{TAG:12,_0:t,_1:e[1]}:t});vn.contents=Ls.contents;var Cs=G(ln(vn,v({TAG:4,_0:3})),function(n){return{TAG:1,_0:n[0]}}),Us=P(G(Rr(P(v({TAG:7,_0:0}),v({TAG:7,_0:1})),rs,v({TAG:4,_0:4}),vn,v({TAG:4,_0:3})),function(n){var e=n[1];return{TAG:0,_0:e[0],_1:Mn(n[0],{TAG:7,_0:1}),_2:n[3],_3:e[1]}}),Cs);fo.contents=Us.contents;var Ms=G(Rr(P(v({TAG:7,_0:0}),v({TAG:7,_0:1})),qt,v({TAG:4,_0:4}),vn,v({TAG:4,_0:3})),function(n){return{TAG:1,_0:n[1],_1:Mn(n[0],{TAG:7,_0:1}),_2:n[3]}}),Os=P(G(Rr(v({TAG:7,_0:10}),Qr,v({TAG:4,_0:6}),ve(Hn(ln(de(v({TAG:7,_0:1})),ae),v({TAG:4,_0:10}),ue)),v({TAG:4,_0:7})),function(n){var e=l(n[3],function(t){var u=t[0];return[u[1],t[2],Vr(u[0])]});return{TAG:2,_0:n[1],_1:e}}),Ms),go=P(G(Ye(v({TAG:7,_0:5}),ae,G(Me(ve(ln(de(v({TAG:7,_0:1})),ae))),function(n){return l(n,function(e){return[e[1],Vr(e[0])]})}),dr),function(n){return{TAG:0,_0:n[1],_1:n[2],_2:n[3]}}),Os),zs=P(G(Jf(v({TAG:7,_0:12}),v({TAG:7,_0:5}),ae,Me(G(ve(Ye(de(v({TAG:7,_0:1})),ae,v({TAG:4,_0:10}),ue)),function(n){return l(n,function(e){return[e[1],e[3],Vr(e[0])]})})),v({TAG:4,_0:5}),ue,v({TAG:4,_0:3})),function(n){return{TAG:4,name:n[2],args:n[3],ret:n[5]}}),go),Vs=P(G(Hn(v({TAG:7,_0:11}),Qr,G(Hn(v({TAG:4,_0:6}),Nr(go),v({TAG:4,_0:7})),function(n){return n[1]})),function(n){return{TAG:3,_0:n[1],_1:n[2]}}),zs);_o.contents=Vs.contents;var Bs=Nr(_o);function Ir(n){var e=n.replace(/(\/\/[^\n]*)/g,""),t=Bf(Z_(e));if(t===void 0)return{TAG:1,_0:"could not tokenize"};var u=T(Bs.contents,ya(t[0]));if(u===void 0)return{TAG:1,_0:"could not parse"};var a=u[1];if(Ct(a))return{TAG:0,_0:u[0]};var r=w(ct(W_(a),0,5)," ",jf);return{TAG:1,_0:"could not parse near "+r}}function Ps(n,e){var t=n!==void 0?n:100,u={contents:e.length},a=function(r,o,i){for(;;){var c=i,_=o,f=r;if(f){var d=f.hd,R=0;if(typeof d=="number")switch(d){case 2:var B=f.tl;if(B&&B.hd===3){r={hd:2,tl:B.tl};continue}break;case 9:var b=f.tl;if(b&&b.hd===9){r=b.tl;continue}break;case 10:var z=f.tl;if(z&&z.hd===9){r={hd:14,tl:z.tl};continue}break;case 14:var _n=f.tl;if(_n&&_n.hd===9){r={hd:10,tl:_n.tl};continue}break;case 18:var hn=f.tl;if(hn&&hn.hd===9){r={hd:36,tl:hn.tl};continue}break;case 19:var Dn=f.tl;if(Dn&&Dn.hd===9){r={hd:37,tl:Dn.tl};continue}break;case 24:var En=f.tl;if(En&&En.hd===9){r={hd:30,tl:En.tl};continue}break;case 25:var Nn=f.tl;if(Nn&&Nn.hd===9){r={hd:31,tl:Nn.tl};continue}break;case 30:var Sn=f.tl;if(Sn&&Sn.hd===9){r={hd:24,tl:Sn.tl};continue}break;case 31:var An=f.tl;if(An&&An.hd===9){r={hd:25,tl:An.tl};continue}break;case 36:var dn=f.tl;if(dn&&dn.hd===9){r={hd:18,tl:dn.tl};continue}break;case 37:var un=f.tl;if(un&&un.hd===9){r={hd:19,tl:un.tl};continue}break}else switch(d.TAG|0){case 0:var X=d._0,Bn=0,bn=f.tl;if(bn){var Rn=bn.hd;if(typeof Rn=="number")switch(Rn){case 3:r=bn.tl;continue;case 6:if(Fa.isPowerOf2(X)){r={hd:{TAG:0,_0:Math.log2(X)|0},tl:{hd:46,tl:bn.tl}};continue}break;case 7:if(Fa.isPowerOf2(X)){r={hd:{TAG:0,_0:Math.log2(X)|0},tl:{hd:48,tl:bn.tl}};continue}break;default:Bn=3}else switch(Rn.TAG|0){case 0:var an=bn.tl;if(an){var Pn=an.hd;if(typeof Pn=="number"){var Ln=Rn._0;if(Pn>=15){if(Pn>=43)switch(Pn){case 43:r={hd:{TAG:0,_0:ri(X,Ln)},tl:an.tl};continue;case 46:r={hd:{TAG:0,_0:X<<Ln},tl:an.tl};continue;case 44:case 45:case 47:break;case 48:r={hd:{TAG:0,_0:X>>>Ln|0},tl:an.tl};continue}}else switch(Pn){case 4:r={hd:{TAG:0,_0:X+Ln|0},tl:an.tl};continue;case 5:r={hd:{TAG:0,_0:X-Ln|0},tl:an.tl};continue;case 6:r={hd:{TAG:0,_0:Math.imul(X,Ln)},tl:an.tl};continue;case 7:r={hd:{TAG:0,_0:ti(X,Ln)},tl:an.tl};continue;case 10:r={hd:{TAG:0,_0:X===Ln?1:0},tl:an.tl};continue;case 0:case 1:case 2:case 3:case 8:case 9:case 11:case 12:case 13:break;case 14:r={hd:{TAG:0,_0:X===Ln?0:1},tl:an.tl};continue}}}break;case 15:r={hd:{TAG:14,_0:X},tl:bn.tl};continue;default:Bn=3}}if(Bn===3&&X===0){var ie=f.tl,qn=ie.hd;if(typeof qn=="number"){if(qn>=46){if(qn!==47){r=ie.tl;continue}}else if(qn===10){r={hd:9,tl:ie.tl};continue}}}break;case 1:case 2:case 3:case 9:case 11:R=2;break;case 12:var ce=f.tl;if(ce){var Te=ce.hd;if(typeof Te!="number"&&Te.TAG===11){var _e=d._0;if(_e===Te._0){r={hd:{TAG:13,_0:_e},tl:ce.tl};continue}}}break;case 13:var Qn=f.tl;if(Qn&&Qn.hd===3){r={hd:{TAG:12,_0:d._0},tl:Qn.tl};continue}break}if(R===2){var ze=f.tl;if(ze&&ze.hd===3){r=ze.tl;continue}}o={hd:d,tl:_},r=f.tl;continue}var Ge=au(_),be=ui(Ge);if(!(c>1&&be<u.contents))return Ge;u.contents=be,i=c-1|0,o=0,r=Ge}};return t>0?ir(a(wr(e),0,t)):e}function jt(n,e){switch(e.TAG|0){case 0:return n===e._0;case 1:return lt(e._1,function(u){return jt(n,u)});case 2:var t=e._0;return t.TAG===0?!1:lt(Wn.toArray(t._0),function(u){return jt(n,u[1])})}}function ho(n,e,t){if(jt(n,e))return{TAG:1,_0:k({TAG:0,_0:n})+" occurs in "+k(e)};var u=lu(t,n);return u!==void 0?Mn(u,e)?{TAG:0,_0:t}:{TAG:1,_0:k(e)+" is not unifiable with "+k(u)}:{TAG:0,_0:hu(t,n,e)}}function Tr(n,e){for(;;){var t=n;if(!t)return{TAG:0,_0:e};var u=t.tl,a=t.hd,r=a[1],o=a[0],i=0;switch(o.TAG|0){case 0:var c=o._0,_=0;switch(r.TAG|0){case 0:if(c===r._0){n=u;continue}_=3;break;case 1:case 2:_=3;break}if(_===3)return F(ho(c,r,e),function(un){return function(X){return Tr(un,X)}}(u));break;case 1:var f=o._1;switch(r.TAG|0){case 0:i=1;break;case 1:var d=r._1;if(o._0===r._0&&f.length===d.length){var R=wn(Ze(f,d),u,function(un,X){return{hd:[A(e,X[0]),A(e,X[1])],tl:un}});n=R;continue}i=2;break;case 2:i=2;break}break;case 2:var B=o._0;switch(r.TAG|0){case 0:i=1;break;case 1:i=2;break;case 2:var b=r._0;if(B.TAG===0){var z=B._0;if(b.TAG===0){if(z!==b._0)return{TAG:1,_0:"cannot unify "+k(o)+" with "+k(r)};n=u;continue}var _n=Yn(z);if(_n===void 0)return{TAG:1,_0:'undeclared struct "'+z+'"'};var hn=Tr({hd:[{TAG:2,_0:{TAG:1,_0:b._0}},Dt(_n,me())],tl:u},e);return hn.TAG===0?{TAG:0,_0:hn._0}:{TAG:1,_0:"struct type "+k(r)+" does not match "+z+": "+hn._0}}var Dn=B._0;if(b.TAG===0){var En=b._0,Nn=Yn(En);if(Nn===void 0)return{TAG:1,_0:'undeclared struct "'+En+'"'};var Sn=Tr({hd:[{TAG:2,_0:{TAG:1,_0:Dn}},Dt(Nn,me())],tl:u},e);return Sn.TAG===0?{TAG:0,_0:Sn._0}:{TAG:1,_0:"struct type "+k(o)+" does not match "+En+": "+Sn._0}}var An=Wn.toMap(b._0),dn=Wn.toArray(Dn);return F(we.mapResult(l(dn,function(un,X,Bn){return function(bn){var Rn=bn[0],an=it(Bn,Rn);return an!==void 0?{TAG:0,_0:[bn[1],an]}:{TAG:1,_0:"struct type "+k(X)+' is missing attribute "'+Rn+'" from type "'+k(un)+'"'}}}(o,r,An)),function(un){return un}),function(un,X,Bn,bn){return function(Rn){var an={TAG:2,_0:{TAG:1,_0:Wn.fromArray(_u(ai(Bn,l(bn,function(Pn){return Pn[0]}))),me())}};return Tr(oi(wr(Rn),{hd:[Wn.tail(X),an],tl:un}),e)}}(u,Dn,An,dn))}break}switch(i){case 1:return F(ho(r._0,o,e),function(un){return function(X){return Tr(un,X)}}(u));case 2:return{TAG:1,_0:k(o)+" is not unifiable with "+k(r)}}}}function on(n,e){return Tr({hd:[n,e],tl:0},void 0)}function qs(n,e){return ii(on(n,e))}function js(n,e){return"cannot infer struct type: inferred type "+Wn.show(n,k)+" matches "+w(e,", ",function(t){return t.name})}function Zt(n){var e=ci(Eu(Kn.structs),function(a){return _i(on({TAG:2,_0:{TAG:1,_0:n}},Dt(a,me())),void 0,function(r){return a})}),t=e.length;if(t!==1)return t!==0?{TAG:1,_0:e}:0;var u=e[0];return{TAG:0,_0:u}}function Zs(n){var e;if(typeof n=="number")e=Xe;else switch(n.TAG|0){case 0:e=Et;break;case 1:e=Jn;break;case 2:e=Zn;break;case 3:e=At;break;case 4:e=wt;break}return fr(e)}function Ws(n){var e=0;if(n>=5)switch(n){case 5:case 6:case 7:case 8:e=2;break;case 9:case 10:e=3;break;case 11:case 12:return fr($n([Zn,Zn],Zn));case 13:case 14:case 15:case 16:e=1;break}else e=1;switch(e){case 1:return fr($n([Jn,Jn],Jn));case 2:return fr($n([Jn,Jn],Zn));case 3:return[[0],$n([{TAG:0,_0:0},{TAG:0,_0:0}],Zn)]}}function Js(n){switch(n){case 0:return fr($n([Jn],Jn));case 1:return fr($n([Zn],Zn));case 2:return[[0],$n([E_({TAG:0,_0:0})],{TAG:0,_0:0})]}}var Gr=Br();function Eo(n,e,t,u,a){var r=Xn.typeOf(t);Re(Gr,r);var o=wn(e,n,function(_,f){return Vn.addMono(_,f.contents.name,f.contents.ty)}),i=$n(l(e,function(_){return _.contents.ty}),r),c=a!==void 0?Vn.addMono(o,a,i):o;return F(mn(c,t,r),function(_){var f=A(_,i),d=A(_,u),R=gn(_,n),B=bt(R,f);return Q(on(d,f),function(b){mr(Gr);var z=M(b,_);return[z,A(b,d),za(b,B)]})})}function mn(n,e,t){return F(oe(n,e),function(u){return Q(on(A(u,t),A(u,Xn.typeOf(e))),function(a){return M(a,u)})})}function oe(n,e){switch(e.TAG|0){case 0:var t=Yr(Zs(e._0));return on(Xn.typeOf(e),t);case 1:var u=e._3,a=e._2,r=e._1,o=e._0;return F(oe(n,r),function(s){var m=gn(s,n);return F(oe(m,u),function(p){var D=M(p,s),L=A(D,$n([Xn.typeOf(r),Xn.typeOf(u)],o)),V=Yr(Ws(a));return Q(on(L,V),function(H){return M(H,D)})})});case 2:var i=e._2,c=e._1,_=e._0,f=Xn.typeOf(i);return F(oe(n,i),function(s){var m=A(s,$n([f],_)),p=Yr(Js(c));return Q(on(m,p),function(D){return M(D,s)})});case 3:var d=e._0.contents,R=Vn.get(n,d.name);if(R!==void 0)return on(d.ty,Yr(R));var B=Yn(d.name);if(B===void 0)return{TAG:1,_0:'unbound variable: "'+d.name+'"'};var b={TAG:2,_0:{TAG:1,_0:Wn.fromArray(l(B.staticFuncs,function(s){var m=s.name;return[m.contents.name,m.contents.ty]}),me())}};return on(d.ty,b);case 4:var z=e._1,_n=e._0,hn=sn.typeOfExpr(_n),Dn=sn.typeOfExpr(z);return F(oe(n,z),function(s){var m=gn(s,n),p=A(s,hn);return F(mn(m,_n,p),function(D){var L=M(D,s),V=A(D,p),H=A(L,Dn);return Q(on(V,H),function(x){return M(x,L)})})});case 5:return Q(Eo(n,e._1,e._2,e._0,void 0),function(s){return s[0]});case 6:var En=e._4,Nn=e._3,Sn=e._0,An=e._2.contents,dn=Xn.typeOf(Nn);return F(oe(n,Nn),function(s){var m=gn(s,n),p=A(s,dn),D=A(s,Sn),L=bt(Vn.remove(m,An.name),p),V=Vn.add(m,An.name,L);return F(mn(V,En,D),function(H){var x=M(H,s);return Q(on(A(x,dn),A(x,An.ty)),function(Fn){return M(Fn,x)})})});case 7:var un=e._4,X=e._3,Bn=e._2,bn=e._0,Rn=e._1.contents,an=Xn.typeOf(X);Re(Gr,an);var Pn=$n(l(Bn,function(s){return s.contents.ty}),an),Ln=wn(Bn,n,function(s,m){return Vn.addMono(s,m.contents.name,m.contents.ty)}),ie=Vn.addMono(Ln,Rn.name,Pn);return F(mn(ie,X,an),function(s){var m=gn(s,ie),p=A(s,Pn),D=A(s,bn),L=Vn.add(m,Rn.name,bt(m,p));return F(mn(L,un,D),function(V){var H=M(V,s);return Q(on(Rn.ty,A(V,p)),function(x){return mr(Gr),M(x,H)})})});case 8:var qn=e._2,ce=l(qn,Xn.typeOf),Te=$n(ce,e._0);return Q(F(mn(n,e._1,Te),function(s){return wn(Ze(qn,ce),{TAG:0,_0:[s,gn(s,n)]},function(m,p){var D=p[1],L=p[0];return F(m,function(V){var H=V[1],x=V[0],Fn=A(x,D);return Q(mn(H,L,Fn),function(fe){return[M(fe,x),gn(fe,H)]})})})}),function(s){return s[0]});case 9:var _e=e._2,Qn=e._0;return F(wn(e._1,{TAG:0,_0:[void 0,n]},function(s,m){return F(s,function(p){var D=p[1],L=p[0];return Q(Ks(D,m),function(V){return[M(V,L),gn(V,D)]})})}),function(s){var m=s[0];return _e!==void 0?F(oe(gn(m,n),_e),function(p){var D=Xn.typeOf(_e),L=M(p,m);return Q(on(A(L,Qn),A(L,D)),function(V){return M(V,L)})}):Q(on(A(m,Qn),Xe),function(p){return M(p,m)})});case 10:var ze=e._3,Ge=e._2,be=e._0;return F(mn(n,e._1,Zn),function(s){var m=gn(s,n),p=A(s,be);return F(mn(m,Ge,p),function(D){var L=gn(D,m),V=A(D,p),H=M(D,s);return Q(mn(L,ze,V),function(x){return M(x,H)})})});case 11:var xe=e._1,Ve=Xn.typeOf(xe);return F(oe(n,e._0),function(s){var m=A(s,Ve),p=gn(s,n);return Q(mn(p,xe,m),function(D){return M(D,s)})});case 12:var ge=Fe(Gr);return ge!==void 0?mn(n,Tn(e._0,{TAG:0,_0:0},function(s){return s}),ge):{TAG:1,_0:"'return' used outside of a function"};case 13:return mn(n,e._0,e._1);case 14:var gr=wn(e._0,{TAG:0,_0:[Je,n]},function(s,m){return F(s,function(p){var D=p[1],L=p[0];return F(oe(D,m),function(V){var H=M(V,L),x=gn(V,D);return{TAG:0,_0:[H,x]}})})});return Q(gr,function(s){return s[0]});case 15:var $r=e._1,ke=e._0,hr=Yn(ke);if(hr===void 0)return{TAG:1,_0:'undeclared struct "'+ke+'"'};var Er=hr.attributes,Xr=wn(Or(Er,function(s){return he(s.impl)}),{TAG:0,_0:[n,Je]},function(s,m){var p=m.ty,D=m.name;return F(s,function(L){var V=L[1],H=L[0],x=zr($r,function(Fn){return Fn[0]===D});return x!==void 0?F(mn(H,x[1],p),function(Fn){var fe=gn(Fn,H),tr=M(Fn,V);return{TAG:0,_0:[fe,tr]}}):{TAG:1,_0:'missing attribute "'+D+'" for struct "'+ke+'"'}})}),nr=we.firstSomeBy($r,function(s){var m=s[0];if(!lt(Er,function(p){return p.name===m}))return m});return nr!==void 0?{TAG:1,_0:'extraneous attribute: "'+nr+'" for struct "'+ke+'"'}:Q(Xr,function(s){return s[1]});case 16:var De=e._1,Lr=e._0,er=kr(),rr;if(De.TAG===0)rr=mn(n,De._0,er);else{var tt=wn(De._0,{TAG:0,_0:[Je,n]},function(s,m){return F(s,function(p){var D=p[1],L=p[0],V=A(L,er);return F(mn(D,m,V),function(H){var x=M(H,L),Fn=gn(H,D);return{TAG:0,_0:[x,Fn]}})})});rr=Q(tt,function(s){return s[0]})}var Cr=T(sn.ArrayInit.len,De);return F(rr,function(s){return Q(on(Lr,$a(er,Cr)),function(m){return M(m,s)})});case 17:var S=e._2,$=e._1,Ne=e._0;return F(oe(n,$),function(s){var m=sn.typeOfExpr($),p=A(s,m),D=function(nn){return Au(p,A(nn,m))?mn(gn(nn,n),e,A(nn,Ne)):{TAG:0,_0:nn}};switch(p.TAG|0){case 0:case 1:break;case 2:var L=p._0;if(L.TAG===0){var V=L._0,H=Yn(V);if(H===void 0)return{TAG:1,_0:'undeclared struct: "'+V+'"'};var x=zr(H.attributes,function(nn){return nn.name===S});if(x===void 0)return{TAG:1,_0:'attribute "'+S+'" does not exist on struct "'+V+'"'};var Fn=Tn(x.impl,x.ty,function(nn){return nn[0].contents.ty});return Q(on(A(s,Ne),A(s,Fn)),function(nn){return M(nn,s)})}var fe=L._0,tr=it(Wn.toMap(fe),S);if(tr!==void 0)return Q(on(A(s,Ne),A(s,tr)),function(nn){return M(nn,s)});var ur=Wn.insert(fe,S,Ne),ar=A(s,{TAG:2,_0:{TAG:1,_0:ur}}),Be=Zt(ur);if(typeof Be!="number")return Be.TAG===0?F(on(p,{TAG:2,_0:{TAG:0,_0:Be._0.name}}),function(nn){return D(M(nn,s))}):F(on(p,ar),function(nn){return D(M(nn,s))});var Pe=0;switch(m.TAG|0){case 0:return{TAG:0,_0:M(hu(Je,m._0,ar),s)};case 1:case 2:Pe=2;break}if(Pe===2)return Q(on(m,ar),function(nn){return M(nn,s)});break}var ut=me(),Ur=Wn.insert(Wn.make({TAG:0,_0:ut}),S,Ne),or=A(s,{TAG:2,_0:{TAG:1,_0:Ur}}),qe=Zt(Ur);return typeof qe=="number"?{TAG:1,_0:"no struct declaration matches type "+k(or)}:qe.TAG===0?F(on(p,{TAG:2,_0:{TAG:0,_0:qe._0.name}}),function(nn){return D(M(nn,s))}):F(on(p,or),function(nn){return D(M(nn,s))})})}}function Ks(n,e){return oe(n,e._0)}function Wt(n,e){return n+"_"+e}function Ao(n,e){switch(e.TAG|0){case 0:var t=e._0.contents;return Q(Eo(n,l(e._1,function(c){return c[0]}),e._2,t.ty,t.newName),function(c){var _=c[0];return[gn(_,Vn.addMono(n,t.name,t.ty)),_]});case 1:var u=e._0;return Q(mn(n,e._2,u.contents.ty),function(c){return[gn(c,Vn.addMono(n,u.contents.name,u.contents.ty)),c]});case 2:return{TAG:0,_0:[n,Je]};case 3:var a=e._0,r=Yn(a);return r!==void 0?wn(e._1,{TAG:0,_0:[n,Je]},function(c,_){var f=_[2],d=_[1],R=_[0];return F(c,function(B){var b=B[1],z=B[0];R.contents.newName=Wt(a,R.contents.name);var _n=Tn(je(d,0),[!1,!1],function(dn){return dn[0].contents.name==="self"?[!0,dn[1]]:[!1,!1]}),hn;if(_n[0]){U_(r,R,_n[1]);var Dn=Mn(d,[])?[]:si(d,1),En={TAG:2,_0:{TAG:0,_0:a}},Nn=je(d,0),Sn;if(Nn!==void 0){var An=Nn[0];An.contents.ty=En,Sn=Vn.addMono(z,An.contents.name,En)}else Sn=z;hn=[Sn,Dn]}else M_(r,R),hn=[n,d];return F(Ao(hn[0],{TAG:0,_0:R,_1:hn[1],_2:f}),function(dn){var un=M(dn[1],b);Ba(un,R);var X=Vn.remove(dn[0],R.contents.name);return{TAG:0,_0:[X,un]}})})}):{TAG:1,_0:'cannot implement for unknown type "'+a+'"'};case 4:var o=e.name,i=$n(l(e.args,function(c){return c[0].contents.ty}),e.ret);return Q(on(o.contents.ty,i),function(c){return[gn(c,Vn.addMono(n,o.contents.name,o.contents.ty)),c]})}}function wo(n){return fi(Gr),wn(n,{TAG:0,_0:[Vn.empty,Je]},function(e,t){return F(e,function(u){var a=u[1];return Q(Ao(u[0],t),function(r){return[r[0],M(r[1],a)]})})})}var Se=Gn("CompilerExn.InvalidTypeConversion"),Jt=Gn("CompilerExn.InvalidFunctionSignature"),yr=Gn("CompilerExn.VariableNotFound"),mo=Gn("CompilerExn.EmptyFunctionStack"),Ie=Gn("CompilerExn.CannotReassignImmutableValue"),So=Gn("CompilerExn.FunctionNotFound"),Oe=Gn("CompilerExn.Unimplemented"),Ys=Gn("CompilerExn.UnsupportedGlobalInitializer"),y=Gn("CompilerExn.InvalidTypeAssertion"),po=Gn("CompilerExn.DerefUsedOutsideOfUnsafeBlock"),xr=Gn("CompilerExn.InvalidAttributeAccess");function Fr(n){return n.RE_EXN_ID===Se?"unsupported type: "+k(n._1):n.RE_EXN_ID===Jt?"invalid function signature: "+k(n._1):n.RE_EXN_ID===yr?'variable "'+n._1+'" not found':n.RE_EXN_ID===mo?"Function stack is empty":n.RE_EXN_ID===Ie?'cannot mutate "'+n._1+'" as it is behind an immutable binding':n.RE_EXN_ID===So?'no function named "'+n._1+'" found':n.RE_EXN_ID===Oe?"unimplemented: "+n._1:n.RE_EXN_ID===Ys?"unsupported global initializer: "+Xn.show(void 0,n._1):n.RE_EXN_ID===y?"invalid type assertion from "+k(n._1)+" to "+k(n._2):n.RE_EXN_ID===po?"the deref operator can only be used in an unsafe block":n.RE_EXN_ID===re.UnkownTypeSize?"unknown type size: "+k(n._1):n.RE_EXN_ID===Nt?'undeclared struct "'+n._1+'"':n.RE_EXN_ID===xr?n._1+' does not exist for type "'+k(n._2)+'"':n.RE_EXN_ID===Rt?"No struct declaration matches type "+k(n._1):n.RE_EXN_ID===Va?js(n._1,n._2):n.RE_EXN_ID===sn.UndeclaredIdentifer?'identifier "'+n._1+'" not found':n.RE_EXN_ID===sn.UnexpectedDeclarationInImplBlock?"unexpected declaration in impl block: "+Ce.show(void 0,n._1):n.RE_EXN_ID===sn.UnreachableLetStmt?"unreachable: let statement found in Core.fromStmt":j_(n,function(e){return console.log(e),"unhandled compiler exception"})}function Hs(n,e,t,u){return{name:n,depth:e,ty:t,isMutable:u}}function Kt(n){if(n.TAG===0){var e=n._0,t=Yn(e);if(t!==void 0)return t;throw{RE_EXN_ID:Nt,_1:e,Error:new Error}}var u=n._0,a=Zt(u);if(typeof a=="number")throw{RE_EXN_ID:Rt,_1:{TAG:2,_0:n},Error:new Error};if(a.TAG===0)return a._0;throw{RE_EXN_ID:Va,_1:u,_2:a._0,Error:new Error}}function ye(n){switch(n.TAG|0){case 0:throw{RE_EXN_ID:Se,_1:n,Error:new Error};case 1:switch(n._0){case"()":if(n._1.length!==0)throw{RE_EXN_ID:Se,_1:n,Error:new Error};return[];case"Array":var e=n._1;if(e.length!==2)throw{RE_EXN_ID:Se,_1:n,Error:new Error};var t=e[1];switch(t.TAG|0){case 1:if(t._1.length!==0)throw{RE_EXN_ID:Se,_1:n,Error:new Error};return[0];case 0:case 2:throw{RE_EXN_ID:Se,_1:n,Error:new Error}}case"Fun":case"Ptr":return[0];case"Tuple":return cn(l(n._1,ye));case"u64":if(n._1.length!==0)throw{RE_EXN_ID:Se,_1:n,Error:new Error};return[1];case"bool":case"char":case"str":case"u32":case"u8":break;default:throw{RE_EXN_ID:Se,_1:n,Error:new Error}}if(n._1.length!==0)throw{RE_EXN_ID:Se,_1:n,Error:new Error};return[0];case 2:var u=Kt(n._0);return u.size===0?[]:[0]}}function Qs(n,e){switch(e.TAG|0){case 1:if(e._0==="Tuple"){var t=cn(l(e._1,ye)),u=[],a={_0:u,_1:t},r=zn.getOrAddSignature(n,a);return{TAG:1,_0:r,_1:[[],t]}}break}var o=ye(e),i=o.length;if(i!==1){if(i===0)return 0;throw{RE_EXN_ID:Oe,_1:"wasmBlockReturnTypeOf for "+k(e),Error:new Error}}var c=o[0];return{TAG:0,_0:c}}function Yt(n){switch(n.TAG|0){case 1:if(n._0==="Fun"){var e=n._1,t=e.slice(0,e.length-1|0),u=je(e,e.length-1|0);return vt(pr.Signature.make,cn(l(t,ye)),Tn(u,[],ye))}throw{RE_EXN_ID:Jt,_1:n,Error:new Error};case 0:case 2:throw{RE_EXN_ID:Jt,_1:n,Error:new Error}}}function Ht(n,e,t){return{name:n,locals:[],params:Or(e,function(u){return!re.isZeroSizedType(u[1])}),ret:t,instructions:[]}}function E(n,e){n.instructions.push(e)}function Is(n,e,t,u,a){return n.locals.push(Hs(e,u,t,a)),(n.params.length+n.locals.length|0)-1|0}function ys(n,e){var t=ot(n.params,function(r){return r[0]===e});if(t!==void 0){var u=Ee(n.params,t);return[t,u[2]]}var a=we.getReverseIndexBy(n.locals,function(r){return r.name===e});if(a!==void 0)return[n.params.length+a|0,Ee(n.locals,a).isMutable]}function xs(n){var e=Yt($n(l(n.params,function(a){return a[1]}),n.ret)),t=T(pr.Local.fromTypes,cn(l(n.locals,function(a){return l(ye(a.ty),function(r){return[a.name,r]})}))),u=vt(pr.Body.make,t,Ps(void 0,n.instructions));return pr.make(n.name,e,u)}function bo(n,e,t,u,a){return{name:n,mutability:e,ty:t,index:u,init:a}}function n1(n){var e=n.init,t=n.mutability;return K(n.ty,function(u){return br.make(t!==2,u,e)})}function h(n){var e=Fe(n.funcStack);if(e!==void 0)return e;throw{RE_EXN_ID:mo,Error:new Error}}function Qt(n,e){return K(we.getValueAndIndexBy(n.funcs,function(t){return t.name===e}),function(t){var u=n.externFuncs.length;return[t[0],u+t[1]|0]})}function e1(n,e){return we.getValueAndIndexBy(n.externFuncs,function(t){return t.name===e})}function It(n){switch(n.TAG|0){case 0:return 0;case 1:switch(n._0){case"Array":var e=n._1;if(e.length!==2)return 0;var t=e[0],u=e[1];switch(u.TAG|0){case 1:return u._1.length!==0?0:Math.imul(gu(u._0),re.size(t));case 0:case 2:return 0}case"Tuple":return wn(l(n._1,It),0,function(i,c){return i+c|0});default:return 0}case 2:var a=n._0;if(a.TAG===0){var r=a._0,o=Yn(r);if(o!==void 0)return o.size;throw{RE_EXN_ID:Nt,_1:r,Error:new Error}}throw{RE_EXN_ID:Rt,_1:n,Error:new Error}}}function ko(n,e){var t=Fe(n.blockStack);if(t!==void 0&&!(e<=0)){var u=t.shadowStackDelta;return u.contents=u.contents+e|0,E(h(n),{TAG:9,_0:n.stackTop.index}),E(h(n),{TAG:0,_0:e}),E(h(n),5),E(h(n),{TAG:10,_0:n.stackTop.index})}}function r1(n,e){var t=Fe(n.blockStack);if(t!==void 0&&!(e<=0)){var u=t.shadowStackDelta;return u.contents=u.contents-e|0,E(h(n),{TAG:9,_0:n.stackTop.index}),E(h(n),{TAG:0,_0:e}),E(h(n),4),E(h(n),{TAG:10,_0:n.stackTop.index})}}function Do(n){var e=Fe(n.blockStack);return e!==void 0?e.isUnsafe:!1}function No(n,e){return n.scopeDepth=n.scopeDepth+1|0,Re(n.blockStack,{isUnsafe:e||Do(n),shadowStackDelta:{contents:0}})}function t1(n){n.scopeDepth=n.scopeDepth-1|0,r1(n,Tn(Fe(n.blockStack),0,function(e){return e.shadowStackDelta.contents})),mr(n.blockStack)}function yt(n,e,t,u){var a=h(n),r=Is(a,e,t,n.scopeDepth,u);return E(h(n),{TAG:12,_0:r}),r}function Ro(n,e,t,u,a){var r=Ti(n.globals),o=bo(e,t,u,r,a);return ft(n.globals,e,o),r}function u1(n,e){var t=h(n);return K(ys(t,e),function(u){return{index:u[0],isMutable:u[1]}})}function nt(n,e){var t=u1(n,e);return t!==void 0?{TAG:0,_0:t.index,_1:t.isMutable}:K(du(n.globals,e),function(u){return{TAG:1,_0:u.index,_1:u.mutability===1}})}function a1(n){if(typeof n!="number")switch(n.TAG|0){case 0:return{TAG:0,_0:n._0&255};case 1:return{TAG:0,_0:n._0&-1};case 2:return{TAG:0,_0:n._0?1:0};case 3:return{TAG:0,_0:n._0};case 4:return}}function Fo(n){if(!Do(n))throw{RE_EXN_ID:po,Error:new Error}}function et(n,e,t){switch(e.TAG|0){case 0:case 1:return{TAG:1,_0:{RE_EXN_ID:xr,_1:t,_2:e}};case 2:var u=Kt(e._0),a=zr(u.attributes,function(i){return i.name===t});if(a===void 0)return{TAG:1,_0:{RE_EXN_ID:xr,_1:t,_2:e}};var r=a.impl;if(r===void 0)return{TAG:0,_0:{TAG:0,_0:{offset:a.offset,ty:a.ty,size:a.size,mut:a.mut}}};var o=Qt(n,Wt(u.name,r[0].contents.name));return o!==void 0?{TAG:0,_0:{TAG:1,_0:[o[0],o[1],r[1]]}}:{TAG:1,_0:{RE_EXN_ID:xr,_1:t,_2:e}}}}function $o(n){return te(void 0,"$lambda"+String(n.funcs.length))}function Xo(n,e){var t=n!==void 0?n:"",u=h(e);return"$"+t+"_local"+String(u.locals.length)}function rt(n,e){for(;;){var t=e;switch(t.TAG|0){case 3:var u=t._0,a=nt(n,u.contents.newName);if(a!==void 0)return a._1?void 0:u.contents.name;throw{RE_EXN_ID:yr,_1:u.contents.name,Error:new Error};case 17:var r=t._2,o=t._1,i=et(n,sn.typeOfExpr(o),r);if(i.TAG===0){var c=i._0;if(c.TAG!==0)return;if(!c._0.mut)return r;e=o;continue}throw i._0;default:return}}}var Lo=function(n){return Array.from(new Uint8Array(new TextEncoder().encode(n).buffer))};function rn(n,e){for(;;){var t=e;switch(t.TAG|0){case 0:var u=t._0;if(typeof u!="number"&&u.TAG===4){var a=Lo(u._0),r=n.staticStringsOffset;return zn.addData(n.mod,vt(ka.Segment.make,a,{_0:0,_1:r})),n.staticStringsOffset=r+a.length|0,E(h(n),{TAG:0,_0:r})}var o=a1(u);return o!==void 0?E(h(n),o):void 0;case 1:var i=t._3,c=t._2,_=t._1;if(re.isZeroSizedType(sn.typeOfExpr(_))){e={TAG:0,_0:{TAG:2,_0:c===9}};continue}var f=function(J,pn){return function(Un){return rn(n,J),rn(n,pn),E(h(n),Un)}}(_,i);switch(c){case 0:return f(4);case 1:return f(5);case 2:return f(6);case 3:return f(7);case 4:return f(43);case 5:return f(31);case 6:return f(19);case 7:return f(37);case 8:return f(25);case 9:return f(10);case 10:return f(14);case 11:e={TAG:10,_0:Zn,_1:_,_2:i,_3:{TAG:0,_0:{TAG:2,_0:!1}}};continue;case 12:e={TAG:10,_0:Zn,_1:_,_2:{TAG:0,_0:{TAG:2,_0:!0}},_3:i};continue;case 13:return f(44);case 14:return f(45);case 15:return f(46);case 16:return f(48)}case 2:var d;switch(t._1){case 0:throw{RE_EXN_ID:Oe,_1:"u32 negation is not handled",Error:new Error};case 1:d=9;break;case 2:Fo(n),d={TAG:16,_0:0,_1:0};break}return rn(n,t._2),E(h(n),d);case 3:var R=t._0;if(re.isZeroSizedType(R.contents.ty))return;var B=nt(n,R.contents.newName);if(B!==void 0)return B.TAG===0?E(h(n),{TAG:11,_0:B._0}):E(h(n),{TAG:9,_0:B._0});throw{RE_EXN_ID:yr,_1:R.contents.name,Error:new Error};case 4:var b=t._1,z=t._0;if(re.isZeroSizedType(sn.typeOfExpr(b)))return;switch(z.TAG|0){case 2:if(z._1>=2){Fo(n),rn(n,z._2),rn(n,b);var _n=re.sizeLog2(sn.typeOfExpr(b)),hn={TAG:17,_0:_n,_1:0};return E(h(n),hn)}throw{RE_EXN_ID:Oe,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error};case 3:var Dn=z._0,En=nt(n,Dn.contents.newName);if(En!==void 0){if(En._1){var Nn;return Nn=En.TAG===0?{TAG:12,_0:En._0}:{TAG:10,_0:En._0},rn(n,b),E(h(n),Nn)}throw{RE_EXN_ID:Ie,_1:Dn.contents.name,Error:new Error}}throw{RE_EXN_ID:yr,_1:Dn.contents.name,Error:new Error};case 17:var Sn=z._2,An=z._1,dn=et(n,sn.typeOfExpr(An),Sn);if(dn.TAG===0){var un=dn._0;if(un.TAG===0){var X=un._0;if(!X.mut)throw{RE_EXN_ID:Ie,_1:Sn,Error:new Error};var Bn=rt(n,An);if(Bn!==void 0)throw{RE_EXN_ID:Ie,_1:Bn,Error:new Error};return X.size>0?(rn(n,An),rn(n,b),E(h(n),{TAG:17,_0:0,_1:X.offset})):void 0}throw{RE_EXN_ID:Oe,_1:"cannot reassign "+Sn+" for type "+k(sn.typeOfExpr(An)),Error:new Error}}throw dn._0;default:throw{RE_EXN_ID:Oe,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error}}case 5:var bn=$o(n),Rn=xt(n,bn,l(t._1,function(J){return[J,!1]}),t._2);return E(h(n),{TAG:0,_0:Rn});case 6:var an=t._3,Pn=t._2.contents;re.isZeroSizedType(sn.typeOfExpr(an))||(rn(n,an),yt(n,Pn.name,Pn.ty,t._1)),e=t._4;continue;case 7:var Ln=$o(n);t._1.contents.newName=Ln.contents.name,xt(n,Ln,l(t._2,function(J){return[J,!1]}),t._3),e=t._4;continue;case 8:var ie=t._2,qn=t._1,ce=function(J){return function(Cn){return kn(J,function(Un){return rn(n,Un)}),E(h(n),{TAG:14,_0:Cn})}}(ie),Te=function(J,pn){return function(Un){kn(pn,function(Mo){return rn(n,Mo)});var at=sn.typeOfExpr(J),Mr=Yt(at),Ar=zn.getOrAddSignature(n.mod,Mr);return rn(n,J),E(h(n),{TAG:15,_0:Ar,_1:0})}}(qn,ie),_e=function(J){return function(Cn,Un){var at=Un!==void 0?tn([Un],J):J;return kn(Ze(at,Cn),function(Mr){var Ar=Mr[1];if(!!(Ar[2]&&mt(Ar[1])&&Vr(rt(n,Mr[0]))))throw{RE_EXN_ID:Ie,_1:Ar[0],Error:new Error}})}}(ie);switch(qn.TAG|0){case 3:var Qn=qn._0,ze=nt(n,Qn.contents.newName);if(ze!==void 0)return Te(void 0);var Ge=Qt(n,Qn.contents.newName);if(Ge!==void 0)return _e(Ge[0].params,void 0),ce(Ge[1]);var be=e1(n,Qn.contents.newName);if(be!==void 0)return _e(be[0].args,void 0),ce(be[1]);throw{RE_EXN_ID:So,_1:Qn.contents.name,Error:new Error};case 17:var xe=qn._2,Ve=qn._1,ge;if(Ve.TAG===3){var gr=Ve._0.contents.name,$r=Yn(gr);if($r!==void 0){var ke=Qt(n,Wt(gr,xe));if(ke!==void 0)ge=[!1,ke[0],ke[1]];else throw{RE_EXN_ID:Oe,_1:'static function "'+xe+'" does not exists on struct '+gr,Error:new Error}}else ge=[!0,void 0,void 0]}else ge=[!0,void 0,void 0];var hr=ge[2],Er=ge[1],Xr=ge[0],nr;if(Er!==void 0)nr=Er;else{var De=et(n,sn.typeOfExpr(Ve),xe);if(De.TAG===0){var Lr=De._0;nr=Lr.TAG===0?void 0:Lr._0[0]}else throw De._0}return Tn(nr,void 0,function(J,pn){return function(Cn){var Un=pn?J:void 0;return _e(Cn.params,Un)}}(Ve,Xr)),Xr&&rn(n,Ve),hr!==void 0?ce(hr):Te(void 0);default:return Te(void 0)}case 9:var er=t._2;return No(n,t._3===1),kn(t._1,function(J){return o1(n,J)}),er!==void 0&&rn(n,er),t1(n);case 10:var rr=t._3,tt=Qs(n.mod,t._0);return rn(n,t._1),E(h(n),{TAG:4,_0:tt}),rn(n,t._2),Au(rr,{TAG:0,_0:0})&&(E(h(n),0),rn(n,rr)),E(h(n),1);case 11:return E(h(n),{TAG:7,_0:0}),E(h(n),{TAG:8,_0:0}),rn(n,t._0),E(h(n),9),E(h(n),{TAG:5,_0:1}),rn(n,t._1),E(h(n),{TAG:6,_0:0}),E(h(n),1),E(h(n),1);case 12:var Cr=t._0;return Cr!==void 0&&rn(n,Cr),E(h(n),2);case 13:var S=t._2,$=t._1;if(!Mn($,S))switch($.TAG|0){case 1:switch($._0){case"Array":var Ne=$._1;if(Ne.length!==2)throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};var s=Ne[0];switch(S.TAG|0){case 1:if(S._0==="Ptr"){var m=S._1;if(m.length!==1)throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};var p=m[0];if(!qs(s,p))throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error}}else throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error}}break;case"Ptr":var D=$._1;if(D.length!==1)throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};var L=D[0];switch(L.TAG|0){case 1:if(L._0==="u32"){if(L._1.length!==0)throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};switch(S.TAG|0){case 1:if(S._0==="u32"){if(S._1.length!==0)throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error}}else throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error}}}else throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error}}break;case"str":if($._1.length!==0)throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};switch(S.TAG|0){case 1:if(S._0==="Ptr"){var V=S._1;if(V.length!==1)throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};var H=V[0];switch(H.TAG|0){case 1:if(H._0==="char"){if(H._1.length!==0)throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error}}else throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error}}}else throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error}}break;case"u32":if($._1.length!==0)throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};switch(S.TAG|0){case 1:switch(S._0){case"Ptr":if(S._1.length!==1)throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};break;case"u8":if(S._1.length!==0)throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error};break;default:throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error}}break;case 0:case 2:throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error}}break;default:throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error}}break;case 0:case 2:throw{RE_EXN_ID:y,_1:$,_2:S,Error:new Error}}e=t._0;continue;case 14:return kn(t._0,function(J){return rn(n,J)});case 15:var x=t._1,Fn=st(Yn(t._0)),fe=Fn.size;ko(n,fe),kn(Ze(Fn.attributes,x),function(J){var pn=J[0],Cn=pn.ty;if(pn.mut&&mt(Cn)){var Un=rt(n,J[1][1]);if(Un!==void 0)throw{RE_EXN_ID:Ie,_1:Un,Error:new Error}}if(he(pn.impl)&&re.size(Cn)>0)return E(h(n),{TAG:9,_0:n.stackTop.index})}),fe>0&&E(h(n),{TAG:9,_0:n.stackTop.index});var tr={contents:0};return kn(x,function(J){return function(pn){var Cn=nu(n,pn[1],J.contents);J.contents=J.contents+Cn|0}}(tr));case 16:var ur=t._1,ar=It(t._0);ko(n,ar),E(h(n),{TAG:9,_0:n.stackTop.index});var Be=yt(n,Xo("arrayAddr",n),Jn,!0);if(ur.TAG===0){E(h(n),{TAG:0,_0:0});var Pe=yt(n,Xo("addr",n),Jn,!0);E(h(n),{TAG:7,_0:0}),E(h(n),{TAG:8,_0:0}),E(h(n),{TAG:11,_0:Pe}),E(h(n),{TAG:0,_0:ar}),E(h(n),10),E(h(n),{TAG:5,_0:1}),E(h(n),{TAG:11,_0:Be}),E(h(n),{TAG:11,_0:Pe}),E(h(n),4);var ut=nu(n,ur._0,0);E(h(n),{TAG:11,_0:Pe}),E(h(n),{TAG:0,_0:ut}),E(h(n),4),E(h(n),{TAG:12,_0:Pe}),E(h(n),{TAG:6,_0:0}),E(h(n),1),E(h(n),1)}else{var Ur={contents:0};kn(ur._0,function(J,pn){return function(Cn){E(h(n),{TAG:11,_0:J});var Un=nu(n,Cn,pn.contents);pn.contents=pn.contents+Un|0}}(Be,Ur))}return E(h(n),{TAG:11,_0:Be});case 17:var or=t._1,qe=et(n,sn.typeOfExpr(or),t._2);if(qe.TAG===0){var nn=qe._0;if(nn.TAG===0){var ru=nn._0;return re.isZeroSizedType(ru.ty)?void 0:(rn(n,or),E(h(n),{TAG:16,_0:0,_1:ru.offset}))}var tu=nn._0;if(tu[2]){var uu=rt(n,or);if(uu!==void 0)throw{RE_EXN_ID:Ie,_1:uu,Error:new Error}}return E(h(n),{TAG:0,_0:tu[1]})}throw qe._0}}}function o1(n,e){var t=e._0;return rn(n,t),kn(ye(Xn.typeOf(t)),function(u){return E(h(n),3)})}function xt(n,e,t,u){var a=l(t,function(i){var c=i[0];return[c.contents.name,c.contents.ty,i[1]||!mt(c.contents.ty)]}),r=Ht(e.contents.newName,a,Xn.typeOf(u)),o=n.funcs.push(r)-1|0;return Re(n.funcStack,r),rn(n,u),E(h(n),1),mr(n.funcStack),o}function i1(n,e){var t=Ht("__isolated__",[],sn.typeOfExpr(e));return Re(n.funcStack,t),rn(n,e),mr(n.funcStack),t}function Co(n,e){switch(e.TAG|0){case 0:xt(n,e._0,e._1,e._2);return;case 1:var t=e._1,u=e._0;No(n,!1);var a=i1(n,e._2),r=a.instructions;if(r.length===1){var o=r[0];if(typeof o!="number"&&o.TAG===0){Ro(n,u.contents.name,t?1:2,0,T(br.Initializer.fromInstructions,[{TAG:0,_0:o._0}]));return}}vi(n.globalsInitializer.instructions,"push",[r]);var i=Ro(n,u.contents.name,t?1:0,0,T(br.Initializer.fromInstructions,[{TAG:0,_0:0}]));n.globalsInitializer.instructions.push({TAG:10,_0:i});return;case 2:return;case 3:return kn(e._1,function(d){return Co(n,{TAG:0,_0:d[0],_1:d[1],_2:d[2]})});case 4:var c=e.name,_=Yt(c.contents.ty),f=zn.getOrAddSignature(n.mod,_);zn.addImport(n.mod,va.make("index",c.contents.name,{_0:f})),n.externFuncs.push({name:c.contents.name,args:l(e.args,function(d){var R=d[0];return[R.contents.name,R.contents.ty,d[1]]}),ret:e.ret});return}}function nu(n,e,t){var u=function(o){return rn(n,e),E(h(n),{TAG:17,_0:0,_1:t}),o},a=Xn.typeOf(e);switch(a.TAG|0){case 0:break;case 1:var r=0;switch(a._0){case"()":if(a._1.length===0)return 0;break;case"Fun":return u(4);case"Ptr":if(a._1.length===1)return u(4);break;case"bool":case"u32":r=2;break;case"char":case"u8":r=3;break}switch(r){case 2:if(a._1.length===0)return u(4);break;case 3:if(a._1.length===0)return u(1);break}break;case 2:return Kt(a._0),u(4)}throw{RE_EXN_ID:Oe,_1:"cannot store "+k(a)+" in the shadow stack",Error:new Error}}function c1(n){var e=Br(),t={contents:0},u=function(c){return Re(e,{contents:0})},a=function(c){switch(c.TAG|0){case 0:var _=c._0;if(typeof _=="number"||_.TAG!==4)return;t.contents=t.contents+Lo(_._0).length|0;return;case 15:case 16:break;default:return}var f=It(sn.typeOfExpr(c)),d=Fe(e);if(d!==void 0){d.contents=d.contents+f|0;return}else return Re(e,{contents:f})},r=function(c){var _=Fe(e);if(_!==void 0)return Re(e,{contents:-_.contents|0})};sn.visitProg(N(u),N(r),a,n);var o={contents:0},i={contents:0};return di(e,function(c){var _=c.contents;i.contents=i.contents+_|0,o.contents=o.contents>i.contents?o.contents:i.contents}),t.contents+o.contents|0}function _1(n){var e=c1(n),t={mod:zn.make(void 0),funcs:[],scopeDepth:0,funcStack:Br(),globals:vu(1),globalsInitializer:Ht("__initGlobals__",[],Xe),stackTop:bo("__STACK_TOP__",1,0,0,T(br.Initializer.fromInstructions,[{TAG:0,_0:e}])),blockStack:Br(),externFuncs:[],options:{useBulkMemoryInstructions:!1},staticStringsOffset:0};ft(t.globals,t.stackTop.name,t.stackTop);try{kn(n,function(c){return Co(t,c)});var u=(Math.ceil(e/65536)|0)+16|0;zn.addMemory(t.mod,aa.make(gt.make(u,void 0))),zn.addExport(t.mod,Vu.make("memory",2,0)),kn(li(Eu(t.globals),function(c,_){return c.index-_.index|0}),function(c){var _=n1(c);if(_!==void 0)return zn.addGlobal(t.mod,_)});var a=Hu.fromFuncRefs(0,ou(t.funcs,function(c,_){return c}));zn.addElement(t.mod,a),zn.addTable(t.mod,Zu.make(0,gt.makeExact(t.funcs.length)));var r=t.funcs.length,o=t.globalsInitializer.instructions.length===0;return o||(t.globalsInitializer.instructions.push(1),t.funcs.push(t.globalsInitializer)),kn(t.funcs,function(c){c.name==="main"&&!o&&c.instructions.unshift({TAG:14,_0:r});var _=xs(c);zn.addExportedFunc(t.mod,c.name,_[1],_[2])}),{TAG:0,_0:t.mod}}catch(c){var i=Sr(c);return{TAG:1,_0:Fr(i)}}}function f1(n){try{return F(Ir(n),function(t){var u=l(t,Ce.from);return F(wo(u),function(a){var r=a[1];Pa(r);var o=l(u,function(i){return Ce.subst(r,i)});return Q(_1(o),function(i){var c=zn.encodeAsUint8Array(i);return[i,c]})})})}catch(t){var e=Sr(t);return{TAG:1,_0:Fr(e)}}}function s1(n){try{var e=Ir(n);return e.TAG===0?{TAG:0,_0:w(e._0,`

`,function(u){return L_.show(u)})}:{TAG:1,_0:e._0}}catch(u){var t=Sr(u);return{TAG:1,_0:Fr(t)}}}function l1(n){try{var e=Ir(n);if(e.TAG!==0)return{TAG:1,_0:e._0};var t=l(e._0,Ce.from);return{TAG:0,_0:w(t,`

`,function(a){return Ce.show(void 0,a)})}}catch(a){var u=Sr(a);return{TAG:1,_0:Fr(u)}}}function v1(n){try{var e=Ir(n);if(e.TAG!==0)return{TAG:1,_0:e._0};var t=l(e._0,Ce.from),u=wo(t);if(u.TAG!==0)return{TAG:1,_0:u._0};var a=u._0[1];Pa(a);var r=l(t,function(i){return Ce.subst(a,i)});return{TAG:0,_0:w(r,`

`,function(i){return Ce.show(N(N(a)),i)})}}catch(i){var o=Sr(i);return{TAG:1,_0:Fr(o)}}}var d1={debugAst:s1,debugCoreAst:l1,debugTypes:v1},T1=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",compile:f1,Debug:d1});const eu={"0":"Else","1":"End","2":"Return","3":"Drop","4":"AddI32","5":"SubI32","6":"MulI32","7":"DivI32Unsigned","8":"DivI32Signed","9":"EqzI32","10":"EqI32","11":"EqI64","12":"EqF32","13":"EqF64","14":"NeI32","15":"NeI64","16":"NeF32","17":"NeF64","18":"LeI32Signed","19":"LeI32Unsigned","20":"LeI64Signed","21":"LeI64Unsigned","22":"LeF32","23":"LeF64","24":"GeI32Signed","25":"GeI32Unsigned","26":"GeI64Signed","27":"GeI64Unsigned","28":"GeF32","29":"GeF64","30":"LtI32Signed","31":"LtI32Unsigned","32":"LtI64Signed","33":"LtI64Unsigned","34":"LtF32","35":"LtF64","36":"GtI32Signed","37":"GtI32Unsigned","38":"GtI64Signed","39":"GtI64Unsigned","40":"GtF32","41":"GtF64","42":"RemI32Signed","43":"RemI32Unsigned","44":"AndI32","45":"OrI32","46":"ShlI32","47":"ShrI32Signed","48":"ShrI32Unsigned"},U={"0":"I32","1":"I64","2":"F32","3":"F64"},G1={"0":"FuncRef","1":"ExternRef"},g1={"0":"Func","1":"Table","2":"Memory","3":"Global"},pe={"0":"Void"},h1={"0":"Passive"},E1=T1,Uo=function(n){const e=E1.compile(n);return e.TAG===0?{tag:"Ok",value:[{typeSection:e._0[0].typeSection.map(function(u){return[u._0.map(function(r){return U[r]}),u._1.map(function(r){return U[r]})]}),importSection:e._0[0].importSection.map(function(u){return{moduleName:u.moduleName,entityName:u.entityName,desc:{tag:"Func",value:u.desc._0}}}),funcSection:e._0[0].funcSection,tableSection:e._0[0].tableSection.map(function(u){return[G1[u[0]],u[1]]}),memorySection:e._0[0].memorySection,globalSection:e._0[0].globalSection.map(function(u){return[U[u[0]],u[1],u[2].map(function(r){return typeof r=="object"?r.TAG===0?{tag:"ConstI32",value:r._0}:r.TAG===1?{tag:"ConstI64",value:r._0}:r.TAG===2?{tag:"ConstF32",value:r._0}:r.TAG===3?{tag:"ConstF64",value:r._0}:r.TAG===4?{tag:"If",value:typeof r._0=="object"?r._0.TAG===0?{tag:"TypeValue",value:U[r._0._0]}:{tag:"TypeIndex",value:[r._0._0,[r._0._1[0].map(function(i){return U[i]}),r._0._1[1].map(function(i){return U[i]})]]}:pe[r._0]}:r.TAG===5?{tag:"BranchIf",value:r._0}:r.TAG===6?{tag:"Branch",value:r._0}:r.TAG===7?{tag:"Block",value:typeof r._0=="object"?r._0.TAG===0?{tag:"TypeValue",value:U[r._0._0]}:{tag:"TypeIndex",value:[r._0._0,[r._0._1[0].map(function(i){return U[i]}),r._0._1[1].map(function(i){return U[i]})]]}:pe[r._0]}:r.TAG===8?{tag:"Loop",value:typeof r._0=="object"?r._0.TAG===0?{tag:"TypeValue",value:U[r._0._0]}:{tag:"TypeIndex",value:[r._0._0,[r._0._1[0].map(function(i){return U[i]}),r._0._1[1].map(function(i){return U[i]})]]}:pe[r._0]}:r.TAG===9?{tag:"GetGlobal",value:r._0}:r.TAG===10?{tag:"SetGlobal",value:r._0}:r.TAG===11?{tag:"GetLocal",value:r._0}:r.TAG===12?{tag:"SetLocal",value:r._0}:r.TAG===13?{tag:"TeeLocal",value:r._0}:r.TAG===14?{tag:"Call",value:r._0}:r.TAG===15?{tag:"CallIndirect",value:[r._0,r._1]}:r.TAG===16?{tag:"LoadI32",value:[r._0,r._1]}:r.TAG===17?{tag:"StoreI32",value:[r._0,r._1]}:r.TAG===18?{tag:"InitMemory",value:r._0}:{tag:"DropData",value:r._0}:eu[r]})]}),exportSection:e._0[0].exportSection.map(function(u){return{name:u.name,kind:g1[u.kind],index:u.index}}),elementSection:e._0[0].elementSection,codeSection:e._0[0].codeSection.map(function(u){return[u[0].map(function(r){return[r[0],U[r[1]]]}),u[1].map(function(r){return typeof r=="object"?r.TAG===0?{tag:"ConstI32",value:r._0}:r.TAG===1?{tag:"ConstI64",value:r._0}:r.TAG===2?{tag:"ConstF32",value:r._0}:r.TAG===3?{tag:"ConstF64",value:r._0}:r.TAG===4?{tag:"If",value:typeof r._0=="object"?r._0.TAG===0?{tag:"TypeValue",value:U[r._0._0]}:{tag:"TypeIndex",value:[r._0._0,[r._0._1[0].map(function(i){return U[i]}),r._0._1[1].map(function(i){return U[i]})]]}:pe[r._0]}:r.TAG===5?{tag:"BranchIf",value:r._0}:r.TAG===6?{tag:"Branch",value:r._0}:r.TAG===7?{tag:"Block",value:typeof r._0=="object"?r._0.TAG===0?{tag:"TypeValue",value:U[r._0._0]}:{tag:"TypeIndex",value:[r._0._0,[r._0._1[0].map(function(i){return U[i]}),r._0._1[1].map(function(i){return U[i]})]]}:pe[r._0]}:r.TAG===8?{tag:"Loop",value:typeof r._0=="object"?r._0.TAG===0?{tag:"TypeValue",value:U[r._0._0]}:{tag:"TypeIndex",value:[r._0._0,[r._0._1[0].map(function(i){return U[i]}),r._0._1[1].map(function(i){return U[i]})]]}:pe[r._0]}:r.TAG===9?{tag:"GetGlobal",value:r._0}:r.TAG===10?{tag:"SetGlobal",value:r._0}:r.TAG===11?{tag:"GetLocal",value:r._0}:r.TAG===12?{tag:"SetLocal",value:r._0}:r.TAG===13?{tag:"TeeLocal",value:r._0}:r.TAG===14?{tag:"Call",value:r._0}:r.TAG===15?{tag:"CallIndirect",value:[r._0,r._1]}:r.TAG===16?{tag:"LoadI32",value:[r._0,r._1]}:r.TAG===17?{tag:"StoreI32",value:[r._0,r._1]}:r.TAG===18?{tag:"InitMemory",value:r._0}:{tag:"DropData",value:r._0}:eu[r]})]}),dataSection:e._0[0].dataSection.map(function(u){return{init:u.init,mode:typeof u.mode=="object"?[u.mode._0,u.mode._1]:h1[u.mode]}}),funcs:e._0[0].funcs.map(function(u){return[u[0],[u[1]._0.map(function(r){return U[r]}),u[1]._1.map(function(r){return U[r]})],[u[2][0].map(function(r){return[r[0],U[r[1]]]}),u[2][1].map(function(r){return typeof r=="object"?r.TAG===0?{tag:"ConstI32",value:r._0}:r.TAG===1?{tag:"ConstI64",value:r._0}:r.TAG===2?{tag:"ConstF32",value:r._0}:r.TAG===3?{tag:"ConstF64",value:r._0}:r.TAG===4?{tag:"If",value:typeof r._0=="object"?r._0.TAG===0?{tag:"TypeValue",value:U[r._0._0]}:{tag:"TypeIndex",value:[r._0._0,[r._0._1[0].map(function(i){return U[i]}),r._0._1[1].map(function(i){return U[i]})]]}:pe[r._0]}:r.TAG===5?{tag:"BranchIf",value:r._0}:r.TAG===6?{tag:"Branch",value:r._0}:r.TAG===7?{tag:"Block",value:typeof r._0=="object"?r._0.TAG===0?{tag:"TypeValue",value:U[r._0._0]}:{tag:"TypeIndex",value:[r._0._0,[r._0._1[0].map(function(i){return U[i]}),r._0._1[1].map(function(i){return U[i]})]]}:pe[r._0]}:r.TAG===8?{tag:"Loop",value:typeof r._0=="object"?r._0.TAG===0?{tag:"TypeValue",value:U[r._0._0]}:{tag:"TypeIndex",value:[r._0._0,[r._0._1[0].map(function(i){return U[i]}),r._0._1[1].map(function(i){return U[i]})]]}:pe[r._0]}:r.TAG===9?{tag:"GetGlobal",value:r._0}:r.TAG===10?{tag:"SetGlobal",value:r._0}:r.TAG===11?{tag:"GetLocal",value:r._0}:r.TAG===12?{tag:"SetLocal",value:r._0}:r.TAG===13?{tag:"TeeLocal",value:r._0}:r.TAG===14?{tag:"Call",value:r._0}:r.TAG===15?{tag:"CallIndirect",value:[r._0,r._1]}:r.TAG===16?{tag:"LoadI32",value:[r._0,r._1]}:r.TAG===17?{tag:"StoreI32",value:[r._0,r._1]}:r.TAG===18?{tag:"InitMemory",value:r._0}:{tag:"DropData",value:r._0}:eu[r]})]]})},e._0[1]]}:{tag:"Error",value:e._0}};var A1=`
let SIZEOF_U32 = 4;

struct Array {
  start: Ptr<u32>,
  mut length: u32,
}

impl Array {
  fn read(self, n) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>)
  }

  fn write(mut self, n, val) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>) = val;
  }

  fn push(mut self, val) {
    self.write(self.length, val);
    self.length += 1;
  }
}

struct Sieve {
  mut primes: Array,
  mut current: u32
}

impl Sieve {
  fn clear(mut self) {
    self.primes.length = 0;
    // 2 is the first prime
    self.primes.push(2);
    self.current = 1;
  }

  fn isPrime(mut self, n) {
    mut i = 0;
    mut p = self.primes.read(i);

    while p * p <= n {
      if n % p == 0 { return false; }
      i += 1;
      p = self.primes.read(i);
    }

    // n is prime
    // add it to the sieve
    self.primes.push(n);

    true
  }

  fn nextPrime(mut self) {
    self.current += 2;

    while !self.isPrime(self.current) {
      self.current += 2;
    }

    self.current
  }

  // count the prime numbers <= m
  fn countUpTo(mut self, m) {
    self.clear();

    while self.current <= m {
      self.nextPrime();
    }

    self.primes.length - 1
  }
}

fn main() {
  mut sieve = Sieve {
    primes: Array {
      start: [0; 10000] as Ptr<u32>,
      length: 0
    },
    current: 0
  };

  sieve.countUpTo(100000)
}
`,w1=`
fn fact(n) {
  if n == 0 { 1 } else { n * fact(n - 1) }
}

fn main() {
  fact(11)
}`,m1=`
fn fib(n) {
  let fib_aux = (n, a, b) -> {
    if n == 0 {
      a
    } else {
      fib_aux(n - 1, b, a + b)
    }
  };

  fib_aux(n, 0, 1)
}

fn main() {
  fib(83)
}`,S1=`
let SIZEOF_U32 = 4;

fn read_u32(addr) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>)
}

fn write_u32(addr, val) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>) = val;
}

fn main() {
  let square = n -> n * n;

  mut i = 0;
  while i < 100 {
    write_u32(i, square(i));
    i += 1;
  }

  read_u32(42) // 1764
}`,p1=`
fn isEven(n) {
  n & 1 == 0
}

fn isPrime(n) {
  if n < 2 { return false; }
  if n == 2 { return true; }
  if isEven(n) { return false; }

  mut i = 3;

  while i * i <= n {
    if n % i == 0 { return false; }
    i += 2;
  }

  true
}

fn countPrimesLessThan(m) {
  mut i = m;
  mut count = 0;

  while i > 1 {
    if isPrime(i) {
      count += 1;
    }

    i -= 1;
  }

  count
}

fn main() {
  countPrimesLessThan(1000000)
}`,b1=`
struct MinMax {
  mut min: u32,
  mut max: u32
}

impl MinMax {
  fn reset(mut self) {
    self.min = 0;
    self.max = 0;
  }

  fn resetStatic(mut m) {
    m.reset();
  }
}

fn main() {
  mut m = MinMax {
    min: 17,
    max: 22
  };

  MinMax.resetStatic(m);
  
  m.min + m.max == 0
}`,k1=`
fn main() {
  let twice = (f, x) -> f(f(x));
  
  twice(n -> n * n, 7)
}`,D1=`
struct BumpAllocator {
  mut head: u32
}

impl BumpAllocator {
  fn allocate(mut self, bytes) {
    let addr = self.head as Ptr<u32>;
    self.head = self.head + bytes;
    addr
  }
  
  // do nothing!
  fn free(mut self, addr) { }
}

mut allocator = BumpAllocator { head: 64 * 1024 };

let SIZEOF_U32 = 4;

struct Vec {
  mut start: Ptr<u32>,
  mut length: u32,
  mut capacity: u32 
}

impl Vec {
  fn read(self, index) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>)
  }

  fn write(mut self, index, value) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>) = value;
  }

  fn grow(mut self) unsafe {
    let newCap = if self.capacity == 0 { 8 } else { self.capacity * 2 };
    let newStart = allocator.allocate(newCap * SIZEOF_U32);

    // copy the data from the old array to the new one
    mut i = 0;
    while i < self.length {
      *(((newStart as u32) + (i * SIZEOF_U32)) as Ptr<u32>) = self.read(i);
      i += 1;
    }

    allocator.free(self.start);
    self.start = newStart;
    self.capacity = newCap;
  }

  fn push(mut self, val) {
    if self.length + 1 > self.capacity {
      self.grow();
    }

    self.write(self.length, val);
    self.length += 1;
  }

  fn pop(mut self) {
    if self.length > 0 {
      self.length -= 1;
      self.read(self.length)
    } else {
      // until we have Option<T>
      4294967295 // -1
    }
  }
}

fn main() {
  mut vec = Vec {
    start: 0 as Ptr<u32>,
    length: 0,
    capacity: 0
  };

  mut i = 0;
  while i < 1000 {
    vec.push(i);
    i += 1;
  }

  (vec.length, vec.capacity, vec.read(723))
}`,N1=`
fn isEven(n) {
  n & 1 == 0
}

fn nextCollatz(n) {
  if isEven(n) { n / 2 } else { 3 * n + 1 }
}

fn collatzLen(n) {
  mut len = 1;
  
  while n != 1 {
    n = nextCollatz(n); 
    len += 1;
  }
  
  len
}

fn pb14() {
  mut longest = 0;
  mut longestIndex = 0;

  mut i = 1;
  while i <= 1000000 {
    let len = collatzLen(i);
    if len > longest {
      longest = len;
      longestIndex = i;
    }

    i += 1;
  }
  
  (longest, longestIndex)
}

fn main() {
  pb14()
}`,R1=`
fn digitsSquareSum(n) {
  let square = n -> n * n;
  mut sum = 0;

  while n > 0 {
    sum += square(n % 10);
    n /= 10;
  }

  sum
}

fn reaches89(n) {
  while n != 1 {
    if n == 89 { return true; }
    n = digitsSquareSum(n);
  }

  false
}

fn main() {
  mut i = 1;
  mut count = 0;
  while i < 10000000 {
    if reaches89(i) {
      count += 1;
    }

    i += 1;
  }

  count
}`,F1=`
extern fn log(n: u32) -> ();
extern fn expectEqual(value: u32, expected: u32) -> ();

fn main() {
  mut i = 0;
  
  while i <= 10 {
    expectEqual(i, i);
    i += 1;
  }
}`,$1=`
struct Str {
  start: Ptr<char>,
  len: u32,
}

extern fn printString(start: Ptr<char>, len: u32) -> ();

fn print(s) {
  printString(s.start, s.len);
}

fn main() {
  let hello = Str {
    start: "hello yolang" as Ptr<char>,
    len: 12,
  };

  print(hello);
}`;const X1={"Prime sieve":A1,Factorial:w1,Fibonacci:m1,Pointers:S1,Primes:p1,Structs:b1,"Lambda (kind of)":k1,Vector:D1,"External functions":F1,"Project Euler 14":N1,"Project Euler 92":R1,Strings:$1},L1=async n=>{const e=await WebAssembly.compile(n),t=new TextDecoder,u=await WebAssembly.instantiate(e,{index:{log:console.log,expectEqual(a,r){if(a!==r)throw new Error(`[expectEqual] expected ${a}, got: ${r}`)},printString(a,r){const o=u.exports.memory,i=new Uint8Array(o.buffer),c=t.decode(i.subarray(a,a+r));console.log(c)}}});if("main"in u.exports){console.time("run");const a=u.exports.main();return console.timeEnd("run"),a}else return"Error: main function not found, exported functions are: "+Object.keys(u.exports).join(", ")},C1={Run:async(n,e)=>{e("running...");try{const t=Uo(n);if(t.tag==="Ok"){const u=await L1(t.value[1]);e(`${u}`)}else e(t.value)}catch(t){e(`${t}`)}},Disassemble:(n,e)=>{try{const t=Uo(n);if(t.tag==="Ok"){const[u]=t.value;e(Qc(u))}else e(t.value)}catch(t){e(`${t}`)}}},U1=()=>Pr.createElement(Gi,{actions:C1,samples:X1,aceMode:"rust"});gi.render(Pr.createElement(Pr.StrictMode,null,Pr.createElement(U1,null)),document.getElementById("root"));
