import{c as un,a as cn,j as m,r as Eo,m as Gn,g as ze,b as tr,d as s,z as Ve,k as Lt,e as jr,f as Gt,t as nt,h as Ao,i as Zr,l as Mn,n as Wr,o as Ee,_ as d,p as Ae,s as z,v as Un,q as K,u as Jr,w as wo,x as mo,y as rr,A as Kr,B as Yr,C as An,D as ur,E as wn,F as So,G as po,H as Hr,I as ar,J as bo,K as ko,L as Do,M as No,N as Fo,O as Ro,P as $o,Q as Qr,R as Lo,S as Ir,T as Rn,U as Co,V as or,W as yr,X as Xo,Y as yn,Z as Mo,$ as Uo,a0 as fe,a1 as xr,a2 as Ct,a3 as nu,a4 as eu,a5 as tu,a6 as Xt,a7 as Oo,a8 as Mt,a9 as zo,aa as Vo,ab as Bo,ac as N,ad as Po,ae as qo,af as ru,ag as ir,ah as jo,ai as uu,aj as Zo,ak as Wo,al as Y,am as Jo,an as gt,ao as Ut,ap as Be,aq as Ne,ar as au,as as Ko,at as ht,au as ou,av as Yo,aw as Ho,ax as Qo,ay as Ot,az as Io,aA as yo}from"./vendor.198e55ca.js";const xo=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))u(a);new MutationObserver(a=>{for(const t of a)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const t={};return a.integrity&&(t.integrity=a.integrity),a.referrerpolicy&&(t.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?t.credentials="include":a.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function u(a){if(a.ep)return;a.ep=!0;const t=r(a);fetch(a.href,t)}};xo();function fn(n){var e=[],r=function(u){for(;;){var a=u,t=a&127,o=a>>>7;if(o!==0){e.push(t|128),u=o;continue}e.push(t);return}};return r(n),e}function zt(n){var e=[],r=function(u){for(;;){var a=u,t=a&127,o=a>>7;if(o===0&&(t&64)==0||o===-1&&(t&64)!=0){e.push(t);return}e.push(t|128),u=o}};return r(n|0),e}function Fe(n){return un(fn(n.length),n)}function Vn(n){return un(fn(n.length),cn(n))}var ni={encode:Fe,encodeMany:Vn},ei=zt,ti={encode:ei},ri=zt,ui={encode:ri};function iu(n){var e=new DataView(new ArrayBuffer(4));return e.setFloat32(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3)]}var ai={encode:iu};function cu(n){var e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3),e.getUint8(4),e.getUint8(5),e.getUint8(6),e.getUint8(7)]}var oi={encode:cu};function ii(n){return n}function xn(n,e){return un([n],Fe(e))}function ne(n){var e;switch(n){case 0:e="custom";break;case 1:e="type";break;case 2:e="import";break;case 3:e="function";break;case 4:e="table";break;case 5:e="memory";break;case 6:e="global";break;case 7:e="export";break;case 8:e="start";break;case 9:e="element";break;case 10:e="code";break;case 11:e="data";break}return"["+e+"]"}var ci={id:ii,encode:xn,show:ne};function et(n){switch(n){case 0:return 127;case 1:return 126;case 2:return 125;case 3:return 124}}function tt(n){switch(n){case 0:return"i32";case 1:return"i64";case 2:return"f32";case 3:return"f64"}}var _i={encode:et,show:tt};function _u(n){return typeof n=="number"?[64]:n.TAG===0?[et(n._0)]:fn(n._0)}function fi(n){return typeof n=="number"?"void":n.TAG===0?tt(n._0):"type "+String(n._0)}var si={encode:_u,show:fi};function cr(n){if(typeof n=="number")switch(n){case 0:return[[5],"else"];case 1:return[[11],"end"];case 2:return[[15],"return"];case 3:return[[26],"drop"];case 4:return[[106],"i32.add"];case 5:return[[107],"i32.sub"];case 6:return[[108],"i32.mul"];case 7:return[[110],"i32.div_s"];case 8:return[[109],"i32.div_u"];case 9:return[[69],"i32.eqz"];case 10:return[[70],"i32.eq"];case 11:return[[81],"i64.eq"];case 12:return[[91],"f32.eq"];case 13:return[[97],"f64.eq"];case 14:return[[71],"i32.ne"];case 15:return[[82],"i64.ne"];case 16:return[[92],"f32.ne"];case 17:return[[98],"f64.ne"];case 18:return[[76],"i32.le_s"];case 19:return[[77],"i32.le_u"];case 20:return[[87],"i64.le_s"];case 21:return[[88],"i64.le_u"];case 22:return[[95],"f32.le"];case 23:return[[101],"f64.le"];case 24:return[[78],"i32.ge_s"];case 25:return[[79],"i32.ge_u"];case 26:return[[89],"i64.ge_s"];case 27:return[[90],"i64.ge_u"];case 28:return[[96],"f32.ge"];case 29:return[[102],"f64.ge"];case 30:return[[72],"i32.lt_s"];case 31:return[[73],"i32.lt_u"];case 32:return[[83],"i64.lt_s"];case 33:return[[84],"i64.lt_u"];case 34:return[[93],"f32.lt"];case 35:return[[99],"f64.lt"];case 36:return[[74],"i32.gt_s"];case 37:return[[75],"i32.gt_u"];case 38:return[[85],"i64.gt_s"];case 39:return[[86],"i64.gt_u"];case 40:return[[94],"f32.gt"];case 41:return[[100],"f64.gt"];case 42:return[[111],"i32.rem_s"];case 43:return[[112],"i32.rem_u"];case 44:return[[113],"i32.and"];case 45:return[[114],"i32.or"];case 46:return[[116],"i32.shl"];case 47:return[[117],"i32.shr_s"];case 48:return[[118],"i32.shr_u"]}else switch(n.TAG|0){case 0:return[[65],"i32.const "+String(n._0)];case 1:return[[66],"i64.const "+String(n._0)];case 2:return[[67],"i64.const "+String(n._0)];case 3:return[[68],"i64.const "+String(n._0)];case 4:return[[4],"if"];case 5:return[[13],"br_if "+String(n._0)];case 6:return[[12],"br "+String(n._0)];case 7:return[[2],"block"];case 8:return[[3],"loop"];case 9:return[[35],"global.get "+String(n._0)];case 10:return[[36],"global.set "+String(n._0)];case 11:return[[32],"local.get "+String(n._0)];case 12:return[[33],"local.set "+String(n._0)];case 13:return[[34],"local.tee "+String(n._0)];case 14:return[[16],"call "+String(n._0)];case 15:return[[17],"call_indirect [typeIndex="+String(n._0)+", tableIndex="+String(n._1)+"]"];case 16:return[[40],"i32.load (alignment="+String(n._0)+", offset="+String(n._1)+")"];case 17:return[[54],"i32.store (alignment="+String(n._0)+", offset="+String(n._1)+")"];case 18:return[[252,8],"memory.init "+String(n._0)];case 19:return[[252,9],"data.drop "+String(n._0)]}}function ee(n){return cr(n)[0]}function fu(n){if(typeof n=="number")switch(n){case 0:case 1:return-1;default:return 0}else switch(n.TAG|0){case 4:case 7:case 8:return 1;default:return 0}}function Vt(n,e,r,u){var a=n!==void 0?n:{contents:0},t=cr(e),o=fu(e),i=m(Eo(0,a.contents+(o<0?o:0)|0),"  ",function(v){return""});a.contents=a.contents+o|0,e===0&&(a.contents=a.contents+1|0);var c,_=0;if(typeof e=="number")c="";else switch(e.TAG|0){case 11:case 12:case 13:_=1;break;case 14:c="<"+Gn(ze(r,e._0),"??",function(v){return v})+">";break;default:c=""}return _===1&&(c="<"+Gn(ze(u,e._0),"??",function(v){return v})+">"),i+t[1]+" "+c}function se(n){var e=0;if(typeof n=="number")return ee(n);switch(n.TAG|0){case 0:case 1:return un(ee(n),zt(n._0));case 2:return un(ee(n),iu(n._0));case 3:return un(ee(n),cu(n._0));case 4:case 7:case 8:e=1;break;case 9:case 10:case 11:case 12:case 13:e=2;break;case 15:return cn([ee(n),fn(n._0),fn(n._1)]);case 16:case 17:e=3;break;case 18:return cn([ee(n),fn(n._0),[0]]);case 5:case 6:case 14:case 19:return un(ee(n),fn(n._0))}switch(e){case 1:return un(ee(n),_u(n._0));case 2:return un(ee(n),fn(n._0));case 3:return cn([ee(n),fn(n._0),fn(n._1)])}}var li={info:cr,opcode:ee,identationDelta:fu,show:Vt,encode:se};function vi(n,e){return{_0:n,_1:e}}var di=[],Ti=[],Gi={_0:di,_1:Ti};function su(n){return cn([[96],Fe(s(n._0,et)),Fe(s(n._1,et))])}function lu(n){var e=n._1,r=n._0,u=m(r,", ",tt),a=m(e,", ",tt);if(r.length===1){var t=e.length;if(t===1)return u+" -> "+a;if(t===0)return u+" -> ()"}var o=e.length;return o!==1?o!==0?"("+u+") -> ("+a+")":"("+u+") -> ()":"("+u+") -> "+a}var gi={funcTypeCode:96,make:vi,empty:Gi,encode:su,show:lu};function hi(n){var e=function(u,a){for(;;){var t=a,o=u;if(!o)return t;var i=o.tl,c=o.hd,_=c[1],v=c[0];if(t){var E=t.tl,b=t.hd,V=b[1],G=b[0];if(Mn(_,V)){a={hd:[{hd:v,tl:G},V],tl:E},u=i;continue}a={hd:[{hd:v,tl:0},_],tl:{hd:[G,V],tl:E}},u=i;continue}a={hd:[{hd:v,tl:0},_],tl:0},u=i}},r=jr(e(Gt(n),0));return nt(Ao(r,function(u){return[Wr(nt(u[0])),u[1]]}))}function vu(n){return un(fn(n[0].length),[et(n[1])])}function du(n){return"local ["+m(n[0],", ",function(e){return e})+"] "+tt(n[1])}var Ei={fromTypes:hi,encode:vu,show:du};function Ai(n,e){return[n,e]}function Tu(n){var e=Vn(s(n[0],vu)),r=cn(s(n[1],se));return cn([[e.length+r.length|0],e,r])}function Gu(n,e,r){var u=n[0],a={contents:1},t=Zr(r._0,function(_,v){return"param["+String(_)+"]"}),o=un(t,cn(s(u,function(_){return _[0]}))),i=m(u,`
`,du),c=m(n[1],`
`,function(_){return Vt(a,_,e,o)});return u.length===0?c:i+`
`+c}var wi={make:Ai,encode:Tu,show:Gu};function mi(n,e,r){return[n,e,r]}var Et={Signature:gi,Local:Ei,Body:wi,make:mi};function Si(n){return[]}function _r(n,e){var r=tr(n,function(u){return Mn(u,e)});return r!==void 0?r:(n.push(e),n.length-1|0)}function gu(n){return xn(1,Vn(s(n,su)))}function hu(n){return ne(1)+`
`+m(n,`
`,lu)}var pi={make:Si,getOrAdd:_r,encode:gu,show:hu};function bi(n){return[]}function Eu(n,e){return n.push(e),n.length-1|0}function Au(n){return xn(3,Vn(s(n,fn)))}function wu(n,e){return ne(3)+`
`+m(Ve(n,e),`
`,function(r){return r[1]+": "+String(r[0])})}var ki={make:bi,addSignature:Eu,encode:Au,show:wu};function Bt(n){return Fe(s(n.split(""),function(e){return e.charCodeAt(0)|0}))}var Di={encode:Bt};function Ni(n){return[n]}function mu(n){switch(n){case 0:return"func";case 1:return"table";case 2:return"memory";case 3:return"global"}}var Fi={encode:Ni,show:mu};function Ri(n,e,r){return{name:n,kind:e,index:r}}function Su(n){return cn([Bt(n.name),[n.kind],fn(n.index)])}function pu(n){return"export "+mu(n.kind)+" "+n.name+" (index: "+String(n.index)+")"}var $i={ExternalKind:Fi,make:Ri,encode:Su,show:pu};function Li(n){return[]}function Ci(n,e){n.push(e)}function bu(n){return xn(7,Vn(s(n,Su)))}function ku(n){return ne(7)+`
`+m(n,`
`,pu)}var Xi={make:Li,add:Ci,encode:bu,show:ku};function Mi(n){return n?"externref":"funcref"}function Ui(n){return n?111:112}var Oi={show:Mi,encode:Ui};function fr(n){return"{ min: "+String(n[0])+", max: "+Gn(n[1],"?",function(e){return String(e)})+" }"}function zi(n,e){return[n,e]}function Vi(n){return[n,n]}function Pt(n){var e=n[1],r=n[0];return e!==void 0?cn([[1],fn(r),fn(e)]):un([0],fn(r))}var sr={show:fr,make:zi,makeExact:Vi,encode:Pt};function Bi(n,e){return[n,e]}function Du(n){return un([n[0]?111:112],Pt(n[1]))}function Nu(n){return"table "+(n[0]?"externref":"funcref")+" "+fr(n[1])}var Fu={make:Bi,encode:Du,show:Nu};function Pi(n){return[]}function qi(n,e){n.push(e)}function Ru(n){return ne(4)+`
`+m(n,`
`,Nu)}function $u(n){return xn(4,Vn(s(n,Du)))}var ji={make:Pi,add:qi,show:Ru,encode:$u};function Zi(n,e){var r=n!==void 0?n:0;return{offset:r,funcIndices:e}}function Lu(n){return"elem funcref ("+m(n.funcIndices," ",function(e){return String(e)})+") (offset="+String(n.offset)+")"}function Cu(n){return cn([[0],se({TAG:0,_0:n.offset}),se(1),Vn(s(n.funcIndices,fn))])}var Xu={fromFuncRefs:Zi,show:Lu,encode:Cu};function Wi(n){return[]}function Ji(n,e){n.push(e)}function Mu(n){return ne(9)+`
`+m(n,`
`,Lu)}function Uu(n){return xn(9,Vn(s(n,Cu)))}var Ki={make:Wi,add:Ji,show:Mu,encode:Uu};function Yi(n){return n}function Ou(n){return un(cn(s(n,se)),se(1))}function zu(n){if(n.length!==1)return`
`+m(n,`
`,function(r){return"  "+Vt(void 0,r,[],[])})+`
end`;var e=n[0];return Vt(void 0,e,[],[])}var Hi={fromInstructions:Yi,encode:Ou,show:zu};function Qi(n,e,r){return[e,n,r]}function Vu(n){return"global "+(n[1]?"mutable":"immutable")+" "+tt(n[0])+" = "+zu(n[2])}function Bu(n){return un([et(n[0]),n[1]?1:0],Ou(n[2]))}var At={Initializer:Hi,make:Qi,show:Vu,encode:Bu};function Ii(n){return[]}function yi(n,e){n.push(e)}function Pu(n){return ne(6)+`
`+m(n,`
`,Vu)}function qu(n){return xn(6,Vn(s(n,Bu)))}var xi={make:Ii,add:yi,show:Pu,encode:qu};function nc(n){return n}function ju(n){return"memory "+fr(n)}var Zu={make:nc,show:ju,encode:Pt};function ec(n){return[]}function Wu(n,e){return n.push(e)-1|0}function Ju(n){return ne(5)+`
`+m(n,`
`,ju)}function Ku(n){return xn(5,Vn(s(n,Pt)))}var tc={make:ec,add:Wu,show:Ju,encode:Ku},rc={};function Yu(n){return cn([[0],fn(n._0)])}function Hu(n){return"func (index: "+String(n._0)+")"}var uc={make:void 0,encode:Yu,show:Hu};function Qu(n){return cn([Bt(n.moduleName),Bt(n.entityName),Yu(n.desc)])}function ac(n,e,r){return{moduleName:n,entityName:e,desc:r}}function Iu(n){return"import "+Hu(n.desc)+" "+n.moduleName+"."+n.entityName}var yu={ImportDesc:uc,encode:Qu,make:ac,show:Iu};function oc(n){return[]}function xu(n,e){return n.push(e)-1|0}function na(n){return xn(2,Vn(s(n,Qu)))}function ea(n){return ne(2)+`
`+m(n,`
`,Iu)}function ic(n){return n.length}var cc={make:oc,add:xu,encode:na,show:ea,count:ic};function _c(n){return[]}function ta(n,e){return n.push(e),n.length-1|0}function ra(n){return xn(10,Vn(s(n,Tu)))}function ua(n,e,r){var u=s(Lt(e,function(t){return!0}),function(t){return t.entityName}),a=un(u,s(r,function(t){return t[0]}));return ne(10)+`
`+m(Ve(n,r),`

`,function(t){var o=t[1];return o[0]+`
`+Gu(t[0],a,o[1])})}var fc={make:_c,addFunc:ta,encode:ra,show:ua};function aa(n){return n?"active memIndex: "+String(n._0)+" offset: "+String(n._1):"passive"}var sc={show:aa};function lc(n,e){return{init:n,mode:e}}function oa(n){return"segment len: "+String(n.init.length)+" mode: "+aa(n.mode)}function ia(n){var e=n.mode,r=n.init;if(!e)return un([1],Fe(r));var u=e._0;return u!==0?cn([[2],fn(u),se({TAG:0,_0:e._1}),se(1),Fe(r)]):cn([[0],se({TAG:0,_0:e._1}),se(1),Fe(r)])}var vc={make:lc,show:oa,encode:ia};function dc(n){return[]}function ca(n,e){return n.push(e)-1|0}function _a(n){return ne(11)+`
`+m(n,`

`,oa)}function fa(n){return xn(11,Vn(s(n,ia)))}var Tc={make:dc,add:ca,show:_a,encode:fa},Gc={Mode:sc,Segment:vc,Section:Tc};function gc(n){return{typeSection:[],importSection:[],funcSection:[],tableSection:[],memorySection:[],globalSection:[],exportSection:[],elementSection:[],codeSection:[],dataSection:[],funcs:[]}}function hc(n,e){return _r(n.typeSection,e)}function sa(n,e,r,u){var a=_r(n.typeSection,r);return Eu(n.funcSection,a),n.funcs.push([e,r,u]),ta(n.codeSection,u)+n.importSection.length|0}function Ec(n,e,r,u){var a=sa(n,e,r,u),t={name:e,kind:0,index:a};return n.exportSection.push(t),a}function Ac(n,e){n.tableSection.push(e)}function wc(n,e){n.elementSection.push(e)}function mc(n,e){n.globalSection.push(e)}function Sc(n,e){return Wu(n.memorySection,e)}function pc(n,e){return xu(n.importSection,e)}function bc(n,e){return ca(n.dataSection,e)}function la(n){return cn([[0,97,115,109,1,0,0,0],gu(n.typeSection),na(n.importSection),Au(n.funcSection),$u(n.tableSection),Ku(n.memorySection),qu(n.globalSection),bu(n.exportSection),Uu(n.elementSection),ra(n.codeSection),fa(n.dataSection)])}function kc(n){return(e=>Uint8Array.from(e))(la(n))}function Dc(n){return m([hu(n.typeSection),ea(n.importSection),wu(n.funcSection,s(n.funcs,function(e){return e[0]})),Ru(n.tableSection),Ju(n.memorySection),Pu(n.globalSection),ku(n.exportSection),Mu(n.elementSection),ua(n.codeSection,n.importSection,n.funcs),_a(n.dataSection)],`

`,function(e){return e})}var jn={make:gc,getOrAddSignature:hc,addFunc:sa,addExportedFunc:Ec,addTable:Ac,addElement:wc,addGlobal:mc,addMemory:Sc,addImport:pc,addData:bc,encode:la,encodeAsUint8Array:kc,show:Dc},Nc=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uleb128:fn,sleb128:zt,Vec:ni,I32:ti,I64:ui,F32:ai,F64:oi,Section:ci,ValueType:_i,BlockReturnType:si,Inst:li,Func:Et,TypeSection:pi,FuncSection:ki,Str:Di,ExportEntry:$i,ExportSection:Xi,ReferenceType:Oi,Limits:sr,Table:Fu,TableSection:ji,Elem:Xu,ElementSection:Ki,Global:At,GlobalSection:xi,Memory:Zu,MemorySection:tc,Import:rc,ImportEntry:yu,ImportSection:cc,CodeSection:fc,Data:Gc,Module:jn});const lr={Else:0,End:1,Return:2,Drop:3,AddI32:4,SubI32:5,MulI32:6,DivI32Unsigned:7,DivI32Signed:8,EqzI32:9,EqI32:10,EqI64:11,EqF32:12,EqF64:13,NeI32:14,NeI64:15,NeF32:16,NeF64:17,LeI32Signed:18,LeI32Unsigned:19,LeI64Signed:20,LeI64Unsigned:21,LeF32:22,LeF64:23,GeI32Signed:24,GeI32Unsigned:25,GeI64Signed:26,GeI64Unsigned:27,GeF32:28,GeF64:29,LtI32Signed:30,LtI32Unsigned:31,LtI64Signed:32,LtI64Unsigned:33,LtF32:34,LtF64:35,GtI32Signed:36,GtI32Unsigned:37,GtI64Signed:38,GtI64Unsigned:39,GtF32:40,GtF64:41,RemI32Signed:42,RemI32Unsigned:43,AndI32:44,OrI32:45,ShlI32:46,ShrI32Signed:47,ShrI32Unsigned:48},va={"0":"I32","1":"I64","2":"F32","3":"F64"},R={I32:0,I64:1,F32:2,F64:3},Fc={FuncRef:0,ExternRef:1},Rc={Func:0,Table:1,Memory:2,Global:3},we={Void:0},$c={Passive:0},W=Nc;W.uleb128;W.sleb128;W.Vec.encode;W.Vec.encodeMany;W.I32.encode;W.I64.encode;W.F32.encode;W.F64.encode;W.Func.Signature.funcTypeCode;W.Func.Signature.empty._0.map(function(e){return va[e]}),W.Func.Signature.empty._1.map(function(e){return va[e]});W.FuncSection.make;W.FuncSection.encode;W.Str.encode;W.Limits.makeExact;W.Elem.show;W.Elem.encode;W.ElementSection.make;W.ElementSection.show;W.ElementSection.encode;W.MemorySection.make;W.ImportEntry.ImportDesc.make;const Lc=function(n){return W.Module.show({typeSection:n.typeSection.map(function(u){return{TAG:0,_0:u[0].map(function(t){return R[t]}),_1:u[1].map(function(t){return R[t]})}}),importSection:n.importSection.map(function(u){return{moduleName:u.moduleName,entityName:u.entityName,desc:{TAG:0,_0:u.desc.value}}}),funcSection:n.funcSection,tableSection:n.tableSection.map(function(u){return[Fc[u[0]],[u[1][0],u[1][1]==null?void 0:u[1][1]]]}),memorySection:n.memorySection.map(function(u){return[u[0],u[1]==null?void 0:u[1]]}),globalSection:n.globalSection.map(function(u){return[R[u[0]],u[1],u[2].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:R[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return R[i]}),t.value.value[1][1].map(function(i){return R[i]})]}:we[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:R[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return R[i]}),t.value.value[1][1].map(function(i){return R[i]})]}:we[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:R[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return R[i]}),t.value.value[1][1].map(function(i){return R[i]})]}:we[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:t.tag==="StoreI32"?{TAG:17,_0:t.value[0],_1:t.value[1]}:t.tag==="InitMemory"?{TAG:18,_0:t.value}:{TAG:19,_0:t.value}:lr[t]})]}),exportSection:n.exportSection.map(function(u){return{name:u.name,kind:Rc[u.kind],index:u.index}}),elementSection:n.elementSection,codeSection:n.codeSection.map(function(u){return[u[0].map(function(t){return[t[0],R[t[1]]]}),u[1].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:R[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return R[i]}),t.value.value[1][1].map(function(i){return R[i]})]}:we[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:R[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return R[i]}),t.value.value[1][1].map(function(i){return R[i]})]}:we[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:R[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return R[i]}),t.value.value[1][1].map(function(i){return R[i]})]}:we[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:t.tag==="StoreI32"?{TAG:17,_0:t.value[0],_1:t.value[1]}:t.tag==="InitMemory"?{TAG:18,_0:t.value}:{TAG:19,_0:t.value}:lr[t]})]}),dataSection:n.dataSection.map(function(u){return{init:u.init,mode:typeof u.mode=="object"?{TAG:0,_0:u.mode[0],_1:u.mode[1]}:$c[u.mode]}}),funcs:n.funcs.map(function(u){return[u[0],{TAG:0,_0:u[1][0].map(function(t){return R[t]}),_1:u[1][1].map(function(t){return R[t]})},[u[2][0].map(function(t){return[t[0],R[t[1]]]}),u[2][1].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:R[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return R[i]}),t.value.value[1][1].map(function(i){return R[i]})]}:we[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:R[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return R[i]}),t.value.value[1][1].map(function(i){return R[i]})]}:we[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:R[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return R[i]}),t.value.value[1][1].map(function(i){return R[i]})]}:we[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:t.tag==="StoreI32"?{TAG:17,_0:t.value[0],_1:t.value[1]}:t.tag==="InitMemory"?{TAG:18,_0:t.value}:{TAG:19,_0:t.value}:lr[t]})]]})})};W.F32;W.F64;W.I32;W.I64;W.Vec;W.Str;function Cc(n,e,r){return d(e,d(n,r))}var Xc={compose:Cc};function Mc(n){var e=Math.log2(n);return e===Math.floor(e)}var da={isPowerOf2:Mc};function Uc(n,e){for(var r,u=0;Ee(r)&&u<n.length;){var a=d(e,Ae(n,u));a!==void 0&&(r=z(Un(a))),u=u+1|0}return r}function Oc(n,e){for(var r,u=n.length-1|0;Ee(r)&&u>=0;)d(e,Ae(n,u))?r=u:u=u-1|0;return r}function zc(n,e){for(var r,u=n.length-1|0;Ee(r)&&u>=0;){var a=Ae(n,u);d(e,a)?r=z(a):u=u-1|0}return r}function Vc(n,e){for(var r=[],u=!1,a=0;u===!1&&a<n.length;){var t=Ae(n,a);t!==void 0?r.push(d(e,Un(t))):u=!0,a=a+1|0}if(!u)return r}function Bc(n,e){for(var r=[],u,a=0;Ee(u)&&a<n.length;){var t=Ae(n,a);t.TAG===0?r.push(d(e,t._0)):u=z(t._0),a=a+1|0}var o=u;return o!==void 0?{TAG:1,_0:Un(o)}:{TAG:0,_0:r}}function Pc(n,e){return K(tr(n,e),function(r){return[Ae(n,r),r]})}var me={firstSomeBy:Uc,getReverseIndexBy:Oc,getReverseBy:zc,mapOption:Vc,mapResult:Bc,getValueAndIndexBy:Pc};function rt(n){return[[],n]}var qc=Jr;function jc(n,e,r){return Jr(n,e,[[],r])}var Zc=wo,Wc=mo,Jc=rr;function Kc(n,e){var r=m(Kr(Yr(n,e)),`
`,function(u){return"  "+u[0]+": "+u[1]});return`{
`+r+`
}`}var On={empty:void 0,add:qc,addMono:jc,remove:Zc,has:Wc,get:Jc,show:Kc},Yc=[],Zn={TAG:1,_0:"u32",_1:Yc},Hc=[],Bn={TAG:1,_0:"bool",_1:Hc},Qc=[],Re={TAG:1,_0:"()",_1:Qc};function Cn(n,e){return{TAG:1,_0:"Fun",_1:un(n,[e])}}function Ic(n){return{TAG:1,_0:"Tuple",_1:n}}function Ta(n,e){return{TAG:1,_0:"Array",_1:[n,{TAG:1,_0:String(e),_1:[]}]}}function yc(n){return{TAG:1,_0:"Ptr",_1:[n]}}function vr(n){switch(n.TAG|0){case 0:case 1:return!1;case 2:return!0}}var le=wn("Types.Size.UnkownTypeSize");function qt(n){for(;;){var e=n;switch(e.TAG|0){case 0:throw{RE_EXN_ID:le,_1:e,Error:new Error};case 1:switch(e._0){case"()":if(e._1.length===0)return 0;throw{RE_EXN_ID:le,_1:e,Error:new Error};case"Array":var r=e._1;if(r.length!==2)throw{RE_EXN_ID:le,_1:e,Error:new Error};var u=r[1];switch(u.TAG|0){case 1:if(u._1.length===0)return 4;throw{RE_EXN_ID:le,_1:e,Error:new Error};case 0:case 2:throw{RE_EXN_ID:le,_1:e,Error:new Error}}case"Mut":var a=e._1;if(a.length!==1)throw{RE_EXN_ID:le,_1:e,Error:new Error};n=a[0];continue;case"Fun":case"Ptr":return 4;case"Tuple":return An(s(e._1,qt),0,function(t,o){return t+o|0});case"bool":case"u32":break;case"u64":if(e._1.length===0)return 8;throw{RE_EXN_ID:le,_1:e,Error:new Error};default:throw{RE_EXN_ID:le,_1:e,Error:new Error}}if(e._1.length===0)return 4;throw{RE_EXN_ID:le,_1:e,Error:new Error};case 2:return 4}}}function xc(n){return Math.ceil(Math.log2(qt(n)))|0}function n_(n){return qt(n)===0}var te={UnkownTypeSize:le,size:qt,sizeLog2:xc,isZeroSizedType:n_};function e_(n){return{TAG:0,_0:n}}function dr(n,e,r){if(n.TAG===0)return{TAG:1,_0:[e,r],_1:{TAG:0,_0:n._0}};var u=n._1,a=n._0,t=a[1],o=a[0];return e<o?{TAG:1,_0:[e,r],_1:{TAG:1,_0:[o,t],_1:u}}:{TAG:1,_0:[o,t],_1:dr(u,e,r)}}function t_(n){for(;;){var e=n;if(e.TAG===0)return e._0;n=e._1}}function r_(n,e){return An(n,{TAG:0,_0:{TAG:0,_0:e}},function(r,u){return dr(r,u[0],u[1])})}function Tr(n){var e=function(r,u){for(;;){var a=u,t=r;if(t.TAG===0){var o=t._0;switch(o.TAG|0){case 0:case 1:return a;case 2:var i=o._0;if(i.TAG===0)return a;var c=i._0;if(c.TAG===0)return a;u={hd:c._0,tl:a},r=c._1;continue}}else{u={hd:t._0,tl:a},r=t._1;continue}}};return nt(e(n,0))}function u_(n){return So(Tr(n))}function Ga(n,e){if(n.TAG===0){var r=d(e,n._0);switch(r.TAG|0){case 0:case 1:return{TAG:0,_0:r};case 2:var u=r._0;return u.TAG===0?{TAG:0,_0:r}:u._0}}else{var a=n._0;return{TAG:1,_0:[a[0],d(e,a[1])],_1:Ga(n._1,e)}}}function ga(n,e){var r=function(u,a){for(;;){var t=a,o=u;if(o.TAG===0)return Wr(nt({hd:"..."+d(e,o._0),tl:t}));var i=o._0;a={hd:i[0]+": "+d(e,i[1]),tl:t},u=o._1}};return"{ "+m(r(n,0),", ",function(u){return u})+" }"}var Pn={make:e_,insert:dr,tail:t_,fromArray:r_,toArray:Tr,toMap:u_,map:Ga,show:ga};function jt(n){switch(n.TAG|0){case 0:return ko(void 0,n._0);case 1:return An(s(n._1,jt),void 0,ar);case 2:var e=n._0;return e.TAG===0?void 0:An(s(Tr(e._0),function(r){return Xc.compose(function(u){return u[1]},jt,r)}),void 0,ar)}}function a_(n){return Hr(jt(n[1]),Do(n[0]))}function o_(n){return An(s(bo(n),a_),void 0,ar)}function Gr(n,e){var r=po(Hr(jt(e),o_(n)));return[r,e]}function i_(n){var e=String.fromCharCode(97+n%26|0),r=n/26|0;return r===0?e:e+String(r)}function k(n){switch(n.TAG|0){case 0:return i_(n._0);case 1:var e=n._0;if(n._1.length===0)return e;switch(e){case"Array":var r=n._1;if(r.length===2){var u=r[0],a=r[1];switch(a.TAG|0){case 1:if(a._1.length===0)return"["+k(u)+"; "+a._0+"]";break}}break;case"Fun":var t=n._1,o=ur(t,0,t.length-1|0),i=Ae(t,t.length-1|0);if(o.length!==1)return"("+m(o,", ",k)+") -> "+k(i);var c=o[0];return k(c)+" -> "+k(i);case"Tuple":return"("+m(n._1,", ",k)+")"}return e+"<"+m(n._1,", ",k)+">";case 2:var _=n._0;return _.TAG===0?_._0:ga(_._0,k)}}function ha(n){switch(n){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/";case 4:return"%";case 5:return"<";case 6:return"<=";case 7:return">";case 8:return">=";case 9:return"==";case 10:return"!=";case 11:return"&&";case 12:return"||";case 13:return"&";case 14:return"|";case 15:return"<<";case 16:return">>"}}var c_={show:ha};function Ea(n){switch(n){case 0:return"-";case 1:return"!";case 2:return"*"}}var __={show:Ea};function Aa(n){return typeof n=="number"?"()":n.TAG===0?String(n._0):n._0?"true":"false"}var f_={show:Aa};function q(n){switch(n.TAG|0){case 0:return Aa(n._0);case 1:return Ea(n._0)+q(n._1);case 2:return"("+q(n._0)+" "+ha(n._1)+" "+q(n._2)+")";case 3:return n._0;case 4:return q(n._0)+" = "+q(n._1);case 5:var e=n._1,r=n._0,u=r.length;if(u!==1)return u!==0?"("+m(r,", ",function(c){return c})+") -> "+q(e):"() -> "+q(e);var a=r[0];return a+" -> "+q(e);case 6:return"let "+n._0+" = "+q(n._1)+" in "+q(n._2);case 7:return"("+q(n._0)+")("+m(n._1,", ",q)+")";case 8:return(n._2===1?"unsafe ":"")+`{
`+m(un(s(n._0,wa),Gn(n._1,[],function(c){return[q(c)]})),`;
`,function(c){return"  "+c})+`
}`;case 9:var t=n._2,o="if "+q(n._0)+" "+q(n._1);return t!==void 0?o+" else "+q(t):o;case 10:return"while "+q(n._0)+" "+q(n._1);case 11:return"return "+Gn(n._0,"",q);case 12:return q(n._0)+" as "+k(n._1);case 13:return"("+m(n._0,", ",q)+")";case 14:return n._0+` {
`+m(n._1,", ",function(c){return c[0]+": "+q(c[1])})+`
}`;case 15:var i=n._0;return i.TAG===0?"["+q(i._0)+"; "+String(i._1)+"]":"["+m(i._0,", ",q)+"]";case 16:return q(n._0)+"."+n._1}}function gr(n){switch(n.TAG|0){case 0:return"fn "+n._0+"("+m(n._1,", ",function(e){return(e[1]?"mut ":"")+e[0]})+") "+q(n._2);case 1:return(n._1?"mut":"let")+" "+n._0+" = "+q(n._2);case 2:return"struct "+n._0+` {
`+m(n._1,`,
`,function(e){return(e[2]?"mut ":"")+e[0]+": "+k(e[1])})+`
}`;case 3:return"impl "+n._0+` {
`+m(n._1,`

`,gr)+`
}`;case 4:return"extern fn "+n.name+"("+m(n.args,", ",function(e){return(e[2]?"mut ":"")+e[0]+": "+k(e[1])})+") -> "+k(n.ret)}}function wa(n){return n.TAG===0?(n._1?"mut":"let")+" "+n._0+" = "+q(n._2):q(n._0)}var s_={showExpr:q,showDecl:gr,showStmt:wa},l_={show:gr};function A(n,e){for(;;){var r=e;switch(r.TAG|0){case 0:var u=r._0,a=Qr(n,u);if(a===void 0)return{TAG:0,_0:u};e=a;continue;case 1:return{TAG:1,_0:r._0,_1:s(r._1,function(i){return A(n,i)})};case 2:var t=r._0,o;return o=t.TAG===0?{TAG:0,_0:t._0}:{TAG:1,_0:Pn.map(t._0,function(i){return A(n,i)})},{TAG:2,_0:o}}}}function ma(n,e){var r=e[0];return[r,A($o(n,r),e[1])]}function U(n,e){return No(Fo(e,function(r){return A(n,r)}),n,function(r,u,a){return Ro(a,u)})}function gn(n,e){return Yr(e,function(r){return ma(n,r)})}var Pe;function v_(n){return"struct "+n.name+`{
`+m(n.attributes,`,
`,function(e){return"  "+e.name+": "+k(e.ty)})+`
}`}function d_(n,e){return{TAG:2,_0:{TAG:1,_0:Pn.fromArray(s(n.attributes,function(r){return[r.name,r.ty]}),e)}}}function T_(n,e){var r={contents:0},u=[];return Rn(e,function(a){var t=a[1],o=te.size(t);u.push({name:a[0],mut:a[2],offset:r.contents,ty:t,size:o,impl:void 0}),r.contents=r.contents+o|0}),{name:n,attributes:u,size:r.contents,staticFuncs:[]}}function G_(n,e,r){n.attributes.push({name:e.contents.name,mut:!1,offset:0,ty:e.contents.ty,size:0,impl:[e,r]})}function g_(n,e){n.staticFuncs.push({name:e})}var ut={show:v_,toPartialStructType:d_,make:T_,addImplementation:G_,addStaticFunc:g_},Wn={tyVarIndex:0,identifiers:[],renaming:Lo(10),structs:Ir(5)};function Se(n){var e=Wn.tyVarIndex;return Wn.tyVarIndex=Wn.tyVarIndex+1|0,e}function wt(n){return{TAG:0,_0:Se()}}function Zt(n){var e=n[0],r=s(e,function(u){return{TAG:0,_0:Se()}});return A(Uo(Ve(e,r)),n[1])}function re(n,e){var r=n!==void 0?Un(n):void 0,u=Wn.identifiers.length;Wn.identifiers.push(e);var a={contents:{name:e,newName:e,index:u,ty:r!==void 0?r:{TAG:0,_0:Se()}}};return Xo(Wn.renaming,u,a),a}function h_(n){return yn(me.getReverseIndexBy(Wn.identifiers,function(e){return e===n}),function(e){return Mo(Wn.renaming,e)})}function Sa(n,e){e.contents.ty=A(n,e.contents.ty)}function pa(n){return Rn(Co(Wn.renaming),function(e){return Sa(n,e)})}function E_(n){return or(Wn.structs,n.name,n)}function Jn(n){return yr(Wn.structs,n)}function pe(n){switch(n.TAG|0){case 0:var e=n._0;return typeof e=="number"?Re:e.TAG===0?Zn:Bn;case 3:return n._0.contents.ty;case 4:case 11:return Re;case 12:return Gn(n._0,Re,pe);case 13:return n._2;case 14:return Ic(s(n._0,pe));case 15:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return n._0}}function A_(n){return n.TAG===0?n._1:n._0.length}var w_={len:A_};function m_(n){return pe(n._0)}function j(n,e){var r=n!==void 0?Un(n):void 0,u=function(G,O){return r!==void 0?"("+O+": "+k(A(Un(r),G))+")":O},a=function(G){return j(z(r),G)};switch(e.TAG|0){case 0:return u(pe(e),f_.show(e._0));case 1:return u(e._0,"("+j(z(r),e._1)+" "+c_.show(e._2)+" "+j(z(r),e._3)+")");case 2:return u(e._0,"("+__.show(e._1)+j(z(r),e._2)+")");case 3:var t=e._0;return u(t.contents.ty,t.contents.name);case 4:var o=e._1;return u(pe(o),j(z(r),e._0)+" = "+j(z(r),o));case 5:return u(e._0,"("+m(e._1,", ",function(G){return G.contents.name})+") -> "+j(z(r),e._2));case 6:return u(e._0,(e._1?"mut":"let")+" "+e._2.contents.name+" = "+j(z(r),e._3)+` in
`+j(z(r),e._4));case 7:return u(e._0,"let rec "+e._1.contents.name+" ("+m(e._2,", ",function(G){return G.contents.name})+") = "+j(z(r),e._3)+` in
`+j(z(r),e._4));case 8:return u(e._0,"("+j(z(r),e._1)+")("+m(e._2,", ",a)+")");case 9:var i=e._2,c=z(r);return u(e._0,(e._3===1?"unsafe ":"")+`{
`+m(un(s(e._1,function(G){return ba(c,G)}),Gn(i,[],function(G){return[j(void 0,G)]})),`;
`,function(G){return"  "+G})+(Ee(i)?"; ":"")+`
}`);case 10:return u(e._0,"if "+j(z(r),e._1)+" "+j(z(r),e._2)+" else "+j(z(r),e._3));case 11:return u(Re,"while "+j(void 0,e._0)+" "+j(void 0,e._1));case 12:var _=z(r);return"return "+u(pe(e),Gn(e._0,"",function(G){return j(_,G)}));case 13:var v=e._0;return u(pe(v),j(void 0,v))+" as "+k(e._2);case 14:var E=z(r);return"("+m(e._0,", ",function(G){return j(E,G)})+")";case 15:return e._0+` {
`+m(e._1,`,
`,function(G){return G[0]+": "+j(void 0,G[1])})+`
}`;case 16:var b=e._1,V;return V=b.TAG===0?"["+j(void 0,b._0)+"; "+String(b._1)+"]":"["+m(b._0,", ",function(G){return j(void 0,G)})+"]",u(e._0,V);case 17:return u(e._0,j(void 0,e._1)+"."+e._2)}}function ba(n,e){var r=n!==void 0?Un(n):void 0;return j(z(r),e._0)}function hr(n,e){var r=n!==void 0?Un(n):void 0,u=function(_,v){return r!==void 0?"("+v+": "+k(A(Un(r),_))+")":v};switch(e.TAG|0){case 0:var a=e._1,t=e._0,o;if(r!==void 0){var i=Un(r);o=m(a,", ",function(_){var v=_[0];return(_[1]?"mut ":"")+(v.contents.name+": "+k(A(i,v.contents.ty)))})}else o=m(a,", ",function(_){return(_[1]?"mut ":"")+_[0].contents.name});return u(t.contents.ty,"fn "+t.contents.name+"("+o+") "+j(z(r),e._2));case 1:var c=e._0;return u(c.contents.ty,(e._1?"mut":"let")+" "+c.contents.name+" = "+j(z(r),e._2));case 2:return s_.showDecl({TAG:2,_0:e._0,_1:e._1});case 3:return"impl "+e._0+` {
`+m(e._1,`

`,function(_){return hr(void 0,{TAG:0,_0:_[0],_1:_[1],_2:_[2]})})+`
}`;case 4:return"extern fn "+e.name.contents.name+"("+m(e.args,", ",function(_){var v=_[0];return(_[1]?"mut ":"")+v.contents.name+": "+k(v.contents.ty)})+") -> "+k(e.ret)}}var ka=wn("Core.CoreAst.UnexpectedDeclarationInImplBlock"),Da=wn("Core.CoreAst.UndeclaredIdentifer"),Na=wn("Core.CoreAst.UnreachableLetStmt");function Er(n,e,r,u,a){return r.TAG===5?{TAG:7,_0:r._0,_1:n,_2:r._1,_3:r._2,_4:u}:{TAG:6,_0:a,_1:e,_2:n,_3:r,_4:u}}function Z(n){var e={LAZY_DONE:!1,VAL:function(){return wt()}};switch(n.TAG|0){case 0:return{TAG:0,_0:n._0};case 1:return{TAG:2,_0:fe(e),_1:n._0,_2:Z(n._1)};case 2:return{TAG:1,_0:fe(e),_1:Z(n._0),_2:n._1,_3:Z(n._2)};case 3:var r=n._0,u=h_(r);if(u!==void 0)return{TAG:3,_0:u};var a=Jn(r);if(a!==void 0)return{TAG:3,_0:re(void 0,r)};throw{RE_EXN_ID:Da,_1:r,Error:new Error};case 4:return{TAG:4,_0:Z(n._0),_1:Z(n._1)};case 5:var t=n._1,o=n._0;if(o.length===0)return{TAG:5,_0:fe(e),_1:[re(void 0,"__x")],_2:Z(t)};var i=z(void 0);return{TAG:5,_0:fe(e),_1:s(o,function(G){return re(i,G)}),_2:Z(t)};case 6:return Er(re(void 0,n._0),!1,Z(n._1),Z(n._2),fe(e));case 7:return{TAG:8,_0:fe(e),_1:Z(n._0),_2:s(n._1,Z)};case 8:var c=n._2,_=n._1,v=function(G){if(!G)return K(_,Z);var O=G.hd;if(O.TAG!==0)return{TAG:9,_0:fe(e),_1:[Fa(O)],_2:v(G.tl),_3:c};var tn=O._3;return Er(re(void 0,O._0),O._1,Z(O._2),Gn(v(G.tl),{TAG:0,_0:0},function(Tn){return Tn}),tn!==void 0?tn:wt())};return{TAG:9,_0:fe(e),_1:[],_2:v(Gt(n._0)),_3:c};case 9:return{TAG:10,_0:fe(e),_1:Z(n._0),_2:Z(n._1),_3:Gn(n._2,{TAG:0,_0:0},Z)};case 10:return{TAG:11,_0:Z(n._0),_1:Z(n._1)};case 11:return{TAG:12,_0:K(n._0,Z)};case 12:return{TAG:13,_0:Z(n._0),_1:fe(e),_2:n._1};case 13:return{TAG:14,_0:s(n._0,Z)};case 14:return{TAG:15,_0:n._0,_1:s(n._1,function(G){return[G[0],Z(G[1])]})};case 15:var E=n._0,b=wt(),V;return V=E.TAG===0?{TAG:0,_0:Z(E._0),_1:E._1}:{TAG:1,_0:s(E._0,Z)},{TAG:16,_0:b,_1:V};case 16:return{TAG:17,_0:wt(),_1:Z(n._0),_2:n._1}}}function Fa(n){if(n.TAG!==0)return{_0:Z(n._0)};throw{RE_EXN_ID:Na,Error:new Error}}function Ar(n){switch(n.TAG|0){case 0:var e=s(n._1,function(o){return[re(z(void 0),o[0]),o[1]]});return{TAG:0,_0:re(void 0,n._0),_1:e,_2:Z(n._2)};case 1:return{TAG:1,_0:re(void 0,n._0),_1:n._1,_2:Z(n._2)};case 2:var r=n._1,u=n._0;return E_(ut.make(u,r)),{TAG:2,_0:u,_1:r};case 3:var a=s(s(n._1,Ar),function(o){if(o.TAG===0)return[o._0,o._1,o._2];throw{RE_EXN_ID:ka,_1:o,Error:new Error}});return{TAG:3,_0:n._0,_1:a};case 4:var t=s(n.args,function(o){return[re(z(o[1]),o[0]),o[2]]});return{TAG:4,name:re(void 0,n.name),args:t,ret:n.ret}}}function H(n,e){var r=function(_){return H(n,_)};switch(e.TAG|0){case 0:return{TAG:0,_0:e._0};case 1:return{TAG:1,_0:A(n,e._0),_1:H(n,e._1),_2:e._2,_3:H(n,e._3)};case 2:return{TAG:2,_0:A(n,e._0),_1:e._1,_2:H(n,e._2)};case 3:return{TAG:3,_0:e._0};case 4:return{TAG:4,_0:H(n,e._0),_1:H(n,e._1)};case 5:return{TAG:5,_0:A(n,e._0),_1:e._1,_2:H(n,e._2)};case 6:return{TAG:6,_0:A(n,e._0),_1:e._1,_2:e._2,_3:H(n,e._3),_4:H(n,e._4)};case 7:return{TAG:7,_0:A(n,e._0),_1:e._1,_2:e._2,_3:H(n,e._3),_4:H(n,e._4)};case 8:return{TAG:8,_0:A(n,e._0),_1:H(n,e._1),_2:s(e._2,r)};case 9:return{TAG:9,_0:A(n,e._0),_1:s(e._1,function(_){return Ra(n,_)}),_2:K(e._2,r),_3:e._3};case 10:return{TAG:10,_0:A(n,e._0),_1:H(n,e._1),_2:H(n,e._2),_3:H(n,e._3)};case 11:return{TAG:11,_0:H(n,e._0),_1:H(n,e._1)};case 12:return{TAG:12,_0:K(e._0,r)};case 13:return{TAG:13,_0:H(n,e._0),_1:A(n,e._1),_2:A(n,e._2)};case 14:return{TAG:14,_0:s(e._0,r)};case 15:var u=e._1,a=e._0,t=Jn(a);if(t===void 0)return xr('unreachable: undeclared struct "'+a+"'");var o=me.mapOption(s(Lt(t.attributes,function(_){return Ee(_.impl)}),function(_){var v=_.name;return Ct(u,function(E){return E[0]===v})}),function(_){return[_[0],H(n,_[1])]});return o!==void 0?{TAG:15,_0:a,_1:o}:xr('unreachable: missing attribute for struct "'+a+'"');case 16:var i=e._1,c;return c=i.TAG===0?{TAG:0,_0:H(n,i._0),_1:i._1}:{TAG:1,_0:s(i._0,r)},{TAG:16,_0:A(n,e._0),_1:c};case 17:return{TAG:17,_0:A(n,e._0),_1:H(n,e._1),_2:e._2}}}function Ra(n,e){return{_0:H(n,e._0)}}function $a(n,e){switch(e.TAG|0){case 0:return{TAG:0,_0:e._0,_1:e._1,_2:H(n,e._2)};case 1:return{TAG:1,_0:e._0,_1:e._1,_2:H(n,e._2)};case 3:return{TAG:3,_0:e._0,_1:s(e._1,function(r){return[r[0],r[1],H(n,r[2])]})};case 2:case 4:return e}}function x(n,e){var r=function(t){return x(n,t)};switch(e.TAG|0){case 1:return d(n,{TAG:1,_0:e._0,_1:x(n,e._1),_2:e._2,_3:x(n,e._3)});case 2:return d(n,{TAG:2,_0:e._0,_1:e._1,_2:x(n,e._2)});case 0:case 3:return d(n,e);case 4:return d(n,{TAG:4,_0:x(n,e._0),_1:x(n,e._1)});case 5:return d(n,{TAG:5,_0:e._0,_1:e._1,_2:x(n,e._2)});case 6:return d(n,{TAG:6,_0:e._0,_1:e._1,_2:e._2,_3:x(n,e._3),_4:x(n,e._4)});case 7:return d(n,{TAG:7,_0:e._0,_1:e._1,_2:e._2,_3:x(n,e._3),_4:x(n,e._4)});case 8:return d(n,{TAG:8,_0:e._0,_1:x(n,e._1),_2:s(e._2,r)});case 9:return d(n,{TAG:9,_0:e._0,_1:s(e._1,function(t){return{_0:x(n,t._0)}}),_2:K(e._2,r),_3:e._3});case 10:return d(n,{TAG:10,_0:e._0,_1:x(n,e._1),_2:x(n,e._2),_3:x(n,e._3)});case 11:return d(n,{TAG:11,_0:x(n,e._0),_1:x(n,e._1)});case 12:return d(n,{TAG:12,_0:K(e._0,r)});case 13:return d(n,{TAG:13,_0:x(n,e._0),_1:e._1,_2:e._2});case 14:return d(n,{TAG:14,_0:s(e._0,r)});case 15:return d(n,{TAG:15,_0:e._0,_1:s(e._1,function(t){return[t[0],x(n,t[1])]})});case 16:var u=e._1,a;return a=u.TAG===0?{TAG:0,_0:x(n,u._0),_1:u._1}:{TAG:1,_0:s(u._0,r)},d(n,{TAG:16,_0:e._0,_1:a});case 17:return d(n,{TAG:17,_0:e._0,_1:x(n,e._1),_2:e._2})}}function La(n,e){switch(e.TAG|0){case 0:return{TAG:0,_0:e._0,_1:e._1,_2:x(n,e._2)};case 1:return{TAG:1,_0:e._0,_1:e._1,_2:x(n,e._2)};case 3:return{TAG:3,_0:e._0,_1:s(e._1,function(r){return[r[0],r[1],x(n,r[2])]})};case 2:case 4:return e}}function Ca(n,e,r,u){var a=n!==void 0?Un(n):void 0,t=e!==void 0?Un(e):void 0;La(function(o){return o.TAG===9?(K(a,function(i){return d(i,o)}),d(r,o),K(t,function(i){return d(i,o)})):d(r,o),o},u)}function S_(n,e,r,u){var a=n!==void 0?Un(n):void 0,t=e!==void 0?Un(e):void 0,o=z(t),i=z(a);return Rn(u,function(c){return Ca(i,o,r,c)})}var sn={typeOfExpr:pe,ArrayInit:w_,typeOfStmt:m_,showExpr:j,showStmt:ba,showDecl:hr,UnexpectedDeclarationInImplBlock:ka,UndeclaredIdentifer:Da,UnreachableLetStmt:Na,rewriteLetIn:Er,fromExpr:Z,fromStmt:Fa,fromDecl:Ar,substExpr:H,substStmt:Ra,substDecl:$a,rewriteExpr:x,rewriteDecl:La,visitDecl:Ca,visitProg:S_},Xn={show:j,from:Z,subst:H,typeOf:pe},$e={show:hr,from:Ar,subst:$a};function Xa(n){return[n,0,n.length]}function p_(n){return Xa(Array.from(n,function(e){return nu(e,0)}))}function Ma(n,e){var r=e[2],u=n!==void 0?n:1;return[e[0],Math.min(e[1]+u|0,r),r]}function wr(n){return ze(n[0],n[1])}function mr(n){return Ma(1,n)}function Sr(n){return n[1]===n[2]}function b_(n){return n[0].slice(n[1],n[2])}function at(n,e){var r=wr(e);if(r!==void 0&&d(n,r))return[r,Ma(void 0,e)]}function en(n){return function(e){return at(function(r){return r===n},e)}}function Ua(n){return n>=97?n<=122:!1}function k_(n){return n>=65?n<=90:!1}function D_(n){return Ua(n)?!0:k_(n)}function Oa(n){return n>=48?n<=57:!1}function N_(n){return D_(n)?!0:Oa(n)}function F_(n){return at(Ua,n)}function R_(n){return at(Oa,n)}function pr(n){return at(N_,n)}function $_(n){return n>13||n<9?n===32:!(n===12||n===11)}function L_(n){return at($_,n)}function w(n,e,r){return K(d(n,r),function(u){return[d(e,u[0]),u[1]]})}function Wt(n,e,r){for(;;){var u=n,a=r,t=u!==void 0?u:[];if(Sr(a))return[t,a];var o=d(e,a);if(o===void 0)return[t,a];t.push(o[0]),r=o[1],n=t}}function za(n){return Wt(void 0,L_,n)}function mt(n,e,r){return yn(d(n,r),function(u){var a=u[0];return K(d(e,u[1]),function(t){return[[a,t[0]],t[1]]})})}function Va(n){return function(e){return w(function(r){return mt(n,function(u){return Wt(void 0,n,u)},r)},function(r){return un([r[0]],r[1])},e)}}function C_(n,e,r,u){return yn(mt(n,e,u),function(a){var t=a[0],o=t[1],i=t[0];return K(d(r,a[1]),function(c){return[[i,o,c[0]],c[1]]})})}function Ba(n){if(!n)return function(a){return[0,a]};var e=n.hd,r=Ba(n.tl),u=function(a){return mt(e,r,a)};return function(a){return w(u,function(t){return{hd:t[0],tl:t[1]}},a)}}function Pa(n,e,r){var u=d(n,r);return u!==void 0?[u[0],u[1]]:d(e,r)}function St(n,e){return me.firstSomeBy(n,function(r){return d(r,e)})}function Q(n){var e=Array.from(n,function(u){var a=nu(u,0);return function(t){return at(function(o){return o===a},t)}}),r=Ba(Gt(e));return function(u){return w(r,function(a){return n},u)}}function X_(n,e){var r=d(n,e);if(r===void 0)return[void 0,mr(e)]}var M_=Va(R_);function U_(n){return w(M_,function(e){return{TAG:0,_0:eu(tu(m(e,"",function(r){return Xt(1,r)})))}},n)}var O_=Q("false");function z_(n){return w(O_,function(e){return{TAG:1,_0:!1}},n)}var V_=Q("true");function B_(n){return w(V_,function(e){return{TAG:1,_0:!0}},n)}function P_(n){return Pa(B_,z_,n)}var q_=[pr,en(95),en(39)];function j_(n){return St(q_,n)}function Z_(n){return Wt(void 0,j_,n)}var W_=en(95);function J_(n){return Pa(F_,W_,n)}function K_(n){return mt(J_,Z_,n)}function Y_(n){return w(K_,function(e){return{TAG:3,_0:Xt(1,e[0])+m(e[1],"",function(r){return Xt(1,r)})}},n)}var H_=[pr,en(95)],Q_=Va(function(n){return St(H_,n)});function I_(n){return w(Q_,function(e){return{TAG:4,_0:m(e,"",function(r){return Xt(1,r)})}},n)}var y_=Q("let"),x_=Q("mut"),n0=Q("in"),e0=Q("if"),t0=Q("else"),r0=Q("fn"),u0=Q("while"),a0=Q("return"),o0=Q("as"),i0=Q("unsafe"),c0=Q("struct"),_0=Q("impl"),f0=Q("extern"),s0=[function(n){return w(y_,function(e){return{TAG:5,_0:0}},n)},function(n){return w(x_,function(e){return{TAG:5,_0:1}},n)},function(n){return w(n0,function(e){return{TAG:5,_0:2}},n)},function(n){return w(e0,function(e){return{TAG:5,_0:3}},n)},function(n){return w(t0,function(e){return{TAG:5,_0:4}},n)},function(n){return w(r0,function(e){return{TAG:5,_0:5}},n)},function(n){return w(u0,function(e){return{TAG:5,_0:6}},n)},function(n){return w(a0,function(e){return{TAG:5,_0:7}},n)},function(n){return w(o0,function(e){return{TAG:5,_0:8}},n)},function(n){return w(i0,function(e){return{TAG:5,_0:9}},n)},function(n){return w(c0,function(e){return{TAG:5,_0:10}},n)},function(n){return w(_0,function(e){return{TAG:5,_0:11}},n)},function(n){return w(f0,function(e){return{TAG:5,_0:12}},n)}];function l0(n){return St(s0,n)}function v0(n){return mt(l0,function(e){return X_(pr,e)},n)}function d0(n){return w(v0,function(e){return e[0]},n)}var T0=Q("->"),G0=Q("=="),g0=Q("!="),h0=Q("&&"),E0=Q("||"),A0=Q("+="),w0=Q("-="),m0=Q("*="),S0=Q("/="),p0=Q("%="),b0=en(43),k0=en(45),D0=en(42),N0=en(47),F0=en(37),R0=Q("<="),$0=Q(">="),L0=en(60),C0=en(62),X0=en(40),M0=en(41),U0=en(44),O0=en(59),z0=en(61),V0=en(123),B0=en(125),P0=en(91),q0=en(93),j0=en(58),Z0=en(33),W0=en(46),J0=en(38),K0=en(124),Y0=[function(n){return w(T0,function(e){return{TAG:2,_0:5}},n)},function(n){return w(G0,function(e){return{TAG:2,_0:16}},n)},function(n){return w(g0,function(e){return{TAG:2,_0:17}},n)},function(n){return w(h0,function(e){return{TAG:2,_0:25}},n)},function(n){return w(E0,function(e){return{TAG:2,_0:27}},n)},function(n){return w(A0,function(e){return{TAG:2,_0:28}},n)},function(n){return w(w0,function(e){return{TAG:2,_0:29}},n)},function(n){return w(m0,function(e){return{TAG:2,_0:30}},n)},function(n){return w(S0,function(e){return{TAG:2,_0:31}},n)},function(n){return w(p0,function(e){return{TAG:2,_0:32}},n)},function(n){return w(b0,function(e){return{TAG:2,_0:11}},n)},function(n){return w(k0,function(e){return{TAG:2,_0:12}},n)},function(n){return w(D0,function(e){return{TAG:2,_0:13}},n)},function(n){return w(N0,function(e){return{TAG:2,_0:14}},n)},function(n){return w(F0,function(e){return{TAG:2,_0:15}},n)},function(n){return w(R0,function(e){return{TAG:2,_0:19}},n)},function(n){return w($0,function(e){return{TAG:2,_0:21}},n)},function(n){return w(L0,function(e){return{TAG:2,_0:18}},n)},function(n){return w(C0,function(e){return{TAG:2,_0:20}},n)},function(n){return w(X0,function(e){return{TAG:2,_0:0}},n)},function(n){return w(M0,function(e){return{TAG:2,_0:1}},n)},function(n){return w(U0,function(e){return{TAG:2,_0:2}},n)},function(n){return w(O0,function(e){return{TAG:2,_0:3}},n)},function(n){return w(z0,function(e){return{TAG:2,_0:4}},n)},function(n){return w(V0,function(e){return{TAG:2,_0:6}},n)},function(n){return w(B0,function(e){return{TAG:2,_0:7}},n)},function(n){return w(P0,function(e){return{TAG:2,_0:8}},n)},function(n){return w(q0,function(e){return{TAG:2,_0:9}},n)},function(n){return w(j0,function(e){return{TAG:2,_0:10}},n)},function(n){return w(Z0,function(e){return{TAG:2,_0:22}},n)},function(n){return w(W0,function(e){return{TAG:2,_0:23}},n)},function(n){return w(J0,function(e){return{TAG:2,_0:24}},n)},function(n){return w(K0,function(e){return{TAG:2,_0:26}},n)}];function H0(n){return St(Y0,n)}var Q0=[U_,P_,d0,H0,Y_,I_];function I0(n){return St(Q0,n)}function y0(n){return Wt(void 0,function(e){return w(function(r){return C_(za,I0,za,r)},function(r){return r[1]},e)},n)}function x0(n){switch(n){case 0:return"(";case 1:return")";case 2:return",";case 3:return";";case 4:return"=";case 5:return"->";case 6:return"{";case 7:return"}";case 8:return"[";case 9:return"]";case 10:return":";case 11:return"+";case 12:return"-";case 13:return"*";case 14:return"/";case 15:return"%";case 16:return"==";case 17:return"!=";case 18:return"<";case 19:return"<=";case 20:return">";case 21:return">=";case 22:return"!";case 23:return".";case 24:return"&";case 25:return"&&";case 26:return"|";case 27:return"||";case 28:return"+=";case 29:return"-=";case 30:return"*=";case 31:return"/=";case 32:return"%="}}function nf(n){switch(n){case 0:return"let";case 1:return"mut";case 2:return"in";case 3:return"if";case 4:return"else";case 5:return"fn";case 6:return"while";case 7:return"return";case 8:return"as";case 9:return"unsafe";case 10:return"struct";case 11:return"impl";case 12:return"extern"}}function ef(n){switch(n.TAG|0){case 0:return String(n._0);case 1:return n._0?"true":"false";case 2:return x0(n._0);case 3:case 4:return n._0;case 5:return nf(n._0)}}function ot(n){return{contents:function(e){return yn(wr(e),function(r){if(d(n,r))return[r,mr(e)]})}}}function it(n){return{contents:function(e){return yn(wr(e),function(r){return K(d(n,r),function(u){return[u,mr(e)]})})}}}function tf(n,e){return{contents:function(r){var u=d(n.contents,r);if(u!==void 0){var a=u[1];return K(d(e,u[0]),function(t){return[t,a]})}}}}function l(n){return ot(function(e){return Mn(e,n)})}function T(n,e){return{contents:function(r){return K(d(n.contents,r),function(u){return[d(e,u[0]),u[1]]})}}}function ln(n,e){return{contents:function(r){return yn(d(n.contents,r),function(u){var a=u[0];return K(d(e.contents,u[1]),function(t){return[[a,t[0]],t[1]]})})}}}function pt(n){var e=function(r){return{contents:function(u){if(Sr(u))return[0,u];var a=d(r.contents,u);if(a===void 0)return[0,u];var t=a[0];return K(d(e(r).contents,a[1]),function(o){return[{hd:t,tl:o[0]},o[1]]})}}};return T(e(n),nt)}function rf(n){return T(ln(n,pt(n)),function(e){return un([e[0]],e[1])})}function Kn(n,e,r){return{contents:function(u){return yn(d(ln(n,e).contents,u),function(a){var t=a[0],o=t[1],i=t[0];return K(d(r.contents,a[1]),function(c){return[[i,o,c[0]],c[1]]})})}}}function qe(n,e,r,u){return{contents:function(a){return yn(d(Kn(n,e,r).contents,a),function(t){var o=t[0],i=o[2],c=o[1],_=o[0];return K(d(u.contents,t[1]),function(v){return[[_,c,i,v[0]],v[1]]})})}}}function bt(n,e,r,u,a){return{contents:function(t){return yn(d(qe(n,e,r,u).contents,t),function(o){var i=o[0],c=i[3],_=i[2],v=i[1],E=i[0];return K(d(a.contents,o[1]),function(b){return[[E,v,_,c,b[0]],b[1]]})})}}}function qa(n,e,r,u,a,t){return{contents:function(o){return yn(d(bt(n,e,r,u,a).contents,o),function(i){var c=i[0],_=c[4],v=c[3],E=c[2],b=c[1],V=c[0];return K(d(t.contents,i[1]),function(G){return[[V,b,E,v,_,G[0]],G[1]]})})}}}function uf(n,e,r,u,a,t,o){return{contents:function(i){return yn(d(qa(n,e,r,u,a,t).contents,i),function(c){var _=c[0],v=_[5],E=_[4],b=_[3],V=_[2],G=_[1],O=_[0];return K(d(o.contents,c[1]),function(tn){return[[O,G,V,b,E,v,tn[0]],tn[1]]})})}}}function P(n,e){return{contents:function(r){var u=d(n.contents,r);return u!==void 0?[u[0],u[1]]:d(e.contents,r)}}}function je(n){return{contents:function(e){return me.firstSomeBy(n,function(r){return d(r.contents,e)})}}}function ja(n,e,r){return T(ln(n,pt(e)),function(u){var a=u[1],t=u[0];return Mn(a,[])?t:An(a,t,r)})}function Ze(n,e,r){return ja(n,ln(e,n),function(u,a){return Oo(r,u,a[0],a[1])})}function Le(n){return T(Kn(ot(function(e){return Mn(e,{TAG:2,_0:0})}),n,ot(function(e){return Mn(e,{TAG:2,_0:1})})),function(e){return e[1]})}function br(n){return T(Kn(ot(function(e){return Mn(e,{TAG:2,_0:8})}),n,ot(function(e){return Mn(e,{TAG:2,_0:9})})),function(e){return e[1]})}function af(n,e){var r=function(u,a){var t=d(n.contents,u);if(t===void 0)return[a,u];var o=t[1];return a.push(t[0]),Gn(d(e.contents,o),[a,o],function(i){return r(i[1],a)})};return{contents:function(u){return r(u,[])}}}function ve(n){return af(n,ot(function(e){return Mn(e,{TAG:2,_0:2})}))}function de(n){return P(T(n,function(e){return z(e)}),{contents:function(e){return[void 0,e]}})}var Za=ln,Wa={contents:function(n){}},vn={contents:function(n){}},ct={contents:function(n){}},Ja={contents:function(n){}},ue={contents:function(n){}},kr=it(function(n){if(n.TAG===0)return{TAG:0,_0:{TAG:0,_0:n._0}}}),of=it(function(n){if(n.TAG===1)return{TAG:0,_0:{TAG:1,_0:n._0}}}),ae=it(function(n){if(n.TAG===3)return n._0}),Jt=it(function(n){if(n.TAG===4)return n._0}),Dr=it(function(n){switch(n.TAG|0){case 3:case 4:return n._0;default:return}}),cf=T(ln(l({TAG:2,_0:0}),l({TAG:2,_0:1})),function(n){return Re}),_f=P(cf,it(function(n){switch(n.TAG|0){case 3:switch(n._0){case"bool":return Bn;case"u32":return Zn;default:return}case 4:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return}})),Ka=P(_f,Le(ue));function Ya(n){if(n.TAG!==0)return-1;var e=n._0;return typeof e=="number"||e.TAG!==0?-1:e._0}var ff=P(T(br(Kn(ue,l({TAG:2,_0:3}),kr)),function(n){return Ta(n[0],Ya(n[2]))}),Ka),sf=P(T(Kn(P(Le(ve(ue)),T(Ka,function(n){return[n]})),l({TAG:2,_0:5}),ue),function(n){return Cn(n[0],n[2])}),ff),lf=P(T(qe(Jt,l({TAG:2,_0:18}),ve(ue),l({TAG:2,_0:20})),function(n){return{TAG:1,_0:n[0],_1:n[2]}}),sf);ue.contents=lf.contents;var vf=T(ln(Dr,de(ln(l({TAG:2,_0:10}),ue))),function(n){return[n[0],K(n[1],function(e){return e[1]})]}),df=T(P(ae,Dr),function(n){return{TAG:3,_0:n}}),Tf=T(ln(l({TAG:2,_0:0}),l({TAG:2,_0:1})),function(n){return{TAG:0,_0:0}}),Gf=T(Le(qe(vn,l({TAG:2,_0:2}),vn,de(ln(l({TAG:2,_0:2}),ve(vn))))),function(n){var e=un([n[0],n[2]],Gn(n[3],[],function(r){return r[1]}));return{TAG:13,_0:e}}),Ha=je([kr,of,Tf,df,Gf,Le(vn)]),Qa=P(ja(Ha,ln(l({TAG:2,_0:23}),ae),function(n,e){return{TAG:16,_0:n,_1:e[1]}}),Ha),Ia=P(T(ln(Qa,rf(Le(ve(vn)))),function(n){return An(n[1],n[0],function(e,r){return{TAG:7,_0:e,_1:r}})}),Qa),gf=je([T(l({TAG:2,_0:13}),function(n){return 2}),T(l({TAG:2,_0:12}),function(n){return 0}),T(l({TAG:2,_0:22}),function(n){return 1})]),hf=P(T(l({TAG:2,_0:11}),function(n){return 0}),T(l({TAG:2,_0:12}),function(n){return 1})),Ef=je([T(l({TAG:2,_0:13}),function(n){return 2}),T(l({TAG:2,_0:14}),function(n){return 3}),T(l({TAG:2,_0:15}),function(n){return 4})]),Af=je([T(l({TAG:2,_0:25}),function(n){return 11}),T(l({TAG:2,_0:27}),function(n){return 12})]),wf=je([T(l({TAG:2,_0:24}),function(n){return 13}),T(l({TAG:2,_0:26}),function(n){return 14}),T(Za(l({TAG:2,_0:18}),l({TAG:2,_0:18})),function(n){return 15}),T(Za(l({TAG:2,_0:20}),l({TAG:2,_0:20})),function(n){return 16})]),mf=je([T(l({TAG:2,_0:18}),function(n){return 5}),T(l({TAG:2,_0:19}),function(n){return 6}),T(l({TAG:2,_0:20}),function(n){return 7}),T(l({TAG:2,_0:21}),function(n){return 8})]),Sf=P(T(l({TAG:2,_0:16}),function(n){return 9}),T(l({TAG:2,_0:17}),function(n){return 10})),pf=P(T(ln(gf,Ia),function(n){return{TAG:1,_0:n[0],_1:n[1]}}),Ia),bf=Ze(pf,Ef,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),kf=Ze(bf,hf,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),Df=Ze(kf,Af,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),Nf=Ze(Df,wf,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),Ff=Ze(Nf,mf,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),Rf=Ze(Ff,Sf,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),$f=P(T(qe(l({TAG:5,_0:3}),vn,ct,de(ln(l({TAG:5,_0:4}),ct))),function(n){return{TAG:9,_0:n[1],_1:n[2],_2:K(n[3],function(e){return e[1]})}}),Rf),Lf=P(T(Kn(l({TAG:5,_0:6}),vn,ct),function(n){return{TAG:10,_0:n[1],_1:n[2]}}),$f),Cf=P(T(qa(l({TAG:5,_0:0}),ae,l({TAG:2,_0:4}),vn,l({TAG:5,_0:2}),vn),function(n){return{TAG:6,_0:n[1],_1:n[3],_2:n[5]}}),Lf),Xf=P(Le(ve(ae)),T(ae,function(n){return[n]})),Mf=P(T(Kn(Xf,l({TAG:2,_0:5}),vn),function(n){return{TAG:5,_0:n[0],_1:n[2]}}),Cf),Uf=tf(vn,function(n){switch(n.TAG|0){case 9:case 10:return[!0,{TAG:1,_0:n}];default:return}});ct.contents=P(T(bt(de(l({TAG:5,_0:9})),l({TAG:2,_0:6}),pt(P(T(Ja,function(n){return[!1,n]}),Uf)),de(vn),l({TAG:2,_0:7})),function(n){var e=n[3],r=n[2],u=s(r,function(i){return i[1]}),a=Gn(n[0],0,function(i){return 1}),t=ze(r,r.length-1|0);if(t===void 0)return{TAG:8,_0:u,_1:e,_2:a};var o=t[1];return o.TAG===0||!(t[0]&&Ee(e))?{TAG:8,_0:u,_1:e,_2:a}:{TAG:8,_0:ur(u,0,r.length-1|0),_1:o._0,_2:a}}),Mf).contents;var Of=T(br(Kn(vn,l({TAG:2,_0:3}),kr)),function(n){return{TAG:15,_0:{TAG:0,_0:n[0],_1:Ya(n[2])}}}),zf=T(br(ve(vn)),function(n){return{TAG:15,_0:{TAG:1,_0:n}}}),Vf=P(P(Of,zf),ct),Bf=P(T(qe(Jt,l({TAG:2,_0:6}),ve(Kn(ae,l({TAG:2,_0:10}),vn)),l({TAG:2,_0:7})),function(n){return{TAG:14,_0:n[0],_1:s(n[2],function(e){return[e[0],e[2]]})}}),Vf),Pf=je([T(l({TAG:2,_0:4}),function(n){return"eq"}),T(l({TAG:2,_0:28}),function(n){return"plusEq"}),T(l({TAG:2,_0:29}),function(n){return"minusEq"}),T(l({TAG:2,_0:30}),function(n){return"starEq"}),T(l({TAG:2,_0:31}),function(n){return"divEq"}),T(l({TAG:2,_0:32}),function(n){return"modEq"})]),qf=Ze(Bf,Pf,function(n,e,r){return e==="minusEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:1,_2:r}}:e==="divEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:3,_2:r}}:e==="eq"?{TAG:4,_0:n,_1:r}:e==="starEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:2,_2:r}}:e==="modEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:4,_2:r}}:{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:0,_2:r}}}),jf=P(T(ln(l({TAG:5,_0:7}),de(vn)),function(n){return{TAG:11,_0:n[1]}}),qf),Zf=T(ln(jf,de(ln(l({TAG:5,_0:8}),ue))),function(n){var e=n[1],r=n[0];return e!==void 0?{TAG:12,_0:r,_1:e[1]}:r});vn.contents=Zf.contents;var Wf=T(ln(vn,l({TAG:2,_0:3})),function(n){return{TAG:1,_0:n[0]}}),Jf=P(T(bt(P(l({TAG:5,_0:0}),l({TAG:5,_0:1})),vf,l({TAG:2,_0:4}),vn,l({TAG:2,_0:3})),function(n){var e=n[1];return{TAG:0,_0:e[0],_1:Mn(n[0],{TAG:5,_0:1}),_2:n[3],_3:e[1]}}),Wf);Ja.contents=Jf.contents;var Kf=T(bt(P(l({TAG:5,_0:0}),l({TAG:5,_0:1})),Dr,l({TAG:2,_0:4}),vn,l({TAG:2,_0:3})),function(n){return{TAG:1,_0:n[1],_1:Mn(n[0],{TAG:5,_0:1}),_2:n[3]}}),Yf=P(T(bt(l({TAG:5,_0:10}),Jt,l({TAG:2,_0:6}),ve(Kn(ln(de(l({TAG:5,_0:1})),ae),l({TAG:2,_0:10}),ue)),l({TAG:2,_0:7})),function(n){var e=s(n[3],function(r){var u=r[0];return[u[1],r[2],Mt(u[0])]});return{TAG:2,_0:n[1],_1:e}}),Kf),ya=P(T(qe(l({TAG:5,_0:5}),ae,T(Le(ve(ln(de(l({TAG:5,_0:1})),ae))),function(n){return s(n,function(e){return[e[1],Mt(e[0])]})}),ct),function(n){return{TAG:0,_0:n[1],_1:n[2],_2:n[3]}}),Yf),Hf=P(T(uf(l({TAG:5,_0:12}),l({TAG:5,_0:5}),ae,Le(T(ve(qe(de(l({TAG:5,_0:1})),ae,l({TAG:2,_0:10}),ue)),function(n){return s(n,function(e){return[e[1],e[3],Mt(e[0])]})})),l({TAG:2,_0:5}),ue,l({TAG:2,_0:3})),function(n){return{TAG:4,name:n[2],args:n[3],ret:n[5]}}),ya),Qf=P(T(Kn(l({TAG:5,_0:11}),Jt,T(Kn(l({TAG:2,_0:6}),pt(ya),l({TAG:2,_0:7})),function(n){return n[1]})),function(n){return{TAG:3,_0:n[1],_1:n[2]}}),Hf);Wa.contents=Qf.contents;var If=pt(Wa);function Kt(n){var e=n.replace(/(\/\/[^\n]*)/g,""),r=y0(p_(e));if(r===void 0)return{TAG:1,_0:"could not tokenize"};var u=d(If.contents,Xa(r[0]));if(u===void 0)return{TAG:1,_0:"could not parse"};var a=u[1];if(Sr(a))return{TAG:0,_0:u[0]};var t=m(ur(b_(a),0,5)," ",ef);return{TAG:1,_0:"could not parse near "+t}}function yf(n,e){var r=n!==void 0?n:100,u={contents:e.length},a=function(t,o,i){for(;;){var c=i,_=o,v=t;if(v){var E=v.hd,b=0;if(typeof E=="number")switch(E){case 2:var V=v.tl;if(V&&V.hd===3){t={hd:2,tl:V.tl};continue}break;case 9:var G=v.tl;if(G&&G.hd===9){t=G.tl;continue}break;case 10:var O=v.tl;if(O&&O.hd===9){t={hd:14,tl:O.tl};continue}break;case 14:var tn=v.tl;if(tn&&tn.hd===9){t={hd:10,tl:tn.tl};continue}break;case 18:var Tn=v.tl;if(Tn&&Tn.hd===9){t={hd:36,tl:Tn.tl};continue}break;case 19:var $n=v.tl;if($n&&$n.hd===9){t={hd:37,tl:$n.tl};continue}break;case 24:var Sn=v.tl;if(Sn&&Sn.hd===9){t={hd:30,tl:Sn.tl};continue}break;case 25:var kn=v.tl;if(kn&&kn.hd===9){t={hd:31,tl:kn.tl};continue}break;case 30:var Dn=v.tl;if(Dn&&Dn.hd===9){t={hd:24,tl:Dn.tl};continue}break;case 31:var pn=v.tl;if(pn&&pn.hd===9){t={hd:25,tl:pn.tl};continue}break;case 36:var hn=v.tl;if(hn&&hn.hd===9){t={hd:18,tl:hn.tl};continue}break;case 37:var an=v.tl;if(an&&an.hd===9){t={hd:19,tl:an.tl};continue}break}else switch(E.TAG|0){case 0:var L=E._0,zn=0,bn=v.tl;if(bn){var Nn=bn.hd;if(typeof Nn=="number")switch(Nn){case 3:t=bn.tl;continue;case 6:if(da.isPowerOf2(L)){t={hd:{TAG:0,_0:Math.log2(L)|0},tl:{hd:46,tl:bn.tl}};continue}break;case 7:if(da.isPowerOf2(L)){t={hd:{TAG:0,_0:Math.log2(L)|0},tl:{hd:48,tl:bn.tl}};continue}break;default:zn=3}else switch(Nn.TAG|0){case 0:var rn=bn.tl;if(rn){var Fn=rn.hd;if(typeof Fn=="number"){var Ln=Nn._0;if(Fn>=15){if(Fn>=43)switch(Fn){case 43:t={hd:{TAG:0,_0:zo(L,Ln)},tl:rn.tl};continue;case 46:t={hd:{TAG:0,_0:L<<Ln},tl:rn.tl};continue;case 44:case 45:case 47:break;case 48:t={hd:{TAG:0,_0:L>>>Ln|0},tl:rn.tl};continue}}else switch(Fn){case 4:t={hd:{TAG:0,_0:L+Ln|0},tl:rn.tl};continue;case 5:t={hd:{TAG:0,_0:L-Ln|0},tl:rn.tl};continue;case 6:t={hd:{TAG:0,_0:Math.imul(L,Ln)},tl:rn.tl};continue;case 7:t={hd:{TAG:0,_0:Vo(L,Ln)},tl:rn.tl};continue;case 10:t={hd:{TAG:0,_0:L===Ln?1:0},tl:rn.tl};continue;case 0:case 1:case 2:case 3:case 8:case 9:case 11:case 12:case 13:break;case 14:t={hd:{TAG:0,_0:L===Ln?0:1},tl:rn.tl};continue}}}break;case 15:t={hd:{TAG:14,_0:L},tl:bn.tl};continue;default:zn=3}}if(zn===3&&L===0){var ie=v.tl,Yn=ie.hd;if(typeof Yn=="number"){if(Yn>=46){if(Yn!==47){t=ie.tl;continue}}else if(Yn===10){t={hd:9,tl:ie.tl};continue}}}break;case 1:case 2:case 3:case 9:case 11:b=2;break;case 12:var Hn=v.tl;if(Hn){var Xe=Hn.hd;if(typeof Xe!="number"&&Xe.TAG===11){var ce=E._0;if(ce===Xe._0){t={hd:{TAG:13,_0:ce},tl:Hn.tl};continue}}}break;case 13:var _e=v.tl;if(_e&&_e.hd===3){t={hd:{TAG:12,_0:E._0},tl:_e.tl};continue}break}if(b===2){var Te=v.tl;if(Te&&Te.hd===3){t=Te.tl;continue}}o={hd:E,tl:_},t=v.tl;continue}var Qn=jr(_),In=Bo(Qn);if(!(c>1&&In<u.contents))return Qn;u.contents=In,i=c-1|0,o=0,t=Qn}};return r>0?nt(a(Gt(e),0,r)):e}function Nr(n,e){switch(e.TAG|0){case 0:return n===e._0;case 1:return ir(e._1,function(u){return Nr(n,u)});case 2:var r=e._0;return r.TAG===0?!1:ir(Pn.toArray(r._0),function(u){return Nr(n,u[1])})}}function xa(n,e,r){if(Nr(n,e))return{TAG:1,_0:k({TAG:0,_0:n})+" occurs in "+k(e)};var u=Qr(r,n);return u!==void 0?Mn(u,e)?{TAG:0,_0:r}:{TAG:1,_0:k(e)+" is not unifiable with "+k(u)}:{TAG:0,_0:ru(r,n,e)}}function _t(n,e){for(;;){var r=n;if(!r)return{TAG:0,_0:e};var u=r.tl,a=r.hd,t=a[1],o=a[0],i=0;switch(o.TAG|0){case 0:var c=o._0,_=0;switch(t.TAG|0){case 0:if(c===t._0){n=u;continue}_=3;break;case 1:case 2:_=3;break}if(_===3)return N(xa(c,t,e),function(an){return function(L){return _t(an,L)}}(u));break;case 1:var v=o._1;switch(t.TAG|0){case 0:i=1;break;case 1:var E=t._1;if(o._0===t._0&&v.length===E.length){var b=An(Ve(v,E),u,function(an,L){return{hd:[A(e,L[0]),A(e,L[1])],tl:an}});n=b;continue}i=2;break;case 2:i=2;break}break;case 2:var V=o._0;switch(t.TAG|0){case 0:i=1;break;case 1:i=2;break;case 2:var G=t._0;if(V.TAG===0){var O=V._0;if(G.TAG===0){if(O!==G._0)return{TAG:1,_0:"cannot unify "+k(o)+" with "+k(t)};n=u;continue}var tn=Jn(O);if(tn===void 0)return{TAG:1,_0:'undeclared struct "'+O+'"'};var Tn=_t({hd:[{TAG:2,_0:{TAG:1,_0:G._0}},ut.toPartialStructType(tn,Se())],tl:u},e);return Tn.TAG===0?{TAG:0,_0:Tn._0}:{TAG:1,_0:"struct type "+k(t)+" does not match "+O+": "+Tn._0}}var $n=V._0;if(G.TAG===0){var Sn=G._0,kn=Jn(Sn);if(kn===void 0)return{TAG:1,_0:'undeclared struct "'+Sn+'"'};var Dn=_t({hd:[{TAG:2,_0:{TAG:1,_0:$n}},ut.toPartialStructType(kn,Se())],tl:u},e);return Dn.TAG===0?{TAG:0,_0:Dn._0}:{TAG:1,_0:"struct type "+k(o)+" does not match "+Sn+": "+Dn._0}}var pn=Pn.toMap(G._0),hn=Pn.toArray($n);return N(me.mapResult(s(hn,function(an,L,zn){return function(bn){var Nn=bn[0],rn=rr(zn,Nn);return rn!==void 0?{TAG:0,_0:[bn[1],rn]}:{TAG:1,_0:"struct type "+k(L)+' is missing attribute "'+Nn+'" from type "'+k(an)+'"'}}}(o,t,pn)),function(an){return an}),function(an,L,zn,bn){return function(Nn){var rn={TAG:2,_0:{TAG:1,_0:Pn.fromArray(Kr(Po(zn,s(bn,function(Fn){return Fn[0]}))),Se())}};return _t(qo(Gt(Nn),{hd:[Pn.tail(L),rn],tl:an}),e)}}(u,$n,pn,hn))}break}switch(i){case 1:return N(xa(t._0,o,e),function(an){return function(L){return _t(an,L)}}(u));case 2:return{TAG:1,_0:k(o)+" is not unifiable with "+k(t)}}}}function on(n,e){return _t({hd:[n,e],tl:0},void 0)}function xf(n,e){return"cannot infer struct type: inferred type "+Pn.show(n,k)+" matches "+m(e,", ",function(r){return r.name})}function Fr(n){var e=jo(uu(Wn.structs),function(a){return Zo(on({TAG:2,_0:{TAG:1,_0:n}},ut.toPartialStructType(a,Se())),void 0,function(t){return a})}),r=e.length;if(r!==1)return r!==0?{TAG:1,_0:e}:0;var u=e[0];return{TAG:0,_0:u}}function ns(n){var e;return e=typeof n=="number"?Re:n.TAG===0?Zn:Bn,rt(e)}function es(n){var e=0;if(n>=5)switch(n){case 5:case 6:case 7:case 8:e=2;break;case 9:case 10:e=3;break;case 11:case 12:return rt(Cn([Bn,Bn],Bn));case 13:case 14:case 15:case 16:e=1;break}else e=1;switch(e){case 1:return rt(Cn([Zn,Zn],Zn));case 2:return rt(Cn([Zn,Zn],Bn));case 3:return[[0],Cn([{TAG:0,_0:0},{TAG:0,_0:0}],Bn)]}}function ts(n){switch(n){case 0:return rt(Cn([Zn],Zn));case 1:return rt(Cn([Bn],Bn));case 2:return[[0],Cn([yc({TAG:0,_0:0})],{TAG:0,_0:0})]}}var ft=Ut();function no(n,e,r,u,a){var t=Xn.typeOf(r);Be(ft,t);var o=An(e,n,function(_,v){return On.addMono(_,v.contents.name,v.contents.ty)}),i=Cn(s(e,function(_){return _.contents.ty}),t),c=a!==void 0?On.addMono(o,a,i):o;return N(mn(c,r,t),function(_){var v=A(_,i),E=A(_,u),b=gn(_,n),V=Gr(b,v);return Y(on(E,v),function(G){gt(ft);var O=U(G,_);return[O,A(G,E),ma(G,V)]})})}function mn(n,e,r){return N(oe(n,e),function(u){return Y(on(A(u,r),A(u,Xn.typeOf(e))),function(a){return U(a,u)})})}function oe(n,e){switch(e.TAG|0){case 0:var r=Zt(ns(e._0));return on(Xn.typeOf(e),r);case 1:var u=e._3,a=e._2,t=e._1,o=e._0;return N(oe(n,t),function(f){var S=gn(f,n);return N(oe(S,u),function(p){var D=U(p,f),X=A(D,Cn([Xn.typeOf(t),Xn.typeOf(u)],o)),M=Zt(es(a));return Y(on(X,M),function(y){return U(y,D)})})});case 2:var i=e._2,c=e._1,_=e._0,v=Xn.typeOf(i);return N(oe(n,i),function(f){var S=A(f,Cn([v],_)),p=Zt(ts(c));return Y(on(S,p),function(D){return U(D,f)})});case 3:var E=e._0.contents,b=On.get(n,E.name);if(b!==void 0)return on(E.ty,Zt(b));var V=Jn(E.name);if(V===void 0)return{TAG:1,_0:'unbound variable: "'+E.name+'"'};var G={TAG:2,_0:{TAG:1,_0:Pn.fromArray(s(V.staticFuncs,function(f){var S=f.name;return[S.contents.name,S.contents.ty]}),Se())}};return on(E.ty,G);case 4:var O=e._1,tn=e._0,Tn=sn.typeOfExpr(tn),$n=sn.typeOfExpr(O);return N(oe(n,O),function(f){var S=gn(f,n),p=A(f,Tn);return N(mn(S,tn,p),function(D){var X=U(D,f),M=A(D,p),y=A(X,$n);return Y(on(M,y),function(J){return U(J,X)})})});case 5:return Y(no(n,e._1,e._2,e._0,void 0),function(f){return f[0]});case 6:var Sn=e._4,kn=e._3,Dn=e._0,pn=e._2.contents,hn=Xn.typeOf(kn);return N(oe(n,kn),function(f){var S=gn(f,n),p=A(f,hn),D=A(f,Dn),X=Gr(On.remove(S,pn.name),p),M=On.add(S,pn.name,X);return N(mn(M,Sn,D),function(y){var J=U(y,f);return Y(on(A(J,hn),A(J,pn.ty)),function(qn){return U(qn,J)})})});case 7:var an=e._4,L=e._3,zn=e._2,bn=e._0,Nn=e._1.contents,rn=Xn.typeOf(L);Be(ft,rn);var Fn=Cn(s(zn,function(f){return f.contents.ty}),rn),Ln=An(zn,n,function(f,S){return On.addMono(f,S.contents.name,S.contents.ty)}),ie=On.addMono(Ln,Nn.name,Fn);return N(mn(ie,L,rn),function(f){var S=gn(f,ie),p=A(f,Fn),D=A(f,bn),X=On.add(S,Nn.name,Gr(S,p));return N(mn(X,an,D),function(M){var y=U(M,f);return Y(on(Nn.ty,A(M,p)),function(J){return gt(ft),U(J,y)})})});case 8:var Yn=e._2,Hn=s(Yn,Xn.typeOf),Xe=Cn(Hn,e._0);return Y(N(mn(n,e._1,Xe),function(f){return An(Ve(Yn,Hn),{TAG:0,_0:[f,gn(f,n)]},function(S,p){var D=p[1],X=p[0];return N(S,function(M){var y=M[1],J=M[0],qn=A(J,D);return Y(mn(y,X,qn),function(he){return[U(he,J),gn(he,y)]})})})}),function(f){return f[0]});case 9:var ce=e._2,_e=e._0;return N(An(e._1,{TAG:0,_0:[void 0,n]},function(f,S){return N(f,function(p){var D=p[1],X=p[0];return Y(rs(D,S),function(M){return[U(M,X),gn(M,D)]})})}),function(f){var S=f[0];return ce!==void 0?N(oe(gn(S,n),ce),function(p){var D=Xn.typeOf(ce),X=U(p,S);return Y(on(A(X,_e),A(X,D)),function(M){return U(M,X)})}):Y(on(A(S,_e),Re),function(p){return U(p,S)})});case 10:var Te=e._3,Qn=e._2,In=e._0;return N(mn(n,e._1,Bn),function(f){var S=gn(f,n),p=A(f,In);return N(mn(S,Qn,p),function(D){var X=gn(D,S),M=A(D,p),y=U(D,f);return Y(mn(X,Te,M),function(J){return U(J,y)})})});case 11:var Ke=e._1,xt=Xn.typeOf(Ke);return N(oe(n,e._0),function(f){var S=A(f,xt),p=gn(f,n);return Y(mn(p,Ke,S),function(D){return U(D,f)})});case 12:var Ye=Ne(ft);return Ye!==void 0?mn(n,Gn(e._0,{TAG:0,_0:0},function(f){return f}),Ye):{TAG:1,_0:"'return' used outside of a function"};case 13:return mn(n,e._0,e._1);case 14:var Dt=An(e._0,{TAG:0,_0:[Pe,n]},function(f,S){return N(f,function(p){var D=p[1],X=p[0];return N(oe(D,S),function(M){var y=U(M,X),J=gn(M,D);return{TAG:0,_0:[y,J]}})})});return Y(Dt,function(f){return f[0]});case 15:var st=e._1,Me=e._0,He=Jn(Me);if(He===void 0)return{TAG:1,_0:'undeclared struct "'+Me+'"'};var Qe=He.attributes,Nt=An(Lt(Qe,function(f){return Ee(f.impl)}),{TAG:0,_0:[n,Pe]},function(f,S){var p=S.ty,D=S.name;return N(f,function(X){var M=X[1],y=X[0],J=Ct(st,function(qn){return qn[0]===D});return J!==void 0?N(mn(y,J[1],p),function(qn){var he=gn(qn,y),De=U(qn,M);return{TAG:0,_0:[he,De]}}):{TAG:1,_0:'missing attribute "'+D+'" for struct "'+Me+'"'}})}),lt=me.firstSomeBy(st,function(f){var S=f[0];if(!ir(Qe,function(p){return p.name===S}))return S});return lt!==void 0?{TAG:1,_0:'extraneous attribute: "'+lt+'" for struct "'+Me+'"'}:Y(Nt,function(f){return f[1]});case 16:var Ue=e._1,nr=e._0,Ie=wt(),C;if(Ue.TAG===0)C=mn(n,Ue._0,Ie);else{var I=An(Ue._0,{TAG:0,_0:[Pe,n]},function(f,S){return N(f,function(p){var D=p[1],X=p[0];return N(mn(D,S,Ie),function(M){var y=U(M,X),J=gn(M,D);return{TAG:0,_0:[y,J]}})})});C=Y(I,function(f){return f[0]})}var Ft=d(sn.ArrayInit.len,Ue);return N(C,function(f){return Y(on(nr,Ta(Ie,Ft)),function(S){return U(S,f)})});case 17:var Ge=e._2,vt=e._1,ge=e._0;return N(oe(n,vt),function(f){var S=sn.typeOfExpr(vt),p=A(f,S),D=function(F){return au(p,A(F,S))?mn(gn(F,n),e,A(F,ge)):{TAG:0,_0:F}};switch(p.TAG|0){case 0:case 1:break;case 2:var X=p._0;if(X.TAG===0){var M=X._0,y=Jn(M);if(y===void 0)return{TAG:1,_0:'undeclared struct: "'+M+'"'};var J=Ct(y.attributes,function(F){return F.name===Ge});if(J===void 0)return{TAG:1,_0:'attribute "'+Ge+'" does not exist on struct "'+M+'"'};var qn=Gn(J.impl,J.ty,function(F){return F[0].contents.ty});return Y(on(A(f,ge),A(f,qn)),function(F){return U(F,f)})}var he=X._0,De=rr(Pn.toMap(he),Ge);if(De!==void 0)return Y(on(A(f,ge),A(f,De)),function(F){return U(F,f)});var ye=Pn.insert(he,Ge,ge),Oe=A(f,{TAG:2,_0:{TAG:1,_0:ye}}),xe=Fr(ye);if(typeof xe!="number")return xe.TAG===0?N(on(p,{TAG:2,_0:{TAG:0,_0:xe._0.name}}),function(F){return D(U(F,f))}):N(on(p,Oe),function(F){return D(U(F,f))});var dt=0;switch(S.TAG|0){case 0:return{TAG:0,_0:U(ru(Pe,S._0,Oe),f)};case 1:case 2:dt=2;break}if(dt===2)return Y(on(S,Oe),function(F){return U(F,f)});break}var Rt=Se(),B=Pn.insert(Pn.make({TAG:0,_0:Rt}),Ge,ge),_n=A(f,{TAG:2,_0:{TAG:1,_0:B}}),En=Fr(B);return typeof En=="number"?{TAG:1,_0:"no struct declaration matches type "+k(_n)}:En.TAG===0?N(on(p,{TAG:2,_0:{TAG:0,_0:En._0.name}}),function(F){return D(U(F,f))}):N(on(p,_n),function(F){return D(U(F,f))})})}}function rs(n,e){return oe(n,e._0)}function Rr(n,e){return n+"_"+e}function eo(n,e){switch(e.TAG|0){case 0:var r=e._0.contents;return Y(no(n,s(e._1,function(c){return c[0]}),e._2,r.ty,r.newName),function(c){var _=c[0];return[gn(_,On.addMono(n,r.name,r.ty)),_]});case 1:var u=e._0;return Y(mn(n,e._2,u.contents.ty),function(c){return[gn(c,On.addMono(n,u.contents.name,u.contents.ty)),c]});case 2:return{TAG:0,_0:[n,Pe]};case 3:var a=e._0,t=Jn(a);return t!==void 0?An(e._1,{TAG:0,_0:[n,Pe]},function(c,_){var v=_[2],E=_[1],b=_[0];return N(c,function(V){var G=V[1],O=V[0];b.contents.newName=Rr(a,b.contents.name);var tn=Gn(ze(E,0),[!1,!1],function(hn){return hn[0].contents.name==="self"?[!0,hn[1]]:[!1,!1]}),Tn;if(tn[0]){ut.addImplementation(t,b,tn[1]);var $n=Mn(E,[])?[]:Jo(E,1),Sn={TAG:2,_0:{TAG:0,_0:a}},kn=ze(E,0),Dn;if(kn!==void 0){var pn=kn[0];pn.contents.ty=Sn,Dn=On.addMono(O,pn.contents.name,Sn)}else Dn=O;Tn=[Dn,$n]}else ut.addStaticFunc(t,b),Tn=[n,E];return N(eo(Tn[0],{TAG:0,_0:b,_1:Tn[1],_2:v}),function(hn){var an=U(hn[1],G);Sa(an,b);var L=On.remove(hn[0],b.contents.name);return{TAG:0,_0:[L,an]}})})}):{TAG:1,_0:'cannot implement for unknown type "'+a+'"'};case 4:var o=e.name,i=Cn(s(e.args,function(c){return c[0].contents.ty}),e.ret);return Y(on(o.contents.ty,i),function(c){return[gn(c,On.addMono(n,o.contents.name,o.contents.ty)),c]})}}function to(n){return Wo(ft),An(n,{TAG:0,_0:[On.empty,Pe]},function(e,r){return N(e,function(u){var a=u[1];return Y(eo(u[0],r),function(t){return[t[0],U(t[1],a)]})})})}var be=wn("CompilerExn.InvalidTypeConversion"),$r=wn("CompilerExn.InvalidFunctionSignature"),Yt=wn("CompilerExn.VariableNotFound"),ro=wn("CompilerExn.EmptyFunctionStack"),We=wn("CompilerExn.CannotReassignImmutableValue"),uo=wn("CompilerExn.FunctionNotFound"),Ce=wn("CompilerExn.Unimplemented"),us=wn("CompilerExn.UnsupportedGlobalInitializer"),dn=wn("CompilerExn.InvalidTypeAssertion"),ao=wn("CompilerExn.DerefUsedOutsideOfUnsafeBlock"),Lr=wn("CompilerExn.UndeclaredStruct"),Ht=wn("CompilerExn.InvalidAttributeAccess"),Cr=wn("CompilerExn.StructTypeNotMatched"),oo=wn("CompilerExn.AmibguousStruct");function kt(n){return n.RE_EXN_ID===be?"unsupported type: "+k(n._1):n.RE_EXN_ID===$r?"invalid function signature: "+k(n._1):n.RE_EXN_ID===Yt?'variable "'+n._1+'" not found':n.RE_EXN_ID===ro?"Function stack is empty":n.RE_EXN_ID===We?'cannot mutate "'+n._1+'" as it is behind an immutable binding':n.RE_EXN_ID===uo?'no function named "'+n._1+'" found':n.RE_EXN_ID===Ce?"unimplemented: "+n._1:n.RE_EXN_ID===us?"unsupported global initializer: "+Xn.show(void 0,n._1):n.RE_EXN_ID===dn?"invalid type assertion from "+k(n._1)+" to "+k(n._2):n.RE_EXN_ID===ao?"the deref operator can only be used in an unsafe block":n.RE_EXN_ID===te.UnkownTypeSize?"unknown type size: "+k(n._1):n.RE_EXN_ID===Lr?'undeclared struct "'+n._1+'"':n.RE_EXN_ID===Ht?n._1+' does not exist for type "'+k(n._2)+'"':n.RE_EXN_ID===Cr?"No struct declaration matches type "+k(n._1):n.RE_EXN_ID===oo?xf(n._1,n._2):n.RE_EXN_ID===sn.UndeclaredIdentifer?'identifier "'+n._1+'" not found':n.RE_EXN_ID===sn.UnexpectedDeclarationInImplBlock?"unexpected declaration in impl block: "+$e.show(void 0,n._1):n.RE_EXN_ID===sn.UnreachableLetStmt?"unreachable: let statement found in Core.fromStmt":"unexpected compiler exception"}function as(n,e,r,u){return{name:n,depth:e,ty:r,isMutable:u}}function Xr(n){if(n.TAG===0){var e=n._0,r=Jn(e);if(r!==void 0)return r;throw{RE_EXN_ID:Lr,_1:e,Error:new Error}}var u=n._0,a=Fr(u);if(typeof a=="number")throw{RE_EXN_ID:Cr,_1:{TAG:2,_0:n},Error:new Error};if(a.TAG===0)return a._0;throw{RE_EXN_ID:oo,_1:u,_2:a._0,Error:new Error}}function Je(n){switch(n.TAG|0){case 0:throw{RE_EXN_ID:be,_1:n,Error:new Error};case 1:switch(n._0){case"()":if(n._1.length!==0)throw{RE_EXN_ID:be,_1:n,Error:new Error};return[];case"Array":var e=n._1;if(e.length!==2)throw{RE_EXN_ID:be,_1:n,Error:new Error};var r=e[1];switch(r.TAG|0){case 1:if(r._1.length!==0)throw{RE_EXN_ID:be,_1:n,Error:new Error};return[0];case 0:case 2:throw{RE_EXN_ID:be,_1:n,Error:new Error}}case"Fun":case"Ptr":return[0];case"Tuple":return cn(s(n._1,Je));case"bool":case"u32":break;case"u64":if(n._1.length!==0)throw{RE_EXN_ID:be,_1:n,Error:new Error};return[1];default:throw{RE_EXN_ID:be,_1:n,Error:new Error}}if(n._1.length!==0)throw{RE_EXN_ID:be,_1:n,Error:new Error};return[0];case 2:var u=Xr(n._0);return u.size===0?[]:[0]}}function os(n,e){switch(e.TAG|0){case 1:if(e._0==="Tuple"){var r=cn(s(e._1,Je)),u=[],a={_0:u,_1:r},t=jn.getOrAddSignature(n,a);return{TAG:1,_0:t,_1:[[],r]}}break}var o=Je(e),i=o.length;if(i!==1){if(i===0)return 0;throw{RE_EXN_ID:Ce,_1:"wasmBlockReturnTypeOf for "+k(e),Error:new Error}}var c=o[0];return{TAG:0,_0:c}}function Mr(n){switch(n.TAG|0){case 1:if(n._0==="Fun"){var e=n._1,r=e.slice(0,e.length-1|0),u=ze(e,e.length-1|0);return ou(Et.Signature.make,cn(s(r,Je)),Gn(u,[],Je))}throw{RE_EXN_ID:$r,_1:n,Error:new Error};case 0:case 2:throw{RE_EXN_ID:$r,_1:n,Error:new Error}}}function Ur(n,e,r){return{name:n,locals:[],params:Lt(e,function(u){return!te.isZeroSizedType(u[1])}),ret:r,instructions:[]}}function h(n,e){n.instructions.push(e)}function is(n,e,r,u,a){return n.locals.push(as(e,u,r,a)),(n.params.length+n.locals.length|0)-1|0}function cs(n,e){var r=tr(n.params,function(t){return t[0]===e});if(r!==void 0){var u=Ae(n.params,r);return[r,u[2]]}var a=me.getReverseIndexBy(n.locals,function(t){return t.name===e});if(a!==void 0)return[n.params.length+a|0,Ae(n.locals,a).isMutable]}function _s(n){var e=Mr(Cn(s(n.params,function(a){return a[1]}),n.ret)),r=d(Et.Local.fromTypes,cn(s(n.locals,function(a){return s(Je(a.ty),function(t){return[a.name,t]})}))),u=ou(Et.Body.make,r,yf(void 0,n.instructions));return Et.make(n.name,e,u)}function io(n,e,r,u,a){return{name:n,mutability:e,ty:r,index:u,init:a}}function fs(n){var e=n.init,r=n.mutability;return K(n.ty,function(u){return At.make(r!==2,u,e)})}function g(n){var e=Ne(n.funcStack);if(e!==void 0)return e;throw{RE_EXN_ID:ro,Error:new Error}}function Or(n,e){return K(me.getValueAndIndexBy(n.funcs,function(r){return r.name===e}),function(r){var u=n.externFuncs.length;return[r[0],u+r[1]|0]})}function ss(n,e){return me.getValueAndIndexBy(n.externFuncs,function(r){return r.name===e})}function zr(n){switch(n.TAG|0){case 0:return 0;case 1:switch(n._0){case"Array":var e=n._1;if(e.length!==2)return 0;var r=e[0],u=e[1];switch(u.TAG|0){case 1:return u._1.length!==0?0:Math.imul(tu(u._0),te.size(r));case 0:case 2:return 0}case"Tuple":return An(s(n._1,zr),0,function(i,c){return i+c|0});default:return 0}case 2:var a=n._0;if(a.TAG===0){var t=a._0,o=Jn(t);if(o!==void 0)return o.size;throw{RE_EXN_ID:Lr,_1:t,Error:new Error}}throw{RE_EXN_ID:Cr,_1:n,Error:new Error}}}function co(n,e){var r=Ne(n.blockStack);if(r!==void 0&&!(e<=0)){var u=r.shadowStackDelta;return u.contents=u.contents+e|0,h(g(n),{TAG:9,_0:n.stackTop.index}),h(g(n),{TAG:0,_0:e}),h(g(n),5),h(g(n),{TAG:10,_0:n.stackTop.index})}}function ls(n,e){var r=Ne(n.blockStack);if(r!==void 0&&!(e<=0)){var u=r.shadowStackDelta;return u.contents=u.contents-e|0,h(g(n),{TAG:9,_0:n.stackTop.index}),h(g(n),{TAG:0,_0:e}),h(g(n),4),h(g(n),{TAG:10,_0:n.stackTop.index})}}function _o(n){var e=Ne(n.blockStack);return e!==void 0?e.isUnsafe:!1}function fo(n,e){return n.scopeDepth=n.scopeDepth+1|0,Be(n.blockStack,{isUnsafe:e||_o(n),shadowStackDelta:{contents:0}})}function vs(n){n.scopeDepth=n.scopeDepth-1|0,ls(n,Gn(Ne(n.blockStack),0,function(e){return e.shadowStackDelta.contents})),gt(n.blockStack)}function Vr(n,e,r,u){var a=g(n),t=is(a,e,r,n.scopeDepth,u);return h(g(n),{TAG:12,_0:t}),t}function so(n,e,r,u,a){var t=Qo(n.globals),o=io(e,r,u,t,a);return or(n.globals,e,o),t}function ds(n,e){var r=g(n);return K(cs(r,e),function(u){return{index:u[0],isMutable:u[1]}})}function Qt(n,e){var r=ds(n,e);return r!==void 0?{TAG:0,_0:r.index,_1:r.isMutable}:K(yr(n.globals,e),function(u){return{TAG:1,_0:u.index,_1:u.mutability===1}})}function Ts(n){if(typeof n!="number")return n.TAG===0?{TAG:0,_0:n._0}:{TAG:0,_0:n._0?1:0}}function lo(n){if(!_o(n))throw{RE_EXN_ID:ao,Error:new Error}}function It(n,e,r){switch(e.TAG|0){case 0:case 1:return{TAG:1,_0:{RE_EXN_ID:Ht,_1:r,_2:e}};case 2:var u=Xr(e._0),a=Ct(u.attributes,function(i){return i.name===r});if(a===void 0)return{TAG:1,_0:{RE_EXN_ID:Ht,_1:r,_2:e}};var t=a.impl;if(t===void 0)return{TAG:0,_0:{TAG:0,_0:{offset:a.offset,ty:a.ty,size:a.size,mut:a.mut}}};var o=Or(n,Rr(u.name,t[0].contents.name));return o!==void 0?{TAG:0,_0:{TAG:1,_0:[o[0],o[1],t[1]]}}:{TAG:1,_0:{RE_EXN_ID:Ht,_1:r,_2:e}}}}function vo(n){return re(void 0,"$lambda"+String(n.funcs.length))}function To(n,e){var r=n!==void 0?n:"",u=g(e);return"$"+r+"_local"+String(u.locals.length)}function yt(n,e){for(;;){var r=e;switch(r.TAG|0){case 3:var u=r._0,a=Qt(n,u.contents.newName);if(a!==void 0)return a._1?void 0:u.contents.name;throw{RE_EXN_ID:Yt,_1:u.contents.name,Error:new Error};case 17:var t=r._2,o=r._1,i=It(n,sn.typeOfExpr(o),t);if(i.TAG===0){var c=i._0;if(c.TAG!==0)return;if(!c._0.mut)return t;e=o;continue}throw i._0;default:return}}}function nn(n,e){for(;;){var r=e;switch(r.TAG|0){case 0:var u=Ts(r._0);return u!==void 0?h(g(n),u):void 0;case 1:var a=r._3,t=r._2,o=r._1;if(te.isZeroSizedType(sn.typeOfExpr(o))){e={TAG:0,_0:{TAG:1,_0:t===9}};continue}var i=function(B,_n){return function(F){return nn(n,B),nn(n,_n),h(g(n),F)}}(o,a);switch(t){case 0:return i(4);case 1:return i(5);case 2:return i(6);case 3:return i(7);case 4:return i(43);case 5:return i(31);case 6:return i(19);case 7:return i(37);case 8:return i(25);case 9:return i(10);case 10:return i(14);case 11:e={TAG:10,_0:Bn,_1:o,_2:a,_3:{TAG:0,_0:{TAG:1,_0:!1}}};continue;case 12:e={TAG:10,_0:Bn,_1:o,_2:{TAG:0,_0:{TAG:1,_0:!0}},_3:a};continue;case 13:return i(44);case 14:return i(45);case 15:return i(46);case 16:return i(48)}case 2:var c;switch(r._1){case 0:throw{RE_EXN_ID:Ce,_1:"u32 negation is not handled",Error:new Error};case 1:c=9;break;case 2:lo(n),c={TAG:16,_0:0,_1:0};break}return nn(n,r._2),h(g(n),c);case 3:var _=r._0;if(te.isZeroSizedType(_.contents.ty))return;var v=Qt(n,_.contents.newName);if(v!==void 0)return v.TAG===0?h(g(n),{TAG:11,_0:v._0}):h(g(n),{TAG:9,_0:v._0});throw{RE_EXN_ID:Yt,_1:_.contents.name,Error:new Error};case 4:var E=r._1,b=r._0;if(te.isZeroSizedType(sn.typeOfExpr(E)))return;switch(b.TAG|0){case 2:if(b._1>=2){lo(n),nn(n,b._2),nn(n,E);var V=te.sizeLog2(sn.typeOfExpr(E)),G={TAG:17,_0:V,_1:0};return h(g(n),G)}throw{RE_EXN_ID:Ce,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error};case 3:var O=b._0,tn=Qt(n,O.contents.newName);if(tn!==void 0){if(tn._1){var Tn;return Tn=tn.TAG===0?{TAG:12,_0:tn._0}:{TAG:10,_0:tn._0},nn(n,E),h(g(n),Tn)}throw{RE_EXN_ID:We,_1:O.contents.name,Error:new Error}}throw{RE_EXN_ID:Yt,_1:O.contents.name,Error:new Error};case 17:var $n=b._2,Sn=b._1,kn=It(n,sn.typeOfExpr(Sn),$n);if(kn.TAG===0){var Dn=kn._0;if(Dn.TAG===0){var pn=Dn._0;if(!pn.mut)throw{RE_EXN_ID:We,_1:$n,Error:new Error};var hn=yt(n,Sn);if(hn!==void 0)throw{RE_EXN_ID:We,_1:hn,Error:new Error};return pn.size>0?(nn(n,Sn),nn(n,E),h(g(n),{TAG:17,_0:0,_1:pn.offset})):void 0}throw{RE_EXN_ID:Ce,_1:"cannot reassign "+$n+" for type "+k(sn.typeOfExpr(Sn)),Error:new Error}}throw kn._0;default:throw{RE_EXN_ID:Ce,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error}}case 5:var an=vo(n),L=Br(n,an,s(r._1,function(B){return[B,!1]}),r._2);return h(g(n),{TAG:0,_0:L});case 6:var zn=r._3,bn=r._2.contents;te.isZeroSizedType(sn.typeOfExpr(zn))||(nn(n,zn),Vr(n,bn.name,bn.ty,r._1)),e=r._4;continue;case 7:var Nn=vo(n);r._1.contents.newName=Nn.contents.name,Br(n,Nn,s(r._2,function(B){return[B,!1]}),r._3),e=r._4;continue;case 8:var rn=r._2,Fn=r._1,Ln=function(B){return function(En){return Rn(B,function(F){return nn(n,F)}),h(g(n),{TAG:14,_0:En})}}(rn),ie=function(B,_n){return function(F){Rn(_n,function(ho){return nn(n,ho)});var er=sn.typeOfExpr(B),$t=Mr(er),Tt=jn.getOrAddSignature(n.mod,$t);return nn(n,B),h(g(n),{TAG:15,_0:Tt,_1:0})}}(Fn,rn),Yn=function(B){return function(En,F){var er=F!==void 0?un([F],B):B;return Rn(Ve(er,En),function($t){var Tt=$t[1];if(!!(Tt[2]&&vr(Tt[1])&&Mt(yt(n,$t[0]))))throw{RE_EXN_ID:We,_1:Tt[0],Error:new Error}})}}(rn);switch(Fn.TAG|0){case 3:var Hn=Fn._0,Xe=Qt(n,Hn.contents.newName);if(Xe!==void 0)return ie(void 0);var ce=Or(n,Hn.contents.newName);if(ce!==void 0)return Yn(ce[0].params,void 0),Ln(ce[1]);var _e=ss(n,Hn.contents.newName);if(_e!==void 0)return Yn(_e[0].args,void 0),Ln(_e[1]);throw{RE_EXN_ID:uo,_1:Hn.contents.name,Error:new Error};case 17:var Te=Fn._2,Qn=Fn._1,In;if(Qn.TAG===3){var Ke=Qn._0.contents.name,xt=Jn(Ke);if(xt!==void 0){var Ye=Or(n,Rr(Ke,Te));if(Ye!==void 0)In=[!1,Ye[0],Ye[1]];else throw{RE_EXN_ID:Ce,_1:'static function "'+Te+'" does not exists on struct '+Ke,Error:new Error}}else In=[!0,void 0,void 0]}else In=[!0,void 0,void 0];var Dt=In[2],st=In[1],Me=In[0],He;if(st!==void 0)He=st;else{var Qe=It(n,sn.typeOfExpr(Qn),Te);if(Qe.TAG===0){var Nt=Qe._0;He=Nt.TAG===0?void 0:Nt._0[0]}else throw Qe._0}return Gn(He,void 0,function(B,_n){return function(En){var F=_n?B:void 0;return Yn(En.params,F)}}(Qn,Me)),Me&&nn(n,Qn),Dt!==void 0?Ln(Dt):ie(void 0);default:return ie(void 0)}case 9:var lt=r._2;return fo(n,r._3===1),Rn(r._1,function(B){return Gs(n,B)}),lt!==void 0&&nn(n,lt),vs(n);case 10:var Ue=r._3,nr=os(n.mod,r._0);return nn(n,r._1),h(g(n),{TAG:4,_0:nr}),nn(n,r._2),au(Ue,{TAG:0,_0:0})&&(h(g(n),0),nn(n,Ue)),h(g(n),1);case 11:return h(g(n),{TAG:7,_0:0}),h(g(n),{TAG:8,_0:0}),nn(n,r._0),h(g(n),9),h(g(n),{TAG:5,_0:1}),nn(n,r._1),h(g(n),{TAG:6,_0:0}),h(g(n),1),h(g(n),1);case 12:var Ie=r._0;return Ie!==void 0&&nn(n,Ie),h(g(n),2);case 13:var C=r._2,I=r._1;if(!Mn(I,C))switch(I.TAG|0){case 1:switch(I._0){case"Array":switch(C.TAG|0){case 1:if(C._0==="Ptr"){var Ft=C._1;if(Ft.length!==1)throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error};var Ge=Ft[0];switch(Ge.TAG|0){case 1:if(Ge._0==="u32"){if(Ge._1.length!==0)throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error}}else throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error}}}else throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error}}break;case"Ptr":var vt=I._1;if(vt.length!==1)throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error};var ge=vt[0];switch(ge.TAG|0){case 1:if(ge._0==="u32"){if(ge._1.length!==0)throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error};switch(C.TAG|0){case 1:if(C._0==="u32"){if(C._1.length!==0)throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error}}else throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error}}}else throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error}}break;case"u32":if(I._1.length!==0)throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error};switch(C.TAG|0){case 1:if(C._0==="Ptr"){if(C._1.length!==1)throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error}}else throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error}}break;default:throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error}}break;case 0:case 2:throw{RE_EXN_ID:dn,_1:I,_2:C,Error:new Error}}e=r._0;continue;case 14:return Rn(r._0,function(B){return nn(n,B)});case 15:var f=r._1,S=eu(Jn(r._0)),p=S.size;co(n,p),Rn(Ve(S.attributes,f),function(B){var _n=B[0],En=_n.ty;if(_n.mut&&vr(En)){var F=yt(n,B[1][1]);if(F!==void 0)throw{RE_EXN_ID:We,_1:F,Error:new Error}}if(Ee(_n.impl)&&te.size(En)>0)return h(g(n),{TAG:9,_0:n.stackTop.index})}),p>0&&h(g(n),{TAG:9,_0:n.stackTop.index});var D={contents:0};return Rn(f,function(B){return function(_n){var En=Pr(n,_n[1],B.contents);B.contents=B.contents+En|0}}(D));case 16:var X=r._1,M=zr(r._0);co(n,M),h(g(n),{TAG:9,_0:n.stackTop.index});var y=Vr(n,To("arrayAddr",n),Zn,!0);if(X.TAG===0){h(g(n),{TAG:0,_0:0});var J=Vr(n,To("addr",n),Zn,!0);h(g(n),{TAG:7,_0:0}),h(g(n),{TAG:8,_0:0}),h(g(n),{TAG:11,_0:J}),h(g(n),{TAG:0,_0:M}),h(g(n),10),h(g(n),{TAG:5,_0:1}),h(g(n),{TAG:11,_0:y}),h(g(n),{TAG:11,_0:J}),h(g(n),4);var qn=Pr(n,X._0,0);h(g(n),{TAG:11,_0:J}),h(g(n),{TAG:0,_0:qn}),h(g(n),4),h(g(n),{TAG:12,_0:J}),h(g(n),{TAG:6,_0:0}),h(g(n),1),h(g(n),1)}else{var he={contents:0};Rn(X._0,function(B,_n){return function(En){h(g(n),{TAG:11,_0:B});var F=Pr(n,En,_n.contents);_n.contents=_n.contents+F|0}}(y,he))}return h(g(n),{TAG:11,_0:y});case 17:var De=r._1,ye=It(n,sn.typeOfExpr(De),r._2);if(ye.TAG===0){var Oe=ye._0;if(Oe.TAG===0){var xe=Oe._0;return te.isZeroSizedType(xe.ty)?void 0:(nn(n,De),h(g(n),{TAG:16,_0:0,_1:xe.offset}))}var dt=Oe._0;if(dt[2]){var Rt=yt(n,De);if(Rt!==void 0)throw{RE_EXN_ID:We,_1:Rt,Error:new Error}}return h(g(n),{TAG:0,_0:dt[1]})}throw ye._0}}}function Gs(n,e){var r=e._0;return nn(n,r),Rn(Je(Xn.typeOf(r)),function(u){return h(g(n),3)})}function Br(n,e,r,u){var a=s(r,function(i){var c=i[0];return[c.contents.name,c.contents.ty,i[1]||!vr(c.contents.ty)]}),t=Ur(e.contents.newName,a,Xn.typeOf(u)),o=n.funcs.push(t)-1|0;return Be(n.funcStack,t),nn(n,u),h(g(n),1),gt(n.funcStack),o}function gs(n,e){var r=Ur("__isolated__",[],sn.typeOfExpr(e));return Be(n.funcStack,r),nn(n,e),gt(n.funcStack),r}function Go(n,e){switch(e.TAG|0){case 0:Br(n,e._0,e._1,e._2);return;case 1:var r=e._1,u=e._0;fo(n,!1);var a=gs(n,e._2),t=a.instructions;if(t.length===1){var o=t[0];if(typeof o!="number"&&o.TAG===0){so(n,u.contents.name,r?1:2,0,d(At.Initializer.fromInstructions,[{TAG:0,_0:o._0}]));return}}Yo(n.globalsInitializer.instructions,"push",[t]);var i=so(n,u.contents.name,r?1:0,0,d(At.Initializer.fromInstructions,[{TAG:0,_0:0}]));n.globalsInitializer.instructions.push({TAG:10,_0:i});return;case 2:return;case 3:return Rn(e._1,function(E){return Go(n,{TAG:0,_0:E[0],_1:E[1],_2:E[2]})});case 4:var c=e.name,_=Mr(c.contents.ty),v=jn.getOrAddSignature(n.mod,_);jn.addImport(n.mod,yu.make("index",c.contents.name,{_0:v})),n.externFuncs.push({name:c.contents.name,args:s(e.args,function(E){var b=E[0];return[b.contents.name,b.contents.ty,E[1]]}),ret:e.ret});return}}function Pr(n,e,r){var u=function(o){return nn(n,e),h(g(n),{TAG:17,_0:0,_1:r}),o},a=Xn.typeOf(e);switch(a.TAG|0){case 0:break;case 1:var t=0;switch(a._0){case"()":if(a._1.length===0)return 0;break;case"Fun":return u(4);case"Ptr":if(a._1.length===1)return u(4);break;case"bool":case"u32":t=2;break}if(t===2&&a._1.length===0)return u(4);break;case 2:return Xr(a._0),u(4)}throw{RE_EXN_ID:Ce,_1:"cannot store "+k(a)+" in the shadow stack",Error:new Error}}function hs(n){var e=Ut(),r=function(i){return Be(e,{contents:0})},u=function(i){switch(i.TAG|0){case 15:case 16:break;default:return}var c=zr(sn.typeOfExpr(i)),_=Ne(e);_.contents=_.contents+c|0},a=function(i){var c=Ne(e);return Be(e,{contents:-c.contents|0})};sn.visitProg(z(r),z(a),u,n);var t={contents:0},o={contents:0};return Ho(e,function(i){var c=i.contents;o.contents=o.contents+c|0,t.contents=t.contents>o.contents?t.contents:o.contents}),t.contents}function Es(n){var e=hs(n),r={mod:jn.make(void 0),funcs:[],scopeDepth:0,funcStack:Ut(),globals:Ir(1),globalsInitializer:Ur("__initGlobals__",[],Re),stackTop:io("__STACK_TOP__",1,0,0,d(At.Initializer.fromInstructions,[{TAG:0,_0:e}])),blockStack:Ut(),externFuncs:[],options:{useBulkMemoryInstructions:!1}};or(r.globals,r.stackTop.name,r.stackTop);try{Rn(n,function(i){return Go(r,i)}),jn.addMemory(r.mod,Zu.make(sr.make(64,void 0))),Rn(Ko(uu(r.globals),function(i,c){return i.index-c.index|0}),function(i){var c=fs(i);if(c!==void 0)return jn.addGlobal(r.mod,c)});var u=Xu.fromFuncRefs(0,Zr(r.funcs,function(i,c){return i}));jn.addElement(r.mod,u),jn.addTable(r.mod,Fu.make(0,sr.makeExact(r.funcs.length)));var a=r.funcs.length,t=r.globalsInitializer.instructions.length===0;return t||(r.globalsInitializer.instructions.push(1),r.funcs.push(r.globalsInitializer)),Rn(r.funcs,function(i){i.name==="main"&&!t&&i.instructions.unshift({TAG:14,_0:a});var c=_s(i);jn.addExportedFunc(r.mod,i.name,c[1],c[2])}),{TAG:0,_0:r.mod}}catch(i){var o=ht(i);return{TAG:1,_0:kt(o)}}}function As(n){try{return N(Kt(n),function(r){var u=s(r,$e.from);return N(to(u),function(a){var t=a[1];pa(t);var o=s(u,function(i){return $e.subst(t,i)});return Y(Es(o),function(i){var c=jn.encodeAsUint8Array(i);return[i,c]})})})}catch(r){var e=ht(r);return{TAG:1,_0:kt(e)}}}function ws(n){try{var e=Kt(n);return e.TAG===0?{TAG:0,_0:m(e._0,`

`,function(u){return l_.show(u)})}:{TAG:1,_0:e._0}}catch(u){var r=ht(u);return{TAG:1,_0:kt(r)}}}function ms(n){try{var e=Kt(n);if(e.TAG!==0)return{TAG:1,_0:e._0};var r=s(e._0,$e.from);return{TAG:0,_0:m(r,`

`,function(a){return $e.show(void 0,a)})}}catch(a){var u=ht(a);return{TAG:1,_0:kt(u)}}}function Ss(n){try{var e=Kt(n);if(e.TAG!==0)return{TAG:1,_0:e._0};var r=s(e._0,$e.from),u=to(r);if(u.TAG!==0)return{TAG:1,_0:u._0};var a=u._0[1];pa(a);var t=s(r,function(i){return $e.subst(a,i)});return{TAG:0,_0:m(t,`

`,function(i){return $e.show(void 0,i)})}}catch(i){var o=ht(i);return{TAG:1,_0:kt(o)}}}var ps={debugAst:ws,debugCoreAst:ms,debugTypes:Ss},bs=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",compile:As,Debug:ps});const qr={"0":"Else","1":"End","2":"Return","3":"Drop","4":"AddI32","5":"SubI32","6":"MulI32","7":"DivI32Unsigned","8":"DivI32Signed","9":"EqzI32","10":"EqI32","11":"EqI64","12":"EqF32","13":"EqF64","14":"NeI32","15":"NeI64","16":"NeF32","17":"NeF64","18":"LeI32Signed","19":"LeI32Unsigned","20":"LeI64Signed","21":"LeI64Unsigned","22":"LeF32","23":"LeF64","24":"GeI32Signed","25":"GeI32Unsigned","26":"GeI64Signed","27":"GeI64Unsigned","28":"GeF32","29":"GeF64","30":"LtI32Signed","31":"LtI32Unsigned","32":"LtI64Signed","33":"LtI64Unsigned","34":"LtF32","35":"LtF64","36":"GtI32Signed","37":"GtI32Unsigned","38":"GtI64Signed","39":"GtI64Unsigned","40":"GtF32","41":"GtF64","42":"RemI32Signed","43":"RemI32Unsigned","44":"AndI32","45":"OrI32","46":"ShlI32","47":"ShrI32Signed","48":"ShrI32Unsigned"},$={"0":"I32","1":"I64","2":"F32","3":"F64"},ks={"0":"FuncRef","1":"ExternRef"},Ds={"0":"Func","1":"Table","2":"Memory","3":"Global"},ke={"0":"Void"},Ns={"0":"Passive"},Fs=bs,go=function(n){const e=Fs.compile(n);return e.TAG===0?{tag:"Ok",value:[{typeSection:e._0[0].typeSection.map(function(u){return[u._0.map(function(t){return $[t]}),u._1.map(function(t){return $[t]})]}),importSection:e._0[0].importSection.map(function(u){return{moduleName:u.moduleName,entityName:u.entityName,desc:{tag:"Func",value:u.desc._0}}}),funcSection:e._0[0].funcSection,tableSection:e._0[0].tableSection.map(function(u){return[ks[u[0]],u[1]]}),memorySection:e._0[0].memorySection,globalSection:e._0[0].globalSection.map(function(u){return[$[u[0]],u[1],u[2].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:$[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return $[i]}),t._0._1[1].map(function(i){return $[i]})]]}:ke[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:$[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return $[i]}),t._0._1[1].map(function(i){return $[i]})]]}:ke[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:$[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return $[i]}),t._0._1[1].map(function(i){return $[i]})]]}:ke[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:t.TAG===17?{tag:"StoreI32",value:[t._0,t._1]}:t.TAG===18?{tag:"InitMemory",value:t._0}:{tag:"DropData",value:t._0}:qr[t]})]}),exportSection:e._0[0].exportSection.map(function(u){return{name:u.name,kind:Ds[u.kind],index:u.index}}),elementSection:e._0[0].elementSection,codeSection:e._0[0].codeSection.map(function(u){return[u[0].map(function(t){return[t[0],$[t[1]]]}),u[1].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:$[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return $[i]}),t._0._1[1].map(function(i){return $[i]})]]}:ke[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:$[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return $[i]}),t._0._1[1].map(function(i){return $[i]})]]}:ke[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:$[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return $[i]}),t._0._1[1].map(function(i){return $[i]})]]}:ke[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:t.TAG===17?{tag:"StoreI32",value:[t._0,t._1]}:t.TAG===18?{tag:"InitMemory",value:t._0}:{tag:"DropData",value:t._0}:qr[t]})]}),dataSection:e._0[0].dataSection.map(function(u){return{init:u.init,mode:typeof u.mode=="object"?[u.mode._0,u.mode._1]:Ns[u.mode]}}),funcs:e._0[0].funcs.map(function(u){return[u[0],[u[1]._0.map(function(t){return $[t]}),u[1]._1.map(function(t){return $[t]})],[u[2][0].map(function(t){return[t[0],$[t[1]]]}),u[2][1].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:$[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return $[i]}),t._0._1[1].map(function(i){return $[i]})]]}:ke[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:$[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return $[i]}),t._0._1[1].map(function(i){return $[i]})]]}:ke[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:$[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return $[i]}),t._0._1[1].map(function(i){return $[i]})]]}:ke[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:t.TAG===17?{tag:"StoreI32",value:[t._0,t._1]}:t.TAG===18?{tag:"InitMemory",value:t._0}:{tag:"DropData",value:t._0}:qr[t]})]]})},e._0[1]]}:{tag:"Error",value:e._0}};var Rs=`
let SIZEOF_U32 = 4;

struct Array {
  start: Ptr<u32>,
  mut length: u32,
}

impl Array {
  fn read(self, n) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>)
  }

  fn write(mut self, n, val) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>) = val;
  }

  fn push(mut self, val) {
    self.write(self.length, val);
    self.length += 1;
  }
}

struct Sieve {
  mut primes: Array,
  mut current: u32
}

impl Sieve {
  fn clear(mut self) {
    self.primes.length = 0;
    // 2 is the first prime
    self.primes.push(2);
    self.current = 1;
  }

  fn isPrime(mut self, n) {
    mut i = 0;
    mut p = self.primes.read(i);

    while p * p <= n {
      if n % p == 0 { return false; }
      i += 1;
      p = self.primes.read(i);
    }

    // n is prime
    // add it to the sieve
    self.primes.push(n);

    true
  }

  fn nextPrime(mut self) {
    self.current += 2;

    while !self.isPrime(self.current) {
      self.current += 2;
    }

    self.current
  }

  // count the prime numbers <= m
  fn countUpTo(mut self, m) {
    self.clear();

    while self.current <= m {
      self.nextPrime();
    }

    self.primes.length - 1
  }
}

fn main() {
  mut sieve = Sieve {
    primes: Array {
      start: [0; 10000] as Ptr<u32>,
      length: 0
    },
    current: 0
  };

  sieve.countUpTo(100000)
}
`,$s=`
fn fact(n) {
  if n == 0 { 1 } else { n * fact(n - 1) }
}

fn main() {
  fact(11)
}`,Ls=`
fn fib(n) {
  let fib_aux = (n, a, b) -> {
    if n == 0 { return a; }
    if n == 1 { return b; }
    fib_aux(n - 1, b, a + b)
  };

  fib_aux(n, 0, 1)
}

fn main() {
  fib(83)
}`,Cs=`
let SIZEOF_U32 = 4;

fn read_u32(addr) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>)
}

fn write_u32(addr, val) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>) = val;
}

fn main() {
  let square = n -> n * n;

  mut i = 0;
  while i < 100 {
    write_u32(i, square(i));
    i += 1;
  }

  read_u32(42) // 1764
}`,Xs=`
fn isEven(n) {
  n & 1 == 0
}

fn isPrime(n) {
  if n < 2 { return false; }
  if n == 2 { return true; }
  if isEven(n) { return false; }

  mut i = 3;

  while i * i <= n {
    if n % i == 0 { return false; }
    i += 2;
  }

  true
}

fn countPrimesLessThan(m) {
  mut i = m;
  mut count = 0;

  while i > 1 {
    if isPrime(i) {
      count += 1;
    }

    i -= 1;
  }

  count
}

fn main() {
  countPrimesLessThan(1000000)
}`,Ms=`
struct MinMax {
  mut min: u32,
  mut max: u32
}

impl MinMax {
  fn reset(mut self) {
    self.min = 0;
    self.max = 0;
  }

  fn resetStatic(mut m) {
    m.reset();
  }
}

fn main() {
  mut m = MinMax {
    min: 17,
    max: 22
  };

  MinMax.resetStatic(m);
  
  m.min + m.max == 0
}`,Us=`
fn main() {
  let twice = (f, x) -> f(f(x));
  
  twice(n -> n * n, 7)
}`,Os=`
struct BumpAllocator {
  mut head: u32
}

impl BumpAllocator {
  fn allocate(mut self, bytes) {
    let addr = self.head as Ptr<u32>;
    self.head = self.head + bytes;
    addr
  }
  
  // do nothing!
  fn free(mut self, addr) { }
}

mut allocator = BumpAllocator { head: 64 * 1024 };

let SIZEOF_U32 = 4;

struct Vec {
  mut start: Ptr<u32>,
  mut length: u32,
  mut capacity: u32 
}

impl Vec {
  fn read(self, index) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>)
  }

  fn write(mut self, index, value) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>) = value;
  }

  fn grow(mut self) unsafe {
    let newCap = if self.capacity == 0 { 8 } else { self.capacity * 2 };
    let newStart = allocator.allocate(newCap * SIZEOF_U32);

    // copy the data from the old array to the new one
    mut i = 0;
    while i < self.length {
      *(((newStart as u32) + (i * SIZEOF_U32)) as Ptr<u32>) = self.read(i);
      i += 1;
    }

    allocator.free(self.start);
    self.start = newStart;
    self.capacity = newCap;
  }

  fn push(mut self, val) {
    if self.length + 1 > self.capacity {
      self.grow();
    }

    self.write(self.length, val);
    self.length += 1;
  }

  fn pop(mut self) {
    if self.length > 0 {
      self.length -= 1;
      self.read(self.length)
    } else {
      // until we have Option<T>
      4294967295 // -1
    }
  }
}

fn main() {
  mut vec = Vec {
    start: 0 as Ptr<u32>,
    length: 0,
    capacity: 0
  };

  mut i = 0;
  while i < 1000 {
    vec.push(i);
    i += 1;
  }

  (vec.length, vec.capacity, vec.read(723))
}`,zs=`
fn isEven(n) {
  n & 1 == 0
}

fn nextCollatz(n) {
  if isEven(n) { n / 2 } else { 3 * n + 1 }
}

fn collatzLen(n) {
  mut len = 1;
  
  while n != 1 {
    n = nextCollatz(n); 
    len += 1;
  }
  
  len
}

fn pb14() {
  mut longest = 0;
  mut longestIndex = 0;

  mut i = 1;
  while i <= 1000000 {
    let len = collatzLen(i);
    if len > longest {
      longest = len;
      longestIndex = i;
    }

    i += 1;
  }
  
  (longest, longestIndex)
}

fn main() {
  pb14()
}`,Vs=`
fn digitsSquareSum(n) {
  let square = n -> n * n;
  mut sum = 0;

  while n > 0 {
    sum += square(n % 10);
    n /= 10;
  }

  sum
}

fn reaches89(n) {
  while n != 1 {
    if n == 89 { return true; }
    n = digitsSquareSum(n);
  }

  false
}

fn main() {
  mut i = 1;
  mut count = 0;
  while i < 10000000 {
    if reaches89(i) {
      count += 1;
    }

    i += 1;
  }

  count
}`,Bs=`
extern fn log(n: u32) -> ();
extern fn expectEqual(value: u32, expected: u32) -> ();

fn main() {
  mut i = 0;
  
  while i <= 10 {
    expectEqual(i, i);
    i += 1;
  }
}`;const Ps={"Prime sieve":Rs,Factorial:$s,Fibonacci:Ls,Pointers:Cs,Primes:Xs,Structs:Ms,"Lambda (kind of)":Us,Vector:Os,"External functions":Bs,"Project Euler 14":zs,"Project Euler 92":Vs},qs=async n=>{const e=await WebAssembly.compile(n),r=await WebAssembly.instantiate(e,{index:{log:console.log,expectEqual:(u,a)=>{if(u!==a)throw new Error(`[expectEqual] expected ${u}, got: ${a}`)}}});if("main"in r.exports){console.time("run");const u=r.exports.main();return console.timeEnd("run"),u}else return"Error: main function not found, exported functions are: "+Object.keys(r.exports).join(", ")},js={Run:async(n,e)=>{e("running...");try{const r=go(n);if(r.tag==="Ok"){const u=await qs(r.value[1]);e(`${u}`)}else e(r.value)}catch(r){e(`${r}`)}},Disassemble:(n,e)=>{try{const r=go(n);if(r.tag==="Ok"){const[u]=r.value;e(Lc(u))}else e(r.value)}catch(r){e(`${r}`)}}},Zs=()=>Ot.createElement(Io,{actions:js,samples:Ps,aceMode:"rust"});yo.render(Ot.createElement(Ot.StrictMode,null,Ot.createElement(Zs,null)),document.getElementById("root"));
