import{c as un,a as cn,j as m,r as Do,m as Tn,g as Ve,b as ur,d as s,z as Be,k as Ct,e as Qr,f as Et,t as tt,h as No,i as Ir,l as Un,n as yr,o as ge,_ as d,p as he,s as N,v as On,q as K,u as xr,w as Fo,x as Ro,y as ar,A as nu,B as eu,C as hn,D as or,E as En,F as $o,G as Lo,H as tu,I as ir,J as Xo,K as Co,L as Mo,M as rt,N as Uo,O as Oo,P as zo,Q as Vo,R as ru,S as Fn,T as Bo,U as uu,V as Po,W as cr,X as au,Y as qo,Z as xn,$ as jo,a0 as Zo,a1 as le,a2 as ou,a3 as Mt,a4 as iu,a5 as _r,a6 as cu,a7 as Wo,a8 as Ut,a9 as Jo,aa as Ko,ab as Yo,ac as F,ad as Ho,ae as Qo,af as _u,ag as Io,ah as fr,ai as yo,aj as fu,ak as xo,al as ni,am as I,an as ei,ao as At,ap as Ot,aq as pe,ar as be,as as su,at as ti,au as wt,av as lu,aw as ri,ax as ui,ay as ai,az as zt,aA as oi,aB as ii}from"./vendor.708cc860.js";const ci=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))u(a);new MutationObserver(a=>{for(const t of a)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const t={};return a.integrity&&(t.integrity=a.integrity),a.referrerpolicy&&(t.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?t.credentials="include":a.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function u(a){if(a.ep)return;a.ep=!0;const t=r(a);fetch(a.href,t)}};ci();function _n(n){var e=[],r=function(u){for(;;){var a=u,t=a&127,o=a>>>7;if(o!==0){e.push(t|128),u=o;continue}e.push(t);return}};return r(n),e}function Vt(n){var e=[],r=function(u){for(;;){var a=u,t=a&127,o=a>>7;if(o===0&&(t&64)==0||o===-1&&(t&64)!=0){e.push(t);return}e.push(t|128),u=o}};return r(n|0),e}function ke(n){return un(_n(n.length),n)}function Bn(n){return un(_n(n.length),cn(n))}var _i={encode:ke,encodeMany:Bn},fi=Vt,si={encode:fi},li=Vt,vi={encode:li};function vu(n){var e=new DataView(new ArrayBuffer(4));return e.setFloat32(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3)]}var di={encode:vu};function du(n){var e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,n,1),[e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3),e.getUint8(4),e.getUint8(5),e.getUint8(6),e.getUint8(7)]}var Ti={encode:du};function Gi(n){return n}function ne(n,e){return un([n],ke(e))}function ee(n){var e;switch(n){case 0:e="custom";break;case 1:e="type";break;case 2:e="import";break;case 3:e="function";break;case 4:e="table";break;case 5:e="memory";break;case 6:e="global";break;case 7:e="export";break;case 8:e="start";break;case 9:e="element";break;case 10:e="code";break;case 11:e="data";break}return"["+e+"]"}var gi={id:Gi,encode:ne,show:ee};function ut(n){switch(n){case 0:return 127;case 1:return 126;case 2:return 125;case 3:return 124}}function at(n){switch(n){case 0:return"i32";case 1:return"i64";case 2:return"f32";case 3:return"f64"}}var hi={encode:ut,show:at};function Tu(n){return typeof n=="number"?[64]:n.TAG===0?[ut(n._0)]:_n(n._0)}function Ei(n){return typeof n=="number"?"void":n.TAG===0?at(n._0):"type "+String(n._0)}var Ai={encode:Tu,show:Ei};function sr(n){if(typeof n=="number")switch(n){case 0:return[[5],"else"];case 1:return[[11],"end"];case 2:return[[15],"return"];case 3:return[[26],"drop"];case 4:return[[106],"i32.add"];case 5:return[[107],"i32.sub"];case 6:return[[108],"i32.mul"];case 7:return[[110],"i32.div_s"];case 8:return[[109],"i32.div_u"];case 9:return[[69],"i32.eqz"];case 10:return[[70],"i32.eq"];case 11:return[[81],"i64.eq"];case 12:return[[91],"f32.eq"];case 13:return[[97],"f64.eq"];case 14:return[[71],"i32.ne"];case 15:return[[82],"i64.ne"];case 16:return[[92],"f32.ne"];case 17:return[[98],"f64.ne"];case 18:return[[76],"i32.le_s"];case 19:return[[77],"i32.le_u"];case 20:return[[87],"i64.le_s"];case 21:return[[88],"i64.le_u"];case 22:return[[95],"f32.le"];case 23:return[[101],"f64.le"];case 24:return[[78],"i32.ge_s"];case 25:return[[79],"i32.ge_u"];case 26:return[[89],"i64.ge_s"];case 27:return[[90],"i64.ge_u"];case 28:return[[96],"f32.ge"];case 29:return[[102],"f64.ge"];case 30:return[[72],"i32.lt_s"];case 31:return[[73],"i32.lt_u"];case 32:return[[83],"i64.lt_s"];case 33:return[[84],"i64.lt_u"];case 34:return[[93],"f32.lt"];case 35:return[[99],"f64.lt"];case 36:return[[74],"i32.gt_s"];case 37:return[[75],"i32.gt_u"];case 38:return[[85],"i64.gt_s"];case 39:return[[86],"i64.gt_u"];case 40:return[[94],"f32.gt"];case 41:return[[100],"f64.gt"];case 42:return[[111],"i32.rem_s"];case 43:return[[112],"i32.rem_u"];case 44:return[[113],"i32.and"];case 45:return[[114],"i32.or"];case 46:return[[116],"i32.shl"];case 47:return[[117],"i32.shr_s"];case 48:return[[118],"i32.shr_u"]}else switch(n.TAG|0){case 0:return[[65],"i32.const "+String(n._0)];case 1:return[[66],"i64.const "+String(n._0)];case 2:return[[67],"i64.const "+String(n._0)];case 3:return[[68],"i64.const "+String(n._0)];case 4:return[[4],"if"];case 5:return[[13],"br_if "+String(n._0)];case 6:return[[12],"br "+String(n._0)];case 7:return[[2],"block"];case 8:return[[3],"loop"];case 9:return[[35],"global.get "+String(n._0)];case 10:return[[36],"global.set "+String(n._0)];case 11:return[[32],"local.get "+String(n._0)];case 12:return[[33],"local.set "+String(n._0)];case 13:return[[34],"local.tee "+String(n._0)];case 14:return[[16],"call "+String(n._0)];case 15:return[[17],"call_indirect [typeIndex="+String(n._0)+", tableIndex="+String(n._1)+"]"];case 16:return[[40],"i32.load (alignment="+String(n._0)+", offset="+String(n._1)+")"];case 17:return[[54],"i32.store (alignment="+String(n._0)+", offset="+String(n._1)+")"];case 18:return[[252,8],"memory.init "+String(n._0)];case 19:return[[252,9],"data.drop "+String(n._0)]}}function te(n){return sr(n)[0]}function Gu(n){if(typeof n=="number")switch(n){case 0:case 1:return-1;default:return 0}else switch(n.TAG|0){case 4:case 7:case 8:return 1;default:return 0}}function Bt(n,e,r,u){var a=n!==void 0?n:{contents:0},t=sr(e),o=Gu(e),i=m(Do(0,a.contents+(o<0?o:0)|0),"  ",function(v){return""});a.contents=a.contents+o|0,e===0&&(a.contents=a.contents+1|0);var c,_=0;if(typeof e=="number")c="";else switch(e.TAG|0){case 11:case 12:case 13:_=1;break;case 14:c="<"+Tn(Ve(r,e._0),"??",function(v){return v})+">";break;default:c=""}return _===1&&(c="<"+Tn(Ve(u,e._0),"??",function(v){return v})+">"),i+t[1]+" "+c}function ve(n){var e=0;if(typeof n=="number")return te(n);switch(n.TAG|0){case 0:case 1:return un(te(n),Vt(n._0));case 2:return un(te(n),vu(n._0));case 3:return un(te(n),du(n._0));case 4:case 7:case 8:e=1;break;case 9:case 10:case 11:case 12:case 13:e=2;break;case 15:return cn([te(n),_n(n._0),_n(n._1)]);case 16:case 17:e=3;break;case 18:return cn([te(n),_n(n._0),[0]]);case 5:case 6:case 14:case 19:return un(te(n),_n(n._0))}switch(e){case 1:return un(te(n),Tu(n._0));case 2:return un(te(n),_n(n._0));case 3:return cn([te(n),_n(n._0),_n(n._1)])}}var wi={info:sr,opcode:te,identationDelta:Gu,show:Bt,encode:ve};function mi(n,e){return{_0:n,_1:e}}var Si=[],pi=[],bi={_0:Si,_1:pi};function gu(n){return cn([[96],ke(s(n._0,ut)),ke(s(n._1,ut))])}function hu(n){var e=n._1,r=n._0,u=m(r,", ",at),a=m(e,", ",at);if(r.length===1){var t=e.length;if(t===1)return u+" -> "+a;if(t===0)return u+" -> ()"}var o=e.length;return o!==1?o!==0?"("+u+") -> ("+a+")":"("+u+") -> ()":"("+u+") -> "+a}var ki={funcTypeCode:96,make:mi,empty:bi,encode:gu,show:hu};function Di(n){var e=function(u,a){for(;;){var t=a,o=u;if(!o)return t;var i=o.tl,c=o.hd,_=c[1],v=c[0];if(t){var T=t.tl,p=t.hd,J=p[1],R=p[0];if(Un(_,J)){a={hd:[{hd:v,tl:R},J],tl:T},u=i;continue}a={hd:[{hd:v,tl:0},_],tl:{hd:[R,J],tl:T}},u=i;continue}a={hd:[{hd:v,tl:0},_],tl:0},u=i}},r=Qr(e(Et(n),0));return tt(No(r,function(u){return[yr(tt(u[0])),u[1]]}))}function Eu(n){return un(_n(n[0].length),[ut(n[1])])}function Au(n){return"local ["+m(n[0],", ",function(e){return e})+"] "+at(n[1])}var Ni={fromTypes:Di,encode:Eu,show:Au};function Fi(n,e){return[n,e]}function wu(n){var e=Bn(s(n[0],Eu)),r=cn(s(n[1],ve));return cn([[e.length+r.length|0],e,r])}function mu(n,e,r){var u=n[0],a={contents:1},t=Ir(r._0,function(_,v){return"param["+String(_)+"]"}),o=un(t,cn(s(u,function(_){return _[0]}))),i=m(u,`
`,Au),c=m(n[1],`
`,function(_){return Bt(a,_,e,o)});return u.length===0?c:i+`
`+c}var Ri={make:Fi,encode:wu,show:mu};function $i(n,e,r){return[n,e,r]}var mt={Signature:ki,Local:Ni,Body:Ri,make:$i};function Li(n){return[]}function lr(n,e){var r=ur(n,function(u){return Un(u,e)});return r!==void 0?r:(n.push(e),n.length-1|0)}function Su(n){return ne(1,Bn(s(n,gu)))}function pu(n){return ee(1)+`
`+m(n,`
`,hu)}var Xi={make:Li,getOrAdd:lr,encode:Su,show:pu};function Ci(n){return[]}function bu(n,e){return n.push(e),n.length-1|0}function ku(n){return ne(3,Bn(s(n,_n)))}function Du(n,e){return ee(3)+`
`+m(Be(n,e),`
`,function(r){return r[1]+": "+String(r[0])})}var Mi={make:Ci,addSignature:bu,encode:ku,show:Du};function Pt(n){return ke(s(n.split(""),function(e){return e.charCodeAt(0)|0}))}var Ui={encode:Pt};function Oi(n){return[n]}function Nu(n){switch(n){case 0:return"func";case 1:return"table";case 2:return"memory";case 3:return"global"}}var zi={encode:Oi,show:Nu};function Vi(n,e,r){return{name:n,kind:e,index:r}}function Fu(n){return cn([Pt(n.name),[n.kind],_n(n.index)])}function Ru(n){return"export "+Nu(n.kind)+" "+n.name+" (index: "+String(n.index)+")"}var $u={ExternalKind:zi,make:Vi,encode:Fu,show:Ru};function Bi(n){return[]}function Pi(n,e){n.push(e)}function Lu(n){return ne(7,Bn(s(n,Fu)))}function Xu(n){return ee(7)+`
`+m(n,`
`,Ru)}var qi={make:Bi,add:Pi,encode:Lu,show:Xu};function ji(n){return n?"externref":"funcref"}function Zi(n){return n?111:112}var Wi={show:ji,encode:Zi};function vr(n){return"{ min: "+String(n[0])+", max: "+Tn(n[1],"?",function(e){return String(e)})+" }"}function Ji(n,e){return[n,e]}function Ki(n){return[n,n]}function qt(n){var e=n[1],r=n[0];return e!==void 0?cn([[1],_n(r),_n(e)]):un([0],_n(r))}var dr={show:vr,make:Ji,makeExact:Ki,encode:qt};function Yi(n,e){return[n,e]}function Cu(n){return un([n[0]?111:112],qt(n[1]))}function Mu(n){return"table "+(n[0]?"externref":"funcref")+" "+vr(n[1])}var Uu={make:Yi,encode:Cu,show:Mu};function Hi(n){return[]}function Qi(n,e){n.push(e)}function Ou(n){return ee(4)+`
`+m(n,`
`,Mu)}function zu(n){return ne(4,Bn(s(n,Cu)))}var Ii={make:Hi,add:Qi,show:Ou,encode:zu};function yi(n,e){var r=n!==void 0?n:0;return{offset:r,funcIndices:e}}function Vu(n){return"elem funcref ("+m(n.funcIndices," ",function(e){return String(e)})+") (offset="+String(n.offset)+")"}function Bu(n){return cn([[0],ve({TAG:0,_0:n.offset}),ve(1),Bn(s(n.funcIndices,_n))])}var Pu={fromFuncRefs:yi,show:Vu,encode:Bu};function xi(n){return[]}function nc(n,e){n.push(e)}function qu(n){return ee(9)+`
`+m(n,`
`,Vu)}function ju(n){return ne(9,Bn(s(n,Bu)))}var ec={make:xi,add:nc,show:qu,encode:ju};function tc(n){return n}function Zu(n){return un(cn(s(n,ve)),ve(1))}function Wu(n){if(n.length!==1)return`
`+m(n,`
`,function(r){return"  "+Bt(void 0,r,[],[])})+`
end`;var e=n[0];return Bt(void 0,e,[],[])}var rc={fromInstructions:tc,encode:Zu,show:Wu};function uc(n,e,r){return[e,n,r]}function Ju(n){return"global "+(n[1]?"mutable":"immutable")+" "+at(n[0])+" = "+Wu(n[2])}function Ku(n){return un([ut(n[0]),n[1]?1:0],Zu(n[2]))}var St={Initializer:rc,make:uc,show:Ju,encode:Ku};function ac(n){return[]}function oc(n,e){n.push(e)}function Yu(n){return ee(6)+`
`+m(n,`
`,Ju)}function Hu(n){return ne(6,Bn(s(n,Ku)))}var ic={make:ac,add:oc,show:Yu,encode:Hu};function cc(n){return n}function Qu(n){return"memory "+vr(n)}var Iu={make:cc,show:Qu,encode:qt};function _c(n){return[]}function yu(n,e){return n.push(e)-1|0}function xu(n){return ee(5)+`
`+m(n,`
`,Qu)}function na(n){return ne(5,Bn(s(n,qt)))}var fc={make:_c,add:yu,show:xu,encode:na},sc={};function ea(n){return cn([[0],_n(n._0)])}function ta(n){return"func (index: "+String(n._0)+")"}var lc={make:void 0,encode:ea,show:ta};function ra(n){return cn([Pt(n.moduleName),Pt(n.entityName),ea(n.desc)])}function vc(n,e,r){return{moduleName:n,entityName:e,desc:r}}function ua(n){return"import "+ta(n.desc)+" "+n.moduleName+"."+n.entityName}var aa={ImportDesc:lc,encode:ra,make:vc,show:ua};function dc(n){return[]}function oa(n,e){return n.push(e)-1|0}function ia(n){return ne(2,Bn(s(n,ra)))}function ca(n){return ee(2)+`
`+m(n,`
`,ua)}function Tc(n){return n.length}var Gc={make:dc,add:oa,encode:ia,show:ca,count:Tc};function gc(n){return[]}function _a(n,e){return n.push(e),n.length-1|0}function fa(n){return ne(10,Bn(s(n,wu)))}function sa(n,e,r){var u=s(Ct(e,function(t){return!0}),function(t){return t.entityName}),a=un(u,s(r,function(t){return t[0]}));return ee(10)+`
`+m(Be(n,r),`

`,function(t){var o=t[1];return o[0]+`
`+mu(t[0],a,o[1])})}var hc={make:gc,addFunc:_a,encode:fa,show:sa};function la(n){return n?"active memIndex: "+String(n._0)+" offset: "+String(n._1):"passive"}var Ec={show:la};function Ac(n,e){return{init:n,mode:e}}function va(n){return"segment len: "+String(n.init.length)+" mode: "+la(n.mode)}function da(n){var e=n.mode,r=n.init;if(!e)return un([1],ke(r));var u=e._0;return u!==0?cn([[2],_n(u),ve({TAG:0,_0:e._1}),ve(1),ke(r)]):cn([[0],ve({TAG:0,_0:e._1}),ve(1),ke(r)])}var wc={make:Ac,show:va,encode:da};function mc(n){return[]}function Ta(n,e){return n.push(e)-1|0}function Ga(n){return ee(11)+`
`+m(n,`

`,va)}function ga(n){return ne(11,Bn(s(n,da)))}var Sc={make:mc,add:Ta,show:Ga,encode:ga},pc={Mode:Ec,Segment:wc,Section:Sc};function bc(n){return{typeSection:[],importSection:[],funcSection:[],tableSection:[],memorySection:[],globalSection:[],exportSection:[],elementSection:[],codeSection:[],dataSection:[],funcs:[]}}function kc(n,e){return lr(n.typeSection,e)}function ha(n,e,r,u){var a=lr(n.typeSection,r);return bu(n.funcSection,a),n.funcs.push([e,r,u]),_a(n.codeSection,u)+n.importSection.length|0}function Dc(n,e,r,u){var a=ha(n,e,r,u),t={name:e,kind:0,index:a};return n.exportSection.push(t),a}function Nc(n,e){n.exportSection.push(e)}function Fc(n,e){n.tableSection.push(e)}function Rc(n,e){n.elementSection.push(e)}function $c(n,e){n.globalSection.push(e)}function Lc(n,e){return yu(n.memorySection,e)}function Xc(n,e){return oa(n.importSection,e)}function Cc(n,e){return Ta(n.dataSection,e)}function Ea(n){return cn([[0,97,115,109,1,0,0,0],Su(n.typeSection),ia(n.importSection),ku(n.funcSection),zu(n.tableSection),na(n.memorySection),Hu(n.globalSection),Lu(n.exportSection),ju(n.elementSection),fa(n.codeSection),ga(n.dataSection)])}function Mc(n){return(e=>Uint8Array.from(e))(Ea(n))}function Uc(n){return m([pu(n.typeSection),ca(n.importSection),Du(n.funcSection,s(n.funcs,function(e){return e[0]})),Ou(n.tableSection),xu(n.memorySection),Yu(n.globalSection),Xu(n.exportSection),qu(n.elementSection),sa(n.codeSection,n.importSection,n.funcs),Ga(n.dataSection)],`

`,function(e){return e})}var Pn={make:bc,getOrAddSignature:kc,addFunc:ha,addExportedFunc:Dc,addExport:Nc,addTable:Fc,addElement:Rc,addGlobal:$c,addMemory:Lc,addImport:Xc,addData:Cc,encode:Ea,encodeAsUint8Array:Mc,show:Uc},Oc=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uleb128:_n,sleb128:Vt,Vec:_i,I32:si,I64:vi,F32:di,F64:Ti,Section:gi,ValueType:hi,BlockReturnType:Ai,Inst:wi,Func:mt,TypeSection:Xi,FuncSection:Mi,Str:Ui,ExportEntry:$u,ExportSection:qi,ReferenceType:Wi,Limits:dr,Table:Uu,TableSection:Ii,Elem:Pu,ElementSection:ec,Global:St,GlobalSection:ic,Memory:Iu,MemorySection:fc,Import:sc,ImportEntry:aa,ImportSection:Gc,CodeSection:hc,Data:pc,Module:Pn});const Tr={Else:0,End:1,Return:2,Drop:3,AddI32:4,SubI32:5,MulI32:6,DivI32Unsigned:7,DivI32Signed:8,EqzI32:9,EqI32:10,EqI64:11,EqF32:12,EqF64:13,NeI32:14,NeI64:15,NeF32:16,NeF64:17,LeI32Signed:18,LeI32Unsigned:19,LeI64Signed:20,LeI64Unsigned:21,LeF32:22,LeF64:23,GeI32Signed:24,GeI32Unsigned:25,GeI64Signed:26,GeI64Unsigned:27,GeF32:28,GeF64:29,LtI32Signed:30,LtI32Unsigned:31,LtI64Signed:32,LtI64Unsigned:33,LtF32:34,LtF64:35,GtI32Signed:36,GtI32Unsigned:37,GtI64Signed:38,GtI64Unsigned:39,GtF32:40,GtF64:41,RemI32Signed:42,RemI32Unsigned:43,AndI32:44,OrI32:45,ShlI32:46,ShrI32Signed:47,ShrI32Unsigned:48},Aa={"0":"I32","1":"I64","2":"F32","3":"F64"},L={I32:0,I64:1,F32:2,F64:3},zc={FuncRef:0,ExternRef:1},Vc={Func:0,Table:1,Memory:2,Global:3},Ee={Void:0},Bc={Passive:0},Z=Oc;Z.uleb128;Z.sleb128;Z.Vec.encode;Z.Vec.encodeMany;Z.I32.encode;Z.I64.encode;Z.F32.encode;Z.F64.encode;Z.Func.Signature.funcTypeCode;Z.Func.Signature.empty._0.map(function(e){return Aa[e]}),Z.Func.Signature.empty._1.map(function(e){return Aa[e]});Z.FuncSection.make;Z.FuncSection.encode;Z.Str.encode;Z.Limits.makeExact;Z.Elem.show;Z.Elem.encode;Z.ElementSection.make;Z.ElementSection.show;Z.ElementSection.encode;Z.MemorySection.make;Z.ImportEntry.ImportDesc.make;const Pc=function(n){return Z.Module.show({typeSection:n.typeSection.map(function(u){return{TAG:0,_0:u[0].map(function(t){return L[t]}),_1:u[1].map(function(t){return L[t]})}}),importSection:n.importSection.map(function(u){return{moduleName:u.moduleName,entityName:u.entityName,desc:{TAG:0,_0:u.desc.value}}}),funcSection:n.funcSection,tableSection:n.tableSection.map(function(u){return[zc[u[0]],[u[1][0],u[1][1]==null?void 0:u[1][1]]]}),memorySection:n.memorySection.map(function(u){return[u[0],u[1]==null?void 0:u[1]]}),globalSection:n.globalSection.map(function(u){return[L[u[0]],u[1],u[2].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:L[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return L[i]}),t.value.value[1][1].map(function(i){return L[i]})]}:Ee[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:L[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return L[i]}),t.value.value[1][1].map(function(i){return L[i]})]}:Ee[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:L[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return L[i]}),t.value.value[1][1].map(function(i){return L[i]})]}:Ee[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:t.tag==="StoreI32"?{TAG:17,_0:t.value[0],_1:t.value[1]}:t.tag==="InitMemory"?{TAG:18,_0:t.value}:{TAG:19,_0:t.value}:Tr[t]})]}),exportSection:n.exportSection.map(function(u){return{name:u.name,kind:Vc[u.kind],index:u.index}}),elementSection:n.elementSection,codeSection:n.codeSection.map(function(u){return[u[0].map(function(t){return[t[0],L[t[1]]]}),u[1].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:L[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return L[i]}),t.value.value[1][1].map(function(i){return L[i]})]}:Ee[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:L[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return L[i]}),t.value.value[1][1].map(function(i){return L[i]})]}:Ee[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:L[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return L[i]}),t.value.value[1][1].map(function(i){return L[i]})]}:Ee[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:t.tag==="StoreI32"?{TAG:17,_0:t.value[0],_1:t.value[1]}:t.tag==="InitMemory"?{TAG:18,_0:t.value}:{TAG:19,_0:t.value}:Tr[t]})]}),dataSection:n.dataSection.map(function(u){return{init:u.init,mode:typeof u.mode=="object"?{TAG:0,_0:u.mode[0],_1:u.mode[1]}:Bc[u.mode]}}),funcs:n.funcs.map(function(u){return[u[0],{TAG:0,_0:u[1][0].map(function(t){return L[t]}),_1:u[1][1].map(function(t){return L[t]})},[u[2][0].map(function(t){return[t[0],L[t[1]]]}),u[2][1].map(function(t){return typeof t=="object"?t.tag==="ConstI32"?{TAG:0,_0:t.value}:t.tag==="ConstI64"?{TAG:1,_0:t.value}:t.tag==="ConstF32"?{TAG:2,_0:t.value}:t.tag==="ConstF64"?{TAG:3,_0:t.value}:t.tag==="If"?{TAG:4,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:L[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return L[i]}),t.value.value[1][1].map(function(i){return L[i]})]}:Ee[t.value]}:t.tag==="BranchIf"?{TAG:5,_0:t.value}:t.tag==="Branch"?{TAG:6,_0:t.value}:t.tag==="Block"?{TAG:7,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:L[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return L[i]}),t.value.value[1][1].map(function(i){return L[i]})]}:Ee[t.value]}:t.tag==="Loop"?{TAG:8,_0:typeof t.value=="object"?t.value.tag==="TypeValue"?{TAG:0,_0:L[t.value.value]}:{TAG:1,_0:t.value.value[0],_1:[t.value.value[1][0].map(function(i){return L[i]}),t.value.value[1][1].map(function(i){return L[i]})]}:Ee[t.value]}:t.tag==="GetGlobal"?{TAG:9,_0:t.value}:t.tag==="SetGlobal"?{TAG:10,_0:t.value}:t.tag==="GetLocal"?{TAG:11,_0:t.value}:t.tag==="SetLocal"?{TAG:12,_0:t.value}:t.tag==="TeeLocal"?{TAG:13,_0:t.value}:t.tag==="Call"?{TAG:14,_0:t.value}:t.tag==="CallIndirect"?{TAG:15,_0:t.value[0],_1:t.value[1]}:t.tag==="LoadI32"?{TAG:16,_0:t.value[0],_1:t.value[1]}:t.tag==="StoreI32"?{TAG:17,_0:t.value[0],_1:t.value[1]}:t.tag==="InitMemory"?{TAG:18,_0:t.value}:{TAG:19,_0:t.value}:Tr[t]})]]})})};Z.F32;Z.F64;Z.I32;Z.I64;Z.Vec;Z.Str;function qc(n,e,r){return d(e,d(n,r))}var jc={compose:qc};function Zc(n){var e=Math.log2(n);return e===Math.floor(e)}var wa={isPowerOf2:Zc};function Wc(n,e){for(var r,u=0;ge(r)&&u<n.length;){var a=d(e,he(n,u));a!==void 0&&(r=N(On(a))),u=u+1|0}return r}function Jc(n,e){for(var r,u=n.length-1|0;ge(r)&&u>=0;)d(e,he(n,u))?r=u:u=u-1|0;return r}function Kc(n,e){for(var r,u=n.length-1|0;ge(r)&&u>=0;){var a=he(n,u);d(e,a)?r=N(a):u=u-1|0}return r}function Yc(n,e){for(var r=[],u=!1,a=0;u===!1&&a<n.length;){var t=he(n,a);t!==void 0?r.push(d(e,On(t))):u=!0,a=a+1|0}if(!u)return r}function Hc(n,e){for(var r=[],u,a=0;ge(u)&&a<n.length;){var t=he(n,a);t.TAG===0?r.push(d(e,t._0)):u=N(t._0),a=a+1|0}var o=u;return o!==void 0?{TAG:1,_0:On(o)}:{TAG:0,_0:r}}function Qc(n,e){return K(ur(n,e),function(r){return[he(n,r),r]})}var Ae={firstSomeBy:Wc,getReverseIndexBy:Jc,getReverseBy:Kc,mapOption:Yc,mapResult:Hc,getValueAndIndexBy:Qc};function ot(n){return[[],n]}var Ic=xr;function yc(n,e,r){return xr(n,e,[[],r])}var xc=Fo,n_=Ro,e_=ar;function t_(n,e){var r=m(nu(eu(n,e)),`
`,function(u){return"  "+u[0]+": "+u[1]});return`{
`+r+`
}`}var zn={empty:void 0,add:Ic,addMono:yc,remove:xc,has:n_,get:e_,show:t_},r_=[],Gr={TAG:1,_0:"u8",_1:r_},u_=[],Wn={TAG:1,_0:"u32",_1:u_},a_=[],gr={TAG:1,_0:"char",_1:a_},o_=[],qn={TAG:1,_0:"bool",_1:o_},i_=[],De={TAG:1,_0:"()",_1:i_};function Ln(n,e){return{TAG:1,_0:"Fun",_1:un(n,[e])}}function c_(n){return{TAG:1,_0:"Tuple",_1:n}}function ma(n,e){return{TAG:1,_0:"Array",_1:[n,{TAG:1,_0:String(e),_1:[]}]}}function __(n){return{TAG:1,_0:"Ptr",_1:[n]}}function hr(n){switch(n.TAG|0){case 0:return!1;case 1:return n._0==="Array";case 2:return!0}}var re=En("Types.Size.UnkownTypeSize");function jt(n){for(;;){var e=n;switch(e.TAG|0){case 0:throw{RE_EXN_ID:re,_1:e,Error:new Error};case 1:var r=0;switch(e._0){case"()":if(e._1.length===0)return 0;throw{RE_EXN_ID:re,_1:e,Error:new Error};case"Array":var u=e._1;if(u.length!==2)throw{RE_EXN_ID:re,_1:e,Error:new Error};var a=u[1];switch(a.TAG|0){case 1:if(a._1.length===0)return 4;throw{RE_EXN_ID:re,_1:e,Error:new Error};case 0:case 2:throw{RE_EXN_ID:re,_1:e,Error:new Error}}case"Mut":var t=e._1;if(t.length!==1)throw{RE_EXN_ID:re,_1:e,Error:new Error};n=t[0];continue;case"Fun":case"Ptr":return 4;case"Tuple":return hn(s(e._1,jt),0,function(o,i){return o+i|0});case"bool":case"u32":r=1;break;case"u64":if(e._1.length===0)return 8;throw{RE_EXN_ID:re,_1:e,Error:new Error};case"char":case"u8":r=2;break;default:throw{RE_EXN_ID:re,_1:e,Error:new Error}}switch(r){case 1:if(e._1.length===0)return 4;throw{RE_EXN_ID:re,_1:e,Error:new Error};case 2:if(e._1.length===0)return 1;throw{RE_EXN_ID:re,_1:e,Error:new Error}}break;case 2:return 4}}}function f_(n){return Math.ceil(Math.log2(jt(n)))|0}function s_(n){return jt(n)===0}var ue={UnkownTypeSize:re,size:jt,sizeLog2:f_,isZeroSizedType:s_};function l_(n){return{TAG:0,_0:n}}function Er(n,e,r){if(n.TAG===0)return{TAG:1,_0:[e,r],_1:{TAG:0,_0:n._0}};var u=n._1,a=n._0,t=a[1],o=a[0];return e<o?{TAG:1,_0:[e,r],_1:{TAG:1,_0:[o,t],_1:u}}:{TAG:1,_0:[o,t],_1:Er(u,e,r)}}function v_(n){for(;;){var e=n;if(e.TAG===0)return e._0;n=e._1}}function d_(n,e){return hn(n,{TAG:0,_0:{TAG:0,_0:e}},function(r,u){return Er(r,u[0],u[1])})}function Ar(n){var e=function(r,u){for(;;){var a=u,t=r;if(t.TAG===0){var o=t._0;switch(o.TAG|0){case 0:case 1:return a;case 2:var i=o._0;if(i.TAG===0)return a;var c=i._0;if(c.TAG===0)return a;u={hd:c._0,tl:a},r=c._1;continue}}else{u={hd:t._0,tl:a},r=t._1;continue}}};return tt(e(n,0))}function T_(n){return $o(Ar(n))}function Sa(n,e){if(n.TAG===0){var r=d(e,n._0);switch(r.TAG|0){case 0:case 1:return{TAG:0,_0:r};case 2:var u=r._0;return u.TAG===0?{TAG:0,_0:r}:u._0}}else{var a=n._0;return{TAG:1,_0:[a[0],d(e,a[1])],_1:Sa(n._1,e)}}}function pa(n,e){var r=function(u,a){for(;;){var t=a,o=u;if(o.TAG===0)return yr(tt({hd:"..."+d(e,o._0),tl:t}));var i=o._0;a={hd:i[0]+": "+d(e,i[1]),tl:t},u=o._1}};return"{ "+m(r(n,0),", ",function(u){return u})+" }"}var jn={make:l_,insert:Er,tail:v_,fromArray:d_,toArray:Ar,toMap:T_,map:Sa,show:pa};function Zt(n){switch(n.TAG|0){case 0:return Co(void 0,n._0);case 1:return hn(s(n._1,Zt),void 0,ir);case 2:var e=n._0;return e.TAG===0?void 0:hn(s(Ar(e._0),function(r){return jc.compose(function(u){return u[1]},Zt,r)}),void 0,ir)}}function G_(n){return tu(Zt(n[1]),Mo(n[0]))}function g_(n){return hn(s(Xo(n),G_),void 0,ir)}function wr(n,e){var r=Lo(tu(Zt(e),g_(n)));return[r,e]}function h_(n){var e=String.fromCharCode(97+n%26|0),r=n/26|0;return r===0?e:e+String(r)}function b(n){switch(n.TAG|0){case 0:return h_(n._0);case 1:var e=n._0;if(n._1.length===0)return e;switch(e){case"Array":var r=n._1;if(r.length===2){var u=r[0],a=r[1];switch(a.TAG|0){case 1:if(a._1.length===0)return"["+b(u)+"; "+a._0+"]";break}}break;case"Fun":var t=n._1,o=or(t,0,t.length-1|0),i=he(t,t.length-1|0);if(o.length!==1)return"("+m(o,", ",b)+") -> "+b(i);var c=o[0];return b(c)+" -> "+b(i);case"Tuple":return"("+m(n._1,", ",b)+")"}return e+"<"+m(n._1,", ",b)+">";case 2:var _=n._0;return _.TAG===0?_._0:pa(_._0,b)}}function ba(n){switch(n){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/";case 4:return"%";case 5:return"<";case 6:return"<=";case 7:return">";case 8:return">=";case 9:return"==";case 10:return"!=";case 11:return"&&";case 12:return"||";case 13:return"&";case 14:return"|";case 15:return"<<";case 16:return">>"}}var E_={show:ba};function ka(n){switch(n){case 0:return"-";case 1:return"!";case 2:return"*"}}var A_={show:ka};function Da(n){if(typeof n=="number")return"()";switch(n.TAG|0){case 0:case 1:return String(n._0);case 2:return n._0?"true":"false";case 3:return"'"+rt(1,n._0)+"'"}}var w_={show:Da};function B(n){switch(n.TAG|0){case 0:return Da(n._0);case 1:return ka(n._0)+B(n._1);case 2:return"("+B(n._0)+" "+ba(n._1)+" "+B(n._2)+")";case 3:return n._0;case 4:return B(n._0)+" = "+B(n._1);case 5:var e=n._1,r=n._0,u=r.length;if(u!==1)return u!==0?"("+m(r,", ",function(c){return c})+") -> "+B(e):"() -> "+B(e);var a=r[0];return a+" -> "+B(e);case 6:return"let "+n._0+" = "+B(n._1)+" in "+B(n._2);case 7:return"("+B(n._0)+")("+m(n._1,", ",B)+")";case 8:return(n._2===1?"unsafe ":"")+`{
`+m(un(s(n._0,Na),Tn(n._1,[],function(c){return[B(c)]})),`;
`,function(c){return"  "+c})+`
}`;case 9:var t=n._2,o="if "+B(n._0)+" "+B(n._1);return t!==void 0?o+" else "+B(t):o;case 10:return"while "+B(n._0)+" "+B(n._1);case 11:return"return "+Tn(n._0,"",B);case 12:return B(n._0)+" as "+b(n._1);case 13:return"("+m(n._0,", ",B)+")";case 14:return n._0+` {
`+m(n._1,", ",function(c){return c[0]+": "+B(c[1])})+`
}`;case 15:var i=n._0;return i.TAG===0?"["+B(i._0)+"; "+String(i._1)+"]":"["+m(i._0,", ",B)+"]";case 16:return B(n._0)+"."+n._1}}function mr(n){switch(n.TAG|0){case 0:return"fn "+n._0+"("+m(n._1,", ",function(e){return(e[1]?"mut ":"")+e[0]})+") "+B(n._2);case 1:return(n._1?"mut":"let")+" "+n._0+" = "+B(n._2);case 2:return"struct "+n._0+` {
`+m(n._1,`,
`,function(e){return(e[2]?"mut ":"")+e[0]+": "+b(e[1])})+`
}`;case 3:return"impl "+n._0+` {
`+m(n._1,`

`,mr)+`
}`;case 4:return"extern fn "+n.name+"("+m(n.args,", ",function(e){return(e[2]?"mut ":"")+e[0]+": "+b(e[1])})+") -> "+b(n.ret)}}function Na(n){return n.TAG===0?(n._1?"mut":"let")+" "+n._0+" = "+B(n._2):B(n._0)}var m_={showExpr:B,showDecl:mr,showStmt:Na},S_={show:mr};function A(n,e){for(;;){var r=e;switch(r.TAG|0){case 0:var u=r._0,a=ru(n,u);if(a===void 0)return{TAG:0,_0:u};e=a;continue;case 1:return{TAG:1,_0:r._0,_1:s(r._1,function(i){return A(n,i)})};case 2:var t=r._0,o;return o=t.TAG===0?{TAG:0,_0:t._0}:{TAG:1,_0:jn.map(t._0,function(i){return A(n,i)})},{TAG:2,_0:o}}}}function Fa(n,e){var r=e[0];return[r,A(Vo(n,r),e[1])]}function U(n,e){return Uo(Oo(e,function(r){return A(n,r)}),n,function(r,u,a){return zo(a,u)})}function Gn(n,e){return eu(e,function(r){return Fa(n,r)})}var Pe;function Sr(n,e){return{TAG:2,_0:{TAG:1,_0:jn.fromArray(s(n.attributes,function(r){return[r.name,r.ty]}),e)}}}function p_(n,e){var r={contents:0},u=[];return Fn(e,function(a){var t=a[1],o=ue.size(t);u.push({name:a[0],mut:a[2],offset:r.contents,ty:t,size:o,impl:void 0}),r.contents=r.contents+o|0}),{name:n,attributes:u,size:r.contents,staticFuncs:[]}}function b_(n,e,r){n.attributes.push({name:e.contents.name,mut:!1,offset:0,ty:e.contents.ty,size:0,impl:[e,r]})}function k_(n,e){n.staticFuncs.push({name:e})}var pr=En("Struct.UndeclaredStruct"),br=En("Struct.StructTypeNotMatched"),Ra=En("Struct.AmibguousStruct"),Jn={tyVarIndex:0,identifiers:[],renaming:Bo(10),structs:uu(5)};function we(n){var e=Jn.tyVarIndex;return Jn.tyVarIndex=Jn.tyVarIndex+1|0,e}function pt(n){return{TAG:0,_0:we()}}function Wt(n){var e=n[0],r=s(e,function(u){return{TAG:0,_0:we()}});return A(Zo(Be(e,r)),n[1])}function ae(n,e){var r=n!==void 0?On(n):void 0,u=Jn.identifiers.length;Jn.identifiers.push(e);var a={contents:{name:e,newName:e,index:u,ty:r!==void 0?r:{TAG:0,_0:we()}}};return qo(Jn.renaming,u,a),a}function D_(n){return xn(Ae.getReverseIndexBy(Jn.identifiers,function(e){return e===n}),function(e){return jo(Jn.renaming,e)})}function $a(n,e){e.contents.ty=A(n,e.contents.ty)}function La(n){return Fn(Po(Jn.renaming),function(e){return $a(n,e)})}function N_(n){return cr(Jn.structs,n.name,n)}function Kn(n){return au(Jn.structs,n)}function Ne(n){switch(n.TAG|0){case 0:var e=n._0;if(typeof e=="number")return De;switch(e.TAG|0){case 0:return Gr;case 1:return Wn;case 2:return qn;case 3:return gr}case 3:return n._0.contents.ty;case 4:case 11:return De;case 12:return Tn(n._0,De,Ne);case 13:return n._2;case 14:return c_(s(n._0,Ne));case 15:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return n._0}}function F_(n){return n.TAG===0?n._1:n._0.length}var R_={len:F_};function $_(n){return Ne(n._0)}function Y(n,e){var r=n!==void 0?On(n):void 0,u=function(T,p){return r!==void 0?"("+p+": "+b(A(On(r),T))+")":p},a=function(T){return Y(N(r),T)};switch(e.TAG|0){case 0:return u(Ne(e),w_.show(e._0));case 1:return u(e._0,"("+Y(N(r),e._1)+" "+E_.show(e._2)+" "+Y(N(r),e._3)+")");case 2:return u(e._0,"("+A_.show(e._1)+Y(N(r),e._2)+")");case 3:var t=e._0;return u(t.contents.ty,t.contents.name);case 4:var o=e._1;return u(Ne(o),Y(N(r),e._0)+" = "+Y(N(r),o));case 5:return u(e._0,"("+m(e._1,", ",function(T){return T.contents.name})+") -> "+Y(N(r),e._2));case 6:return u(e._0,(e._1?"mut":"let")+" "+e._2.contents.name+" = "+Y(N(r),e._3)+` in
`+Y(N(r),e._4));case 7:return u(e._0,"let rec "+e._1.contents.name+" ("+m(e._2,", ",function(T){return T.contents.name})+") = "+Y(N(r),e._3)+` in
`+Y(N(r),e._4));case 8:return u(e._0,"("+Y(N(r),e._1)+")("+m(e._2,", ",a)+")");case 9:var i=e._2,c=N(r);return u(e._0,(e._3===1?"unsafe ":"")+`{
`+m(un(s(e._1,function(T){return Xa(c,T)}),Tn(i,[],function(T){return[Y(N(r),T)]})),`;
`,function(T){return"  "+T})+(ge(i)?"; ":"")+`
}`);case 10:return u(e._0,"if "+Y(N(r),e._1)+" "+Y(N(r),e._2)+" else "+Y(N(r),e._3));case 11:return u(De,"while "+Y(N(r),e._0)+" "+Y(N(r),e._1));case 12:return"return "+u(Ne(e),Tn(e._0,"",a));case 13:return Y(N(r),e._0)+" as "+b(e._2);case 14:return"("+m(e._0,", ",a)+")";case 15:return e._0+` {
`+m(e._1,`,
`,function(T){return T[0]+": "+Y(N(r),T[1])})+`
}`;case 16:var _=e._1,v;return v=_.TAG===0?"["+Y(N(r),_._0)+"; "+String(_._1)+"]":"["+m(_._0,", ",function(T){return Y(N(r),T)})+"]",u(e._0,v);case 17:return u(e._0,Y(N(r),e._1)+"."+e._2)}}function Xa(n,e){var r=n!==void 0?On(n):void 0;return Y(N(r),e._0)}function kr(n,e){var r=n!==void 0?On(n):void 0,u=function(_,v){return r!==void 0?"("+v+": "+b(A(On(r),_))+")":v};switch(e.TAG|0){case 0:var a=e._1,t=e._0,o;if(r!==void 0){var i=On(r);o=m(a,", ",function(_){var v=_[0];return(_[1]?"mut ":"")+(v.contents.name+": "+b(A(i,v.contents.ty)))})}else o=m(a,", ",function(_){return(_[1]?"mut ":"")+_[0].contents.name});return u(t.contents.ty,"fn "+t.contents.name+"("+o+") "+Y(N(r),e._2));case 1:var c=e._0;return u(c.contents.ty,(e._1?"mut":"let")+" "+c.contents.name+" = "+Y(N(r),e._2));case 2:return m_.showDecl({TAG:2,_0:e._0,_1:e._1});case 3:return"impl "+e._0+` {
`+m(e._1,`

`,function(_){return kr(void 0,{TAG:0,_0:_[0],_1:_[1],_2:_[2]})})+`
}`;case 4:return"extern fn "+e.name.contents.name+"("+m(e.args,", ",function(_){var v=_[0];return(_[1]?"mut ":"")+v.contents.name+": "+b(v.contents.ty)})+") -> "+b(e.ret)}}var Ca=En("Core.CoreAst.UnexpectedDeclarationInImplBlock"),Ma=En("Core.CoreAst.UndeclaredIdentifer"),Ua=En("Core.CoreAst.UnreachableLetStmt");function Dr(n,e,r,u,a){return r.TAG===5?{TAG:7,_0:r._0,_1:n,_2:r._1,_3:r._2,_4:u}:{TAG:6,_0:a,_1:e,_2:n,_3:r,_4:u}}function P(n){var e={LAZY_DONE:!1,VAL:function(){return pt()}};switch(n.TAG|0){case 0:return{TAG:0,_0:n._0};case 1:return{TAG:2,_0:le(e),_1:n._0,_2:P(n._1)};case 2:return{TAG:1,_0:le(e),_1:P(n._0),_2:n._1,_3:P(n._2)};case 3:var r=n._0,u=D_(r);if(u!==void 0)return{TAG:3,_0:u};var a=Kn(r);if(a!==void 0)return{TAG:3,_0:ae(void 0,r)};throw{RE_EXN_ID:Ma,_1:r,Error:new Error};case 4:return{TAG:4,_0:P(n._0),_1:P(n._1)};case 5:var t=n._1,o=n._0;if(o.length===0)return{TAG:5,_0:le(e),_1:[ae(void 0,"__x")],_2:P(t)};var i=N(void 0);return{TAG:5,_0:le(e),_1:s(o,function(R){return ae(i,R)}),_2:P(t)};case 6:return Dr(ae(void 0,n._0),!1,P(n._1),P(n._2),le(e));case 7:return{TAG:8,_0:le(e),_1:P(n._0),_2:s(n._1,P)};case 8:var c=n._2,_=n._1,v=function(R){if(!R)return K(_,P);var j=R.hd;if(j.TAG!==0)return{TAG:9,_0:le(e),_1:[Oa(j)],_2:v(R.tl),_3:c};var tn=j._3;return Dr(ae(void 0,j._0),j._1,P(j._2),Tn(v(R.tl),{TAG:0,_0:0},function(dn){return dn}),tn!==void 0?tn:pt())};return{TAG:9,_0:le(e),_1:[],_2:v(Et(n._0)),_3:c};case 9:return{TAG:10,_0:le(e),_1:P(n._0),_2:P(n._1),_3:Tn(n._2,{TAG:0,_0:0},P)};case 10:return{TAG:11,_0:P(n._0),_1:P(n._1)};case 11:return{TAG:12,_0:K(n._0,P)};case 12:return{TAG:13,_0:P(n._0),_1:le(e),_2:n._1};case 13:return{TAG:14,_0:s(n._0,P)};case 14:return{TAG:15,_0:n._0,_1:s(n._1,function(R){return[R[0],P(R[1])]})};case 15:var T=n._0,p=pt(),J;return J=T.TAG===0?{TAG:0,_0:P(T._0),_1:T._1}:{TAG:1,_0:s(T._0,P)},{TAG:16,_0:p,_1:J};case 16:return{TAG:17,_0:pt(),_1:P(n._0),_2:n._1}}}function Oa(n){if(n.TAG!==0)return{_0:P(n._0)};throw{RE_EXN_ID:Ua,Error:new Error}}function Nr(n){switch(n.TAG|0){case 0:var e=s(n._1,function(o){return[ae(N(void 0),o[0]),o[1]]});return{TAG:0,_0:ae(void 0,n._0),_1:e,_2:P(n._2)};case 1:return{TAG:1,_0:ae(void 0,n._0),_1:n._1,_2:P(n._2)};case 2:var r=n._1,u=n._0;return N_(p_(u,r)),{TAG:2,_0:u,_1:r};case 3:var a=s(s(n._1,Nr),function(o){if(o.TAG===0)return[o._0,o._1,o._2];throw{RE_EXN_ID:Ca,_1:o,Error:new Error}});return{TAG:3,_0:n._0,_1:a};case 4:var t=s(n.args,function(o){return[ae(N(o[1]),o[0]),o[2]]});return{TAG:4,name:ae(void 0,n.name),args:t,ret:n.ret}}}function y(n,e){var r=function(_){return y(n,_)};switch(e.TAG|0){case 0:return{TAG:0,_0:e._0};case 1:return{TAG:1,_0:A(n,e._0),_1:y(n,e._1),_2:e._2,_3:y(n,e._3)};case 2:return{TAG:2,_0:A(n,e._0),_1:e._1,_2:y(n,e._2)};case 3:return{TAG:3,_0:e._0};case 4:return{TAG:4,_0:y(n,e._0),_1:y(n,e._1)};case 5:return{TAG:5,_0:A(n,e._0),_1:e._1,_2:y(n,e._2)};case 6:return{TAG:6,_0:A(n,e._0),_1:e._1,_2:e._2,_3:y(n,e._3),_4:y(n,e._4)};case 7:return{TAG:7,_0:A(n,e._0),_1:e._1,_2:e._2,_3:y(n,e._3),_4:y(n,e._4)};case 8:return{TAG:8,_0:A(n,e._0),_1:y(n,e._1),_2:s(e._2,r)};case 9:return{TAG:9,_0:A(n,e._0),_1:s(e._1,function(_){return za(n,_)}),_2:K(e._2,r),_3:e._3};case 10:return{TAG:10,_0:A(n,e._0),_1:y(n,e._1),_2:y(n,e._2),_3:y(n,e._3)};case 11:return{TAG:11,_0:y(n,e._0),_1:y(n,e._1)};case 12:return{TAG:12,_0:K(e._0,r)};case 13:return{TAG:13,_0:y(n,e._0),_1:A(n,e._1),_2:A(n,e._2)};case 14:return{TAG:14,_0:s(e._0,r)};case 15:var u=e._1,a=e._0,t=Kn(a);if(t===void 0)return ou('unreachable: undeclared struct "'+a+"'");var o=Ae.mapOption(s(Ct(t.attributes,function(_){return ge(_.impl)}),function(_){var v=_.name;return Mt(u,function(T){return T[0]===v})}),function(_){return[_[0],y(n,_[1])]});return o!==void 0?{TAG:15,_0:a,_1:o}:ou('unreachable: missing attribute for struct "'+a+'"');case 16:var i=e._1,c;return c=i.TAG===0?{TAG:0,_0:y(n,i._0),_1:i._1}:{TAG:1,_0:s(i._0,r)},{TAG:16,_0:A(n,e._0),_1:c};case 17:return{TAG:17,_0:A(n,e._0),_1:y(n,e._1),_2:e._2}}}function za(n,e){return{_0:y(n,e._0)}}function Va(n,e){switch(e.TAG|0){case 0:return{TAG:0,_0:e._0,_1:e._1,_2:y(n,e._2)};case 1:return{TAG:1,_0:e._0,_1:e._1,_2:y(n,e._2)};case 3:return{TAG:3,_0:e._0,_1:s(e._1,function(r){return[r[0],r[1],y(n,r[2])]})};case 2:case 4:return e}}function nn(n,e){var r=function(t){return nn(n,t)};switch(e.TAG|0){case 1:return d(n,{TAG:1,_0:e._0,_1:nn(n,e._1),_2:e._2,_3:nn(n,e._3)});case 2:return d(n,{TAG:2,_0:e._0,_1:e._1,_2:nn(n,e._2)});case 0:case 3:return d(n,e);case 4:return d(n,{TAG:4,_0:nn(n,e._0),_1:nn(n,e._1)});case 5:return d(n,{TAG:5,_0:e._0,_1:e._1,_2:nn(n,e._2)});case 6:return d(n,{TAG:6,_0:e._0,_1:e._1,_2:e._2,_3:nn(n,e._3),_4:nn(n,e._4)});case 7:return d(n,{TAG:7,_0:e._0,_1:e._1,_2:e._2,_3:nn(n,e._3),_4:nn(n,e._4)});case 8:return d(n,{TAG:8,_0:e._0,_1:nn(n,e._1),_2:s(e._2,r)});case 9:return d(n,{TAG:9,_0:e._0,_1:s(e._1,function(t){return{_0:nn(n,t._0)}}),_2:K(e._2,r),_3:e._3});case 10:return d(n,{TAG:10,_0:e._0,_1:nn(n,e._1),_2:nn(n,e._2),_3:nn(n,e._3)});case 11:return d(n,{TAG:11,_0:nn(n,e._0),_1:nn(n,e._1)});case 12:return d(n,{TAG:12,_0:K(e._0,r)});case 13:return d(n,{TAG:13,_0:nn(n,e._0),_1:e._1,_2:e._2});case 14:return d(n,{TAG:14,_0:s(e._0,r)});case 15:return d(n,{TAG:15,_0:e._0,_1:s(e._1,function(t){return[t[0],nn(n,t[1])]})});case 16:var u=e._1,a;return a=u.TAG===0?{TAG:0,_0:nn(n,u._0),_1:u._1}:{TAG:1,_0:s(u._0,r)},d(n,{TAG:16,_0:e._0,_1:a});case 17:return d(n,{TAG:17,_0:e._0,_1:nn(n,e._1),_2:e._2})}}function Ba(n,e){switch(e.TAG|0){case 0:return{TAG:0,_0:e._0,_1:e._1,_2:nn(n,e._2)};case 1:return{TAG:1,_0:e._0,_1:e._1,_2:nn(n,e._2)};case 3:return{TAG:3,_0:e._0,_1:s(e._1,function(r){return[r[0],r[1],nn(n,r[2])]})};case 2:case 4:return e}}function Pa(n,e,r,u){var a=n!==void 0?On(n):void 0,t=e!==void 0?On(e):void 0;Ba(function(o){return o.TAG===9?(K(a,function(i){return d(i,o)}),d(r,o),K(t,function(i){return d(i,o)})):d(r,o),o},u)}function L_(n,e,r,u){var a=n!==void 0?On(n):void 0,t=e!==void 0?On(e):void 0,o=N(t),i=N(a);return Fn(u,function(c){return Pa(i,o,r,c)})}var fn={typeOfExpr:Ne,ArrayInit:R_,typeOfStmt:$_,showExpr:Y,showStmt:Xa,showDecl:kr,UnexpectedDeclarationInImplBlock:Ca,UndeclaredIdentifer:Ma,UnreachableLetStmt:Ua,rewriteLetIn:Dr,fromExpr:P,fromStmt:Oa,fromDecl:Nr,substExpr:y,substStmt:za,substDecl:Va,rewriteExpr:nn,rewriteDecl:Ba,visitDecl:Pa,visitProg:L_},Xn={show:Y,from:P,subst:y,typeOf:Ne},Fe={show:kr,from:Nr,subst:Va};function qa(n){return[n,0,n.length]}function X_(n){return qa(Array.from(n,function(e){return iu(e,0)}))}function ja(n,e){var r=e[2],u=n!==void 0?n:1;return[e[0],Math.min(e[1]+u|0,r),r]}function Jt(n){return Ve(n[0],n[1])}function Fr(n){return ja(1,n)}function Rr(n){return n[1]===n[2]}function C_(n){return n[0].slice(n[1],n[2])}function it(n,e){var r=Jt(e);if(r!==void 0&&d(n,r))return[r,ja(void 0,e)]}function q(n){return function(e){return it(function(r){return r===n},e)}}function Za(n){return n>=97?n<=122:!1}function M_(n){return n>=65?n<=90:!1}function U_(n){return Za(n)?!0:M_(n)}function Wa(n){return n>=48?n<=57:!1}function O_(n){return U_(n)?!0:Wa(n)}function z_(n){return it(Za,n)}function V_(n){return it(Wa,n)}function $r(n){return it(O_,n)}function B_(n){return n>13||n<9?n===32:!(n===12||n===11)}function P_(n){return it(B_,n)}function g(n,e,r){return K(d(n,r),function(u){return[d(e,u[0]),u[1]]})}function Kt(n,e,r){for(;;){var u=n,a=r,t=u!==void 0?u:[];if(Rr(a))return[t,a];var o=d(e,a);if(o===void 0)return[t,a];t.push(o[0]),r=o[1],n=t}}function Ja(n){return Kt(void 0,P_,n)}function qe(n,e,r){return xn(d(n,r),function(u){var a=u[0];return K(d(e,u[1]),function(t){return[[a,t[0]],t[1]]})})}function Ka(n){return function(e){return g(function(r){return qe(n,function(u){return Kt(void 0,n,u)},r)},function(r){return un([r[0]],r[1])},e)}}function Ya(n,e,r,u){return xn(qe(n,e,u),function(a){var t=a[0],o=t[1],i=t[0];return K(d(r,a[1]),function(c){return[[i,o,c[0]],c[1]]})})}function Ha(n){if(!n)return function(a){return[0,a]};var e=n.hd,r=Ha(n.tl),u=function(a){return qe(e,r,a)};return function(a){return g(u,function(t){return{hd:t[0],tl:t[1]}},a)}}function Lr(n,e,r){var u=d(n,r);return u!==void 0?[u[0],u[1]]:d(e,r)}function ct(n,e){return Ae.firstSomeBy(n,function(r){return d(r,e)})}function W(n){var e=Array.from(n,function(u){var a=iu(u,0);return function(t){return it(function(o){return o===a},t)}}),r=Ha(Et(e));return function(u){return g(r,function(a){return n},u)}}function Qa(n,e){var r=d(n,e);if(r===void 0)return[_r(Jt(e)),Fr(e)]}var q_=Ka(V_);function Xr(n){return g(q_,function(e){return _r(cu(m(e,"",function(r){return rt(1,r)})))},n)}var j_=W("u8");function Z_(n){return qe(Xr,j_,n)}function W_(n){return g(Z_,function(e){return{TAG:0,_0:e[0],_1:8}},n)}var J_=W("u32");function K_(n){return qe(Xr,J_,n)}function Y_(n){return g(K_,function(e){return{TAG:0,_0:e[0],_1:32}},n)}function H_(n){return Lr(Y_,function(e){return g(Xr,function(r){return{TAG:0,_0:r,_1:32}},e)},n)}var Q_=[W_,H_];function I_(n){return ct(Q_,n)}var y_=W("false");function x_(n){return g(y_,function(e){return{TAG:1,_0:!1}},n)}var n0=W("true");function e0(n){return g(n0,function(e){return{TAG:1,_0:!0}},n)}function t0(n){return Lr(e0,x_,n)}var r0=[$r,q(95),q(39)];function u0(n){return ct(r0,n)}function a0(n){return Kt(void 0,u0,n)}var o0=q(95);function i0(n){return Lr(z_,o0,n)}function c0(n){return qe(i0,a0,n)}function _0(n){return g(c0,function(e){return{TAG:4,_0:rt(1,e[0])+m(e[1],"",function(r){return rt(1,r)})}},n)}var f0=[$r,q(95)],s0=Ka(function(n){return ct(f0,n)});function l0(n){return g(s0,function(e){return{TAG:5,_0:m(e,"",function(r){return rt(1,r)})}},n)}var v0=q(39),d0=q(39);function T0(n){return Qa(d0,n)}var G0=q(39);function g0(n){return Ya(G0,T0,v0,n)}function h0(n){return g(g0,function(e){return{TAG:2,_0:e[1]}},n)}var E0=W("let"),A0=W("mut"),w0=W("in"),m0=W("if"),S0=W("else"),p0=W("fn"),b0=W("while"),k0=W("return"),D0=W("as"),N0=W("unsafe"),F0=W("struct"),R0=W("impl"),$0=W("extern"),L0=[function(n){return g(E0,function(e){return{TAG:6,_0:0}},n)},function(n){return g(A0,function(e){return{TAG:6,_0:1}},n)},function(n){return g(w0,function(e){return{TAG:6,_0:2}},n)},function(n){return g(m0,function(e){return{TAG:6,_0:3}},n)},function(n){return g(S0,function(e){return{TAG:6,_0:4}},n)},function(n){return g(p0,function(e){return{TAG:6,_0:5}},n)},function(n){return g(b0,function(e){return{TAG:6,_0:6}},n)},function(n){return g(k0,function(e){return{TAG:6,_0:7}},n)},function(n){return g(D0,function(e){return{TAG:6,_0:8}},n)},function(n){return g(N0,function(e){return{TAG:6,_0:9}},n)},function(n){return g(F0,function(e){return{TAG:6,_0:10}},n)},function(n){return g(R0,function(e){return{TAG:6,_0:11}},n)},function(n){return g($0,function(e){return{TAG:6,_0:12}},n)}];function X0(n){return ct(L0,n)}function C0(n){return qe(X0,function(e){return Qa($r,e)},n)}function M0(n){return g(C0,function(e){return e[0]},n)}var U0=W("->"),O0=W("=="),z0=W("!="),V0=W("&&"),B0=W("||"),P0=W("+="),q0=W("-="),j0=W("*="),Z0=W("/="),W0=W("%="),J0=q(43),K0=q(45),Y0=q(42),H0=q(47),Q0=q(37),I0=W("<="),y0=W(">="),x0=q(60),nf=q(62),ef=q(40),tf=q(41),rf=q(44),uf=q(59),af=q(61),of=q(123),cf=q(125),_f=q(91),ff=q(93),sf=q(58),lf=q(33),vf=q(46),df=q(38),Tf=q(124),Gf=q(39),gf=q(34),hf=[function(n){return g(U0,function(e){return{TAG:3,_0:5}},n)},function(n){return g(O0,function(e){return{TAG:3,_0:16}},n)},function(n){return g(z0,function(e){return{TAG:3,_0:17}},n)},function(n){return g(V0,function(e){return{TAG:3,_0:25}},n)},function(n){return g(B0,function(e){return{TAG:3,_0:27}},n)},function(n){return g(P0,function(e){return{TAG:3,_0:28}},n)},function(n){return g(q0,function(e){return{TAG:3,_0:29}},n)},function(n){return g(j0,function(e){return{TAG:3,_0:30}},n)},function(n){return g(Z0,function(e){return{TAG:3,_0:31}},n)},function(n){return g(W0,function(e){return{TAG:3,_0:32}},n)},function(n){return g(J0,function(e){return{TAG:3,_0:11}},n)},function(n){return g(K0,function(e){return{TAG:3,_0:12}},n)},function(n){return g(Y0,function(e){return{TAG:3,_0:13}},n)},function(n){return g(H0,function(e){return{TAG:3,_0:14}},n)},function(n){return g(Q0,function(e){return{TAG:3,_0:15}},n)},function(n){return g(I0,function(e){return{TAG:3,_0:19}},n)},function(n){return g(y0,function(e){return{TAG:3,_0:21}},n)},function(n){return g(x0,function(e){return{TAG:3,_0:18}},n)},function(n){return g(nf,function(e){return{TAG:3,_0:20}},n)},function(n){return g(ef,function(e){return{TAG:3,_0:0}},n)},function(n){return g(tf,function(e){return{TAG:3,_0:1}},n)},function(n){return g(rf,function(e){return{TAG:3,_0:2}},n)},function(n){return g(uf,function(e){return{TAG:3,_0:3}},n)},function(n){return g(af,function(e){return{TAG:3,_0:4}},n)},function(n){return g(of,function(e){return{TAG:3,_0:6}},n)},function(n){return g(cf,function(e){return{TAG:3,_0:7}},n)},function(n){return g(_f,function(e){return{TAG:3,_0:8}},n)},function(n){return g(ff,function(e){return{TAG:3,_0:9}},n)},function(n){return g(sf,function(e){return{TAG:3,_0:10}},n)},function(n){return g(lf,function(e){return{TAG:3,_0:22}},n)},function(n){return g(vf,function(e){return{TAG:3,_0:23}},n)},function(n){return g(df,function(e){return{TAG:3,_0:24}},n)},function(n){return g(Tf,function(e){return{TAG:3,_0:26}},n)},function(n){return g(Gf,function(e){return{TAG:3,_0:33}},n)},function(n){return g(gf,function(e){return{TAG:3,_0:34}},n)}];function Ef(n){return ct(hf,n)}var Af=[I_,t0,h0,M0,Ef,_0,l0];function wf(n){return ct(Af,n)}function mf(n){return Kt(void 0,function(e){return g(function(r){return Ya(Ja,wf,Ja,r)},function(r){return r[1]},e)},n)}function Sf(n){switch(n){case 0:return"(";case 1:return")";case 2:return",";case 3:return";";case 4:return"=";case 5:return"->";case 6:return"{";case 7:return"}";case 8:return"[";case 9:return"]";case 10:return":";case 11:return"+";case 12:return"-";case 13:return"*";case 14:return"/";case 15:return"%";case 16:return"==";case 17:return"!=";case 18:return"<";case 19:return"<=";case 20:return">";case 21:return">=";case 22:return"!";case 23:return".";case 24:return"&";case 25:return"&&";case 26:return"|";case 27:return"||";case 28:return"+=";case 29:return"-=";case 30:return"*=";case 31:return"/=";case 32:return"%=";case 33:return"'";case 34:return'"'}}function pf(n){switch(n){case 0:return"let";case 1:return"mut";case 2:return"in";case 3:return"if";case 4:return"else";case 5:return"fn";case 6:return"while";case 7:return"return";case 8:return"as";case 9:return"unsafe";case 10:return"struct";case 11:return"impl";case 12:return"extern"}}function bf(n){switch(n.TAG|0){case 0:return String(n._0);case 1:return n._0?"true":"false";case 2:return rt(1,n._0);case 3:return Sf(n._0);case 4:case 5:return n._0;case 6:return pf(n._0)}}function _t(n){return{contents:function(e){return xn(Jt(e),function(r){if(d(n,r))return[r,Fr(e)]})}}}function je(n){return{contents:function(e){return xn(Jt(e),function(r){return K(d(n,r),function(u){return[u,Fr(e)]})})}}}function kf(n,e){return{contents:function(r){var u=d(n.contents,r);if(u!==void 0){var a=u[1];return K(d(e,u[0]),function(t){return[t,a]})}}}}function l(n){return _t(function(e){return Un(e,n)})}function G(n,e){return{contents:function(r){return K(d(n.contents,r),function(u){return[d(e,u[0]),u[1]]})}}}function sn(n,e){return{contents:function(r){return xn(d(n.contents,r),function(u){var a=u[0];return K(d(e.contents,u[1]),function(t){return[[a,t[0]],t[1]]})})}}}function bt(n){var e=function(r){return{contents:function(u){if(Rr(u))return[0,u];var a=d(r.contents,u);if(a===void 0)return[0,u];var t=a[0];return K(d(e(r).contents,a[1]),function(o){return[{hd:t,tl:o[0]},o[1]]})}}};return G(e(n),tt)}function Df(n){return G(sn(n,bt(n)),function(e){return un([e[0]],e[1])})}function Yn(n,e,r){return{contents:function(u){return xn(d(sn(n,e).contents,u),function(a){var t=a[0],o=t[1],i=t[0];return K(d(r.contents,a[1]),function(c){return[[i,o,c[0]],c[1]]})})}}}function Ze(n,e,r,u){return{contents:function(a){return xn(d(Yn(n,e,r).contents,a),function(t){var o=t[0],i=o[2],c=o[1],_=o[0];return K(d(u.contents,t[1]),function(v){return[[_,c,i,v[0]],v[1]]})})}}}function kt(n,e,r,u,a){return{contents:function(t){return xn(d(Ze(n,e,r,u).contents,t),function(o){var i=o[0],c=i[3],_=i[2],v=i[1],T=i[0];return K(d(a.contents,o[1]),function(p){return[[T,v,_,c,p[0]],p[1]]})})}}}function Ia(n,e,r,u,a,t){return{contents:function(o){return xn(d(kt(n,e,r,u,a).contents,o),function(i){var c=i[0],_=c[4],v=c[3],T=c[2],p=c[1],J=c[0];return K(d(t.contents,i[1]),function(R){return[[J,p,T,v,_,R[0]],R[1]]})})}}}function Nf(n,e,r,u,a,t,o){return{contents:function(i){return xn(d(Ia(n,e,r,u,a,t).contents,i),function(c){var _=c[0],v=_[5],T=_[4],p=_[3],J=_[2],R=_[1],j=_[0];return K(d(o.contents,c[1]),function(tn){return[[j,R,J,p,T,v,tn[0]],tn[1]]})})}}}function V(n,e){return{contents:function(r){var u=d(n.contents,r);return u!==void 0?[u[0],u[1]]:d(e.contents,r)}}}function We(n){return{contents:function(e){return Ae.firstSomeBy(n,function(r){return d(r.contents,e)})}}}function ya(n,e,r){return G(sn(n,bt(e)),function(u){var a=u[1],t=u[0];return Un(a,[])?t:hn(a,t,r)})}function Je(n,e,r){return ya(n,sn(e,n),function(u,a){return Wo(r,u,a[0],a[1])})}function Re(n){return G(Yn(_t(function(e){return Un(e,{TAG:3,_0:0})}),n,_t(function(e){return Un(e,{TAG:3,_0:1})})),function(e){return e[1]})}function Cr(n){return G(Yn(_t(function(e){return Un(e,{TAG:3,_0:8})}),n,_t(function(e){return Un(e,{TAG:3,_0:9})})),function(e){return e[1]})}function Ff(n,e){var r=function(u,a){var t=d(n.contents,u);if(t===void 0)return[a,u];var o=t[1];return a.push(t[0]),Tn(d(e.contents,o),[a,o],function(i){return r(i[1],a)})};return{contents:function(u){return r(u,[])}}}function de(n){return Ff(n,_t(function(e){return Un(e,{TAG:3,_0:2})}))}function Te(n){return V(G(n,function(e){return N(e)}),{contents:function(e){return[void 0,e]}})}var xa=sn,no={contents:function(n){}},ln={contents:function(n){}},ft={contents:function(n){}},eo={contents:function(n){}},oe={contents:function(n){}},Mr=je(function(n){if(n.TAG===0){var e=n._0;return n._1===32?{TAG:0,_0:{TAG:1,_0:e}}:{TAG:0,_0:{TAG:0,_0:e}}}}),Rf=je(function(n){if(n.TAG===1)return{TAG:0,_0:{TAG:2,_0:n._0}}}),ie=je(function(n){if(n.TAG===4)return n._0}),Yt=je(function(n){if(n.TAG===5)return n._0}),Ur=je(function(n){switch(n.TAG|0){case 4:case 5:return n._0;default:return}}),$f=je(function(n){if(n.TAG===2)return{TAG:0,_0:{TAG:3,_0:n._0}}}),Lf=G(sn(l({TAG:3,_0:0}),l({TAG:3,_0:1})),function(n){return De}),Xf=V(Lf,je(function(n){switch(n.TAG|0){case 4:switch(n._0){case"bool":return qn;case"char":return gr;case"u32":return Wn;case"u8":return Gr;default:return}case 5:return{TAG:2,_0:{TAG:0,_0:n._0}};default:return}})),to=V(Xf,Re(oe));function ro(n){if(n.TAG!==0)return-1;var e=n._0;return typeof e=="number"||e.TAG!==1?-1:e._0}var Cf=V(G(Cr(Yn(oe,l({TAG:3,_0:3}),Mr)),function(n){return ma(n[0],ro(n[2]))}),to),Mf=V(G(Yn(V(Re(de(oe)),G(to,function(n){return[n]})),l({TAG:3,_0:5}),oe),function(n){return Ln(n[0],n[2])}),Cf),Uf=V(G(Ze(Yt,l({TAG:3,_0:18}),de(oe),l({TAG:3,_0:20})),function(n){return{TAG:1,_0:n[0],_1:n[2]}}),Mf);oe.contents=Uf.contents;var Of=G(sn(Ur,Te(sn(l({TAG:3,_0:10}),oe))),function(n){return[n[0],K(n[1],function(e){return e[1]})]}),zf=G(V(ie,Ur),function(n){return{TAG:3,_0:n}}),Vf=G(sn(l({TAG:3,_0:0}),l({TAG:3,_0:1})),function(n){return{TAG:0,_0:0}}),Bf=G(Re(Ze(ln,l({TAG:3,_0:2}),ln,Te(sn(l({TAG:3,_0:2}),de(ln))))),function(n){var e=un([n[0],n[2]],Tn(n[3],[],function(r){return r[1]}));return{TAG:13,_0:e}}),uo=We([Mr,Rf,$f,Vf,zf,Bf,Re(ln)]),ao=V(ya(uo,sn(l({TAG:3,_0:23}),ie),function(n,e){return{TAG:16,_0:n,_1:e[1]}}),uo),oo=V(G(sn(ao,Df(Re(de(ln)))),function(n){return hn(n[1],n[0],function(e,r){return{TAG:7,_0:e,_1:r}})}),ao),Pf=We([G(l({TAG:3,_0:13}),function(n){return 2}),G(l({TAG:3,_0:12}),function(n){return 0}),G(l({TAG:3,_0:22}),function(n){return 1})]),qf=V(G(l({TAG:3,_0:11}),function(n){return 0}),G(l({TAG:3,_0:12}),function(n){return 1})),jf=We([G(l({TAG:3,_0:13}),function(n){return 2}),G(l({TAG:3,_0:14}),function(n){return 3}),G(l({TAG:3,_0:15}),function(n){return 4})]),Zf=We([G(l({TAG:3,_0:25}),function(n){return 11}),G(l({TAG:3,_0:27}),function(n){return 12})]),Wf=We([G(l({TAG:3,_0:24}),function(n){return 13}),G(l({TAG:3,_0:26}),function(n){return 14}),G(xa(l({TAG:3,_0:18}),l({TAG:3,_0:18})),function(n){return 15}),G(xa(l({TAG:3,_0:20}),l({TAG:3,_0:20})),function(n){return 16})]),Jf=We([G(l({TAG:3,_0:18}),function(n){return 5}),G(l({TAG:3,_0:19}),function(n){return 6}),G(l({TAG:3,_0:20}),function(n){return 7}),G(l({TAG:3,_0:21}),function(n){return 8})]),Kf=V(G(l({TAG:3,_0:16}),function(n){return 9}),G(l({TAG:3,_0:17}),function(n){return 10})),Yf=V(G(sn(Pf,oo),function(n){return{TAG:1,_0:n[0],_1:n[1]}}),oo),Hf=Je(Yf,jf,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),Qf=Je(Hf,qf,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),If=Je(Qf,Zf,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),yf=Je(If,Wf,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),xf=Je(yf,Jf,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),ns=Je(xf,Kf,function(n,e,r){return{TAG:2,_0:n,_1:e,_2:r}}),es=V(G(Ze(l({TAG:6,_0:3}),ln,ft,Te(sn(l({TAG:6,_0:4}),ft))),function(n){return{TAG:9,_0:n[1],_1:n[2],_2:K(n[3],function(e){return e[1]})}}),ns),ts=V(G(Yn(l({TAG:6,_0:6}),ln,ft),function(n){return{TAG:10,_0:n[1],_1:n[2]}}),es),rs=V(G(Ia(l({TAG:6,_0:0}),ie,l({TAG:3,_0:4}),ln,l({TAG:6,_0:2}),ln),function(n){return{TAG:6,_0:n[1],_1:n[3],_2:n[5]}}),ts),us=V(Re(de(ie)),G(ie,function(n){return[n]})),as=V(G(Yn(us,l({TAG:3,_0:5}),ln),function(n){return{TAG:5,_0:n[0],_1:n[2]}}),rs),os=kf(ln,function(n){switch(n.TAG|0){case 9:case 10:return[!0,{TAG:1,_0:n}];default:return}});ft.contents=V(G(kt(Te(l({TAG:6,_0:9})),l({TAG:3,_0:6}),bt(V(G(eo,function(n){return[!1,n]}),os)),Te(ln),l({TAG:3,_0:7})),function(n){var e=n[3],r=n[2],u=s(r,function(i){return i[1]}),a=Tn(n[0],0,function(i){return 1}),t=Ve(r,r.length-1|0);if(t===void 0)return{TAG:8,_0:u,_1:e,_2:a};var o=t[1];return o.TAG===0||!(t[0]&&ge(e))?{TAG:8,_0:u,_1:e,_2:a}:{TAG:8,_0:or(u,0,r.length-1|0),_1:o._0,_2:a}}),as).contents;var is=G(Cr(Yn(ln,l({TAG:3,_0:3}),Mr)),function(n){return{TAG:15,_0:{TAG:0,_0:n[0],_1:ro(n[2])}}}),cs=G(Cr(de(ln)),function(n){return{TAG:15,_0:{TAG:1,_0:n}}}),_s=V(V(is,cs),ft),fs=V(G(Ze(Yt,l({TAG:3,_0:6}),de(Yn(ie,l({TAG:3,_0:10}),ln)),l({TAG:3,_0:7})),function(n){return{TAG:14,_0:n[0],_1:s(n[2],function(e){return[e[0],e[2]]})}}),_s),ss=We([G(l({TAG:3,_0:4}),function(n){return"eq"}),G(l({TAG:3,_0:28}),function(n){return"plusEq"}),G(l({TAG:3,_0:29}),function(n){return"minusEq"}),G(l({TAG:3,_0:30}),function(n){return"starEq"}),G(l({TAG:3,_0:31}),function(n){return"divEq"}),G(l({TAG:3,_0:32}),function(n){return"modEq"})]),ls=Je(fs,ss,function(n,e,r){return e==="minusEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:1,_2:r}}:e==="divEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:3,_2:r}}:e==="eq"?{TAG:4,_0:n,_1:r}:e==="starEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:2,_2:r}}:e==="modEq"?{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:4,_2:r}}:{TAG:4,_0:n,_1:{TAG:2,_0:n,_1:0,_2:r}}}),vs=V(G(sn(l({TAG:6,_0:7}),Te(ln)),function(n){return{TAG:11,_0:n[1]}}),ls),ds=G(sn(vs,Te(sn(l({TAG:6,_0:8}),oe))),function(n){var e=n[1],r=n[0];return e!==void 0?{TAG:12,_0:r,_1:e[1]}:r});ln.contents=ds.contents;var Ts=G(sn(ln,l({TAG:3,_0:3})),function(n){return{TAG:1,_0:n[0]}}),Gs=V(G(kt(V(l({TAG:6,_0:0}),l({TAG:6,_0:1})),Of,l({TAG:3,_0:4}),ln,l({TAG:3,_0:3})),function(n){var e=n[1];return{TAG:0,_0:e[0],_1:Un(n[0],{TAG:6,_0:1}),_2:n[3],_3:e[1]}}),Ts);eo.contents=Gs.contents;var gs=G(kt(V(l({TAG:6,_0:0}),l({TAG:6,_0:1})),Ur,l({TAG:3,_0:4}),ln,l({TAG:3,_0:3})),function(n){return{TAG:1,_0:n[1],_1:Un(n[0],{TAG:6,_0:1}),_2:n[3]}}),hs=V(G(kt(l({TAG:6,_0:10}),Yt,l({TAG:3,_0:6}),de(Yn(sn(Te(l({TAG:6,_0:1})),ie),l({TAG:3,_0:10}),oe)),l({TAG:3,_0:7})),function(n){var e=s(n[3],function(r){var u=r[0];return[u[1],r[2],Ut(u[0])]});return{TAG:2,_0:n[1],_1:e}}),gs),io=V(G(Ze(l({TAG:6,_0:5}),ie,G(Re(de(sn(Te(l({TAG:6,_0:1})),ie))),function(n){return s(n,function(e){return[e[1],Ut(e[0])]})}),ft),function(n){return{TAG:0,_0:n[1],_1:n[2],_2:n[3]}}),hs),Es=V(G(Nf(l({TAG:6,_0:12}),l({TAG:6,_0:5}),ie,Re(G(de(Ze(Te(l({TAG:6,_0:1})),ie,l({TAG:3,_0:10}),oe)),function(n){return s(n,function(e){return[e[1],e[3],Ut(e[0])]})})),l({TAG:3,_0:5}),oe,l({TAG:3,_0:3})),function(n){return{TAG:4,name:n[2],args:n[3],ret:n[5]}}),io),As=V(G(Yn(l({TAG:6,_0:11}),Yt,G(Yn(l({TAG:3,_0:6}),bt(io),l({TAG:3,_0:7})),function(n){return n[1]})),function(n){return{TAG:3,_0:n[1],_1:n[2]}}),Es);no.contents=As.contents;var ws=bt(no);function Ht(n){var e=n.replace(/(\/\/[^\n]*)/g,""),r=mf(X_(e));if(r===void 0)return{TAG:1,_0:"could not tokenize"};var u=d(ws.contents,qa(r[0]));if(u===void 0)return{TAG:1,_0:"could not parse"};var a=u[1];if(Rr(a))return{TAG:0,_0:u[0]};var t=m(or(C_(a),0,5)," ",bf);return{TAG:1,_0:"could not parse near "+t}}function ms(n,e){var r=n!==void 0?n:100,u={contents:e.length},a=function(t,o,i){for(;;){var c=i,_=o,v=t;if(v){var T=v.hd,p=0;if(typeof T=="number")switch(T){case 2:var J=v.tl;if(J&&J.hd===3){t={hd:2,tl:J.tl};continue}break;case 9:var R=v.tl;if(R&&R.hd===9){t=R.tl;continue}break;case 10:var j=v.tl;if(j&&j.hd===9){t={hd:14,tl:j.tl};continue}break;case 14:var tn=v.tl;if(tn&&tn.hd===9){t={hd:10,tl:tn.tl};continue}break;case 18:var dn=v.tl;if(dn&&dn.hd===9){t={hd:36,tl:dn.tl};continue}break;case 19:var Rn=v.tl;if(Rn&&Rn.hd===9){t={hd:37,tl:Rn.tl};continue}break;case 24:var wn=v.tl;if(wn&&wn.hd===9){t={hd:30,tl:wn.tl};continue}break;case 25:var pn=v.tl;if(pn&&pn.hd===9){t={hd:31,tl:pn.tl};continue}break;case 30:var bn=v.tl;if(bn&&bn.hd===9){t={hd:24,tl:bn.tl};continue}break;case 31:var mn=v.tl;if(mn&&mn.hd===9){t={hd:25,tl:mn.tl};continue}break;case 36:var gn=v.tl;if(gn&&gn.hd===9){t={hd:18,tl:gn.tl};continue}break;case 37:var on=v.tl;if(on&&on.hd===9){t={hd:19,tl:on.tl};continue}break}else switch(T.TAG|0){case 0:var C=T._0,Vn=0,Sn=v.tl;if(Sn){var kn=Sn.hd;if(typeof kn=="number")switch(kn){case 3:t=Sn.tl;continue;case 6:if(wa.isPowerOf2(C)){t={hd:{TAG:0,_0:Math.log2(C)|0},tl:{hd:46,tl:Sn.tl}};continue}break;case 7:if(wa.isPowerOf2(C)){t={hd:{TAG:0,_0:Math.log2(C)|0},tl:{hd:48,tl:Sn.tl}};continue}break;default:Vn=3}else switch(kn.TAG|0){case 0:var rn=Sn.tl;if(rn){var Dn=rn.hd;if(typeof Dn=="number"){var $n=kn._0;if(Dn>=15){if(Dn>=43)switch(Dn){case 43:t={hd:{TAG:0,_0:Jo(C,$n)},tl:rn.tl};continue;case 46:t={hd:{TAG:0,_0:C<<$n},tl:rn.tl};continue;case 44:case 45:case 47:break;case 48:t={hd:{TAG:0,_0:C>>>$n|0},tl:rn.tl};continue}}else switch(Dn){case 4:t={hd:{TAG:0,_0:C+$n|0},tl:rn.tl};continue;case 5:t={hd:{TAG:0,_0:C-$n|0},tl:rn.tl};continue;case 6:t={hd:{TAG:0,_0:Math.imul(C,$n)},tl:rn.tl};continue;case 7:t={hd:{TAG:0,_0:Ko(C,$n)},tl:rn.tl};continue;case 10:t={hd:{TAG:0,_0:C===$n?1:0},tl:rn.tl};continue;case 0:case 1:case 2:case 3:case 8:case 9:case 11:case 12:case 13:break;case 14:t={hd:{TAG:0,_0:C===$n?0:1},tl:rn.tl};continue}}}break;case 15:t={hd:{TAG:14,_0:C},tl:Sn.tl};continue;default:Vn=3}}if(Vn===3&&C===0){var _e=v.tl,Hn=_e.hd;if(typeof Hn=="number"){if(Hn>=46){if(Hn!==47){t=_e.tl;continue}}else if(Hn===10){t={hd:9,tl:_e.tl};continue}}}break;case 1:case 2:case 3:case 9:case 11:p=2;break;case 12:var Qn=v.tl;if(Qn){var Le=Qn.hd;if(typeof Le!="number"&&Le.TAG===11){var fe=T._0;if(fe===Le._0){t={hd:{TAG:13,_0:fe},tl:Qn.tl};continue}}}break;case 13:var se=v.tl;if(se&&se.hd===3){t={hd:{TAG:12,_0:T._0},tl:se.tl};continue}break}if(p===2){var Ge=v.tl;if(Ge&&Ge.hd===3){t=Ge.tl;continue}}o={hd:T,tl:_},t=v.tl;continue}var In=Qr(_),yn=Yo(In);if(!(c>1&&yn<u.contents))return In;u.contents=yn,i=c-1|0,o=0,t=In}};return r>0?tt(a(Et(e),0,r)):e}function Or(n,e){switch(e.TAG|0){case 0:return n===e._0;case 1:return fr(e._1,function(u){return Or(n,u)});case 2:var r=e._0;return r.TAG===0?!1:fr(jn.toArray(r._0),function(u){return Or(n,u[1])})}}function co(n,e,r){if(Or(n,e))return{TAG:1,_0:b({TAG:0,_0:n})+" occurs in "+b(e)};var u=ru(r,n);return u!==void 0?Un(u,e)?{TAG:0,_0:r}:{TAG:1,_0:b(e)+" is not unifiable with "+b(u)}:{TAG:0,_0:_u(r,n,e)}}function st(n,e){for(;;){var r=n;if(!r)return{TAG:0,_0:e};var u=r.tl,a=r.hd,t=a[1],o=a[0],i=0;switch(o.TAG|0){case 0:var c=o._0,_=0;switch(t.TAG|0){case 0:if(c===t._0){n=u;continue}_=3;break;case 1:case 2:_=3;break}if(_===3)return F(co(c,t,e),function(on){return function(C){return st(on,C)}}(u));break;case 1:var v=o._1;switch(t.TAG|0){case 0:i=1;break;case 1:var T=t._1;if(o._0===t._0&&v.length===T.length){var p=hn(Be(v,T),u,function(on,C){return{hd:[A(e,C[0]),A(e,C[1])],tl:on}});n=p;continue}i=2;break;case 2:i=2;break}break;case 2:var J=o._0;switch(t.TAG|0){case 0:i=1;break;case 1:i=2;break;case 2:var R=t._0;if(J.TAG===0){var j=J._0;if(R.TAG===0){if(j!==R._0)return{TAG:1,_0:"cannot unify "+b(o)+" with "+b(t)};n=u;continue}var tn=Kn(j);if(tn===void 0)return{TAG:1,_0:'undeclared struct "'+j+'"'};var dn=st({hd:[{TAG:2,_0:{TAG:1,_0:R._0}},Sr(tn,we())],tl:u},e);return dn.TAG===0?{TAG:0,_0:dn._0}:{TAG:1,_0:"struct type "+b(t)+" does not match "+j+": "+dn._0}}var Rn=J._0;if(R.TAG===0){var wn=R._0,pn=Kn(wn);if(pn===void 0)return{TAG:1,_0:'undeclared struct "'+wn+'"'};var bn=st({hd:[{TAG:2,_0:{TAG:1,_0:Rn}},Sr(pn,we())],tl:u},e);return bn.TAG===0?{TAG:0,_0:bn._0}:{TAG:1,_0:"struct type "+b(o)+" does not match "+wn+": "+bn._0}}var mn=jn.toMap(R._0),gn=jn.toArray(Rn);return F(Ae.mapResult(s(gn,function(on,C,Vn){return function(Sn){var kn=Sn[0],rn=ar(Vn,kn);return rn!==void 0?{TAG:0,_0:[Sn[1],rn]}:{TAG:1,_0:"struct type "+b(C)+' is missing attribute "'+kn+'" from type "'+b(on)+'"'}}}(o,t,mn)),function(on){return on}),function(on,C,Vn,Sn){return function(kn){var rn={TAG:2,_0:{TAG:1,_0:jn.fromArray(nu(Ho(Vn,s(Sn,function(Dn){return Dn[0]}))),we())}};return st(Qo(Et(kn),{hd:[jn.tail(C),rn],tl:on}),e)}}(u,Rn,mn,gn))}break}switch(i){case 1:return F(co(t._0,o,e),function(on){return function(C){return st(on,C)}}(u));case 2:return{TAG:1,_0:b(o)+" is not unifiable with "+b(t)}}}}function an(n,e){return st({hd:[n,e],tl:0},void 0)}function Ss(n,e){return Io(an(n,e))}function ps(n,e){return"cannot infer struct type: inferred type "+jn.show(n,b)+" matches "+m(e,", ",function(r){return r.name})}function zr(n){var e=yo(fu(Jn.structs),function(a){return xo(an({TAG:2,_0:{TAG:1,_0:n}},Sr(a,we())),void 0,function(t){return a})}),r=e.length;if(r!==1)return r!==0?{TAG:1,_0:e}:0;var u=e[0];return{TAG:0,_0:u}}function bs(n){var e;if(typeof n=="number")e=De;else switch(n.TAG|0){case 0:e=Gr;break;case 1:e=Wn;break;case 2:e=qn;break;case 3:e=gr;break}return ot(e)}function ks(n){var e=0;if(n>=5)switch(n){case 5:case 6:case 7:case 8:e=2;break;case 9:case 10:e=3;break;case 11:case 12:return ot(Ln([qn,qn],qn));case 13:case 14:case 15:case 16:e=1;break}else e=1;switch(e){case 1:return ot(Ln([Wn,Wn],Wn));case 2:return ot(Ln([Wn,Wn],qn));case 3:return[[0],Ln([{TAG:0,_0:0},{TAG:0,_0:0}],qn)]}}function Ds(n){switch(n){case 0:return ot(Ln([Wn],Wn));case 1:return ot(Ln([qn],qn));case 2:return[[0],Ln([__({TAG:0,_0:0})],{TAG:0,_0:0})]}}var lt=Ot();function _o(n,e,r,u,a){var t=Xn.typeOf(r);pe(lt,t);var o=hn(e,n,function(_,v){return zn.addMono(_,v.contents.name,v.contents.ty)}),i=Ln(s(e,function(_){return _.contents.ty}),t),c=a!==void 0?zn.addMono(o,a,i):o;return F(An(c,r,t),function(_){var v=A(_,i),T=A(_,u),p=Gn(_,n),J=wr(p,v);return I(an(T,v),function(R){At(lt);var j=U(R,_);return[j,A(R,T),Fa(R,J)]})})}function An(n,e,r){return F(ce(n,e),function(u){return I(an(A(u,r),A(u,Xn.typeOf(e))),function(a){return U(a,u)})})}function ce(n,e){switch(e.TAG|0){case 0:var r=Wt(bs(e._0));return an(Xn.typeOf(e),r);case 1:var u=e._3,a=e._2,t=e._1,o=e._0;return F(ce(n,t),function(f){var w=Gn(f,n);return F(ce(w,u),function(S){var k=U(S,f),M=A(k,Ln([Xn.typeOf(t),Xn.typeOf(u)],o)),z=Wt(ks(a));return I(an(M,z),function(Q){return U(Q,k)})})});case 2:var i=e._2,c=e._1,_=e._0,v=Xn.typeOf(i);return F(ce(n,i),function(f){var w=A(f,Ln([v],_)),S=Wt(Ds(c));return I(an(w,S),function(k){return U(k,f)})});case 3:var T=e._0.contents,p=zn.get(n,T.name);if(p!==void 0)return an(T.ty,Wt(p));var J=Kn(T.name);if(J===void 0)return{TAG:1,_0:'unbound variable: "'+T.name+'"'};var R={TAG:2,_0:{TAG:1,_0:jn.fromArray(s(J.staticFuncs,function(f){var w=f.name;return[w.contents.name,w.contents.ty]}),we())}};return an(T.ty,R);case 4:var j=e._1,tn=e._0,dn=fn.typeOfExpr(tn),Rn=fn.typeOfExpr(j);return F(ce(n,j),function(f){var w=Gn(f,n),S=A(f,dn);return F(An(w,tn,S),function(k){var M=U(k,f),z=A(k,S),Q=A(M,Rn);return I(an(z,Q),function(x){return U(x,M)})})});case 5:return I(_o(n,e._1,e._2,e._0,void 0),function(f){return f[0]});case 6:var wn=e._4,pn=e._3,bn=e._0,mn=e._2.contents,gn=Xn.typeOf(pn);return F(ce(n,pn),function(f){var w=Gn(f,n),S=A(f,gn),k=A(f,bn),M=wr(zn.remove(w,mn.name),S),z=zn.add(w,mn.name,M);return F(An(z,wn,k),function(Q){var x=U(Q,f);return I(an(A(x,gn),A(x,mn.ty)),function(Nn){return U(Nn,x)})})});case 7:var on=e._4,C=e._3,Vn=e._2,Sn=e._0,kn=e._1.contents,rn=Xn.typeOf(C);pe(lt,rn);var Dn=Ln(s(Vn,function(f){return f.contents.ty}),rn),$n=hn(Vn,n,function(f,w){return zn.addMono(f,w.contents.name,w.contents.ty)}),_e=zn.addMono($n,kn.name,Dn);return F(An(_e,C,rn),function(f){var w=Gn(f,_e),S=A(f,Dn),k=A(f,Sn),M=zn.add(w,kn.name,wr(w,S));return F(An(M,on,k),function(z){var Q=U(z,f);return I(an(kn.ty,A(z,S)),function(x){return At(lt),U(x,Q)})})});case 8:var Hn=e._2,Qn=s(Hn,Xn.typeOf),Le=Ln(Qn,e._0);return I(F(An(n,e._1,Le),function(f){return hn(Be(Hn,Qn),{TAG:0,_0:[f,Gn(f,n)]},function(w,S){var k=S[1],M=S[0];return F(w,function(z){var Q=z[1],x=z[0],Nn=A(x,k);return I(An(Q,M,Nn),function(Zn){return[U(Zn,x),Gn(Zn,Q)]})})})}),function(f){return f[0]});case 9:var fe=e._2,se=e._0;return F(hn(e._1,{TAG:0,_0:[void 0,n]},function(f,w){return F(f,function(S){var k=S[1],M=S[0];return I(Ns(k,w),function(z){return[U(z,M),Gn(z,k)]})})}),function(f){var w=f[0];return fe!==void 0?F(ce(Gn(w,n),fe),function(S){var k=Xn.typeOf(fe),M=U(S,w);return I(an(A(M,se),A(M,k)),function(z){return U(z,M)})}):I(an(A(w,se),De),function(S){return U(S,w)})});case 10:var Ge=e._3,In=e._2,yn=e._0;return F(An(n,e._1,qn),function(f){var w=Gn(f,n),S=A(f,yn);return F(An(w,In,S),function(k){var M=Gn(k,w),z=A(k,S),Q=U(k,f);return I(An(M,Ge,z),function(x){return U(x,Q)})})});case 11:var He=e._1,er=Xn.typeOf(He);return F(ce(n,e._0),function(f){var w=A(f,er),S=Gn(f,n);return I(An(S,He,w),function(k){return U(k,f)})});case 12:var Qe=be(lt);return Qe!==void 0?An(n,Tn(e._0,{TAG:0,_0:0},function(f){return f}),Qe):{TAG:1,_0:"'return' used outside of a function"};case 13:return An(n,e._0,e._1);case 14:var Nt=hn(e._0,{TAG:0,_0:[Pe,n]},function(f,w){return F(f,function(S){var k=S[1],M=S[0];return F(ce(k,w),function(z){var Q=U(z,M),x=Gn(z,k);return{TAG:0,_0:[Q,x]}})})});return I(Nt,function(f){return f[0]});case 15:var vt=e._1,Xe=e._0,Ie=Kn(Xe);if(Ie===void 0)return{TAG:1,_0:'undeclared struct "'+Xe+'"'};var ye=Ie.attributes,Ft=hn(Ct(ye,function(f){return ge(f.impl)}),{TAG:0,_0:[n,Pe]},function(f,w){var S=w.ty,k=w.name;return F(f,function(M){var z=M[1],Q=M[0],x=Mt(vt,function(Nn){return Nn[0]===k});return x!==void 0?F(An(Q,x[1],S),function(Nn){var Zn=Gn(Nn,Q),nt=U(Nn,z);return{TAG:0,_0:[Zn,nt]}}):{TAG:1,_0:'missing attribute "'+k+'" for struct "'+Xe+'"'}})}),dt=Ae.firstSomeBy(vt,function(f){var w=f[0];if(!fr(ye,function(S){return S.name===w}))return w});return dt!==void 0?{TAG:1,_0:'extraneous attribute: "'+dt+'" for struct "'+Xe+'"'}:I(Ft,function(f){return f[1]});case 16:var Ce=e._1,tr=e._0,xe=pt(),$;if(Ce.TAG===0)$=An(n,Ce._0,xe);else{var H=hn(Ce._0,{TAG:0,_0:[Pe,n]},function(f,w){return F(f,function(S){var k=S[1],M=S[0],z=A(M,xe);return F(An(k,w,z),function(Q){var x=U(Q,M),Nn=Gn(Q,k);return{TAG:0,_0:[x,Nn]}})})});$=I(H,function(f){return f[0]})}var Rt=d(fn.ArrayInit.len,Ce);return F($,function(f){return I(an(tr,ma(xe,Rt)),function(w){return U(w,f)})});case 17:var Me=e._2,Tt=e._1,Ue=e._0;return F(ce(n,Tt),function(f){var w=fn.typeOfExpr(Tt),S=A(f,w),k=function(D){return su(S,A(D,w))?An(Gn(D,n),e,A(D,Ue)):{TAG:0,_0:D}};switch(S.TAG|0){case 0:case 1:break;case 2:var M=S._0;if(M.TAG===0){var z=M._0,Q=Kn(z);if(Q===void 0)return{TAG:1,_0:'undeclared struct: "'+z+'"'};var x=Mt(Q.attributes,function(D){return D.name===Me});if(x===void 0)return{TAG:1,_0:'attribute "'+Me+'" does not exist on struct "'+z+'"'};var Nn=Tn(x.impl,x.ty,function(D){return D[0].contents.ty});return I(an(A(f,Ue),A(f,Nn)),function(D){return U(D,f)})}var Zn=M._0,nt=ar(jn.toMap(Zn),Me);if(nt!==void 0)return I(an(A(f,Ue),A(f,nt)),function(D){return U(D,f)});var $t=jn.insert(Zn,Me,Ue),Oe=A(f,{TAG:2,_0:{TAG:1,_0:$t}}),ze=zr($t);if(typeof ze!="number")return ze.TAG===0?F(an(S,{TAG:2,_0:{TAG:0,_0:ze._0.name}}),function(D){return k(U(D,f))}):F(an(S,Oe),function(D){return k(U(D,f))});var et=0;switch(w.TAG|0){case 0:return{TAG:0,_0:U(_u(Pe,w._0,Oe),f)};case 1:case 2:et=2;break}if(et===2)return I(an(w,Oe),function(D){return U(D,f)});break}var Lt=we(),Gt=jn.insert(jn.make({TAG:0,_0:Lt}),Me,Ue),gt=A(f,{TAG:2,_0:{TAG:1,_0:Gt}}),O=zr(Gt);return typeof O=="number"?{TAG:1,_0:"no struct declaration matches type "+b(gt)}:O.TAG===0?F(an(S,{TAG:2,_0:{TAG:0,_0:O._0.name}}),function(D){return k(U(D,f))}):F(an(S,gt),function(D){return k(U(D,f))})})}}function Ns(n,e){return ce(n,e._0)}function Vr(n,e){return n+"_"+e}function fo(n,e){switch(e.TAG|0){case 0:var r=e._0.contents;return I(_o(n,s(e._1,function(c){return c[0]}),e._2,r.ty,r.newName),function(c){var _=c[0];return[Gn(_,zn.addMono(n,r.name,r.ty)),_]});case 1:var u=e._0;return I(An(n,e._2,u.contents.ty),function(c){return[Gn(c,zn.addMono(n,u.contents.name,u.contents.ty)),c]});case 2:return{TAG:0,_0:[n,Pe]};case 3:var a=e._0,t=Kn(a);return t!==void 0?hn(e._1,{TAG:0,_0:[n,Pe]},function(c,_){var v=_[2],T=_[1],p=_[0];return F(c,function(J){var R=J[1],j=J[0];p.contents.newName=Vr(a,p.contents.name);var tn=Tn(Ve(T,0),[!1,!1],function(gn){return gn[0].contents.name==="self"?[!0,gn[1]]:[!1,!1]}),dn;if(tn[0]){b_(t,p,tn[1]);var Rn=Un(T,[])?[]:ei(T,1),wn={TAG:2,_0:{TAG:0,_0:a}},pn=Ve(T,0),bn;if(pn!==void 0){var mn=pn[0];mn.contents.ty=wn,bn=zn.addMono(j,mn.contents.name,wn)}else bn=j;dn=[bn,Rn]}else k_(t,p),dn=[n,T];return F(fo(dn[0],{TAG:0,_0:p,_1:dn[1],_2:v}),function(gn){var on=U(gn[1],R);$a(on,p);var C=zn.remove(gn[0],p.contents.name);return{TAG:0,_0:[C,on]}})})}):{TAG:1,_0:'cannot implement for unknown type "'+a+'"'};case 4:var o=e.name,i=Ln(s(e.args,function(c){return c[0].contents.ty}),e.ret);return I(an(o.contents.ty,i),function(c){return[Gn(c,zn.addMono(n,o.contents.name,o.contents.ty)),c]})}}function so(n){return ni(lt),hn(n,{TAG:0,_0:[zn.empty,Pe]},function(e,r){return F(e,function(u){var a=u[1];return I(fo(u[0],r),function(t){return[t[0],U(t[1],a)]})})})}var me=En("CompilerExn.InvalidTypeConversion"),Br=En("CompilerExn.InvalidFunctionSignature"),Qt=En("CompilerExn.VariableNotFound"),lo=En("CompilerExn.EmptyFunctionStack"),Ke=En("CompilerExn.CannotReassignImmutableValue"),vo=En("CompilerExn.FunctionNotFound"),$e=En("CompilerExn.Unimplemented"),Fs=En("CompilerExn.UnsupportedGlobalInitializer"),vn=En("CompilerExn.InvalidTypeAssertion"),To=En("CompilerExn.DerefUsedOutsideOfUnsafeBlock"),It=En("CompilerExn.InvalidAttributeAccess");function Dt(n){return n.RE_EXN_ID===me?"unsupported type: "+b(n._1):n.RE_EXN_ID===Br?"invalid function signature: "+b(n._1):n.RE_EXN_ID===Qt?'variable "'+n._1+'" not found':n.RE_EXN_ID===lo?"Function stack is empty":n.RE_EXN_ID===Ke?'cannot mutate "'+n._1+'" as it is behind an immutable binding':n.RE_EXN_ID===vo?'no function named "'+n._1+'" found':n.RE_EXN_ID===$e?"unimplemented: "+n._1:n.RE_EXN_ID===Fs?"unsupported global initializer: "+Xn.show(void 0,n._1):n.RE_EXN_ID===vn?"invalid type assertion from "+b(n._1)+" to "+b(n._2):n.RE_EXN_ID===To?"the deref operator can only be used in an unsafe block":n.RE_EXN_ID===ue.UnkownTypeSize?"unknown type size: "+b(n._1):n.RE_EXN_ID===pr?'undeclared struct "'+n._1+'"':n.RE_EXN_ID===It?n._1+' does not exist for type "'+b(n._2)+'"':n.RE_EXN_ID===br?"No struct declaration matches type "+b(n._1):n.RE_EXN_ID===Ra?ps(n._1,n._2):n.RE_EXN_ID===fn.UndeclaredIdentifer?'identifier "'+n._1+'" not found':n.RE_EXN_ID===fn.UnexpectedDeclarationInImplBlock?"unexpected declaration in impl block: "+Fe.show(void 0,n._1):n.RE_EXN_ID===fn.UnreachableLetStmt?"unreachable: let statement found in Core.fromStmt":(console.log(n),"unexpected compiler exception")}function Rs(n,e,r,u){return{name:n,depth:e,ty:r,isMutable:u}}function Pr(n){if(n.TAG===0){var e=n._0,r=Kn(e);if(r!==void 0)return r;throw{RE_EXN_ID:pr,_1:e,Error:new Error}}var u=n._0,a=zr(u);if(typeof a=="number")throw{RE_EXN_ID:br,_1:{TAG:2,_0:n},Error:new Error};if(a.TAG===0)return a._0;throw{RE_EXN_ID:Ra,_1:u,_2:a._0,Error:new Error}}function Ye(n){switch(n.TAG|0){case 0:throw{RE_EXN_ID:me,_1:n,Error:new Error};case 1:switch(n._0){case"()":if(n._1.length!==0)throw{RE_EXN_ID:me,_1:n,Error:new Error};return[];case"Array":var e=n._1;if(e.length!==2)throw{RE_EXN_ID:me,_1:n,Error:new Error};var r=e[1];switch(r.TAG|0){case 1:if(r._1.length!==0)throw{RE_EXN_ID:me,_1:n,Error:new Error};return[0];case 0:case 2:throw{RE_EXN_ID:me,_1:n,Error:new Error}}case"Fun":case"Ptr":return[0];case"Tuple":return cn(s(n._1,Ye));case"u64":if(n._1.length!==0)throw{RE_EXN_ID:me,_1:n,Error:new Error};return[1];case"bool":case"char":case"u32":case"u8":break;default:throw{RE_EXN_ID:me,_1:n,Error:new Error}}if(n._1.length!==0)throw{RE_EXN_ID:me,_1:n,Error:new Error};return[0];case 2:var u=Pr(n._0);return u.size===0?[]:[0]}}function $s(n,e){switch(e.TAG|0){case 1:if(e._0==="Tuple"){var r=cn(s(e._1,Ye)),u=[],a={_0:u,_1:r},t=Pn.getOrAddSignature(n,a);return{TAG:1,_0:t,_1:[[],r]}}break}var o=Ye(e),i=o.length;if(i!==1){if(i===0)return 0;throw{RE_EXN_ID:$e,_1:"wasmBlockReturnTypeOf for "+b(e),Error:new Error}}var c=o[0];return{TAG:0,_0:c}}function qr(n){switch(n.TAG|0){case 1:if(n._0==="Fun"){var e=n._1,r=e.slice(0,e.length-1|0),u=Ve(e,e.length-1|0);return lu(mt.Signature.make,cn(s(r,Ye)),Tn(u,[],Ye))}throw{RE_EXN_ID:Br,_1:n,Error:new Error};case 0:case 2:throw{RE_EXN_ID:Br,_1:n,Error:new Error}}}function jr(n,e,r){return{name:n,locals:[],params:Ct(e,function(u){return!ue.isZeroSizedType(u[1])}),ret:r,instructions:[]}}function E(n,e){n.instructions.push(e)}function Ls(n,e,r,u,a){return n.locals.push(Rs(e,u,r,a)),(n.params.length+n.locals.length|0)-1|0}function Xs(n,e){var r=ur(n.params,function(t){return t[0]===e});if(r!==void 0){var u=he(n.params,r);return[r,u[2]]}var a=Ae.getReverseIndexBy(n.locals,function(t){return t.name===e});if(a!==void 0)return[n.params.length+a|0,he(n.locals,a).isMutable]}function Cs(n){var e=qr(Ln(s(n.params,function(a){return a[1]}),n.ret)),r=d(mt.Local.fromTypes,cn(s(n.locals,function(a){return s(Ye(a.ty),function(t){return[a.name,t]})}))),u=lu(mt.Body.make,r,ms(void 0,n.instructions));return mt.make(n.name,e,u)}function Go(n,e,r,u,a){return{name:n,mutability:e,ty:r,index:u,init:a}}function Ms(n){var e=n.init,r=n.mutability;return K(n.ty,function(u){return St.make(r!==2,u,e)})}function h(n){var e=be(n.funcStack);if(e!==void 0)return e;throw{RE_EXN_ID:lo,Error:new Error}}function Zr(n,e){return K(Ae.getValueAndIndexBy(n.funcs,function(r){return r.name===e}),function(r){var u=n.externFuncs.length;return[r[0],u+r[1]|0]})}function Us(n,e){return Ae.getValueAndIndexBy(n.externFuncs,function(r){return r.name===e})}function Wr(n){switch(n.TAG|0){case 0:return 0;case 1:switch(n._0){case"Array":var e=n._1;if(e.length!==2)return 0;var r=e[0],u=e[1];switch(u.TAG|0){case 1:return u._1.length!==0?0:Math.imul(cu(u._0),ue.size(r));case 0:case 2:return 0}case"Tuple":return hn(s(n._1,Wr),0,function(i,c){return i+c|0});default:return 0}case 2:var a=n._0;if(a.TAG===0){var t=a._0,o=Kn(t);if(o!==void 0)return o.size;throw{RE_EXN_ID:pr,_1:t,Error:new Error}}throw{RE_EXN_ID:br,_1:n,Error:new Error}}}function go(n,e){var r=be(n.blockStack);if(r!==void 0&&!(e<=0)){var u=r.shadowStackDelta;return u.contents=u.contents+e|0,E(h(n),{TAG:9,_0:n.stackTop.index}),E(h(n),{TAG:0,_0:e}),E(h(n),5),E(h(n),{TAG:10,_0:n.stackTop.index})}}function Os(n,e){var r=be(n.blockStack);if(r!==void 0&&!(e<=0)){var u=r.shadowStackDelta;return u.contents=u.contents-e|0,E(h(n),{TAG:9,_0:n.stackTop.index}),E(h(n),{TAG:0,_0:e}),E(h(n),4),E(h(n),{TAG:10,_0:n.stackTop.index})}}function ho(n){var e=be(n.blockStack);return e!==void 0?e.isUnsafe:!1}function Eo(n,e){return n.scopeDepth=n.scopeDepth+1|0,pe(n.blockStack,{isUnsafe:e||ho(n),shadowStackDelta:{contents:0}})}function zs(n){n.scopeDepth=n.scopeDepth-1|0,Os(n,Tn(be(n.blockStack),0,function(e){return e.shadowStackDelta.contents})),At(n.blockStack)}function Jr(n,e,r,u){var a=h(n),t=Ls(a,e,r,n.scopeDepth,u);return E(h(n),{TAG:12,_0:t}),t}function Ao(n,e,r,u,a){var t=ai(n.globals),o=Go(e,r,u,t,a);return cr(n.globals,e,o),t}function Vs(n,e){var r=h(n);return K(Xs(r,e),function(u){return{index:u[0],isMutable:u[1]}})}function yt(n,e){var r=Vs(n,e);return r!==void 0?{TAG:0,_0:r.index,_1:r.isMutable}:K(au(n.globals,e),function(u){return{TAG:1,_0:u.index,_1:u.mutability===1}})}function Bs(n){if(typeof n!="number")switch(n.TAG|0){case 0:return{TAG:0,_0:n._0&255};case 1:return{TAG:0,_0:n._0&-1};case 2:return{TAG:0,_0:n._0?1:0};case 3:return{TAG:0,_0:n._0}}}function wo(n){if(!ho(n))throw{RE_EXN_ID:To,Error:new Error}}function xt(n,e,r){switch(e.TAG|0){case 0:case 1:return{TAG:1,_0:{RE_EXN_ID:It,_1:r,_2:e}};case 2:var u=Pr(e._0),a=Mt(u.attributes,function(i){return i.name===r});if(a===void 0)return{TAG:1,_0:{RE_EXN_ID:It,_1:r,_2:e}};var t=a.impl;if(t===void 0)return{TAG:0,_0:{TAG:0,_0:{offset:a.offset,ty:a.ty,size:a.size,mut:a.mut}}};var o=Zr(n,Vr(u.name,t[0].contents.name));return o!==void 0?{TAG:0,_0:{TAG:1,_0:[o[0],o[1],t[1]]}}:{TAG:1,_0:{RE_EXN_ID:It,_1:r,_2:e}}}}function mo(n){return ae(void 0,"$lambda"+String(n.funcs.length))}function So(n,e){var r=n!==void 0?n:"",u=h(e);return"$"+r+"_local"+String(u.locals.length)}function nr(n,e){for(;;){var r=e;switch(r.TAG|0){case 3:var u=r._0,a=yt(n,u.contents.newName);if(a!==void 0)return a._1?void 0:u.contents.name;throw{RE_EXN_ID:Qt,_1:u.contents.name,Error:new Error};case 17:var t=r._2,o=r._1,i=xt(n,fn.typeOfExpr(o),t);if(i.TAG===0){var c=i._0;if(c.TAG!==0)return;if(!c._0.mut)return t;e=o;continue}throw i._0;default:return}}}function en(n,e){for(;;){var r=e;switch(r.TAG|0){case 0:var u=Bs(r._0);return u!==void 0?E(h(n),u):void 0;case 1:var a=r._3,t=r._2,o=r._1;if(ue.isZeroSizedType(fn.typeOfExpr(o))){e={TAG:0,_0:{TAG:2,_0:t===9}};continue}var i=function(O,D){return function(Mn){return en(n,O),en(n,D),E(h(n),Mn)}}(o,a);switch(t){case 0:return i(4);case 1:return i(5);case 2:return i(6);case 3:return i(7);case 4:return i(43);case 5:return i(31);case 6:return i(19);case 7:return i(37);case 8:return i(25);case 9:return i(10);case 10:return i(14);case 11:e={TAG:10,_0:qn,_1:o,_2:a,_3:{TAG:0,_0:{TAG:2,_0:!1}}};continue;case 12:e={TAG:10,_0:qn,_1:o,_2:{TAG:0,_0:{TAG:2,_0:!0}},_3:a};continue;case 13:return i(44);case 14:return i(45);case 15:return i(46);case 16:return i(48)}case 2:var c;switch(r._1){case 0:throw{RE_EXN_ID:$e,_1:"u32 negation is not handled",Error:new Error};case 1:c=9;break;case 2:wo(n),c={TAG:16,_0:0,_1:0};break}return en(n,r._2),E(h(n),c);case 3:var _=r._0;if(ue.isZeroSizedType(_.contents.ty))return;var v=yt(n,_.contents.newName);if(v!==void 0)return v.TAG===0?E(h(n),{TAG:11,_0:v._0}):E(h(n),{TAG:9,_0:v._0});throw{RE_EXN_ID:Qt,_1:_.contents.name,Error:new Error};case 4:var T=r._1,p=r._0;if(ue.isZeroSizedType(fn.typeOfExpr(T)))return;switch(p.TAG|0){case 2:if(p._1>=2){wo(n),en(n,p._2),en(n,T);var J=ue.sizeLog2(fn.typeOfExpr(T)),R={TAG:17,_0:J,_1:0};return E(h(n),R)}throw{RE_EXN_ID:$e,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error};case 3:var j=p._0,tn=yt(n,j.contents.newName);if(tn!==void 0){if(tn._1){var dn;return dn=tn.TAG===0?{TAG:12,_0:tn._0}:{TAG:10,_0:tn._0},en(n,T),E(h(n),dn)}throw{RE_EXN_ID:Ke,_1:j.contents.name,Error:new Error}}throw{RE_EXN_ID:Qt,_1:j.contents.name,Error:new Error};case 17:var Rn=p._2,wn=p._1,pn=xt(n,fn.typeOfExpr(wn),Rn);if(pn.TAG===0){var bn=pn._0;if(bn.TAG===0){var mn=bn._0;if(!mn.mut)throw{RE_EXN_ID:Ke,_1:Rn,Error:new Error};var gn=nr(n,wn);if(gn!==void 0)throw{RE_EXN_ID:Ke,_1:gn,Error:new Error};return mn.size>0?(en(n,wn),en(n,T),E(h(n),{TAG:17,_0:0,_1:mn.offset})):void 0}throw{RE_EXN_ID:$e,_1:"cannot reassign "+Rn+" for type "+b(fn.typeOfExpr(wn)),Error:new Error}}throw pn._0;default:throw{RE_EXN_ID:$e,_1:"[unreachable]: assignement to an invalid lhs expression",Error:new Error}}case 5:var on=mo(n),C=Kr(n,on,s(r._1,function(O){return[O,!1]}),r._2);return E(h(n),{TAG:0,_0:C});case 6:var Vn=r._3,Sn=r._2.contents;ue.isZeroSizedType(fn.typeOfExpr(Vn))||(en(n,Vn),Jr(n,Sn.name,Sn.ty,r._1)),e=r._4;continue;case 7:var kn=mo(n);r._1.contents.newName=kn.contents.name,Kr(n,kn,s(r._2,function(O){return[O,!1]}),r._3),e=r._4;continue;case 8:var rn=r._2,Dn=r._1,$n=function(O){return function(Cn){return Fn(O,function(Mn){return en(n,Mn)}),E(h(n),{TAG:14,_0:Cn})}}(rn),_e=function(O,D){return function(Mn){Fn(D,function(ko){return en(n,ko)});var rr=fn.typeOfExpr(O),Xt=qr(rr),ht=Pn.getOrAddSignature(n.mod,Xt);return en(n,O),E(h(n),{TAG:15,_0:ht,_1:0})}}(Dn,rn),Hn=function(O){return function(Cn,Mn){var rr=Mn!==void 0?un([Mn],O):O;return Fn(Be(rr,Cn),function(Xt){var ht=Xt[1];if(!!(ht[2]&&hr(ht[1])&&Ut(nr(n,Xt[0]))))throw{RE_EXN_ID:Ke,_1:ht[0],Error:new Error}})}}(rn);switch(Dn.TAG|0){case 3:var Qn=Dn._0,Le=yt(n,Qn.contents.newName);if(Le!==void 0)return _e(void 0);var fe=Zr(n,Qn.contents.newName);if(fe!==void 0)return Hn(fe[0].params,void 0),$n(fe[1]);var se=Us(n,Qn.contents.newName);if(se!==void 0)return Hn(se[0].args,void 0),$n(se[1]);throw{RE_EXN_ID:vo,_1:Qn.contents.name,Error:new Error};case 17:var Ge=Dn._2,In=Dn._1,yn;if(In.TAG===3){var He=In._0.contents.name,er=Kn(He);if(er!==void 0){var Qe=Zr(n,Vr(He,Ge));if(Qe!==void 0)yn=[!1,Qe[0],Qe[1]];else throw{RE_EXN_ID:$e,_1:'static function "'+Ge+'" does not exists on struct '+He,Error:new Error}}else yn=[!0,void 0,void 0]}else yn=[!0,void 0,void 0];var Nt=yn[2],vt=yn[1],Xe=yn[0],Ie;if(vt!==void 0)Ie=vt;else{var ye=xt(n,fn.typeOfExpr(In),Ge);if(ye.TAG===0){var Ft=ye._0;Ie=Ft.TAG===0?void 0:Ft._0[0]}else throw ye._0}return Tn(Ie,void 0,function(O,D){return function(Cn){var Mn=D?O:void 0;return Hn(Cn.params,Mn)}}(In,Xe)),Xe&&en(n,In),Nt!==void 0?$n(Nt):_e(void 0);default:return _e(void 0)}case 9:var dt=r._2;return Eo(n,r._3===1),Fn(r._1,function(O){return Ps(n,O)}),dt!==void 0&&en(n,dt),zs(n);case 10:var Ce=r._3,tr=$s(n.mod,r._0);return en(n,r._1),E(h(n),{TAG:4,_0:tr}),en(n,r._2),su(Ce,{TAG:0,_0:0})&&(E(h(n),0),en(n,Ce)),E(h(n),1);case 11:return E(h(n),{TAG:7,_0:0}),E(h(n),{TAG:8,_0:0}),en(n,r._0),E(h(n),9),E(h(n),{TAG:5,_0:1}),en(n,r._1),E(h(n),{TAG:6,_0:0}),E(h(n),1),E(h(n),1);case 12:var xe=r._0;return xe!==void 0&&en(n,xe),E(h(n),2);case 13:var $=r._2,H=r._1;if(!Un(H,$))switch(H.TAG|0){case 1:switch(H._0){case"Array":var Rt=H._1;if(Rt.length!==2)throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error};var Me=Rt[0];switch($.TAG|0){case 1:if($._0==="Ptr"){var Tt=$._1;if(Tt.length!==1)throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error};var Ue=Tt[0];if(!Ss(Me,Ue))throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error}}else throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error}}break;case"Ptr":var f=H._1;if(f.length!==1)throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error};var w=f[0];switch(w.TAG|0){case 1:if(w._0==="u32"){if(w._1.length!==0)throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error};switch($.TAG|0){case 1:if($._0==="u32"){if($._1.length!==0)throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error}}else throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error}}}else throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error};break;case 0:case 2:throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error}}break;case"u32":if(H._1.length!==0)throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error};switch($.TAG|0){case 1:switch($._0){case"Ptr":if($._1.length!==1)throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error};break;case"u8":if($._1.length!==0)throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error};break;default:throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error}}break;case 0:case 2:throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error}}break;default:throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error}}break;case 0:case 2:throw{RE_EXN_ID:vn,_1:H,_2:$,Error:new Error}}e=r._0;continue;case 14:return Fn(r._0,function(O){return en(n,O)});case 15:var S=r._1,k=_r(Kn(r._0)),M=k.size;go(n,M),Fn(Be(k.attributes,S),function(O){var D=O[0],Cn=D.ty;if(D.mut&&hr(Cn)){var Mn=nr(n,O[1][1]);if(Mn!==void 0)throw{RE_EXN_ID:Ke,_1:Mn,Error:new Error}}if(ge(D.impl)&&ue.size(Cn)>0)return E(h(n),{TAG:9,_0:n.stackTop.index})}),M>0&&E(h(n),{TAG:9,_0:n.stackTop.index});var z={contents:0};return Fn(S,function(O){return function(D){var Cn=Yr(n,D[1],O.contents);O.contents=O.contents+Cn|0}}(z));case 16:var Q=r._1,x=Wr(r._0);go(n,x),E(h(n),{TAG:9,_0:n.stackTop.index});var Nn=Jr(n,So("arrayAddr",n),Wn,!0);if(Q.TAG===0){E(h(n),{TAG:0,_0:0});var Zn=Jr(n,So("addr",n),Wn,!0);E(h(n),{TAG:7,_0:0}),E(h(n),{TAG:8,_0:0}),E(h(n),{TAG:11,_0:Zn}),E(h(n),{TAG:0,_0:x}),E(h(n),10),E(h(n),{TAG:5,_0:1}),E(h(n),{TAG:11,_0:Nn}),E(h(n),{TAG:11,_0:Zn}),E(h(n),4);var nt=Yr(n,Q._0,0);E(h(n),{TAG:11,_0:Zn}),E(h(n),{TAG:0,_0:nt}),E(h(n),4),E(h(n),{TAG:12,_0:Zn}),E(h(n),{TAG:6,_0:0}),E(h(n),1),E(h(n),1)}else{var $t={contents:0};Fn(Q._0,function(O,D){return function(Cn){E(h(n),{TAG:11,_0:O});var Mn=Yr(n,Cn,D.contents);D.contents=D.contents+Mn|0}}(Nn,$t))}return E(h(n),{TAG:11,_0:Nn});case 17:var Oe=r._1,ze=xt(n,fn.typeOfExpr(Oe),r._2);if(ze.TAG===0){var et=ze._0;if(et.TAG===0){var Lt=et._0;return ue.isZeroSizedType(Lt.ty)?void 0:(en(n,Oe),E(h(n),{TAG:16,_0:0,_1:Lt.offset}))}var Gt=et._0;if(Gt[2]){var gt=nr(n,Oe);if(gt!==void 0)throw{RE_EXN_ID:Ke,_1:gt,Error:new Error}}return E(h(n),{TAG:0,_0:Gt[1]})}throw ze._0}}}function Ps(n,e){var r=e._0;return en(n,r),Fn(Ye(Xn.typeOf(r)),function(u){return E(h(n),3)})}function Kr(n,e,r,u){var a=s(r,function(i){var c=i[0];return[c.contents.name,c.contents.ty,i[1]||!hr(c.contents.ty)]}),t=jr(e.contents.newName,a,Xn.typeOf(u)),o=n.funcs.push(t)-1|0;return pe(n.funcStack,t),en(n,u),E(h(n),1),At(n.funcStack),o}function qs(n,e){var r=jr("__isolated__",[],fn.typeOfExpr(e));return pe(n.funcStack,r),en(n,e),At(n.funcStack),r}function po(n,e){switch(e.TAG|0){case 0:Kr(n,e._0,e._1,e._2);return;case 1:var r=e._1,u=e._0;Eo(n,!1);var a=qs(n,e._2),t=a.instructions;if(t.length===1){var o=t[0];if(typeof o!="number"&&o.TAG===0){Ao(n,u.contents.name,r?1:2,0,d(St.Initializer.fromInstructions,[{TAG:0,_0:o._0}]));return}}ri(n.globalsInitializer.instructions,"push",[t]);var i=Ao(n,u.contents.name,r?1:0,0,d(St.Initializer.fromInstructions,[{TAG:0,_0:0}]));n.globalsInitializer.instructions.push({TAG:10,_0:i});return;case 2:return;case 3:return Fn(e._1,function(T){return po(n,{TAG:0,_0:T[0],_1:T[1],_2:T[2]})});case 4:var c=e.name,_=qr(c.contents.ty),v=Pn.getOrAddSignature(n.mod,_);Pn.addImport(n.mod,aa.make("index",c.contents.name,{_0:v})),n.externFuncs.push({name:c.contents.name,args:s(e.args,function(T){var p=T[0];return[p.contents.name,p.contents.ty,T[1]]}),ret:e.ret});return}}function Yr(n,e,r){var u=function(o){return en(n,e),E(h(n),{TAG:17,_0:0,_1:r}),o},a=Xn.typeOf(e);switch(a.TAG|0){case 0:break;case 1:var t=0;switch(a._0){case"()":if(a._1.length===0)return 0;break;case"Fun":return u(4);case"Ptr":if(a._1.length===1)return u(4);break;case"bool":case"u32":t=2;break;case"char":case"u8":t=3;break}switch(t){case 2:if(a._1.length===0)return u(4);break;case 3:if(a._1.length===0)return u(1);break}break;case 2:return Pr(a._0),u(4)}throw{RE_EXN_ID:$e,_1:"cannot store "+b(a)+" in the shadow stack",Error:new Error}}function js(n){var e=Ot(),r=function(i){return pe(e,{contents:0})},u=function(i){switch(i.TAG|0){case 15:case 16:break;default:return}var c=Wr(fn.typeOfExpr(i)),_=be(e);if(_!==void 0){_.contents=_.contents+c|0;return}else return pe(e,{contents:c})},a=function(i){var c=be(e);if(c!==void 0)return pe(e,{contents:-c.contents|0})};fn.visitProg(N(r),N(a),u,n);var t={contents:0},o={contents:0};return ui(e,function(i){var c=i.contents;o.contents=o.contents+c|0,t.contents=t.contents>o.contents?t.contents:o.contents}),t.contents}function Zs(n){var e=js(n),r={mod:Pn.make(void 0),funcs:[],scopeDepth:0,funcStack:Ot(),globals:uu(1),globalsInitializer:jr("__initGlobals__",[],De),stackTop:Go("__STACK_TOP__",1,0,0,d(St.Initializer.fromInstructions,[{TAG:0,_0:e}])),blockStack:Ot(),externFuncs:[],options:{useBulkMemoryInstructions:!1}};cr(r.globals,r.stackTop.name,r.stackTop);try{Fn(n,function(c){return po(r,c)});var u=(Math.ceil(e/65536)|0)+16|0;Pn.addMemory(r.mod,Iu.make(dr.make(u,void 0))),Pn.addExport(r.mod,$u.make("memory",2,0)),Fn(ti(fu(r.globals),function(c,_){return c.index-_.index|0}),function(c){var _=Ms(c);if(_!==void 0)return Pn.addGlobal(r.mod,_)});var a=Pu.fromFuncRefs(0,Ir(r.funcs,function(c,_){return c}));Pn.addElement(r.mod,a),Pn.addTable(r.mod,Uu.make(0,dr.makeExact(r.funcs.length)));var t=r.funcs.length,o=r.globalsInitializer.instructions.length===0;return o||(r.globalsInitializer.instructions.push(1),r.funcs.push(r.globalsInitializer)),Fn(r.funcs,function(c){c.name==="main"&&!o&&c.instructions.unshift({TAG:14,_0:t});var _=Cs(c);Pn.addExportedFunc(r.mod,c.name,_[1],_[2])}),{TAG:0,_0:r.mod}}catch(c){var i=wt(c);return{TAG:1,_0:Dt(i)}}}function Ws(n){try{return F(Ht(n),function(r){var u=s(r,Fe.from);return F(so(u),function(a){var t=a[1];La(t);var o=s(u,function(i){return Fe.subst(t,i)});return I(Zs(o),function(i){var c=Pn.encodeAsUint8Array(i);return[i,c]})})})}catch(r){var e=wt(r);return{TAG:1,_0:Dt(e)}}}function Js(n){try{var e=Ht(n);return e.TAG===0?{TAG:0,_0:m(e._0,`

`,function(u){return S_.show(u)})}:{TAG:1,_0:e._0}}catch(u){var r=wt(u);return{TAG:1,_0:Dt(r)}}}function Ks(n){try{var e=Ht(n);if(e.TAG!==0)return{TAG:1,_0:e._0};var r=s(e._0,Fe.from);return{TAG:0,_0:m(r,`

`,function(a){return Fe.show(void 0,a)})}}catch(a){var u=wt(a);return{TAG:1,_0:Dt(u)}}}function Ys(n){try{var e=Ht(n);if(e.TAG!==0)return{TAG:1,_0:e._0};var r=s(e._0,Fe.from),u=so(r);if(u.TAG!==0)return{TAG:1,_0:u._0};var a=u._0[1];La(a);var t=s(r,function(i){return Fe.subst(a,i)});return{TAG:0,_0:m(t,`

`,function(i){return Fe.show(N(N(a)),i)})}}catch(i){var o=wt(i);return{TAG:1,_0:Dt(o)}}}var Hs={debugAst:Js,debugCoreAst:Ks,debugTypes:Ys},Qs=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",compile:Ws,Debug:Hs});const Hr={"0":"Else","1":"End","2":"Return","3":"Drop","4":"AddI32","5":"SubI32","6":"MulI32","7":"DivI32Unsigned","8":"DivI32Signed","9":"EqzI32","10":"EqI32","11":"EqI64","12":"EqF32","13":"EqF64","14":"NeI32","15":"NeI64","16":"NeF32","17":"NeF64","18":"LeI32Signed","19":"LeI32Unsigned","20":"LeI64Signed","21":"LeI64Unsigned","22":"LeF32","23":"LeF64","24":"GeI32Signed","25":"GeI32Unsigned","26":"GeI64Signed","27":"GeI64Unsigned","28":"GeF32","29":"GeF64","30":"LtI32Signed","31":"LtI32Unsigned","32":"LtI64Signed","33":"LtI64Unsigned","34":"LtF32","35":"LtF64","36":"GtI32Signed","37":"GtI32Unsigned","38":"GtI64Signed","39":"GtI64Unsigned","40":"GtF32","41":"GtF64","42":"RemI32Signed","43":"RemI32Unsigned","44":"AndI32","45":"OrI32","46":"ShlI32","47":"ShrI32Signed","48":"ShrI32Unsigned"},X={"0":"I32","1":"I64","2":"F32","3":"F64"},Is={"0":"FuncRef","1":"ExternRef"},ys={"0":"Func","1":"Table","2":"Memory","3":"Global"},Se={"0":"Void"},xs={"0":"Passive"},n1=Qs,bo=function(n){const e=n1.compile(n);return e.TAG===0?{tag:"Ok",value:[{typeSection:e._0[0].typeSection.map(function(u){return[u._0.map(function(t){return X[t]}),u._1.map(function(t){return X[t]})]}),importSection:e._0[0].importSection.map(function(u){return{moduleName:u.moduleName,entityName:u.entityName,desc:{tag:"Func",value:u.desc._0}}}),funcSection:e._0[0].funcSection,tableSection:e._0[0].tableSection.map(function(u){return[Is[u[0]],u[1]]}),memorySection:e._0[0].memorySection,globalSection:e._0[0].globalSection.map(function(u){return[X[u[0]],u[1],u[2].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:X[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return X[i]}),t._0._1[1].map(function(i){return X[i]})]]}:Se[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:X[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return X[i]}),t._0._1[1].map(function(i){return X[i]})]]}:Se[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:X[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return X[i]}),t._0._1[1].map(function(i){return X[i]})]]}:Se[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:t.TAG===17?{tag:"StoreI32",value:[t._0,t._1]}:t.TAG===18?{tag:"InitMemory",value:t._0}:{tag:"DropData",value:t._0}:Hr[t]})]}),exportSection:e._0[0].exportSection.map(function(u){return{name:u.name,kind:ys[u.kind],index:u.index}}),elementSection:e._0[0].elementSection,codeSection:e._0[0].codeSection.map(function(u){return[u[0].map(function(t){return[t[0],X[t[1]]]}),u[1].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:X[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return X[i]}),t._0._1[1].map(function(i){return X[i]})]]}:Se[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:X[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return X[i]}),t._0._1[1].map(function(i){return X[i]})]]}:Se[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:X[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return X[i]}),t._0._1[1].map(function(i){return X[i]})]]}:Se[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:t.TAG===17?{tag:"StoreI32",value:[t._0,t._1]}:t.TAG===18?{tag:"InitMemory",value:t._0}:{tag:"DropData",value:t._0}:Hr[t]})]}),dataSection:e._0[0].dataSection.map(function(u){return{init:u.init,mode:typeof u.mode=="object"?[u.mode._0,u.mode._1]:xs[u.mode]}}),funcs:e._0[0].funcs.map(function(u){return[u[0],[u[1]._0.map(function(t){return X[t]}),u[1]._1.map(function(t){return X[t]})],[u[2][0].map(function(t){return[t[0],X[t[1]]]}),u[2][1].map(function(t){return typeof t=="object"?t.TAG===0?{tag:"ConstI32",value:t._0}:t.TAG===1?{tag:"ConstI64",value:t._0}:t.TAG===2?{tag:"ConstF32",value:t._0}:t.TAG===3?{tag:"ConstF64",value:t._0}:t.TAG===4?{tag:"If",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:X[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return X[i]}),t._0._1[1].map(function(i){return X[i]})]]}:Se[t._0]}:t.TAG===5?{tag:"BranchIf",value:t._0}:t.TAG===6?{tag:"Branch",value:t._0}:t.TAG===7?{tag:"Block",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:X[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return X[i]}),t._0._1[1].map(function(i){return X[i]})]]}:Se[t._0]}:t.TAG===8?{tag:"Loop",value:typeof t._0=="object"?t._0.TAG===0?{tag:"TypeValue",value:X[t._0._0]}:{tag:"TypeIndex",value:[t._0._0,[t._0._1[0].map(function(i){return X[i]}),t._0._1[1].map(function(i){return X[i]})]]}:Se[t._0]}:t.TAG===9?{tag:"GetGlobal",value:t._0}:t.TAG===10?{tag:"SetGlobal",value:t._0}:t.TAG===11?{tag:"GetLocal",value:t._0}:t.TAG===12?{tag:"SetLocal",value:t._0}:t.TAG===13?{tag:"TeeLocal",value:t._0}:t.TAG===14?{tag:"Call",value:t._0}:t.TAG===15?{tag:"CallIndirect",value:[t._0,t._1]}:t.TAG===16?{tag:"LoadI32",value:[t._0,t._1]}:t.TAG===17?{tag:"StoreI32",value:[t._0,t._1]}:t.TAG===18?{tag:"InitMemory",value:t._0}:{tag:"DropData",value:t._0}:Hr[t]})]]})},e._0[1]]}:{tag:"Error",value:e._0}};var e1=`
let SIZEOF_U32 = 4;

struct Array {
  start: Ptr<u32>,
  mut length: u32,
}

impl Array {
  fn read(self, n) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>)
  }

  fn write(mut self, n, val) unsafe {
    *(((self.start as u32) + n * SIZEOF_U32) as Ptr<u32>) = val;
  }

  fn push(mut self, val) {
    self.write(self.length, val);
    self.length += 1;
  }
}

struct Sieve {
  mut primes: Array,
  mut current: u32
}

impl Sieve {
  fn clear(mut self) {
    self.primes.length = 0;
    // 2 is the first prime
    self.primes.push(2);
    self.current = 1;
  }

  fn isPrime(mut self, n) {
    mut i = 0;
    mut p = self.primes.read(i);

    while p * p <= n {
      if n % p == 0 { return false; }
      i += 1;
      p = self.primes.read(i);
    }

    // n is prime
    // add it to the sieve
    self.primes.push(n);

    true
  }

  fn nextPrime(mut self) {
    self.current += 2;

    while !self.isPrime(self.current) {
      self.current += 2;
    }

    self.current
  }

  // count the prime numbers <= m
  fn countUpTo(mut self, m) {
    self.clear();

    while self.current <= m {
      self.nextPrime();
    }

    self.primes.length - 1
  }
}

fn main() {
  mut sieve = Sieve {
    primes: Array {
      start: [0; 10000] as Ptr<u32>,
      length: 0
    },
    current: 0
  };

  sieve.countUpTo(100000)
}
`,t1=`
fn fact(n) {
  if n == 0 { 1 } else { n * fact(n - 1) }
}

fn main() {
  fact(11)
}`,r1=`
fn fib(n) {
  let fib_aux = (n, a, b) -> {
    if n == 0 {
      a
    } else {
      fib_aux(n - 1, b, a + b)
    }
  };

  fib_aux(n, 0, 1)
}

fn main() {
  fib(83)
}`,u1=`
let SIZEOF_U32 = 4;

fn read_u32(addr) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>)
}

fn write_u32(addr, val) unsafe {
  *((addr * SIZEOF_U32) as Ptr<u32>) = val;
}

fn main() {
  let square = n -> n * n;

  mut i = 0;
  while i < 100 {
    write_u32(i, square(i));
    i += 1;
  }

  read_u32(42) // 1764
}`,a1=`
fn isEven(n) {
  n & 1 == 0
}

fn isPrime(n) {
  if n < 2 { return false; }
  if n == 2 { return true; }
  if isEven(n) { return false; }

  mut i = 3;

  while i * i <= n {
    if n % i == 0 { return false; }
    i += 2;
  }

  true
}

fn countPrimesLessThan(m) {
  mut i = m;
  mut count = 0;

  while i > 1 {
    if isPrime(i) {
      count += 1;
    }

    i -= 1;
  }

  count
}

fn main() {
  countPrimesLessThan(1000000)
}`,o1=`
struct MinMax {
  mut min: u32,
  mut max: u32
}

impl MinMax {
  fn reset(mut self) {
    self.min = 0;
    self.max = 0;
  }

  fn resetStatic(mut m) {
    m.reset();
  }
}

fn main() {
  mut m = MinMax {
    min: 17,
    max: 22
  };

  MinMax.resetStatic(m);
  
  m.min + m.max == 0
}`,i1=`
fn main() {
  let twice = (f, x) -> f(f(x));
  
  twice(n -> n * n, 7)
}`,c1=`
struct BumpAllocator {
  mut head: u32
}

impl BumpAllocator {
  fn allocate(mut self, bytes) {
    let addr = self.head as Ptr<u32>;
    self.head = self.head + bytes;
    addr
  }
  
  // do nothing!
  fn free(mut self, addr) { }
}

mut allocator = BumpAllocator { head: 64 * 1024 };

let SIZEOF_U32 = 4;

struct Vec {
  mut start: Ptr<u32>,
  mut length: u32,
  mut capacity: u32 
}

impl Vec {
  fn read(self, index) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>)
  }

  fn write(mut self, index, value) unsafe {
    *(((self.start as u32) + (index * SIZEOF_U32)) as Ptr<u32>) = value;
  }

  fn grow(mut self) unsafe {
    let newCap = if self.capacity == 0 { 8 } else { self.capacity * 2 };
    let newStart = allocator.allocate(newCap * SIZEOF_U32);

    // copy the data from the old array to the new one
    mut i = 0;
    while i < self.length {
      *(((newStart as u32) + (i * SIZEOF_U32)) as Ptr<u32>) = self.read(i);
      i += 1;
    }

    allocator.free(self.start);
    self.start = newStart;
    self.capacity = newCap;
  }

  fn push(mut self, val) {
    if self.length + 1 > self.capacity {
      self.grow();
    }

    self.write(self.length, val);
    self.length += 1;
  }

  fn pop(mut self) {
    if self.length > 0 {
      self.length -= 1;
      self.read(self.length)
    } else {
      // until we have Option<T>
      4294967295 // -1
    }
  }
}

fn main() {
  mut vec = Vec {
    start: 0 as Ptr<u32>,
    length: 0,
    capacity: 0
  };

  mut i = 0;
  while i < 1000 {
    vec.push(i);
    i += 1;
  }

  (vec.length, vec.capacity, vec.read(723))
}`,_1=`
fn isEven(n) {
  n & 1 == 0
}

fn nextCollatz(n) {
  if isEven(n) { n / 2 } else { 3 * n + 1 }
}

fn collatzLen(n) {
  mut len = 1;
  
  while n != 1 {
    n = nextCollatz(n); 
    len += 1;
  }
  
  len
}

fn pb14() {
  mut longest = 0;
  mut longestIndex = 0;

  mut i = 1;
  while i <= 1000000 {
    let len = collatzLen(i);
    if len > longest {
      longest = len;
      longestIndex = i;
    }

    i += 1;
  }
  
  (longest, longestIndex)
}

fn main() {
  pb14()
}`,f1=`
fn digitsSquareSum(n) {
  let square = n -> n * n;
  mut sum = 0;

  while n > 0 {
    sum += square(n % 10);
    n /= 10;
  }

  sum
}

fn reaches89(n) {
  while n != 1 {
    if n == 89 { return true; }
    n = digitsSquareSum(n);
  }

  false
}

fn main() {
  mut i = 1;
  mut count = 0;
  while i < 10000000 {
    if reaches89(i) {
      count += 1;
    }

    i += 1;
  }

  count
}`,s1=`
extern fn log(n: u32) -> ();
extern fn expectEqual(value: u32, expected: u32) -> ();

fn main() {
  mut i = 0;
  
  while i <= 10 {
    expectEqual(i, i);
    i += 1;
  }
}`;const l1={"Prime sieve":e1,Factorial:t1,Fibonacci:r1,Pointers:u1,Primes:a1,Structs:o1,"Lambda (kind of)":i1,Vector:c1,"External functions":s1,"Project Euler 14":_1,"Project Euler 92":f1},v1=async n=>{const e=await WebAssembly.compile(n),r=new TextDecoder,u=await WebAssembly.instantiate(e,{index:{log:console.log,expectEqual(a,t){if(a!==t)throw new Error(`[expectEqual] expected ${a}, got: ${t}`)},printString(a,t){const o=u.exports.memory,i=new Uint8Array(o.buffer),c=r.decode(i.subarray(a,a+t));console.log(c)}}});if(console.log(u.exports),"main"in u.exports){console.time("run");const a=u.exports.main();return console.timeEnd("run"),a}else return"Error: main function not found, exported functions are: "+Object.keys(u.exports).join(", ")},d1={Run:async(n,e)=>{e("running...");try{const r=bo(n);if(r.tag==="Ok"){const u=await v1(r.value[1]);e(`${u}`)}else e(r.value)}catch(r){e(`${r}`)}},Disassemble:(n,e)=>{try{const r=bo(n);if(r.tag==="Ok"){const[u]=r.value;e(Pc(u))}else e(r.value)}catch(r){e(`${r}`)}}},T1=()=>zt.createElement(oi,{actions:d1,samples:l1,aceMode:"rust"});ii.render(zt.createElement(zt.StrictMode,null,zt.createElement(T1,null)),document.getElementById("root"));
